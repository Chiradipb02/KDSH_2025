Physics-informed Neural ODE for Post-disaster Mobility Recovery
Jiahao Li∗
Shenzhen International Graduate
School, Tsinghua University
Shenzhen, China
li-jh23@mails.tsinghua.edu.cnHuandong Wang∗
Department of Electronic
Engineering, Tsinghua University
Beijing, China
wanghuandong@tsinghua.edu.cnXinlei Chen†
Shenzhen International Graduate
School, Tsinghua University
Pengcheng Laboratory
RISC-V International Open Source
Laboratory
Shenzhen, China
chen.xinlei@sz.tsinghua.edu.cn.
ABSTRACT
Urban mobility undergoes a profound decline in the aftermath of
a disaster, subsequently exhibiting a complex recovery trajectory.
Effectively capturing and predicting this dynamic recovery pro-
cess holds paramount importance for devising more efficient post-
disaster recovery strategies, such as resource allocation to areas
with protracted recovery periods. Existing models for post-disaster
mobility recovery predominantly employ basic mathematical meth-
ods, which are strongly based on simplifying assumptions, and
their limited parameters restrict their capacity to fully capture the
mobility recovery patterns. In response to this gap, we introduce
the Coupled Dynamic Graph ODE Network (CDGON) to model the
intricate dynamics of post-disaster mobility recovery. Our model
seamlessly integrates existing physical knowledge pertaining to
post-disaster mobility recovery and incorporates the nuanced inter-
actions between intra-regional and inter-regional population flows.
Extensive experimental results demonstrate the efficiency of our
model in capturing the dynamic recovery patterns of urban popula-
tion mobility in post-disaster scenarios, surpassing the capabilities
of current dynamic graph prediction models.
CCS CONCEPTS
•Networks→Network dynamics ;•Computing methodologies
→Machine learning algorithms; •Human-centered comput-
ing→Social engineering (social sciences) .
KEYWORDS
Physics-informed; Graph Neural ODE; Urban Mobility Recovery;
Post-Disaster
ACM Reference Format:
Jiahao Li, Huandong Wang, and Xinlei Chen. 2024. Physics-informed Neural
ODE for Post-disaster Mobility Recovery. In Proceedings of the 30th ACM
SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24),
August 25–29, 2024, Barcelona, Spain. ACM, New York, NY, USA, 12 pages.
https://doi.org/10.1145/3637528.3672027
∗Both authors contributed equally to this research.
†Corresponding author.
This work is licensed under a Creative Commons Attribution
International 4.0 License.
KDD ’24, August 25–29, 2024, Barcelona, Spain
©2024 Copyright held by the owner/author(s).
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3672027
Figure 1: Human mobility within each county over time in
South Carolina, where a line represents the intra-regional
population flow curve of a county, and different colors rep-
resent different counties.
1 INTRODUCTION
The fast progress of urbanization and frequently occurred extreme
events (disasters) around the world have caused a non-negligible
impact on the lives and safety of urban residents [ 14]. As a result,
there is an urgent need to have a deep understanding of urban
resilience, i.e., the ability of the city to rapidly recover its function-
alities from the shock of extreme events, where human mobility
within urban areas has played a critical role [ 23,44]. On the one
hand, urban mobility reflects the behaviors of urban residents in
terms of traveling from residential areas to other functional areas
to acquire essential resources (e.g., food and money), thus serving
as a pivotal indicator of residents’ satisfaction with access to neces-
sities [ 23]. On the other hand, urban mobility is intricately linked
with the normal operation of urban infrastructures, e.g., transport
facilities and office buildings, thus reflecting the recovery status
of urban infrastructures [ 44]. Less resilient cities often need more
time to resume normal urban mobility, thereby causing greater
impacts on the lives of urban residents and more economic losses.
Thus, accurately predicting the recovery process of urban mobility
after disasters helps to detect high-risk urban communities, design
better emergency response strategies, and ultimately build a more
intelligent and resilient city [39].
 
1587
KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
However, predicting the post-disaster recovery process of urban
mobility is also a difficult task with the following challenges. Firstly,
the post-disaster recovery of urban mobility has complicated pat-
terns intricately intertwined with diverse disaster situations and
their normal mobility characteristics before disasters [ 20,38,47].
For instance, as depicted in Fig. 1, the temporal recovery curves of
human mobility in different regions, i.e., counties in this instance,
of South Carolina after Hurricane Dorian in September 2019 exhibit
significant diversity and notable fluctuations. These phenomena
are largely caused by complicated disaster situations in different
regions, coupled with the inherent diversity in their normal mobil-
ity features before disasters. However, the underlying mechanisms
remain unclear and are difficult to be accurately modeled just using
observable data. Secondly, the recovery processes of different ur-
ban areas are interdependent. Interactions between regions, which
can be characterized by inter-regional population flows, have sig-
nificant influences on their recovery processes. Urban areas with
larger net population inflow will have a quicker recovery rate, as
they have a larger active population, thereby facilitating the recon-
struction and recovery process [ 43]. These interactions between
regions are also highly dynamic and further amplify the complexity
of effectively modeling and predicting their dynamics [11].
However, existing approaches for modeling the post-disaster
recovery process of urban mobility are mainly model-based meth-
ods [23, 38, 43]. They make strong simplifying assumptions about
urban mobility, and then employ mathematical models constructed
with a limited number of parameters with explicit physical inter-
pretations to fit its recovery process [ 23,38,43]. For example, Li et
al. [23] propose a hyperbolic model, which is called the spatiotem-
poral decay model, to describe the temporal recovery patterns of
urban mobility. Yabe et al. [ 43] developed two coupled differential
equation models to describe the recovering dynamics of the socio-
physical system composed of physical infrastructure and urban
mobility. Although these models provide valuable knowledge about
the recovery of post-disaster urban mobility, strong simplifying
assumptions and limited model parameters restrict their capacity
to fully capture the diverse and complicated recovery patterns of
post-disaster urban mobility. Moreover, all these models fail to ef-
fectively model the influence of inter-regional population flows on
their recovery.
At the same time, the rapid development of data-driven deep
learning technologies, represented by graph neural networks (GNN)
and neural ordinary differential equations (Neural ODE) [ 18,50],
has equipped us with enhanced capabilities to model the dynamics
of co-evolved nodes and edges in graph structures. Furthermore,
the rise of physics-informed machine learning facilitates the in-
tegration of prior physical knowledge into data-driven modeling
frameworks [ 42]. These methodologies present a promising solu-
tion for effectively modeling and predicting post-disaster urban
mobility dynamics in the data-driven paradigm.
In this paper, we propose a deep learning framework, named
Coupled Dynamic Graph ODE Network (CDGON), to predict the
recovery process of post-disaster urban mobility. To overcome the
first challenge, we employ a paradigm of physics-inspired machine
learning to construct a neural ODE function guided by the spatio-
temporal decay model. It enables effective modeling of the diverse
and highly fluctuating urban mobility within different regions, andjointly considers urban mobility before and after disasters. Further,
we introduce another set of coupled neural ODE functions to de-
scribe the dynamics of inter-regional population flows, which serve
as edges in the formed dynamic graph to characterize the compli-
cated post-disaster urban mobility. The two sets of neural ODE
functions jointly model the co-evolving process of nodes and edges
in the dynamic graph in terms of intra-regional and inter-regional
population flow, thus effectively solving the second challenge. Over-
all, our contributions can be summarized as follows:
•We integrate the physics-based knowledge from the spatio-
temporal decay model into the neural ODE model, and derive
a powerful framework for capturing the intertwined dynam-
ics of urban mobility before and after disasters.
•We employ coupled neural ODE functions to jointly model
the co-evolving process of intra-regional and inter-regional
population flow, capturing dynamic interactions between
regions in the post-disaster recovery process.
•Extensive experimental results demonstrate the efficiency
of our model in capturing the dynamic recovery patterns
of urban mobility in post-disaster scenarios, surpassing the
capabilities of current dynamic graph prediction models.
2 PRELIMINARIES
2.1 Spatiotemporal Decay Model (ST Decay
Model)
In this section, we introduce the Spatiotemporal Decay Model (ST
Decay Model) proposed by Li et al. [23]. This model is formulated
as a hyperbolic equation, represented as follows:
𝑟𝑖(𝑡)=𝑟𝑖
1+𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡), (1)
where𝑟𝑖(𝑡)denotes the abnormal mobility in region 𝑖after a dis-
aster, and𝑟𝑖represents the normal mobility of region 𝑖prior to
the disaster. Eq. (1) illustrates that abnormal urban mobility after
disasters tends to normalize over time, attributable to the reduction
in the value of 𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡). In this context, 𝑘(𝑡)measures
temporal decay, capturing the decline in mobility behavior changes
over time, whileÍ𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡)measures spatial decay. Here, 𝑁𝑗(𝑡)
denotes the severity of the crisis in the region 𝑗at time𝑡, where
region𝑗is a neighbor of the region 𝑖, and𝑤𝑖𝑗represents the spatial
weight between 𝑖and𝑗.
Specifically, the temporal decay function 𝑘(𝑡)is best described
by the negative exponential function 𝑘0𝑒−𝛼𝑡[23] as follows:
𝑘(𝑡)=𝑘0𝑒−𝛼𝑡, (2)
where𝛼serves as the parameter that governs the rate of decay, and
𝑘0represents the initial rate of change in mobility behavior.
2.2 Graph Neural ODE
Neural Ordinary Differential Equation (Neural ODE) is a type of
deep neural network introduced by Chen et al. [ 3], which merges
the neural networks with ordinary differential equations, offer-
ing a continuous generalization of the Residual Neural Network
(ResNet) [ 15]. Neural ODE facilitates the seamless incorporation
of neural networks for continuously learning residuals, thereby
endowing it with robust fitting capabilities. Poli et al. [ 29] integrate
 
1588Physics-informed Neural ODE for Post-disaster Mobility Recovery KDD ’24, August 25–29, 2024, Barcelona, Spain
Graph Convolutional Networks (GCN) into Neural ODE. Following
this work, numerous studies incorporate GCN into Neural ODE
for dynamic graph prediction [ 12,18,50], which is one of the most
challenging tasks in graph learning. The equation of graph Neural
ODE can be described as follows:
𝑍𝑇=𝑍0+∫𝑡=𝑇
𝑡=0𝑓𝐺(𝑍𝑡,Θ)d𝑡, (3)
where𝑍0represents the node embeddings in a graph at the initial
moment, and 𝑓𝐺is a function designed for processing nodes em-
beddings with learnable parameters Θ. Here,𝑓𝐺is often replaced
with a graph convolution operation. Integration across the interval
[0,𝑇]yields𝑍𝑇, denoting the node embeddings at time 𝑇.
3 PROBLEM FORMULATION
The discrete dynamic population mobility graph sequence is defined
asG={𝐺0,𝐺1,...,𝐺𝑇}, where𝐺𝑡=(V,E𝑡,𝑋𝑡,𝐴𝑡)is a human
mobility graph with Vdenoting the set of 𝑛regions, which is
treated as nodes. The feature matrix at timestamp 𝑡is represented
as𝑋𝑡. The setE𝑡indicates the population flows between different
regions at timestamp 𝑡, which is treated as edges, with their features
forming the weighted adjacency matrix 𝐴𝑡at timestamp 𝑡.
Since population mobility recovers day by day instead of hour by
hour, thus𝐺𝑡denotes the population mobility on day 𝑡. The related
definitions of the features on nodes and edges are as follows:
Definition 1 (Intra-regional Population Flow). The intra-
regional population flow within region 𝑖∈V at day𝑡is denoted as
𝑥𝑡
𝑖∈R. This node feature measures the total population that moved
within this region, representing the population mobility of region 𝑖.
Consequently, the feature matrix of nodes at day 𝑡is𝑋𝑡∈R𝑁×1,
with its dynamic sequence represented as X={𝑋0,𝑋1,...,𝑋𝑇}.
Definition 2 (Inter-regional Population Flow). The inter-
regional population flow from region 𝑖to region𝑗at day𝑡is denoted
as𝑥𝑡
𝑖𝑗∈R. This feature on edge 𝑒𝑡
𝑖𝑗∈E𝑡calculates the volume of the
population that moves from region 𝑖to region𝑗at day𝑡and represents
the population mobility between these two regions. Therefore, the corre-
sponding weighted adjacent matrix sequence is A={𝐴0,𝐴1,...,𝐴𝑇}
where the element in the 𝑖th row and𝑗th column of 𝐴𝑡is𝑥𝑡
𝑖𝑗.
In the realm of dynamic graph prediction, traditional meth-
ods typically leverage historical graph sequences to predict future
graphs, performing well under normal circumstances as population
mobility tends to fluctuate periodically within a predictable range.
However, the occurrence of a disaster disrupts this regular pattern,
leading to a shift in population mobility towards an abnormal state.
Consequently, historical population mobility patterns prior to the
disaster become inadequate for predicting the mobility recovery
process under abnormal conditions.
To address this challenge, letting Grepresent the sequence of
abnormal population mobility graphs during the recovery process,
with the landfall day of the disaster as the initial moment, we define
a normal population mobility graph to guide the abnormal mobility
recovery as follows:
Definition 3 (normal population mobility graph). The nor-
mal population mobility graph is defined as 𝐺=(V,E𝑡,𝑋,𝐴),
where the normal intra-regional population flow matrix is 𝑋=1
𝑇1−𝑇2Í𝑡=𝑇2
𝑡=𝑇1𝑋𝑡and the normal weighted adjacent matrix is 𝐴=
1
𝑇1−𝑇2Í𝑡=𝑇2
𝑡=𝑇1𝐴𝑡. Here,𝑇1and𝑇2are the starting and ending days of
a normal period before a disaster.
We now define the post-disaster dynamic population mobility
graph prediction problem as follows:
Definition 4 (Post-disaster Dynamic Population Mobility
Graph Prediction Problem). Given the initial abnormal popula-
tion mobility graph 𝐺0and normal population mobility graph 𝐺, pre-
dict the subsequent population mobility graphs 𝐺𝑡,𝑡∈{1,2,...,𝑇}
during the recovery process after the disaster.
4 METHODOLOGY
4.1 Framework of Proposed Method
The goal of our Coupled Dynamic Graph ODE Network (CDGON)
is to predict the population mobility recovery process post-disaster
using the initial abnormal population mobility graph and the normal
population mobility graph, which is challenging since the available
data is limited. To address this difficulty, we leverage the prior
physical knowledge derived from the ST Decay Model to design our
node ODE function and carefully model the co-evolution of nodes
and edges, effectively solving the post-disaster dynamic population
mobility graph prediction problem.
Fig. 2 presents an overview of our model architecture, comprising
the Encoder, the ST Decay Model Informed Neural ODE, and the
Decoder. The Encoder first maps the initial abnormal population
mobility graph and normal intra-regional population flow into a
latent space. Then, the ST Decay Model Informed Neural ODE
captures the dynamic of the mobility recovery. Finally, the Decoder
generates the predictive graph and filters out unreasonable results.
4.2 Encoder for Population Mobility Graph
To initiate the modeling process, the initial abnormal intra-regional
population flows 𝑥0
𝑖within nodes and corresponding normal intra-
regional population flows 𝑥𝑖are jointly encoded through an identi-
cal node encoder 𝐹𝐸𝑛𝑐𝑁 :R1→R𝑑as follows:
𝑧0
𝑖=𝐹𝐸𝑛𝑐𝑁(𝑥0
𝑖), (4)
𝑧𝑖=𝐹𝐸𝑛𝑐𝑁(𝑥𝑖), (5)
where𝑧0
𝑖and𝑧𝑖are both𝑑-dimensional vectors.
Additionally, the initial abnormal inter-regional population flows
𝑥0
𝑖𝑗on edges are encoded through the edge encoder 𝐹𝐸𝑛𝑐𝐸 :R1→
R𝑑, producing the edge latent state 𝑧0
𝑖𝑗, which is also a 𝑑-dimensional
vector:
𝑧0
𝑖𝑗=𝐹𝐸𝑛𝑐𝐸(𝑥𝑖𝑗). (6)
4.3 ST Decay Model Informed Neural ODE
After acquiring the initial state of node 𝑧0
𝑖and edge𝑧0
𝑖𝑗, our ST
Decay Model Informed Neural ODE utilizes them to generate the
subsequent latent states 𝑧1
𝑖,𝑧2
𝑖,...,𝑧𝑇
𝑖for nodes and 𝑧1
𝑖𝑗,𝑧2
𝑖𝑗,...,𝑧𝑇
𝑖𝑗
for edges, where 𝑇is the observed recovery time length. Notably,
this generation process is guided by the latent state of normal
intra-regional mobility 𝑧𝑖.
 
1589KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
Figure 2: Model architectrue.
This section introduces two primary components of our ST De-
cay Model Informed Neural ODE: the Physics-informed Dynamic
Module (PIDM) and the Node-Edge Interaction Module (NEIM).
4.3.1 Physics-informed Dynamic Module. Before we delve into our
PIDM, we first introduce the theorem that is deduced from the ST
Decay Model:
Theorem 1. Denote𝑟𝑖(𝑡)as the abnormal intra-regional population
flow of region 𝑖after a disaster, which is described in the ST Decay
Model shown in Eq. (1). The derivative of 𝑟𝑖(𝑡)satisfies the following
differential equation:
d𝑟𝑖(𝑡)
d𝑡=𝛼𝑟𝑖(𝑡)
𝑟𝑖[𝑟𝑖−𝑟𝑖(𝑡)], (7)
where𝛼indicates the decay coefficient. It implies that 𝑟𝑖(𝑡)will ap-
proach to the normal intra-regional population flow 𝑟𝑖over time
governed by 𝛼.
Proof. See the Appendix for proof. □
Eq. (7) in Theorem 1 describes the self-evolution of intra-regional
population flow in the region 𝑖. Therefore, it can inform the de-
sign of our node ODE function. However, Eq. (7) describes the
1-dimensional dynamics of mobility recovery. Modeling this in a
𝑑-dimensional space requires a well-designed network structure.
Consequently, we proposed PIDM, structurally resembling Eq. (7),
to capture the self-evolution of the node latent state. The module is
depicted as follows:
d𝑧𝑡
𝑖
d𝑡=®𝛼𝑡
𝑖⊙(𝑓𝜃(𝑧𝑡
𝑖)
𝑓𝜃(𝑧𝑖)⊙𝑅𝑒𝐿𝑈(𝑧𝑖−𝑧𝑡
𝑖)𝑊1), (8)where⊙indicates the element-wise product, and ®𝛼𝑡
𝑖∈R𝑑rep-
resents the decay coefficient vector for region 𝑖, analogous to the
parameter𝛼in Eq. (7), which means we calculate a decay parameter
for each element in the hidden state vector.
Given that the true values of population mobility can reach
several million for regions with large populations, a potential nu-
merical explosion might occur for the term (𝑧𝑡
𝑖)2in𝑧𝑡
𝑖
𝑧𝑖[𝑧𝑖−𝑧𝑡
𝑖]
if we design the node ODE directly as in Eq. (7). Therefore, we
replace𝑧𝑡
𝑖
𝑧𝑖∈R𝑑with𝑓𝜃(𝑧𝑡
𝑖)
𝑓𝜃(𝑧𝑖)∈R1, where𝑓𝜃:R𝑑→R1calculates
a scalar from a 𝑑-dimensional vector, helping to avoid the potential
numerical explosion problem. While 𝑧𝑖−𝑧𝑡
𝑖remains unchanged,
analogous to 𝑟𝑖−𝑟𝑖(𝑡), but we also use a 𝑅𝑒𝐿𝑈 and a learnable
transformation matrix 𝑊1∈R𝑑×𝑑to enhance the model’s learning
capacity.
4.3.2 Node-Edge Interaction Module (NEIM). With the develop-
ment of our PIDM, it is imperative to acknowledge that, in reality,
intra-regional population flow within a region is influenced by
inter-regional population flows from other regions [ 47]. Particu-
larly after a disaster, people who sought refuge in distant areas
will return to their original locations. This surge in population in-
flow leads to a rapid recovery of intra-regional flow in urban areas
near the disaster center, especially in cities with large populations.
Therefore, considering the interaction between nodes and edges is
crucial.
Notably, although the initial edge information is known, the
population mobility graph structure is dynamic, meaning edges may
vanish or emerge during the evolution. To capture this dynamic,
 
1590Physics-informed Neural ODE for Post-disaster Mobility Recovery KDD ’24, August 25–29, 2024, Barcelona, Spain
we compute an adaptive graph weight adjacent matrixˆ𝐴𝑡:
ˆ𝐴𝑡=[𝑎𝑡
𝑖𝑗]𝑛×𝑛, (9)
𝑎𝑡
𝑖𝑗=𝑅𝑒𝐿𝑈(𝑔𝐸𝑡𝑉(𝑔𝑁𝑡𝐸([𝑧𝑡
𝑖∥𝑧𝑡
𝑗]))), (10)
where∥denotes the horizontal concatenation, and 𝑎𝑡
𝑖𝑗in the𝑖th
row and𝑗th column ofˆ𝐴𝑡is learned from the concatenation of
the two corresponding nodes through 𝑔𝑁𝑡𝐸 :R2𝑑→R𝑑and
𝑔𝐸𝑡𝑉:R𝑑→R1. Besides, the 𝑅𝑒𝐿𝑈 activation function is used to
eliminate the negative values.
Afterˆ𝐴𝑡is generated, drawing inspiration from Coupled Graph
ODE [18], we design the edge ODE function as follows:
d𝑧𝑡
𝑖𝑗
d𝑡=ˆ𝑒𝑡
𝑖𝑗[𝑓𝐸𝑡𝐸(𝑧𝑡
𝑖𝑗)+𝑓𝑁𝑡𝐸([𝑧𝑡
𝑖∥𝑧𝑡
𝑗])], (11)
where𝑓𝐸𝑡𝐸:R𝑑→R𝑑computes the self-evolution of edges, and
𝑓𝑁𝑡𝐸 :R2𝑑→R𝑑captures information from the concatenation
of the two connected nodes. Both 𝑓𝐸𝑡𝐸and𝑓𝑁𝑡𝐸are linear layers.
Specifically, the edge indicator ˆ𝑒𝑡
𝑖𝑗denotes the connectivity of node
𝑖and node𝑗based on𝑎𝑡
𝑖𝑗:
ˆ𝑒𝑡
𝑖𝑗=(
1,if𝑎𝑡
𝑖𝑗≥1
0,if𝑎𝑡
𝑖𝑗<1(12)
where ˆ𝑒𝑡
𝑖𝑗will be 1 if𝑎𝑡
𝑖𝑗exceeds 1, indicating that population flow
from region 𝑖to region𝑗exists and the edge should be updated.
For the original node ODE function in PIDM, instead of ag-
gregating neighbor information as in [ 18], we aggregate edges
surrounding the node:
d𝑧𝑡
𝑖
d𝑡=®𝛼𝑡
𝑖⊙(𝑓𝜃(𝑧𝑡
𝑖)
𝑓𝜃(𝑧𝑖)⊙𝑅𝑒𝐿𝑈(𝑧𝑖−𝑧𝑡
𝑖)𝑊1)
+∑︁
𝑗∈𝑁(𝑖)ˆ𝑒𝑡
𝑖𝑗®𝛾𝑡
𝑖𝑗⊙𝑧𝑡
𝑖𝑗+∑︁
𝑗∈𝑁(𝑖)ˆ𝑒𝑡
𝑗𝑖®𝛾𝑡
𝑗𝑖⊙𝑧𝑡
𝑗𝑖,(13)
where𝑁(𝑖)represents all nodes in the graph except for node 𝑖, and
ˆ𝑒𝑡
𝑖𝑗detects whether the edge exists. Additionally, the parameter
®𝛾𝑡
𝑖𝑗∈R𝑑is used to control the degree of aggregation.
Since the recovery rate of the intra-regional population flow
differs for each region, we allocate different decay coefficients ®𝛼𝑡
𝑖
for each region. Moreover, the recovery rate of a region not only
depends on itself but also depends on its neighbors. For example,
two regions suffering similar damage will recover at different rates
if one has healthier neighbors. Consequently, we employ graph
convolution to infer ®𝛼𝑡
𝑖based on the adaptive graph weight adjacent
matrixˆ𝐴𝑡:
[®𝛼𝑡
1,®𝛼𝑡
2,...,®𝛼𝑡
𝑛]𝑇=ℎ𝛼(ˆ𝐷−1/2ˆ𝐴𝑡ˆ𝐷−1/2𝑍𝑡𝑊)
𝑚𝑎𝑥(|ℎ𝛼(ˆ𝐷−1/2ˆ𝐴𝑡ˆ𝐷−1/2𝑍𝑡𝑊)|),(14)
where ˆ𝐷−1/2is the degree matrix ofˆ𝐴𝑡, and𝑍𝑇=[𝑧𝑡
1,𝑧𝑡
2,...,𝑧𝑡𝑛]𝑇
represents the graph signals composed of all latent node states.
After performing graph convolution, a linear layer ℎ𝛼is applied.
While it is common to normalize each value of ®𝛼𝑡
𝑖into the range
[0,1] to indicate a recovery trend, we observe that, in Fig. 1, some
counties face a decline shortly in just one or two days after the
Dorian for uncertain reasons, which can be subsequent effects of the
disaster or the arrival of the workday. Therefore, absolute maximumnormalization is applied to normalize the result to the range [-1,1]
instead of [0,1], allowing the model to capture both the rising and
falling during recovery.
Equally important, the population inflow to a region might not
always promote recovery of this region, as some people who just
arrived might leave on the next day for various reasons. Similarly,
the population outflow from a region might not necessarily damage
the recovery process. Hence, we do not directly add edge states to
the node state but use a linear layer ℎ𝛾to infer®𝛾𝑡
𝑖𝑗, which controls
the influence of an edge to a node:
®𝛾𝑡
𝑖𝑗=𝑆𝑜𝑓𝑡𝑚𝑎𝑥(ℎ𝛾(𝑧𝑡
𝑖𝑗)), (15)
where the𝑆𝑜𝑓𝑡𝑚𝑎𝑥 activation function is used.
Once our ordinary differential equations for noded𝑧𝑡
𝑖
d𝑡and edge
d𝑧𝑡
𝑖𝑗
d𝑡are obtained, given the initial node embedding 𝑧0
𝑖and edge
embedding 𝑧0
𝑖𝑗, we can generate subsequent latent states of intra-
regional and inter-regional population flow using a Neural ODE
solver. This process involves repeated integration at equidistant
intervals△𝑡, where each integration is performed based on the
previous integration result:
𝑧𝑡+△𝑡
𝑖=𝑧𝑡
𝑖+∫𝑡+△𝑡
𝑡d𝑧𝑡
𝑖
d𝑡𝑑𝑡, (16)
𝑧𝑡+△𝑡
𝑖𝑗=𝑧𝑡
𝑖𝑗+∫𝑡+△𝑡
𝑡d𝑧𝑡
𝑖𝑗
d𝑡𝑑𝑡. (17)
4.4 Decoder for Population Mobility Graph
Finally, the node decoder 𝐹𝐷𝑒𝑐𝑁 :R𝑑→R1and edge decoder
𝐹𝐷𝑒𝑐𝐸 :R𝑑→R1generate the ultimate predictive outputs for
nodes and edges on the corresponding day 𝑡:
ˆ𝑥𝑡
𝑖=𝐹𝐷𝑒𝑐𝑁(𝑧𝑡
𝑖), (18)
ˆ𝑥𝑡
𝑖𝑗=𝑒𝑡
𝑖𝑗𝐹𝐷𝑒𝑐𝐸(𝑧𝑡
𝑖𝑗), (19)
where the use of 𝑒𝑡
𝑖𝑗ensures consistency with the network structure
during the integration process. Sinceˆ𝑥𝑡
𝑖𝑗represents the absolute
value of the predicted inter-regional population flow, it is treated
as non-existent if its value is less than 1. Thus, the filtering process
is defined as:
ˆ𝑥𝑡
𝑖𝑗=(
ˆ𝑥𝑖𝑗𝑡,ifˆ𝑥𝑖𝑗𝑡≥1
0. ifˆ𝑥𝑖𝑗𝑡<1(20)
4.5 Model Optimization
Our objective is to minimize the prediction error of population
mobility recovery, for which we use the following loss function:
L=vut
1
𝑛×𝑇𝑇∑︁
𝑡=1𝑛∑︁
𝑖=1(𝑥𝑡
𝑖−ˆ𝑥𝑡
𝑖)2+
𝜆vuut1
𝑛×𝑛×𝑇𝑇∑︁
𝑡=1𝑛∑︁
𝑖=1𝑛∑︁
𝑗=1(𝑥𝑡
𝑖𝑗−ˆ𝑥𝑡
𝑖𝑗)2,(21)
which calculates the weighted sum of root-mean-square errors
(RMSE) between the predicted valueˆ𝑥𝑡
𝑖,ˆ𝑥𝑡
𝑖𝑗and the true value 𝑥𝑡
𝑖,
 
1591KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
Table 1: The life of Hurricane Dorian (2019).
Date Intensity State
Aug 01∼Aug 24 - Unborn
Aug 24∼Seq 01 TD⇒H5 Approaching USA
Sep 02 H5 Arriving at FL
Sep 04 H2 Arriving at GA
Sep 05 H3 Arriving at SC
Sep 05∼Sep 09 H3⇒ET Fading away
Table 2: Population mobility data description in three states,
where NoC is the short of Number of Counties.
State FL GA SC
Original NoC 67 159 46
Filter NoC 55 107 38
𝑉𝑎𝑟(𝑥𝑡
𝑖) 1.1011×10126.9274×1093.8356×1010
𝑉𝑎𝑟(𝑥𝑡
𝑖𝑗) 1.2892×1088.9060×1052.3480×107
𝑀𝑎𝑥(𝑥𝑡
𝑖) 6506832 596636 813207
𝑄25(𝑥𝑡
𝑖) 46936 10755 31331
𝑀𝑒𝑎𝑛(𝑥𝑡
𝑖) 648269 50373 160973
𝑥𝑡
𝑖𝑗over the recovery period of 𝑇days. In the experiment, we ob-
served that inter-regional population flows are significantly smaller
compared to intra-regional flows, leading the model to overlook
edge predictions. Therefore, the parameter 𝜆is used to adjust the
importance of edge predictions in our model. We use 𝐴𝑑𝑎𝑚𝑊 [25]
as our optimizer.
5 EXPERIMENT
5.1 Experimental Settings
5.1.1 Scenario. We select hurricane Dorian (2019) [ 34], which was
delisted for the extensive damage it caused, as our disaster scenario.
Dorian was born on August 24, 2019, then approached Florida (FL)
and made landfall in FL on September 2nd, Georgia (GA) on Septem-
ber 4th, South Carolina (SC) on September 5th, and finally dissipated
on September 9th, resulting in significant damage. Consequently,
we conduct experiments in these three states. The temporal changes
in hurricane Dorian’s intensity and states are outlined in Table 1.
𝑇𝐷and𝐸𝑇are short of "Tropical Depressions" and "Extratropical
Transition", respectively, representing the beginning and end of
Dorian in this scenario.
5.1.2 Dataset. The original population mobility data sourced from
SafeGraph records the daily number of people moving between
different Census Block Groups (CBGs) from August 1st to Septem-
ber 10th, 2019. We aggregate this inter-CBG daily mobility data
by counties to construct the daily within-county population flows
and between-county population flows, corresponding to the intra-
regional population flows on nodes 𝑥𝑡
𝑖and inter-regional popula-
tion flows on edges 𝑥𝑡
𝑖𝑗. Based on the trajectory of Dorian, certain
counties in these three states are located far from the hurricane’s
center. Therefore, we implement a county filtering process based onweather conditions during Dorian and individually generate pop-
ulation mobility graphs for FL, GA, and SC. Detailed information
about the county filtering process can be found in the Appendix.
The description of processed population mobility data is shown
in Table 2, from which we can find that the variance of the intra-
regional population flows 𝑥𝑡
𝑖and the inter-regional population
flows𝑥𝑡
𝑖𝑗are huge. Besides, the highest recorded intra-regional
population flows can reach 6,506,832 people in one day.
5.1.3 Metrics. We employ several metrics to evaluate the perfor-
mance of our model, including Mean Absolute Error (MAE), Nor-
malized Root-Mean-Square Error (NRMSE), and Coefficient of De-
termination ( R2).MAE measures the average magnitude of the
prediction errors. NRMSE is a dimensionless metric that normal-
izes the accuracy of a predictive model, accounting for the data
variability:
𝑁𝑅𝑀𝑆𝐸(𝑥𝑡
𝑖,ˆ𝑥𝑡
𝑖)=√︃Í𝑇
𝑡=1Í𝑛
𝑖=1(𝑥𝑡
𝑖−ˆ𝑥𝑡
𝑖)2/(𝑇×𝑛)
√︃Í𝑇
𝑡=1Í𝑛
𝑖=1(𝑥𝑡
𝑖−¯𝑥)2/(𝑇×𝑛),(22)
where ¯𝑥is the mean of the true values computed over all regions
𝑖and all times 𝑡, serving as the baseline for comparison. A lower
NRMSE value indicates better model performance. R2provides an
unbiased measure of model quality, representing the proportion
of the total variation in the dependent variable explained by the
model. An R2value closer to 1 indicates higher model performance.
5.1.4 Baseline. We compare our model CDGON with the following
six classical baselines.
•LSTM [16] is a classic recurrent neural network designed to
predict future sequences by learning patterns from historical
data.
•AGCRN [1] combines GCN and Gated Recurrent Units
(GRU) for dynamic graph prediction, enabling the adaptively
learned graph structures.
•NDCN [50] focuses on capturing dynamics in complex net-
works with a Neural ODE designed with one GCN layer.
•CG-ODE [18] constructs temporal links between historical
graphs and develops a Variational AutoEncoder(VAE)-based
model to capture the co-evolution of nodes and edges using
coupled Neural ODE functions.
•STG-NCDE [10] employs Neural Controlled Differential
Equations (NCDE), incorporating trajectory gradientsd𝑋(𝑡)
d𝑡
generated through the natural cubic spline of original signals.
•PatchTST [28] divides historical sequences into a series
of equal-length patches, then develops a transformer-based
model to predict the trajectories of multivariate data.
5.2 Performance Evaluation
We assess the performance of different models in each of the three
states individually. Due to the nature of our CDGON model, in ad-
dition to the initial abnormal population mobility graph on the day
Dorian arrived, CDGON requires the normal intra-regional popu-
lation flow prior to the disaster as input. During training, several
post-disaster graph snapshots are needed as labels. Consequently,
the dynamic graphs in the recovery process are divided into two
parts: the former for training and the latter for testing.
 
1592Physics-informed Neural ODE for Post-disaster Mobility Recovery KDD ’24, August 25–29, 2024, Barcelona, Spain
Table 3: Performance comparison of our model and baselines on three states for predicting the recovery process of intra-regional
population flows, where lower NRMSE and MAE, higher 𝑅2are better. Bold denotes best results.
ModelRegion FL GA SC
Metrics MAE NRMSE 𝑅2MAE NRMSE 𝑅2MAE NRMSE 𝑅2
LSTM 302884.0938 0.6689 0.5526 27099.3320 0.8700 0.2431 45117.3867 0.4089 0.8328
AGCRN 273478.9062 0.5377 0.7109 26782.4121 0.9181 0.1570 22293.4277 0.1938 0.9624
NDCN 406064.2812 0.3987 0.8411 11569.9785 0.3539 0.8747 94850.3906 0.6801 0.5375
CG-ODE 224787.1250 0.2936 0.9138 13370.4551 0.2664 0.9290 89249.2109 0.7564 0.4279
STG-NCDE 226016.1562 0.6683 0.5533 5938.1401 0.2316 0.9463 13173.6650 0.2074 0.9570
PatchTST 96736.0547 0.1632 0.9734 3108.3894 0.0963 0.9907 12399.1855 0.1347 0.9819
CDGON 59767.4805 0.0724 0.9948 2013.2821 0.0475 0.9977 9040.6758 0.0771 0.9941
Table 4: Performance comparison of our model and baselines
on three states for predicting the recovery process of inter-
regional population flows, where bold denotes best results.
Region Metrics CG-ODE STG-NCDE CDGON
FLNRMSE 1.0051 0.7603 0.4364
𝑅2-0.0103 0.4218 0.8096
GANRMSE 0.0241 0.5031 0.2663
𝑅20.9879 0.7468 0.9291
SCNRMSE -0.5193 0.4718 0.6086
𝑅21.2326 0.7773 0.6296
Based on our observation of the human mobility curve during
hurricane Dorian, whose details are presented in the Appendix, we
note that it takes approximately four days for the intra-regional pop-
ulation flow of all counties to return to normal, excluding the day
Dorian arrived. Therefore, we use the first three dynamic graphs
after disaster for training and the fourth dynamic graph for testing.
For example, Dorian arrived in FL on September 2nd, causing a
sharp decrease in population mobility on that day, followed by
recovery over the next four days. CDGON takes the population mo-
bility graph of FL on September 2nd and the normal intra-regional
flows as input. It is trained on the data from September 3rd to 5th,
and is evaluated on the graph from September 6th. For Georgia (GA)
and South Carolina (SC), the testing is conducted on the population
mobility graph from September 8th and 9th, respectively.
The experimental results for predicting the intra-regional popu-
lation flow for all models are presented in Table 3, while the results
for inter-regional population flow are shown in Table 4. Notably,
our CDGON model consistently demonstrates superior predictive
performance in predicting intra-regional population flows among
all scenarios. For the prediction of inter-regional population flows,
although CDGON does not outperform baselines in all situations, it
is still the most stable and partially optimal compared with baseline
models. Furthermore, Fig. 3 vividly illustrates the predictive per-
formance comparison between our model and STG-NCDE on the
fourth day after Dorian’s arrival. This visualization highlights that
our model produces accurate predictions that closely align with the
ground truth, surpassing STG-NCDE.
Figure 3: Intra-regional population flow visualizations in
three states among ground truth and prediction results from
CDGON and STG-NCDE.
Figure 4: Intra-regional population flow prediction in the 8
counties with the largest population in SC state, where the
two predictive curves are generated by the models trained in
FL.
 
1593KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
Table 5: Performance comparison for predicting intra-regional population flow recovery process in each state by the model
trained on other two states, where lower NRMSE and MAE, higher 𝑅2are better. Bold denotes best results. Models with * can
not be generalized to different states due to their requirement of the same graph structure, thus their prediction performance
results come from training and testing in the target city simultaneously.
Source→Target Metrics LSTM* AGCRN* NDCN CG-ODE* STG-NCDE* PatchTST CDGON
FL→GAMAE 30069.4746 27000.6348 24600.7168 24787.2109 7720.2603 4872.3203 5433.7192
NRMSE 0.9254 0.9031 0.5628 0.6689 0.3452 0.1444 0.1301
𝑅20.1436 0.1843 0.6832 0.5526 0.8808 0.9791 0.9831
FL→SCMAE 46591.9336 23959.2617 57581.6367 124385.3672 15826.1348 38007.8047 13609.5889
NRMSE 0.4129 0.2143 0.4980 0.9807 0.1964 0.4144 0.1508
𝑅20.8295 0.9541 0.7520 0.0382 0.9614 0.8283 0.9773
GA→FLMAE 314732.8125 110829.3672 89669.6328 308634.5938 205125.8438 70575.5312 48276.1992
NRMSE 0.6675 0.2074 0.1889 0.5605 0.6711 0.1536 0.0997
𝑅20.5544 0.9570 0.9643 0.6858 0.5496 0.9764 0.9901
GA→SCMAE 46591.9336 23959.2617 37860.0586 124385.3672 15826.1348 16386.5156 14315.9375
NRMSE 0.4129 0.2143 0.3880 0.9807 0.1964 0.1844 0.1341
𝑅20.8295 0.9541 0.8495 0.0382 0.9614 0.9660 0.9820
SC→FLMAE 314732.8125 110829.3672 1353806.5000 308634.5938 205125.8438 100522.4141 73204.6719
NRMSE 0.6675 0.2074 1.4442 0.5605 0.6711 0.2294 0.1412
𝑅20.5544 0.9570 -1.0858 0.6858 0.5496 0.9474 0.9801
SC→GAMAE 30069.4746 27000.6348 334504.1250 24787.2109 7720.2603 5576.4810 8921.1035
NRMSE 0.9254 0.9031 5.1555 0.6689 0.3452 0.2232 0.1770
𝑅20.1436 0.1843 -25.5788 0.5526 0.8808 0.9502 0.9687
5.3 Generalization
To verify the model’s generalization ability, we train our model on
each state (source state), and apply the trained model to the other
two states (target states), denoted as "source →target". Specifically,
we use all the dynamic population mobility graphs during the
recovery process of the source state to train our model. The trained
model is then applied to predict the entire recovery processes of
the other two target states, differing from the training setting in
Table 3.
The performance of generalization is shown in Table 5, where the
predictive performance of our CDGON is consistently optimal. This
outcome demonstrates the generalization capability of CDGON.
Such accurate predictions hold substantial significance for devising
coordinated post-disaster recovery plans spanning multiple states.
From the comparison with PatchTST in Fig. 4, our CDGON can
predict the intra-regional flows with higher accuracy. Although
there is some disparity between our predictions and the real values
from the visualization, achieving such accuracy by only knowing
the initial state and normal state illustrates the potential of our
model.
5.4 Hyper-parameters Setting
The main hyper-parameters used in our CDGON model include
embedding dimension, edge loss weight ( 𝜆) in Eq. (21), and learning
rate. These parameters were set to 48, 100, and 0.003, respectively.
Notably, we found that setting the embedding dimension to 64,
while keeping the other two parameters unchanged, results in the
best performance in the generalization part but underperforms inthe evaluation part. This indicates the potential of our CDGON’s
generalization ability. However, to achieve balanced performance
between evaluation and generalization, we used 48 as our embed-
ding dimension.
5.5 Ablation Study
To assess the efficacy of different components in the design of our
CDGON, we conducted ablation experiments across three aspects:
•w/o PIDM: CDGON without PIDM, utilizing a linear layer
to learn from the node embeddings directly.
•w/o GCN-𝛼: CDGON without GCN to compute the 𝛼𝑡
𝑖, em-
ploying a linear layer to compute it directly from 𝑧𝑡
𝑖.
•w/o NEIM: CDGON without NEIM, focusing solely on the
PIDM in node ODE function and changing the edge ODE
function to only consider self-evolution.
The results of the ablation study are presented in Table 6. This com-
prehensive assessment includes the evaluation of the predictive
performance both in the nodes and edges. This experiment indi-
cates that the removal of any of the mentioned modules results in a
reduction of our model’s predictive ability on intra-regional popu-
lation flows. Moreover, our models’ performance on inter-regional
population flows significantly deteriorates when any designed mod-
ule is removed. These findings fully illustrate the effectiveness of
our model design.
 
1594Physics-informed Neural ODE for Post-disaster Mobility Recovery KDD ’24, August 25–29, 2024, Barcelona, Spain
Table 6: Ablation study for different components of our model on three states, where lower NRMSE and MAE, higher 𝑅2are
better. Bold denotes best results. Node and Edge represent two types of evaluation implemented on the recovery process of
intra-regional population flows and inter-regional population flows respectively.
ModelRegion FL GA SC
Metrics MAE NRMSE 𝑅2MAE NRMSE 𝑅2MAE NRMSE 𝑅2
CDGONNode 59767.4805 0.0724 0.9948 2013.2821 0.0475 0.9977 9040.6758 0.0771 0.9941
Edge 1934.2816 0.4364 0.8096 48.2338 0.2663 0.9291 714.8368 0.6086 0.6296
w/o PIDMNode 60685.7891 0.1002 0.9900 9389.4014 0.3432 0.8822 36499.0273 0.4174 0.8258
Edge 1945.6016 0.1002 1.0087 89.7465 1.0087 -0.0176 801.9778 1.0142 -0.0285
w/o GCN-𝛼Node 73036.6641 0.1185 0.9860 6143.5601 0.1921 0.9631 17583.4277 0.1828 0.9666
Edge 1945.6016 0.1002 1.0087 89.7465 1.0087 -0.0176 801.9778 1.0142 -0.0285
w/o NEIMNode 30396.2402 0.0570 0.9968 6783.2905 0.9630 0.1925 25347.1289 0.2261 0.9489
Edge 1945.6016 0.1002 1.0087 89.7465 1.0087 -0.0176 801.9778 1.0142 -0.0285
6 RELATED WORK
Urban Mobility Recovery Dynamic Modeling. Traditional stud-
ies on modeling and analyzing the recovery dynamics of urban
population mobility often adopt mathematical approaches to under-
stand and unveil patterns in population movement after disasters.
For example, the more socially connected a community is to other
communities, the faster it will recover after a disaster [ 47]. Addi-
tionally, socioeconomic and racial disparities affect the resilience
capacity [ 17], and the perturbed population mobility post-disaster
is highly correlated with steady mobility state [ 38]. Modeling meth-
ods vary for different mobility metrics [ 23,37,38,43,45], but the
basic recovery trend can be identified [ 20,46]. These studies on
the recovery dynamics of urban mobility is also part of resilience
research in complex networks [11, 13].
Physic-informed Neural ODE. Incorporating physic-based
knowledge into the data-driven method can significantly improve
method performance in various scenarios, such as sensor calibra-
tion [ 35], field reconstruction [ 26,33], air pollution estimation [ 7–9]
and crowd simulation [ 2]. Neural ODE can also be applied in var-
ious fields by integrating domain knowledge, such as structural
health monitoring [ 22], trajectory forecasting for multi-object phys-
ical systems [ 24,40,41], turbulent fluid dynamic [ 32] and complex
climate systems [ 19,27]. Incorporating physics-based knowledge
will lead to a high physical interpretability. Liu et al. [ 24] present
the Physics-informed Neural Graph ODE (PINGO) model, utilizing
Newton’s second law to simulate long-term dynamics of multi-
object physical systems. Roehrl et al. [ 31] integrate the equations
of motion in Lagrange mechanics to Neural ODE to simulate the
movement of a cart pole.
Post-disaster Emergency Management. In recent years, tech-
nological advancements have significantly enhanced the efficiency
and effectiveness of post-disaster emergency management. Accu-
rate prediction of post-disaster urban mobility recovery is crucial
for various emergency management activities. For example, Ren
et al. [ 30] propose a reinforcement learning method for sched-
uling UAV swarms for data communication, which can assist in
the restoration of damaged communication networks effectively
based on the accurate mobility recovery prediction. Furthermore,
in severely affected areas with slow population mobility recovery,existing routes may be destroyed. Thus, opening new transporta-
tion routes to these detected areas is vital. To address this issue, Jian
et al. [ 21] utilize wheeled robots for path generation on vegetated
terrain, and Wang et al. [ 36] also achieve navigation in the harsh en-
vironment using UAVs. Accurate predictions also prove invaluable
in emergency resource allocation. In complex environments, drones
can efficiently deliver essential resources [ 4,5]. For example, after
a forest fire, residual fires in remote areas can be effectively sup-
pressed through the collaborative scheduling of multiple UAVs [ 6].
By combining our CDGON with these algorithms, the post-disaster
reconstruction work can be better carried out.
7 CONCLUSION
In this paper, we investigate the dynamic urban population mobility
prediction problem in post-disaster scenarios by proposing a novel
Neural ODE model. Informed by physics-based knowledge from
the ST Decay Model, our proposed model CDGON can capture the
co-evolving process of intra-regional and inter-regional population
flows, enhancing the prediction of urban population mobility after
extreme events. Extensive experiments on three real-world mobility
datasets demonstrate the superiority of our model in forecasting
the recovery trajectory of urban population mobility. Our code and
data are available at: https://github.com/tsinghua-fib-lab/CDGON-
KDD24.
In future work, we will explore incorporating the normal inter-
regional flows to further improve prediction performance. Further-
more, we aim to extend the predictions to other types of disasters
(e.g., epidemics, winter storms, etc.). With the rise of the large
language model, more researchers focus on using the generative
pre-trained models to solve the spatio-temporal prediction prob-
lem [ 48,49], which can combine with CDGON to enhance its gen-
eralization capability to predict post-disaster population mobility.
ACKNOWLEDGMENTS
This paper was supported by the Natural Science Foundation of
China under Grant 62371269, U20B2060, 62171260, and 92270114,
Shenzhen 2022 Stabilization Support Program (WDZC20220811103500001),
and Tsinghua Shenzhen International Graduate School Cross-disciplinary
Research and Innovation Fund Research Plan (JC20220011) and
Meituan.
 
1595KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
REFERENCES
[1]Lei Bai, Lina Yao, Can Li, Xianzhi Wang, and Can Wang. 2020. Adaptive graph
convolutional recurrent network for traffic forecasting. Advances in neural
information processing systems 33 (2020), 17804–17815.
[2]Hongyi Chen, Jingtao Ding, Yong Li, Yue Wang, and Xiao-Ping Zhang. 2024.
Social physics informed diffusion model for crowd simulation. arXiv preprint
arXiv:2402.06680 (2024).
[3]Ricky TQ Chen, Yulia Rubanova, Jesse Bettencourt, and David K Duvenaud. 2018.
Neural ordinary differential equations. Advances in neural information processing
systems 31 (2018).
[4]Xinlei Chen, Aveek Purohit, Shijia Pan, Carlos Ruiz, Jun Han, Zheng Sun, Frank
Mokaya, Patric Tague, and Pei Zhang. 2017. Design experiences in minimalistic
flying sensor node platform through sensorfly. ACM Transactions on Sensor
Networks (TOSN) 13, 4 (2017), 1–37.
[5]Xuecheng Chen, Haoyang Wang, Zuxin Li, Wenbo Ding, Fan Dang, Chengye
Wu, and Xinlei Chen. 2022. DeliverSense: Efficient delivery drone scheduling for
crowdsensing with deep reinforcement learning. In Adjunct Proceedings of the
2022 ACM International Joint Conference on Pervasive and Ubiquitous Computing
and the 2022 ACM International Symposium on Wearable Computers. 403–408.
[6]Xuecheng Chen, Zijian Xiao, Yuhan Cheng, ChenChun Hsia, Haoyang Wang,
Jingao Xu, Susu Xu, Fan Dang, Xiao-Ping Zhang, Yunhao Liu, et al .2024. SOSched-
uler: Toward Proactive and Adaptive Wildfire Suppression via Multi-UAV Collab-
orative Scheduling. IEEE Internet of Things Journal (2024).
[7]Xinlei Chen, Susu Xu, Xinyu Liu, Xiangxiang Xu, Hae Young Noh, Lin Zhang,
and Pei Zhang. 2020. Adaptive hybrid model-enabled sensing system (HMSS)
for mobile fine-grained air pollution estimation. IEEE Transactions on Mobile
Computing 21, 6 (2020), 1927–1944.
[8]Xinlei Chen, Xiangxiang Xu, Xinyu Liu, Hae Young Noh, Lin Zhang, and Pei
Zhang. 2016. Hap: Fine-grained dynamic air pollution map reconstruction by
hybrid adaptive particle filter. In Proceedings of the 14th ACM Conference on
Embedded Network Sensor Systems CD-ROM. 336–337.
[9]Xinlei Chen, Xiangxiang Xu, Xinyu Liu, Shijia Pan, Jiayou He, Hae Young Noh,
Lin Zhang, and Pei Zhang. 2018. Pga: Physics guided and adaptive approach
for mobile fine-grained air pollution estimation. In Proceedings of the 2018 ACM
International Joint Conference and 2018 International Symposium on Pervasive and
Ubiquitous Computing and Wearable Computers. 1321–1330.
[10] Jeongwhan Choi, Hwangyong Choi, Jeehyun Hwang, and Noseong Park. 2022.
Graph neural controlled differential equations for traffic forecasting. In Proceed-
ings of the AAAI Conference on Artificial Intelligence, Vol. 36. 6367–6374.
[11] Jingtao Ding, Chang Liu, Yu Zheng, Yunke Zhang, Zihan Yu, Ruikun Li, Hongyi
Chen, Jinghua Piao, Huandong Wang, Jiazhen Liu, et al .2024. Artificial Intel-
ligence for Complex Network: Potential, Methodology and Application. arXiv
preprint arXiv:2402.16887 (2024).
[12] Zheng Fang, Qingqing Long, Guojie Song, and Kunqing Xie. 2021. Spatial-
temporal graph ode networks for traffic flow forecasting. In Proceedings of the
27th ACM SIGKDD conference on knowledge discovery & data mining. 364–373.
[13] Jianxi Gao, Baruch Barzel, and Albert-László Barabási. 2016. Universal resilience
patterns in complex networks. Nature 530, 7590 (2016), 307–312.
[14] Masahiko Haraguchi, Akihiko Nishino, Akira Kodaka, Maura Allaire, Upmanu
Lall, Liao Kuei-Hsien, Kaya Onda, Kota Tsubouchi, and Naohiko Kohtake. 2022.
Human mobility data and analysis for urban resilience: A systematic review.
Environment and Planning B: Urban Analytics and City Science 49, 5 (2022), 1507–
1535.
[15] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016. Deep residual
learning for image recognition. In Proceedings of the IEEE conference on computer
vision and pattern recognition. 770–778.
[16] Sepp Hochreiter and Jürgen Schmidhuber. 1997. Long Short-Term Memory. 9, 8
(1997), 1735–1780. Conference Name: Neural Computation.
[17] Boyeong Hong, Bartosz J Bonczak, Arpit Gupta, and Constantine E Kontokosta.
2021. Measuring inequality in community resilience to natural disasters using
large-scale mobility data. Nature communications 12, 1 (2021), 1870.
[18] Zijie Huang, Yizhou Sun, and Wei Wang. 2021. Coupled graph ode for learning
interacting system dynamics. In Proceedings of the 27th ACM SIGKDD Conference
on Knowledge Discovery & Data Mining. 705–715.
[19] Jeehyun Hwang, Jeongwhan Choi, Hwangyong Choi, Kookjin Lee, Dongeun Lee,
and Noseong Park. 2021. Climate modeling with neural diffusion equations. In
2021 IEEE International Conference on Data Mining (ICDM). IEEE, 230–239.
[20] Tasnuba Binte Jamal and Samiul Hasan. 2023. Understanding the Loss in Com-
munity Resilience due to Hurricanes using Facebook Data. arXiv preprint
arXiv:2302.03530 (2023).
[21] Zhuozhu Jian, Zejia Liu, Haoyu Shao, Xueqian Wang, Xinlei Chen, and Bin Liang.
2023. Path Generation for Wheeled Robots Autonomous Navigation on Vegetated
Terrain. IEEE Robotics and Automation Letters (2023).
[22] Zhilu Lai, Wei Liu, Xudong Jian, Kiran Bacsa, Limin Sun, and Eleni Chatzi. 2022.
Neural modal ordinary differential equations: Integrating physics-based model-
ing with neural ordinary differential equations for modeling high-dimensional
monitored structures. arXiv preprint arXiv:2207.07883 (2022).[23] Weiyu Li, Qi Wang, Yuanyuan Liu, Mario L Small, and Jianxi Gao. 2022. A
spatiotemporal decay model of human mobility when facing large-scale crises.
Proceedings of the National Academy of Sciences 119, 33 (2022), e2203042119.
[24] Yang Liu, Jiashun Cheng, Haihong Zhao, Tingyang Xu, Peilin Zhao, Fugee Tsung,
Jia Li, and Yu Rong. 2023. Physics-Inspired Neural Graph ODE for Long-term
Dynamical Simulation. arXiv preprint arXiv:2308.13212 (2023).
[25] Ilya Loshchilov and Frank Hutter. 2017. Decoupled weight decay regularization.
arXiv preprint arXiv:1711.05101 (2017).
[26] Ji Luo, Yiling Hu, Chengzhao Yu, Chaopeng Hong, Xiao-Ping Zhang, and Xinlei
Chen. 2023. Field Reconstruction-Based Non-Rendezvous Calibration for Low
Cost Mobile Sensors. In Adjunct Proceedings of the 2023 ACM International Joint
Conference on Pervasive and Ubiquitous Computing & the 2023 ACM International
Symposium on Wearable Computing. 688–693.
[27] Björn Lütjens, Catherine H Crawford, Mark Veillette, and Dava Newman. 2021.
Pce-pinns: Physics-informed neural networks for uncertainty propagation in
ocean modeling. arXiv preprint arXiv:2105.02939 (2021).
[28] Yuqi Nie, Nam H Nguyen, Phanwadee Sinthong, and Jayant Kalagnanam. 2022.
A time series is worth 64 words: Long-term forecasting with transformers. arXiv
preprint arXiv:2211.14730 (2022).
[29] Michael Poli, Stefano Massaroli, Junyoung Park, Atsushi Yamashita, Hajime
Asama, and Jinkyoo Park. 2019. Graph neural ordinary differential equations.
arXiv preprint arXiv:1911.07532 (2019).
[30] Jiyuan Ren, Yanggang Xu, Zuxin Li, Chaopeng Hong, Xiao-Ping Zhang, and Xinlei
Chen. 2023. Scheduling UAV Swarm with Attention-based Graph Reinforcement
Learning for Ground-to-air Heterogeneous Data Communication. In Adjunct
Proceedings of the 2023 ACM International Joint Conference on Pervasive and
Ubiquitous Computing & the 2023 ACM International Symposium on Wearable
Computing. 670–675.
[31] Manuel A Roehrl, Thomas A Runkler, Veronika Brandtstetter, Michel Tokic, and
Stefan Obermayer. 2020. Modeling system dynamics with physics-informed
neural networks based on Lagrangian mechanics. IFAC-PapersOnLine 53, 2 (2020),
9195–9200.
[32] Varun Shankar, Christopher Rackauckas, and Venkatasubramanian Viswanathan.
2020. Learning non-linear spatio-temporal dynamics with convolutional Neural
ODEs. Advances in neural information processing systems.
[33] Yifei Sun, Yuxuan Liu, Ziteng Wang, Xiaolei Qu, Dezhi Zheng, and Xinlei Chen.
2022. C-RIDGE: Indoor CO2 Data Collection System for Large Venues Based
on prior Knowledge. In Proceedings of the 20th ACM Conference on Embedded
Networked Sensor Systems. 1077–1082.
[34] NOAA US Department of Commerce. 2019. Hurricane Dorian, September 6, 2019.
https://www.weather.gov/mhx/Dorian2019 Publisher: NOAA’s National Weather
Service.
[35] Haoyang Wang, Yuxuan Liu, Chenyu Zhao, Jiayou He, Wenbo Ding, and Xin-
lei Chen. 2023. CaliFormer: Leveraging Unlabeled Measurements to Calibrate
Sensors with Self-supervised Learning. In Adjunct Proceedings of the 2023 ACM
International Joint Conference on Pervasive and Ubiquitous Computing & the 2023
ACM International Symposium on Wearable Computing. 743–748.
[36] Haoyang Wang, Jingao Xu, Chenyu Zhao, Zihong Lu, Yuhan Cheng, Xuecheng
Chen, Xiao-Ping Zhang, Yunhao Liu, and Xinlei Chen. 2024. TransformLoc:
Transforming MAVs into Mobile Localization Infrastructures in Heterogeneous
Swarms. arXiv preprint arXiv:2403.08815 (2024).
[37] Qi Wang and John E Taylor. 2015. Resilience of human mobility under the
influence of typhoons. Procedia engineering 118 (2015), 942–949.
[38] Qi Wang and John E Taylor. 2016. Patterns and limitations of urban human
mobility resilience under the influence of multiple types of natural disaster. PLoS
one11, 1 (2016), e0147299.
[39] Ruoxi Wang, Qi Wang, and Nan Li. 2023. Percolation transitions in urban mobility
networks in America’s 50 largest cities. Sustainable Cities and Society 91 (2023),
104435.
[40] Song Wen, Hao Wang, Di Liu, Qilong Zhangli, and Dimitris Metaxas. 2024. Second-
Order Graph ODEs for Multi-Agent Trajectory Forecasting. In Proceedings of the
IEEE/CVF Winter Conference on Applications of Computer Vision. 5101–5110.
[41] Song Wen, Hao Wang, and Dimitris Metaxas. 2022. Social ode: Multi-agent
trajectory forecasting with neural ordinary differential equations. In European
Conference on Computer Vision. Springer, 217–233.
[42] Jared Willard, Xiaowei Jia, Shaoming Xu, Michael Steinbach, and Vipin Kumar.
2022. Integrating scientific knowledge with machine learning for engineering
and environmental systems. Comput. Surveys 55, 4 (2022), 1–37.
[43] Takahiro Yabe, P Suresh C Rao, and Satish V Ukkusuri. 2021. Resilience of
interdependent urban socio-physical systems using large-scale mobility data:
Modeling recovery dynamics. Sustainable Cities and Society 75 (2021), 103237.
[44] Takahiro Yabe, P Suresh C Rao, Satish V Ukkusuri, and Susan L Cutter. 2022.
Toward data-driven, dynamical complex systems approaches to disaster resilience.
Proceedings of the National Academy of Sciences 119, 8 (2022), e2111997119.
[45] Takahiro Yabe, Kota Tsubouchi, Naoya Fujiwara, Yoshihide Sekimoto, and Satish V
Ukkusuri. 2019. Universality of population recovery patterns after disasters. arXiv
preprint arXiv:1905.01804 (2019).
 
1596Physics-informed Neural ODE for Post-disaster Mobility Recovery KDD ’24, August 25–29, 2024, Barcelona, Spain
[46] Takahiro Yabe, Kota Tsubouchi, Naoya Fujiwara, Yoshihide Sekimoto, and Satish V
Ukkusuri. 2020. Understanding post-disaster population recovery patterns. Jour-
nal of the Royal Society Interface 17, 163 (2020), 20190532.
[47] Takahiro Yabe, Satish V Ukkusuri, and P Suresh C. Rao. 2019. Mobile phone data
reveals the importance of pre-disaster inter-city social ties for recovery after
hurricane maria. Applied Network Science 4, 1 (2019), 98.
[48] Yuan Yuan, Jingtao Ding, Jie Feng, Depeng Jin, and Yong Li. 2024. UniST: A
Prompt-Empowered Universal Model for Urban Spatio-Temporal Prediction.
arXiv preprint arXiv:2402.11838 (2024).
[49] Yuan Yuan, Chenyang Shao, Jingtao Ding, Depeng Jin, and Yong Li. 2024. A Gen-
erative Pre-Training Framework for Spatio-Temporal Graph Transfer Learning.
arXiv preprint arXiv:2402.11922 (2024).
[50] Chengxi Zang and Fei Wang. 2020. Neural dynamics on complex networks.
InProceedings of the 26th ACM SIGKDD international conference on knowledge
discovery & data mining. 892–902.
A PROOFS OF THE THEOREMS
Theorem 1. Denote𝑟𝑖(𝑡)as the abnormal intra-regional population
flow of region 𝑖after a disaster, which is described in the ST Decay
Model shown in Eq. (1). The derivative of 𝑟𝑖(𝑡)satisfies the following
differential equation:
d𝑟𝑖(𝑡)
d𝑡=𝛼𝑟𝑖(𝑡)
𝑟𝑖[𝑟𝑖−𝑟𝑖(𝑡)], (23)
where𝛼indicates the decay coefficientand this implies that 𝑟𝑖(𝑡)will
approach to the normal intra-regional population flow 𝑟𝑖over time
governed by 𝛼.
Proof. First, the original spatiotemporal decay model can be
differentiated into:
d𝑟𝑖(𝑡)
d𝑡=−𝑟𝑖(𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡))′
(1+𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡))2, (24)
which cannot be solved at this time for unknown functions 𝑘(𝑡)
and𝑁𝑗(𝑡). However, an interesting observation can be found as
follows:
The spatial decayÍ𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡)in Eq. (1), which represents
the total severity of a disaster to the neighbors of the region 𝑖,
actually will weaken over time after a disaster. Therefore, it is rea-
sonable to assume the whole 𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡)decays over time.
Consequently, the negative exponential function 𝑘0𝑒−𝛼𝑡, which
is observed [ 23] as the most accurate function to describe the
spatiotemporal decay process, is used in this paper to replace
𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡):
𝑘(𝑡)Í𝐿
𝑗=1𝑤𝑖𝑗𝑁𝑗(𝑡)=𝑘0𝑒−𝛼𝑡, (25)
where𝛼is the decay control parameters and 𝑘0is the initial rate of
change in mobility behavior.
Accordingly, a new decay model is generated:
𝑟𝑖(𝑡)=𝑟𝑖
1+𝑘0𝑒−𝛼𝑡, (26)
Figure 5: County filtering result, where a star represents a
county and the constructed convex hull is the black trans-
parent
which can be differentiated over time 𝑡to:
d𝑟𝑖(𝑡)
d𝑡=−𝑟𝑖(𝑘0𝑒−𝛼𝑡)′
(1+𝑘0𝑒−𝛼𝑡)2
=−𝑟𝑖−𝛼𝑘0𝑒−𝛼𝑡
𝑟𝑖
𝑟𝑖(𝑡)2
=𝛼𝑟𝑖𝑟𝑖
𝑟𝑖(𝑡)−1
𝑟𝑖
𝑟𝑖(𝑡)2
=𝛼𝑟𝑖(𝑡)
𝑟𝑖[𝑟𝑖−𝑟𝑖(𝑡)], (27)
which proves the theorem.
□
B COUNTY FILTERING
We utilize daily wind speed and precipitation data recorded by
weather stations in FL, GA, and SC. We allocate weather stations
to each county based on the longitude and latitude bounds of each
county, and average the wind speed and precipitation recorded
by these stations to obtain the values for each county. We retain
counties where the wind speed and precipitation exceed a certain
threshold, indicating a significant impact on normal life. However,
we found that some states are relatively small and do not have
weather stations nearby allocatable. Expanding their longitude and
latitude bounds does not resolve this issue. As a result, the selected
counties cannot well represent the real population mobility of this
area. To address this issue, we constructed a convex hull based on
 
1597KDD ’24, August 25–29, 2024, Barcelona, Spain Jiahao Li, Huandong Wang, and Xinlei Chen
Figure 8: Human mobility within each county time in South
Carolina, where a line is the within-county population flow
curve of a county, and different colors represent different
counties
Figure 6: Human mobility within each county over time in
Florida, where a line is the within-county population flow
curve of a county, and different colors represent different
counties.
Figure 7: Human mobility within each county over time in
Georgia, where a line is the within-county population flow
curve of a county, and different colors represent different
counties
the existing counties and retained the counties within this range.
The filtering results for FL, GA, and SC are shown in Fig. 5.
C POPULATION MOBILITY CURVES IN
DIFFERENT COUNTIES BEFORE AND
AFTER DORIAN
To better illustrate the complexity of the population mobility recov-
ery process and provide a better understanding of the population
mobility recovery process, the human mobility curves ranging from
August 21st to September 9th of FL, GA, and SC are provided in
Fig. 6, Fig. 7, and Fig. 8, respectively, which differs from Fig. 1.
 
1598