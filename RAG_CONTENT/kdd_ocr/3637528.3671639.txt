Weather Knows What Will Occur: Urban Public Nuisance Events
Prediction and Control with Meteorological Assistance
Yi Xie
yixie18@fudan.edu.cn
Shanghai Key Lab of Data Science,
School of Computer Science,
Fudan University
Shanghai, ChinaTianyu Qiu
tyqiu22@fudan.edu.cn
Shanghai Key Lab of Data Science,
School of Computer Science,
Fudan University
Shanghai, ChinaYun Xiong
yunx@fudan.edu.cn
Shanghai Key Lab of Data Science,
School of Computer Science,
Fudan University
Shanghai, China
Xiuqi Huang
huangxiuqi@sjtu.edu.cn
MoE Key Lab of Artificial Intelligence,
Shanghai Jiao Tong University
Shanghai, ChinaXiaofeng Gao∗
gao-xf@cs.sjtu.edu.cn
MoE Key Lab of Artificial Intelligence,
Shanghai Jiao Tong University
Shanghai, ChinaChao Chen
cschaochen@cqu.edu.cn
College of Computer Science,
Chongqing University
Chongqing, China
Qiang Wang
18918206933@qq.com
Meteorological Disaster Prevention
Centre, Shanghai Meteorological
Bureau
Shanghai, ChinaHaihong Li
l.haihong@outlook.com
Meteorological Disaster Prevention
Centre, Shanghai Meteorological
Bureau
Shanghai, China
ABSTRACT
Urban public nuisance events, like garbage exposure, illegal park-
ing, facilities damage, and etc., impair the quality of life for city
residents. Predicting and controlling these nuisances is crucial but
complicated due to their ties to subjective and psychological factors.
In this study, we reveal a significant correlation between such nui-
sances and meteorological indicators, influenced by the impact of
climate on people’s psychological states. We employ meteorology
predictions that are integrated in Hawkes processes to enhance the
accuracy of predicting the category and timing of these nuisances.
To this end, we propose Spatial-Temporal Two-Tower Transformer
(ST-T3), which simultaneously considers spatial data and further
improves the prediction accuracy. Evaluated by about three-year
data from both downtown and suburban Shanghai, our method
outperforms both traditional and advanced prediction systems. We
share a portion of the de-identified dataset for open research. The
source code is available at https://github.com/Xieyyyy/STT3.
CCS CONCEPTS
•Applied computing →Law, social and behavioral sciences;
Sociology ;Computational social science methods ; Spatial science and
∗Corresponding author.
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
KDD ’24, August 25–29, 2024, Barcelona, Spain
©2024 Copyright held by the owner/author(s).
ACM ISBN 979-8-4007-0490-1/24/08.
https://doi.org/10.1145/3637528.3671639spatial statistical analysis; •Information systems →Informa-
tion systems applications; Spatial-temporal systems .
KEYWORDS
Urban Public Nuisance Events, Meteorological Indicators, Hawkes
Processes, Transformer
ACM Reference Format:
Yi Xie, Tianyu Qiu, Yun Xiong, Xiuqi Huang, Xiaofeng Gao, Chao Chen,
Qiang Wang, and Haihong Li. 2024. Weather Knows What Will Occur:
Urban Public Nuisance Events Prediction and Control with Meteorological
Assistance. In Proceedings of the 30th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona, Spain.
ACM, New York, NY, USA, 12 pages. https://doi.org/10.1145/3637528.3671639
1 INTRODUCTION
Urban public nuisance events, encompassing issues like garbage
exposure, illegal parking, and facilities damage, etc.[48] (exampled
in Fig. 1 (A)), disrupt public order, societal morals, and communal
safety. For example, garbage exposure and sewage breed diseases;
illegal parking contributes to traffic congestion and even accidents;
and facilities damage disrupts services and contributes to environ-
mental pollution [ 1,45,57]. If unaddressed, these nuisance events
could escalate into urban chaos, making city management com-
plicated and disordered [ 11,39]. Conversely, accurate prediction
and identification of these nuisance events enable authorities to
intervene timely, mitigating adverse effects and safeguarding resi-
dents’ quality of life. Therefore, developing an effective prediction
and management system for urban nuisance events is essential for
maintaining urban harmony and public well-being.
Machine learning has significantly advanced in predicting ur-
ban anomalies like crime[ 23,52], epidemics[ 2,16,47], and traffic
6037
KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
Graffiti and  Unauthorized PostersGarbage ExposureIllegal ParkingFacilities DamageSewage
Absolute values of Pearson correlation Wind SpeedVisibilityHumidityGarbage  ExposureSewageIllegal  ParkingGraffitiFacilities Damage0.60.50.40.30.2PrecipitationTemperature
(B) The correlations between meteorological indicators and occurrences of public nuisance events.(A) The frequency of garbage exposure event is significantly correlated with temperature.
Graffiti and  Unauthorized PostersGarbage ExposureIllegal ParkingFacilities DamageSewage
Graffiti and  Unauthorized PostersGarbage ExposureIllegal ParkingFacilities DamageSewage
 Graffiti and  Unauthorized PostersGarbage ExposureIllegal ParkingFacilities DamageSewage(A) Some typical urban public nuisances (these images are from Internet)(B) The frequency of garbage exposure event is signiﬁcantly correlated with temperature.(C) The correlations between meteorological indicators and occurrences of public nuisances.
Garbage ExposureIllegal Parking
SewageFacilities Damage
Figure 1: (A) Several illustrations of urban public nuisances. (B) One example illustrates that the frequency of garbage exposure
events varies over time, and this frequency is significantly correlated with temperature. The heatmap above shows the number
of garbage exposure events that occurred within four randomly selected time windows. (C) Absolute values of the Pearson
correlation coefficients between five typical meteorological indicators and the five most frequent categories of public nuisances.
accidents[ 51,63,64] by analyzing behavior patterns. Despite these
achievements, existing research often overlooks the impact of psy-
chological factors[ 13,17,49], which are crucial yet hard to quantify,
on these events. The unpredictability of nuisance events, from
minor disturbances to major crimes, further complicates model de-
velopment, emphasizing the need for understanding psychological
and social drivers behind these incidents. Literature in psychology
and sociology links nuisance events to psychological states through
theories like social stress[ 4] and the effects of meteorological condi-
tions, inspired by Seasonal Affective Disorder[ 35,43]. Additionally,
group behavior theory[ 50] highlights the spatial clustering of these
events, indicating a higher likelihood of occurrence in certain areas.
This suggests that climate change could influence individual and
group psychology, thereby affecting behavior[8–10].
We have collected and analyzed data on urban nuisance events
and meteorological information in Shanghai for three years. Data
is collected via sensors, mobile apps, patrol officers, etc.All data
is sourced from governmental agencies. Our analysis confirmed a
strong correlation between specific meteorological indicators and
the frequency of nuisance events, supporting the hypothesis that
weather significantly affects public disturbances. A correlation is
visually illustrated in Fig. 1 (B) and confirmed by the relationship
between garbage exposure frequency and temperature. Fig. 1 (C)
showcases the absolute Pearson correlation coefficient values be-
tween meteorological indicators and the occurrences of the most
common public nuisance events. Results indicate a moderate to high
correlation for 50% of the meteorological indicators with nuisance
events, affirming a substantial correlation.
In this paper, we propose using meteorological information as a
bridge between the elusive subjective psychological states and quan-
tifiable nuisance prediction tasks, to enhance prediction accuracy
and reliability. Leveraging the precision of numerical weather pre-
dictions [ 6], we use these meteorological indicators to foresee and
mitigate the uncertainty in predicting future urban public nuisance
events. Specifically, We deviate from the conventional predictionsthat rely on equally spaced time spans and overlook specific event
timing and order. We adopt Hawkes processes, using a Transformer
structure, to account for historical events’ influence and predict
future occurrences. This approach, supported by previous studies,
acknowledges urban events’ strong spatial agglomeration, integrat-
ing spatial information to enhance prediction accuracy.
We transition from traditional prediction models that rely on
fixed intervals [ 23,24,51,52,63,64], which ignore event timing and
auto-regressive properties, to the use of Hawkes processes [ 21,28]
that incorporate historical event data to predict future occurrences.
Additionally, we integrate spatial information into Transformer
structure, addressing the noted strong spatial agglomeration of
urban nuisances (see Section 2.2.2), enhancing the accuracy and
comprehensiveness of prediction.
We introduce the Spatial-Temporal Two-Tower Transformer (ST-
T3), a model integrating spatial-temporal Transformers. It employs
Graph Convolutional Neural Networks (GCN) [ 30] for spatial infor-
mation extraction, embedded within the Transformer to form its
base. The model encodes both public nuisance events and meteoro-
logical data, aligning and combining them. This amalgamated in-
formation is processed by another spatial-temporal Transformer to
predict upcoming nuisance events, leveraging the encoded Hawkes
processes’ conditional intensity function.
With a one-hour historical event window, ST-T3demonstrates
impressive performance on two datasets (one is a distant suburb of
Shanghai, Fengxian District, and the other is downtown Shanghai),
attaining 87.61% accuracy in event category prediction and a 397.22
seconds time prediction error for the next immediate event. For the
subsequent 5 event predictions, it achieves 73.45% accuracy and a
602.22 second error, outperforming the previous leading method
by 23.09% and 35.15% in these tasks respectively.
Our study’s principal contributions include:
•We address the challenges in predicting urban public nui-
sance events and innovate by incorporating meteorological
data for enhanced accuracy.
6038Weather Knows What Will Occur: Urban Public Nuisance Events Prediction and Control with Meteorological Assistance KDD ’24, August 25–29, 2024, Barcelona, Spain
(A) Statistics of Urban Public Nuisance Events for all towns.
XiduFengpuJin- haiNanqiaoZhelinZhuang- XingQingcunJinhuiHaiwanTourist AreaFengchengSituanTouqiao(B) The distributions of towns in Fengxian.
(C)  The heatmap of the locations of randomly sampled events,  presenting spatial agglomeration.
Garbage Exposure
(A) Statistics of Urban Public Nuisance Events for all towns.
XiduFengpuJin- haiNanqiaoZhelinZhuang- XingQingcunJinhui
HaiwanTourist AreaFengchengSituanTouqiao(B) The distributions of towns in Fengxian.
(C)  The heatmap of the locations of randomly sampled events,  presenting spatial agglomeration.
Garbage Exposure
(A) Statistics of Urban Public Nuisance Events for all towns.
XiduFengpuJin- haiNanqiaoZhelinZhuang- XingQingcunJinhuiHaiwanTourist AreaFengchengSituanTouqiao(B) The distributions of towns in Fengxian.
(C)  The heatmap of the locations of randomly sampled events,  presenting spatial agglomeration.
Garbage Exposure
(A) Statistics of Urban Public Nuisance Events for all towns.
(B) The distributions of towns in Fengxian.(C) The heatmap of the locations of randomly sampled events, presenting spatial agglomeration.
Figure 2: (A) Urban Public Nuisance Events statistics for all
the 13 towns. A noticeable finding is that each town exhibits
distinct distributions for each of the ten event categories
outlined in Table 1. (B) The actual administrative divisions
and distribution of towns in Shanghai’s Fengxian District.
(C) A heatmap showing the locations of a random selection
of events, demonstrating spatial aggregation.
•Our use of the Hawkes process model enables precise pre-
dictions of the timing and category of future nuisances.
•We introduce ST-T3, a model that synergizes event and me-
teorological data, elevating prediction accuracy.
•Experiments on two datasets from Fengxian District, a dis-
tant suburb of Shanghai, and downtown Shanghai validate
the superiority of ST-T3.
Applications and Implications. ST-T3is now implemented for
Shanghai governmental usage, demonstrating enhanced perfor-
mance in managing the city. We released a de-identified dataset of
public nuisance events and meteorological indicators for Fengxian
District, Shanghai, over a three-year period, under strict adherence
to the relevant confidentiality agreement, for open research.
2 DATA OVERVIEW AND ANALYSIS
In this section, we analyze and describe the Fengxian District dataset
that we will release. The dataset of downtown Shanghai shows a
similar correlation although slightly different patterns.
2.1 Data Description and Statistics
2.1.1 Public Nuisances. This dataset records the categories of events,
locations, and timings occurrence timings. In our study, we consol-
idated the location information to the spatial granularity of towns,
while the time refers to when the events were detected and reported
by sensors, mobile apps, patrol officers. Due to the rapid application
of urban intelligence currently, this time and spatial granularity
can be modeled effectively.Table 1: Statistics of Urban Public Nuisance Events
Index Event Category Occurrences Percentage (%)
0 Graffiti and Unauthorized Posters 802140 43.18
1 Garbage Exposure 271522 14.62
2 Illegal Parking 218345 11.76
3 Road Damage 52191 2.81
4 Facilities Damage 38955 2.10
5 Sewage 34589 1.86
6 Tree Damage 34186 1.84
7 Unlawful Drying 30191 1.63
8 Foul Bin 25972 1.40
9 Road Occupations 25242 1.36
The dataset includes 2.07 million nuisances from 13 towns in
Fengxian District, categorized into 210 types over three years (Oc-
tober 2018-February 2022). Despite varying frequencies, the top ten
categories represent 83% of nuisances and are chosen for further
study. Table 1 presents event statistics, Fig. 2 (A) shows the top
ten categories per town. Fig. 2 (B) shows Fengxian’s administrative
division, and Fig. 2 (C) a heatmap of sampled events.
2.1.2 Meteorological Information. We have obtained meteorolog-
ical data for all towns within Shanghai’s Fengxian District over
the same time period mentioned above. This data includes the fol-
lowing indicators, which are the most common and representative
indicators in meteorology:
•Total Surface Precipitation (precipitation): Including
rain or snow, falling on a specific area within a set ßtime
(Millimeters).
•Two-meter Above Ground Temperature (temperature):
The ambient air temperature at around two meters above
ground (Celsius).
•Total Cloud Cover (cloud cover): The fraction of the sky
covered by clouds (Percentage).
•Ten-meter Above Ground Wind Speed (wind speed):
Wind speed at ten meters above the ground.
•Two-meter Above Ground Relative Humidity (humid-
ity): Relative humidity of the air at about two meters above
the ground.
•Surface Visibility (visibility): The maximum distance to
identify prominent objects in daylight (Kilometers).
2.2 Data Analysis
2.2.1 Temporal Periodicity and Mutual-Excitation. Our dataset anal-
ysis, illustrated in Fig. 4, reveals noticeable periodicity in event
occurrence both weekly and daily. Events dip during the Chinese
New Year, weekends, and public holidays, with a significant drop
in mid-January 2020 due to the Covid-19 pandemic (we eliminate
this part of abnormal data caused by the epidemic). These tem-
poral patterns highlight the events’ regularity and predictability.
Moreover, the parallel trends among different events align with
the "mutual-excitation" phenomenon of the Hawkes process, vali-
dating our modeling choice. Note that here provided timings are
report time instead of occurrence time. Nevertheless, considering
the highly intelligent sensors and officers who frequently patrol,
these times can be reported in time, so we regard them as the actual
time of these nuisances.
6039KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
(A) Month (Weekly Granularity of 3 Years, spans from January 2019 through December 2021)
(B) Day (Daily Granularity of 1 Month, spans from June 30, 2019 to July 30 2019)FrequencyFrequency
Figure 3: A study of temporal distributions of three event
categories in (A) weekly granularity and (B) daily granularity.
TemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event FrequencyTemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event FrequencyTemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event FrequencyTemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event FrequencyTemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event FrequencyTemperatureEvent Frequency0510152025303540020406080100
Temperature (Celsius degree)Wind Speed (Meters per Second)0246810120255075100125150175Event Frequency
Relative Humidity (Percentage)2030405060708090100Event Frequency020406080
Cloud Cover (Percentage)020406080Event Frequency020406080100
Visibility (Kilometers)01020304050Precipitation (Liter per Meter Square)024681012020406080100120Event Frequency050100150Event Frequency
Figure 4: Comparison of the trend between meteorological
indicator intervals and the occurrence frequency of events.
The blue scatter plots represent the event frequency corre-
sponding to the meteorological interval, and the orange solid
lines represent the regression curve.2.2.2 Spatial Agglomeration. Spatial agglomeration refers to event
concentration within specific zones. Considering this alongside
temporal analysis is crucial due to the multidimensional nature of
events in Fengxian District, spanning 733 square kilometers and
governing 13 towns.
Fig. 2 (A) shows varied distributions of ten event types per town.
Notably, graffiti is the most common occurrence in the majority of
towns. Fig. 2 (C) details event spatial distribution, with most occur-
ring in the district’s western part, attributed to more towns and a
denser population. This shows nuisances’ spatial agglomeration.
2.2.3 The Relationship between Public Nuisances and Meteorological
Indicators. Previous studies link user behavior with meteorological
psychology, illustrating how weather impacts mental states and
subsequently, behavior [ 8–10]. Building on this, we examine the re-
lation between meteorological data and public nuisances. Fig. 1 (C)
shows that daily nuisance dynamics correspond with fluctuations
in meteorological indicators. We also analyze all six meteorological
factors, as shown in Fig. 4. By dividing each factor into 50 inter-
vals and using the interval median for the x-axis, we ensure the
point height denotes normalized event counts, adjusting for yearly
frequency variations. To clarify the visualization, we employ third-
order regression, noting a strong alignment between points and
curves. This indicates significant correlations between meteorology
and nuisances, reinforcing the benefits of incorporating such data
in predictive models.
3 PROBLEM DEFINITION
Event reports provide spatial-temporal data, linking to specific
times and geographic areas, like towns. Urban space, denoted as
R, divides into towns 𝛾where𝛾∈R and|R|=𝑛. An adjacency
matrix𝐴∈{0,1}𝑛×𝑛illustrates town connections as a graph. We
transform these reports into event streams using timestamps and
town data.
Definition 3.1 (Event Stream). An event stream 𝐻𝛾
𝑡0:𝑡𝐿∈Rℎ×2
representsℎhistorical occurred public nuisance event from the
timestamp𝑡0to𝑡𝐿in the town 𝛾. The𝑖-th occurred event in 𝐻𝛾
𝑡0:𝑡𝐿
can be denoted as a tuple (𝑡,𝜅)𝛾
𝑖, where𝑡denotes it occurred at the
timestamp𝑡, and𝜅represent the category of the event.
Definition 3.2 (Meteorological Indicators). Meteorological indica-
tors𝑀𝛾
𝑡0:𝑡𝐹∈R𝐹×𝑚denotes the available 𝑚meteorological indica-
tors from timestamp 𝑡0to timestamp 𝑡𝐹−1in the town 𝛾.
We use the set|C|=𝑠to denote all event categories containing
𝑠categories.𝜅∈C is a category of urban public nuisance event.
For convenience, we use 𝑇𝛾
𝑡0:𝑡𝐿∈Rℎto represent the occurrence
timing of the events in the event stream 𝐻𝛾
𝑡0:𝑡𝐿, and𝐶𝛾
𝑡0:𝑡𝐿∈Rℎto
represent the categories of events in the event stream 𝐻𝛾
𝑡0:𝑡𝐿.
Based on the definition of event stream and meteorological in-
dicators, we denote historical meteorological indicators by 𝑀𝛾
𝑡0:𝑡𝐿,
and denote predicted meteorological indicators by 𝑀𝛾
𝑡𝐿:𝑡𝐹. Thus, we
formulate the problem studied in this paper as follows:
Definition 3.3 (Meteorology-aided nuisance prediction). Given: (1)
The event stream 𝐻𝛾
𝑡0:𝑡𝐿from time𝑡0until time𝑡𝐿; (2) the historical
meteorological indicators 𝑀𝛾
𝑡0:𝑡𝐿; (3) the predicted meteorological
6040Weather Knows What Will Occur: Urban Public Nuisance Events Prediction and Control with Meteorological Assistance KDD ’24, August 25–29, 2024, Barcelona, Spain
Time. . . Historical EventsFuture EventsImpactImpact
Figure 5: Neural Hawkes processes are illustrated with red
arrows indicating the first future event’s impact and blue for
the second. The neural network determines whether these
impacts are excitation or inhibition, and further quantifies
the impact. Since it’s an auto-regressive process, the first
future event influences subsequent events, but not vice versa.
indicators𝑀𝛾
𝑡𝐿:𝑡𝐹that from time 𝑡0until time𝑡𝐹in the town𝛾, where
𝑡𝐹>𝑡𝐿.Target: is to predict the future event stream ˆ𝐻𝛾
𝑡𝐿:𝑡𝐹from the
timestamp𝑡𝐿until the timestamp 𝑡𝐹in the town𝛾, including: (1) the
conditional intensity function 𝜆𝛾(𝑡); (2) the occurrence timestamps
of the events ˆ𝑇𝛾
𝑡𝐿:𝑡𝐹; (3) the categories of events ˆ𝐶𝛾
𝑡𝐿:𝑡𝐹.
We use𝛾to denote a town instance for simplicity. However, in
modeling, we consider spatial information among towns, perform-
ing predictions in parallel for all towns, changing the superscript
toRto indicate simultaneous output for all towns.
4 METHODOLOGY
4.1 Modeling Hawkes Processes
The Hawkes process models event sequences with feedback, where
an event’s occurrence boosts future event probabilities, resulting in
"mutual excitation" [ 21]. The Neural Hawkes process extends this,
utilizing neural networks to simulate the intensity function, cap-
turing complex event correlations and dynamics more effectively.
Its adaptability and accuracy in predictions are enhanced by the
non-linearity and learning capacity of neural networks [37, 55].
Definition 4.1 (Conditional Intensity function). Given a set of his-
torical event stream 𝐻𝛾
𝑡0:𝑡𝐿from the timestamp 𝑡0to the timestamp
𝑡𝐿in the town𝛾, we define the conditional intensity function 𝜆𝛾(𝑡𝐹)
of Hawkes processes as the expectation of the occurrence of fu-
ture events(𝑡,𝜅)𝛾
𝑖within a time interval 𝑡∈[𝑡𝐹,𝑡𝐹+Δ𝑡)that is
conditioned on 𝐻𝛾
𝑡0:𝑡𝐿, where𝑡𝐹≥𝑡𝐿. It is formally defined as:
𝜆𝛾(𝑡𝐹)=P((𝑡,𝜅)𝛾
𝑖|𝑡∈[𝑡𝐹,𝑡𝐹+Δ𝑡),𝐻𝛾
𝑡0:𝑡𝐿)
Δ𝑡
=Í
𝜅∈CE(𝑁𝛾(𝑡𝐹+Δ𝑡,𝜅)−𝑁𝑟(𝑡𝐹,𝜅)|𝐻𝛾
𝑡0:𝑡𝐿)
Δ𝑡(1)
where𝑁𝛾(𝑡𝐹,𝜅)records the number of the event 𝜅∈Cthat have
occurred until time 𝑡𝐹in the town 𝛾,Cdenotes the set of all event
categories, and Δ𝑡is an arbitrary time shift.
Hawkes processes assume historical events influence future ones
[22]. In Neural Hawkes Processes, this influence extends to both
positive and negative [ 37,60,65]. Being auto-regressive, as new
events are predicted, they are added to the historical data to influ-
ence upcoming events, a dynamic illustrated in Fig. 5.Given an event stream 𝐻𝛾
𝑡0:𝑡𝐹containing real historical events
𝐻𝛾
𝑡0:𝑡𝐹and incorporated predicted events 𝐻𝛾
𝑡0:𝑡𝐹, we use a neural
network𝑓𝜃,𝜅to model a conditional intensity function 𝜆𝛾(𝑡𝐹), quan-
tifying each event’s impact on future ones:
𝜆𝛾(𝑡𝐹)=∑︁
𝜅∈C𝑓𝜃,𝜅(𝐻𝛾
𝑡0:𝑡𝐹), (2)
where𝑓𝜃,𝜅denotes a neural network parameterized by 𝜃. Note that
the parameters of 𝑓𝜃,𝜅are shared among different towns 𝛾.
Combining Eqn. (1) and Eqn. (2), we derive the conditional in-
tensity function 𝜆𝛾(𝑡𝐹)for any𝑡𝐹≥𝑡𝐿. We then integrate this
function to compute the expected occurrences of events in any time
interval from 𝑡𝐹to𝑡𝐹+Δ𝑡.
𝑁𝛾(𝑡𝐹+Δ𝑡,𝜅)−𝑁𝛾(𝑡𝐹,𝜅)≈∫𝑡𝐹+Δ𝑡
𝑡𝐹𝜆𝛾
𝜅(𝑡)d𝑡, (3)
𝜆𝛾
𝜅(𝑡𝐹)represents the conditional intensity for category 𝜅at𝑡𝐹. The
use of approximate equals arises because while event numbers are
integers, the integral result might not be.
4.2 Spatial-Temporal Two-Tower Transformer
We present the Spatial-Temporal Two-Tower Transformer (ST-T3),
an innovative approach conceived for meteorology-aided urban
public nuisance prediction. A thorough illustration of its architec-
ture is provided in Fig. 6.
ST-T3processes three distinct types of input information:
•The historical event streams of all towns: 𝐻R
𝑡0:𝑡𝐿={(𝑡,𝜅)R
𝑖|𝑡0≤
𝑡≤𝑡𝐿}∈R𝑛×ℎ×2.
•The meteorology predictions until 𝑡𝐹:𝑀R
𝑡0:𝑡𝐹∈R𝑛×𝐹×𝑚.
•The adjacency matrix of 𝐴∈{0,1}𝑛×𝑛among𝑛towns.
The addition of spatial information extends data by an extra
dimension. We use the uppercase superscript Rfor all towns, while
𝛾denotes a specific town instance. Event streams 𝐻R
𝑡0:𝑡𝐿are zero-
padded to𝐻R
𝑡0:𝑡𝐹to match meteorological predictions. Both are
embedded into a 𝑑-dimensional latent space, undergo shared time
encoding, and are encoded by category and value encoders. They’re
fused via a gating mechanism and fed into the Hawkes Encoder,
which determines the next event’s category and timing.
4.2.1 Transformers with Two-Tower Structure. As previously men-
tioned, two information sets are crucial: the historical event stream
𝐻𝛾
𝑡0:𝑡𝐿and meteorology predictions 𝑀𝛾
𝑡0:𝑡𝐹. These sets have funda-
mental differences:
•Event streams are irregular time series with varied inter-
vals and durations, unlike meteorology predictions that are
regular, with fixed intervals and output lengths.
•Event streams are auto-regressive, lacking future informa-
tion, while meteorological data is available for the entire
time span due to accurate predictions [6].
We use Hawkes processes for event streams and conventional
time series for meteorological information [ 53,62,65], applying
Transformers to both. This creates a two-tower structure (Fig. 6),
with the Event Stream Encoder andMeteorology Indicator
Encoder modeling respective data. They converge via a gating
mechanism into the Hawkes Encoder, producing final conditional
intensity functions. While the last two encoders share a structure
6041KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
(t,c)ℛ0⋯(t,c)ℛ1(t,c)ℛ2(t,c)Rℛ(t,c)ℛL−1
Mℛ(t0)⋯Mℛ(t1)Mℛ(t2)Mℛ(tF)Urban Public Nuisance Event StreamMeteorological  Indicators
Real Regional Adjacency Relations
Adjacency  MatrixPaddingCategory Embedding
Graph  ConvolutionAttentionQKV
Graph  ConvolutionAttentionQKVValue EmbeddingShared Time Encoding
Graph  ConvolutionAttentionQKVFFNFFN
FFNλℛ(t)FFNConditional Intensity FunctionFFNTiming PredictorCategory Predictor
AbsSoftmaxArgmaxCategory
TiminĝCℛtL:tF
̂TℛtL:tFHawkes  Encoder (N)×Meteorology  Indicator Encoder (N) ×Event Stream Encoder (N) ×Ai,j={1if i and j are adjacent 0otherwise
Figure 6: In ST-T3, event stream encoders and meteorological
indicator encoders process events and meteorological indi-
cators, respectively, aligned via shared time encoding. After
encoding, a gating mechanism fuses the encoders’ outputs,
which then encode the Hawkes processes. The final repre-
sentation quantifies the conditional intensity function, and
is further split into two parts: category, and timing. Category
Predictor uses Softmax for the probability distribution, se-
lecting the highest probability category. Timing Predictor,
a regression model, uses the Absolute function to ensure
positive output values. The conditional intensity function is
derived from these predictions.
for continuous numerical data, the first adapts to discrete input. This
architecture is proven effective in integrating varied information
in recommendation [25, 26] and multi-modal systems [5, 20].
4.2.2 Category and Value Embedding. Category embedding con-
verts discrete event categories into latent forms, utilizing one-hot
vectors and an Embedding layer, extracting data from 𝐻R
𝑡0:𝑡𝐹to cre-
ate𝐶R
𝑡0:𝑡𝐹. Value embedding uses a fully connected (FC) layer to
transform meteorological indicators into the same space:
𝐶=Embedding(𝐶R
𝑡0:𝑡𝐿), 𝑀 =FC(𝑀R
𝑡0:𝑡𝐹), (4)
where𝐶∈R𝑛×ℎ×𝑑, and𝑀∈R𝑛×𝐹×𝑑.
4.2.3 Shared Time Encoding. The embeddings of categories 𝐶and
meteorological indicators 𝑀conduct shared time encoding rule:
𝑇𝐸(𝑡)𝑖= 
𝑐𝑜𝑠(𝑡
10000𝑖−1
𝑑)if𝑖is odd
𝑠𝑖𝑛(𝑡
10000𝑖
𝑑) if𝑖is even(5)where𝑡is the occurence timings, and 𝑖denotes the 𝑖-th dimension.
Event occurrence times are extracted from 𝐻R
𝑡0:𝑡𝐹as𝑇R
𝑡0:𝑡𝐹. Each
sample’s time is relative to the first event’s occurrence. This time
encoding is then added to the representations:
𝐶:=𝐶+𝑇𝐸(𝑇R
𝑡0:𝑡𝐹), 𝑀 :=𝑀+𝑇𝐸(𝑇R
𝑡0:𝑡𝐹). (6)
4.2.4 Spatial-Temporal Transformer. We encode both post-embedding
and time-encoded information for final predictions using a Spatial-
Temporal Transformer that incorporates spatial correlations. Given
event streams are auto-regressive with no future data, we add masks
during training to prevent future data access, as shown in Fig. 6 (B).
Otherwise, both information types are processed similarly.
Intuitively, the main idea behind our model is to calculate the
impact of all historical events and meteorological indicators on the
current conditional intensity function by attention:
𝜆𝛾(𝑡)=∑︁
(𝑡,𝜅)𝛾
𝑖∈𝐻𝛾
𝑡0:𝑡𝐿𝛼𝑖(𝑡,𝜅)𝛾
𝑖+∑︁
𝑡∈[𝑡0,𝑡𝐹]𝛽𝑡𝑀𝛾(𝑡), (7)
whereÍ
𝛼𝑖=Í
𝛽𝑡=1are corresponded attention coefficients.
Formally, we define the spatial-temporal attention in the Spatial-
Temporal Transformer. Given a set of embeddings of historical
information 𝐶∈R𝑛×ℎ×𝑑(event stream information for instance
herein), the spatial-temporal attention can be defined as:
𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛(𝑄,𝐾,𝑉)=𝑠𝑜𝑓𝑡𝑚𝑎𝑥(𝑄𝐾⊤
√
𝑑)𝑉, (8)
where
𝑄=𝐶★𝐴𝑊𝑄, 𝐾 =𝐶★𝐴𝑊𝐾, 𝑉 =𝐶★𝐴𝑊𝑉, (9)
𝑊𝑄,𝑊𝐾,𝑊𝑉∈R𝑑×𝑑are trainable matrices, ∗𝐴denotes the graph
convolutional layer [30] based on the adjacency matrix 𝐴:
𝐶★𝐴𝑊𝐴=𝐷−1
2𝐴𝐷−1
2𝐶𝑊𝐴. (10)
𝐷∈R𝑛×𝑛is the degree matrix of 𝐴,𝑊𝐴∈R𝑑×𝑑is parameters.
Both event streams and meteorological indicators undergo the
same operations, but they differ in data availability. Meteorological
indicators include future data, making them longer. We pad event
streams to match their length and then fuse the datasets through a
gating mechanism. The fused representations are input into multi-
layer perceptrons as category and time predictors, yielding final
predictions for categories ˆ𝐶R
𝑡𝐿:𝑡𝐹and timestamps ˆ𝑇R
𝑡𝐿:𝑡𝐹.
Note that for multi-step prediction problems, we typically use a
recurrent approach to make predictions.
4.3 Training
The optimization objective consists of three parts: log-likelihood
(LL), cross-entropy loss (CE), and mean squared errors (MSE).
4.3.1 Log-Likelihood. Optimizing the log-likelihood (LL) enhances
the conditional intensity function of the event stream, aiming to
maximize its value during events and minimize it when absent.
Formally, given a predicted event stream 𝐻R
𝑡0:𝑡𝐹and its condi-
tional intensity function 𝜆R(𝑡), the log-likelihood is defined as:
𝐿𝐿𝐿(𝐻R
𝑡0:𝑡𝐹)=𝐹−1∑︁
𝑗=0𝑙𝑜𝑔(𝜆R(𝑡𝑗))−∫𝑡𝐹
𝑡0𝜆R(𝑡)d𝑡, (11)
6042Weather Knows What Will Occur: Urban Public Nuisance Events Prediction and Control with Meteorological Assistance KDD ’24, August 25–29, 2024, Barcelona, Spain
The termÍ𝐹−1
𝑗=0𝑙𝑜𝑔(𝜆R(𝑡𝑗)), or event log-likelihood, measures val-
ues when events occur and is maximized. The term∫𝑡𝐹
𝑡0𝜆R(𝑡)d𝑡,
non-event log-likelihood, measures non-occurrence times and is
minimized. We approximate the definite integral using Monte Carlo
integration [46]:
∫𝑡𝐹
𝑡0𝜆R(𝑡)d𝑡≈𝐹−1∑︁
𝑗=1(𝑡𝑗−𝑡𝑗−1)(𝑈−1∑︁
𝑖=0𝜆R(𝑢𝑖)), (12)
where𝑈is the number of uniform sampling points in the Monte
Carlo integration, we let 𝑈=100in this paper.
4.3.2 Cross-Entropy Loss. Cross entropy loss (CE) is to optimize
the category predictor, which is a conventional multi-classification
loss and enhances the prediction of event category:
𝐿𝐶𝐸(𝐶R
𝑡𝐿:𝑡𝐹,ˆ𝐶R
𝑡𝐿:𝑡𝐹)=−𝑠−1∑︁
𝜅=0(𝐶R
𝑡𝐿:𝑡𝐹)𝜅𝑙𝑜𝑔(ˆ𝐶R
𝑡𝐿:𝑡𝐹)𝜅, (13)
𝐶R
𝑡𝐿:𝑡𝐹denotes the ground truth, ˆ𝐶R
𝑡𝐿:𝑡𝐹denotes predicted category
of events, the subscript 𝜅means the𝜅-th category of events.
4.3.3 Mean Squared Errors. Mean Squared Errors (MSE) to reduce
the predicted occurrence time errors of events:
𝐿𝑀𝑆𝐸(𝑇R
𝑡𝐿:𝑡𝐹,ˆ𝑇R
𝑡𝐿:𝑡𝐹)=(𝑇R
𝑡𝐿:𝑡𝐹−ˆ𝑇R
𝑡𝐿:𝑡𝐹)2, (14)
ˆ𝑇R
𝑡𝐿:𝑡𝐹is the predicted timings, 𝑇R
𝑡𝐿:𝑡𝐹is the ground truth.
These loss functions are weighted summed. Since maximizing
log-likelihood contrasts with minimizing cross-entropy and mean
squared error, we minimize negative log-likelihood instead:
𝐿=−𝐿𝐿𝐿+𝛼1𝐿𝐶𝐸+𝛼2𝐿𝑀𝑆𝐸. (15)
5 EXPERIMENTS
We conduct experiments on a real-world dataset (introduced in
Section 2) to answer the following three questions:
•Q1 : How does the proposed ST-T3perform on the public
nuisance prediction tasks, compared with previous state-of-
the-art baselines and used methods?
•Q2: What performance improvements and additional infor-
mation do the meteorological indicators provide?
•Q3: Can ST-T3perform well in real scenarios to capture the
time and category of public nuisance event?
5.1 Setup
5.1.1 Baselines. We evaluate our proposed ST-T3against two cate-
gories of baseline methods. The first is classification methods:
•Nearest Neighbors (N-Neighb) : A heuristic method predicts
the next event’s category by identifying the most common
nuisance in nearby towns over the last 6 hours.
•LightGBM [29]: A commonly-utilized gradient boosting
decision tree algorithm for classification.
•Dense-Connected Neural Network (DNN) : The simplest
form of a neural network with densely connected layers.
Each baseline, except Nearest Neighbors, employs complex, hand-
crafted feature engineering for input but can only predict upcoming
event categories, not their probability distribution or timings.
The second type of baseline methods are Hawkes process:•Naive Hawkes Process (Naive-HP) [21]: A stochastic model
predicting event occurrences over time, with future events’
intensity dependent on functions modeling historical events.
•Neural Hawkes Process (NHP) (2017)[ 37]: A stochastic
model melding the Hawkes process with neural networks
to capture complex interdependencies in dynamic event se-
quences.
•Self-Attentive Hawkes Process (SAHP) (2021) [ 60]: This
neural Hawkes process employs a self-attention mechanism
to grasp complex temporal dynamics in event sequences.
•Attentive Neural Hawkes Process (ANHP) (2021) [ 55]: This
enhanced Neural Hawkes Process integrates flat attention-
based architectures.
We embed meteorological information, fusing it with Hawkes
process representations as these methods lack an interface for it.
5.1.2 Evaluation Metrics. We evaluate performance using:
•Accuracy , measuring the proportion of correct event cate-
gory predictions.
•Micro- & Macro-averaged F1 score addresses class imbal-
ance; micro averages class contributions, while macro calcu-
lates metrics for each class before averaging.
•Root Mean Squared Errors (RMSE) assesses the precision
of event timing predictions.
•Log-Likelihood (LL) evaluates the fit of the parameterized
conditional intensity function.
5.1.3 Experimental Settings. Experiments are conducted on a server
with an Intel Xeon Gold 5217 CPU, 128G RAM, and RTX 3090 graph-
ics cards, using PyTorch. Model hyper-parameters are optimized
using a validation dataset and early stopping. We use the Adam
optimizer with a 0.0001 learning rate and a batch size of 32. The
latent feature dimension is set to 64, each encoder has 2layers, and
the loss function coefficients are set at 1,0.0001 for𝛼1and𝛼2.
5.2 Overall Performance
To address Q1, we compare performance using a historical event
stream and meteorological data from the past hour, along with
meteorological predictions for the future 20 minutes. This data is
used to predict the categories and timing of the subsequent 5 events,
which have already been deployed in a real scenario.
5.2.1 Comparison Description. Table 2 compares various meth-
ods’ performance on the Suburban dataset, we also conduct the
same experiment on the Shanghai Downtown dataset, shown in
the Appendix A. They fall into two categories: statistical learn-
ing techniques and Hawkes process-based methods, outlined in
Section 5.1.1. The former can’t predict event timings or compute
log-likelihood values due to lack of conditional intensity functions.
We further classify methods based on their use of meteorological
data. Some, like N-Neighb, LightGBM, and DNN, only use this data
("only Meteo. Info."). Others, like NHP, SAHP, and ANHP, use past
event streams ("w/o Meteo. Info.") and can add meteorological data
("with Meteo. Info."). Naive-HP, a Hawkes process method, doesn’t
have an interface or deep learning elements to include meteoro-
logical data. So, we simply fuse this data with its historical event
streams in a concatenation way.
6043KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
Table 2: Performance Comparison on Suburban.
MetricsAccuracy
(%) (↑)Micro-F1
(↑)Macro-F1
(↑)RMSE
(100 secs) (↓)LL
(↑)
Task Predict the Next Event
only
Meteo.
Info.N-Neighb 41.45 0.513 0.396 - -
LightGBM 35.45 0.381 0.335 - -
DNN 41.15 0.405 0.391 - -
w/o
Meteo.
Info.Naive-HP 40.41 0.335 0.291 11.41 -2.218
NHP 48.90 0.468 0.452 13.31 -2.261
SAHP 52.10 0.497 0.403 9.97 -2.240
ANHP 71.21 0.600 0.591 8.41 -1.491
with
Meteo.
Info.Naive-HP 35.41 0.325 0.171 21.41 -6.218
NHP 60.23 0.495 0.422 12.21 -1.931
SAHP 65.92 0.563 0.515 8.60 -1.717
ANHP 75.41 0.705 0.652 5.68 -0.672
ST-T387.61 0.901 0.885 3.97 -0.065
Task Predict the Subsequent 5 Events
only
Meteo.
Info.N-Neighb 33.23 0.308 0.107 - -
LightGBM 32.54 0.276 0.175 - -
DNN 30.41 0.255 0.143 - -
w/o
Meteo.
Info.Naive-HP 32.41 0.243 0.190 22.58 -7.615
NHP 35.41 0.311 0.210 15.53 -5.311
SAHP 36.53 0.302 0.241 13.50 -5.431
ANHP 40.31 0.357 0.268 11.60 -5.353
with
Meteo.
Info.Naive-HP 16.41 0.133 0.100 35.58 -9.615
NHP 40.55 0.396 0.355 16.30 -6.652
SAHP 51.01 0.505 0.407 10.32 -3.580
ANHP 55.34 0.562 0.507 8.65 -2.689
ST-T373.45 0.711 0.633 6.02 -1.684
5.2.2 Comparison Analysis. Table 2 assesses various prediction
methods for immediate and 20-minute future events, covering ac-
curacy, micro-F1, macro-F1, RMSE (100 secs), and Log-Likelihood.
Methods are categorized based on data use: meteorological, event
streams, or both.
For meteorology-based predictions, N-Neighb tops the chart
for immediate event prediction with 41.45% accuracy and a 0.513
micro-F1, but sees a decline in accuracy to 33.23% and micro-F1 to
0.308 for upcoming 5 events. This drop highlights the challenge of
accumulating errors in event prediction.
In the event stream category, ANHP is the leader, achieving
71.21% accuracy and a 0.600 micro-F1 for the next event, and 40.31%
accuracy, 0.357 micro-F1 for 20-minute forecasts. Integrating mete-
orological data, ANHP improves to 75.41% accuracy, 0.705 micro-F1
for immediate events, and 55.34% accuracy, 0.562 micro-F1 for short-
term forecasts, illustrating the value of meteorological insights.
ST-T3outperforms others across all metrics, with 87.61% accu-
racy, 0.901 micro-F1, 0.885 macro-F1, 3.97 RMSE, and -0.065 Log-
Likelihood for the next event. For the next 5 events, it records 73.45%
accuracy, 0.711 micro-F1, 0.633 macro-F1, 6.02 RMSE, and -1.684
Log-Likelihood. These results demonstrate the significant advan-
tage of including meteorological data, with ST-T3showing superior
algorithmic efficiency and emerging as the top choice for short-term
event prediction when meteorological data is considered.
5.3 Ablation Studies
We conduct ablation studies for Q2 to highlight the importance
of ST-T3’s key features. We evaluate the impact of meteorologi-
cal information and spatial information in prediction by removing
them individually. We label the model without meteorological in-
formation as ST-T3(w/o M. Info.) and without spatial information
w/o  M.Info.w/o  S.Info.ST-T3Figure 7: Performance Comparison of Ablation Models.
Historical Event StreamPredicted  And Real  Event Stream
Figure 8: The visualization of the case study. Blue shapes
represent the predictions and green shapes denote the real
ocurrences. ✓means the right category predictions, and ×
means otherwise. The numbers near points represent the
occurrence timings, and the numbers above dotted lines rep-
resent the time separation of real events and predictions.
as ST-T3(w/o S. Info.), then evaluate performance on predicting the
next event and subsequent 5 events, shows in Fig. 7. The complete
ST-T3model consistently outperforms its variations lacking meteo-
rological or spatial information in all metrics. In the "Predict the
Next Event" task, it registers a notable 72.85% increase in Macro-F1
compared to ST-T3(w/o M. Info.). For "Predict the Subsequent 5
Events," there’s a 21.33% enhancement in Micro-F1 over the same
variant. The integration of meteorological data, validated by base-
line models, aligns with our analysis of its significant influence on
urban nuisances. Our approach enhances this integration, leading
to improved results. Including spatial information, supported by
identified spatial correlations, further boosts the performance.
5.4 Case Study
In response to Q3, we conduct case study from a town of suburban
area on July 11, 2022, predictions start from 2:00 PM with historical
data from 1:00 PM to 2:00 PM, shown in Fig 8. The part with the
6044Weather Knows What Will Occur: Urban Public Nuisance Events Prediction and Control with Meteorological Assistance KDD ’24, August 25–29, 2024, Barcelona, Spain
dark background of Fig. 8 shows the historical events timestamps
are relatively starting at 0.00 for the first event, with subsequent
times indicating elapsed periods in 100-second units. The below
part shows the predicted and actual values for the subsequent 5
events. In this case, our model attained an 80% accuracy in event
category prediction, consistent with our earlier reported results.
The average timing error was 165 seconds, slightly better than
earlier findings. It is noteworthy that the final event is predicted in
an incorrect category, stemming from that the approach of one-step-
ahead prediction gives rise to an accumulation of cascading errors,
as we build on predicted events to generate subsequent occurrences.
Nonetheless, such errors are controllable and acceptable to the
system.
6 CONCLUSION
In this paper, we tackled the challenge of accurate urban public nui-
sance predictions. Our study shows that including meteorological
indicators significantly improves prediction accuracy. We propose
a two-tower Transformer structure to integrate meteorological in-
formation into nuisance predictions seamlessly. We further employ
Hawkes processes to model public nuisance occurrences, enhancing
prediction accuracy for event timings and categories. Additionally,
extensive experiments on our collected and soon-to-be-released
dataset demonstrated the effectiveness of our proposed scheme, pro-
viding empirical support for our methodology and its contributions
toward more accurate urban public nuisance event predictions.
ACKNOWLEDGMENTS
This study is supported National Natural Science Foundation of
China under Grant 62322601; and is also partially supported by the
Excellent Youth Foundation of Chongqing under Grant
CSTB2023NSCQJQX0025.
REFERENCES
[1]A. Ahlbom and M. Feychting. 2003. Electromagnetic radiation: environmental
pollution and health. British medical bulletin 68, 1 (2003), 157–165.
[2]F. Ahouz and A. Golabpour. 2021. Predicting the incidence of COVID-19 using
data mining. BMC public health 21 (2021), 1–12.
[3]Giuseppe Amatulli, Maria João Rodrigues, Marco Trombetti, and Raffaella
Lovreglio. 2006. Assessing long-term fire risk at local scale by means of de-
cision tree technique. Journal of Geophysical Research: Biogeosciences 111, G4
(2006).
[4]Carol S Aneshensel. 1992. Social stress: Theory and research. Annual review of
sociology 18, 1 (1992), 15–38.
[5]T. Baltrušaitis, C. Ahuja, and L. P. Morency. 2018. Multimodal machine learning:
A survey and taxonomy. IEEE transactions on pattern analysis and machine
intelligence 41, 2 (2018), 423–443.
[6]P. Bauer, A. Thorpe, and G. Brunet. 2015. The quiet revolution of numerical
weather prediction. Nature 525, 7567 (2015), 47–55.
[7]Jinming Cao, Xia Jiang, Bin Zhao, et al .2020. Mathematical modeling and
epidemic prediction of COVID-19 and its significance to epidemic prevention
and control measures. Journal of Biomedical Research & Innovation 1, 1 (2020),
1–19.
[8]S. Clayton. 2020. Climate anxiety: Psychological responses to climate change.
Journal of anxiety disorders 74 (2020), 102263.
[9]A. Cunsolo, S. L. Harper, K. Minor, K. Hayes, K. G. Williams, and C. Howard. 2020.
Ecological grief and anxiety: the start of a healthy response to climate change?
The Lancet Planetary Health 4, 7 (2020), e261–e263.
[10] A. Cunsolo Willox, S. L. Harper, J. D. Ford, K. Landman, K. Houle, and V. L. Edge.
2012. “From this place and of this place:” climate change, sense of place, and
health in Nunatsiavut, Canada. Social science & medicine 75, 3 (2012), 538–547.
[11] A. Di Ronco. 2016. Understanding uncivil behaviour through urban space and
culture. In Regulation and Social Control of Incivilities. Routledge, 108–124.[12] Nan Du, Hanjun Dai, Rakshit Trivedi, Utkarsh Upadhyay, Manuel Gomez-
Rodriguez, and Le Song. 2016. Recurrent marked temporal point processes:
Embedding event history to vector. In Proceedings of the 22nd ACM SIGKDD
international conference on knowledge discovery and data mining. 1555–1564.
[13] J. R. Edwards and C. L. Cooper. 1988. The impacts of positive psychological
states on physical health: A review and theoretical framework. Social science &
medicine 27, 12 (1988), 1447–1459.
[14] Zipei Fan, Xuan Song, Ryosuke Shibasaki, and Ryutaro Adachi. 2015. Citymo-
mentum: an online approach for crowd behavior prediction at a citywide level.
InProceedings of the 2015 ACM International Joint Conference on Pervasive and
Ubiquitous Computing. 559–569.
[15] Laura Ferrari, Alberto Rosi, Marco Mamei, and Franco Zambonelli. 2011. Extract-
ing urban patterns from location-based social networks. In Proceedings of the 3rd
ACM SIGSPATIAL international workshop on location-based social networks . 9–16.
[16] J. Gao, C. Xiao, L. M. Glass, and J. Sun. 2022. PopNet: Real-Time Population-Level
Disease Prediction with Data Latency. In Proceedings of the ACM Web Conference
2022. 2552–2562.
[17] L. A. Gottschalk and G. C. Gleser. 1969. The measurement of psychological states
through the content analysis of verbal behavior. Univ of California Press.
[18] Eryn Grant, Paul M Salmon, Nicholas J Stevens, Natassia Goode, and Gemma J
Read. 2018. Back to the future: What do accident causation models tell us about
accident prediction? Safety Science 104 (2018), 99–109.
[19] Poul Greibe. 2003. Accident prediction models for urban roads. Accident Analysis
& Prevention 35, 2 (2003), 273–285.
[20] W. Guo, J. Wang, and S. Wang. 2019. Deep multimodal representation learning:
A survey. IEEE Access 7 (2019), 63373–63394.
[21] A. G. Hawkes. 1971. Spectra of some self-exciting and mutually exciting point
processes. Biometrika 58, 1 (1971), 83–90.
[22] J. Hawkes. 1971. On the Hausdorff dimension of the intersection of the range of
a stable process with a Borel set. Zeitschrift für Wahrscheinlichkeitstheorie und
Verwandte Gebiete 19, 2 (1971), 90–102.
[23] C. Huang, J. Zhang, Y. Zheng, and N. V. Chawla. 2018. DeepCrime: Attentive
hierarchical recurrent networks for crime prediction. In Proceedings of the 27th
ACM international conference on information and knowledge management. 1423–
1432.
[24] H. Huang, X. Yang, and S. He. 2021. Multi-Head Spatio-Temporal Attention
Mechanism for Urban Anomaly Event Prediction. Proceedings of the ACM on
Interactive, Mobile, Wearable and Ubiquitous Technologies 5, 3 (2021), 1–21.
[25] P. S. Huang, X. He, J. Gao, L. Deng, A. Acero, and L. Heck. 2013. Learning
deep structured semantic models for web search using clickthrough data. In
Proceedings of the 22nd ACM international conference on Information & Knowledge
Management. 2333–2338.
[26] T. Huang, Z. Zhang, and J. Zhang. 2019. FiBiNET: combining feature importance
and bilinear feature interaction for click-through rate prediction. In Proceedings
of the 13th ACM Conference on Recommender Systems. 169–177.
[27] Rizwan Iqbal, Masrah Azrifah Azmi Murad, Aida Mustapha, Payam Has-
sany Shariat Panahy, and Nasim Khanahmadliravi. 2013. An experimental study
of classification algorithms for crime prediction. Indian Journal of Science and
Technology 6, 3 (2013), 4219–4225.
[28] V. Isham and M. Westcott. 1979. A self-correcting point process. Stochastic
processes and their applications 8, 3 (1979), 335–347.
[29] G. Ke, Q. Meng, T. Finley, T. Wang, W. Chen, W. Ma, et al .2017. Lightgbm: A
highly efficient gradient boosting decision tree. Advances in neural information
processing systems 30 (2017).
[30] T. N. Kipf and M. Welling. 2016. Semi-supervised classification with graph
convolutional networks. arXiv preprint arXiv:1609.02907 (2016).
[31] Toshikazu Kuniya. 2020. Prediction of the epidemic peak of coronavirus disease
in Japan, 2020. Journal of clinical medicine 9, 3 (2020), 789.
[32] Z. Li, C. Huang, L. Xia, Y. Xu, and J. Pei. 2022. Spatial-Temporal Hypergraph
Self-Supervised Learning for Crime Prediction. In 2022 IEEE 38th International
Conference on Data Engineering (ICDE). IEEE, 2984–2996.
[33] Thomas Josef Liniger. 2009. Multivariate hawkes processes. Ph. D. Dissertation.
ETH Zurich.
[34] Ross Maciejewski, Ryan Hafen, Stephen Rudolph, Stephen G Larew, Michael A
Mitchell, William S Cleveland, and David S Ebert. 2010. Forecasting hotspots—A
predictive analytics approach. IEEE transactions on visualization and computer
graphics 17, 4 (2010), 440–453.
[35] Andres Magnusson and Diane Boivin. 2003. Seasonal affective disorder: an
overview. Chronobiology international 20, 2 (2003), 189–207.
[36] Mohammad Saeid Mahdavinejad, Mohammadreza Rezvan, Mohammadamin
Barekatain, Peyman Adibi, Payam Barnaghi, and Amit P Sheth. 2018. Machine
learning for Internet of Things data analysis: A survey. Digital Communications
and Networks 4, 3 (2018), 161–175.
[37] H. Mei and J. M. Eisner. 2017. The neural hawkes process: A neurally self-
modulating multivariate point process. In Advances in neural information pro-
cessing systems, Vol. 30.
[38] Hongyuan Mei and Jason M Eisner. 2017. The neural hawkes process: A neurally
self-modulating multivariate point process. Advances in neural information
6045KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
processing systems 30 (2017).
[39] A. Millie. 2008. Anti-social behaviour, behavioural expectations and an urban
aesthetic. The British Journal of Criminology 48, 3 (2008), 379–394.
[40] Jutaek Oh, Simon P Washington, and Doohee Nam. 2006. Accident prediction
model for railway-highway interfaces. Accident Analysis & Prevention 38, 2 (2006),
346–356.
[41] Takahiro Omi, Kazuyuki Aihara, et al .2019. Fully neural network based model
for general temporal point processes. Advances in neural information processing
systems 32 (2019).
[42] Conny Palm. 1943. Intensitatsschwankungen im fernsprechverker. Ericsson
technics (1943).
[43] Timo Partonen and Jouko Lönnqvist. 1998. Seasonal affective disorder. The
Lancet 352, 9137 (1998), 1369–1374.
[44] Chengbin Peng, Xiaogang Jin, Ka-Chun Wong, Meixia Shi, and Pietro Liò. 2012.
Collective human mobility pattern from taxi trips in urban area. PloS one 7, 4
(2012), e34487.
[45] R. Pollitzer. 1954. Plague. WHO, Geneva. 409–482 pages.
[46] C. P. Robert, G. Casella, and G. Casella. 1999. Monte Carlo statistical methods.
Vol. 2. Springer.
[47] R. Safdari, S. Rezayi, S. Saeedi, M. Tanhapour, and M. Gholamzadeh. 2021. Using
data mining techniques to fight and control epidemics: A scoping review. Health
and Technology 11 (2021), 759–771.
[48] J. R. Spencer. 1989. Public Nuisance—A Critical Examination. The Cambridge
Law Journal 48, 1 (1989), 55–84.
[49] D. Trafimow and M. Fishbein. 1994. The moderating effect of behavior type on
the subjective norm-behavior relationship. The Journal of Social Psychology 134,
6 (1994), 755–763.
[50] John C Turner. 2010. Social categorization and the self-concept: a social cognitive
theory of group behavior. (2010).
[51] B. Wang, Y. Lin, S. Guo, and H. Wan. 2021. GSNet: learning spatial-temporal
correlations from geographical and semantic aspects for traffic accident risk
forecasting. In Proceedings of the AAAI conference on artificial intelligence, Vol. 35.
4402–4409.
[52] C. Wang, Z. Lin, X. Yang, J. Sun, M. Yue, and C. Shahabi. 2022. Hagen: Homophily-
aware graph convolutional recurrent network for crime forecasting. In Proceed-
ings of the AAAI Conference on Artificial Intelligence, Vol. 36. 4193–4200.
[53] H. Wu, J. Xu, J. Wang, and M. Long. 2021. Autoformer: Decomposition transform-
ers with auto-correlation for long-term series forecasting. Advances in Neural
Information Processing Systems 34 (2021), 22419–22430.
[54] Shuai Xiao, Junchi Yan, Xiaokang Yang, Hongyuan Zha, and Stephen Chu. 2017.
Modeling the intensity function of point process via recurrent neural networks.
InProceedings of the AAAI conference on artificial intelligence, Vol. 31.
[55] C. Yang, H. Mei, and J. Eisner. 2021. Transformer embeddings of irregularly
spaced events and their participants. arXiv preprint arXiv:2201.00044 (2021).
[56] Chenghao Yang, Hongyuan Mei, and Jason Eisner. 2021. Transformer embeddings
of irregularly spaced events and their participants. arXiv preprint arXiv:2201.00044
(2021).
[57] S. Yousif. 1999. A study into on-street parking: Effects on traffic congestion.
Traffic Engineering and Control 40 (1999), 424–427.
[58] Junbo Zhang, Yu Zheng, and Dekang Qi. 2017. Deep spatio-temporal residual net-
works for citywide crowd flows prediction. In Proceedings of the AAAI conference
on artificial intelligence, Vol. 31.
[59] Mingyang Zhang, Tong Li, Yue Yu, Yong Li, Pan Hui, and Yu Zheng. 2020. Urban
anomaly analytics: Description, detection, and prediction. IEEE Transactions on
Big Data 8, 3 (2020), 809–826.
[60] Q. Zhang, A. Lipani, O. Kirnap, and E. Yilmaz. 2020. Self-attentive Hawkes process.
InInternational conference on machine learning. PMLR, 11183–11193.
[61] Xiangyu Zhao and Jiliang Tang. 2017. Modeling temporal-spatial correlations for
crime prediction. In Proceedings of the 2017 ACM on Conference on Information
and Knowledge Management. 497–506.
[62] H. Zhou, S. Zhang, J. Peng, S. Zhang, J. Li, H. Xiong, and W. Zhang. 2021. In-
former: Beyond efficient transformer for long sequence time-series forecasting. In
Proceedings of the AAAI conference on artificial intelligence, Vol. 35. 11106–11115.
[63] Z. Zhou, Y. Wang, X. Xie, L. Chen, and H. Liu. 2020. RiskOracle: a minute-
level citywide traffic accident forecasting framework. In Proceedings of the AAAI
conference on artificial intelligence, Vol. 34. 1258–1265.
[64] Z. Zhou, Y. Wang, X. Xie, L. Chen, and C. Zhu. 2020. Foresee urban sparse traffic
accidents: A spatiotemporal multi-granularity perspective. IEEE Transactions on
Knowledge and Data Engineering 34, 8 (2020), 3786–3799.
[65] S. Zuo, H. Jiang, Z. Li, T. Zhao, and H. Zha. 2020. Transformer hawkes process.
InInternational conference on machine learning. PMLR, 11692–11702.
A PERFORMANCE COMPARISON ON
DOWNTOWN DATASET
We also conducted a performance comparison in downtown data.Table 3: Prediction Performance Comparison on Downtown.
MetricsAccuracy
(%) (↑)Micro-F1
(↑)Macro-F1
(↑)RMSE
(100 secs) (↓)LL
(↑)
Task Predict the Next Event
only
Meteo.
Info.N-Neighb 41.45 0.557 0.383 - -
LightGBM 38.99 0.441 0.319 - -
DNN 41.15 0.463 0.408 - -
w/o
Meteo.
Info.Naive-HP 44.45 0.324 0.286 6.61 -2.342
NHP 48.90 0.510 0.445 7.75 -2.171
SAHP 52.10 0.514 0.399 5.20 -2.465
ANHP 71.21 0.660 0.505 4.88 -1.650
with
Meteo.
Info.Naive-HP 31.87 0.355 0.155 13.67 -7.026
NHP 66.25 0.520 0.410 7.28 -2.142
SAHP 65.92 0.528 0.506 4.64 -1.789
ANHP 70.41 0.730 0.580 3.09 -0.572
ST-T377.61 0.847 0.780 2.30 0.038
Task Predict the Subsequent 5 Events
only
Meteo.
Info.N-Neighb 36.55 0.354 0.102 - -
LightGBM 28.29 0.273 0.134 - -
DNN 26.36 0.250 0.111 - -
w/o
Meteo.
Info.Naive-HP 28.15 0.293 0.166 16.28 -8.692
NHP 38.85 0.319 0.184 9.65 -6.092
SAHP 32.88 0.281 0.209 6.65 -6.131
ANHP 44.27 0.373 0.261 6.91 -6.142
with
Meteo.
Info.Naive-HP 14.37 0.117 0.078 40.15 -10.942
NHP 44.60 0.436 0.310 14.47 -7.512
SAHP 56.11 0.556 0.445 6.40 -3.872
ANHP 55.34 0.646 0.558 5.15 -2.876
ST-T366.80 0.707 0.625 3.52 -1.752
Compared to the data from the Fengxian District, the data from
Downtown is more abundant and considerably messier. This dis-
crepancy has led to the observation of two distinct phenomena: On
one hand, when it comes to the types of events, the urban data is
more intricate. The patterns in which these events occur are harder
to discern, making it challenging to predict the nature of these
events. On the other hand, the sheer volume and complexity of
the data offer more precise information for modeling the Hawkes
process. As a result, timing predictions are more accurate, and the
fit for the conditional intensity function is notably improved.
B RELATED WORKS
B.1 Temporal Point Processes
The foundational model for representing event streams in various
domains, from natural phenomena to social media analytics, is the
Poisson process. This process, rooted in the work of Palm [ 42],
assumes the independence of events, making it a cornerstone in
statistical modeling of random events. The Hawkes process, a sig-
nificant advancement in this field, introduces a crucial aspect of
temporal correlation between events [ 21,33]. Unlike the Poisson
process, the Hawkes model acknowledges that past events can in-
fluence the likelihood of future events. This is characterized by a
framework of positive excitation, where each event not only con-
tributes additively to future occurrences but also sees its influence
exponentially decay over time.
In the realm of machine learning and computational statistics,
recent years have witnessed the emergence of a rich variety of
RNN-based Temporal Point Processes (TPPs) [ 12,38,41,54]. These
processes have revolutionized the way we model time-sequential
6046Weather Knows What Will Occur: Urban Public Nuisance Events Prediction and Control with Meteorological Assistance KDD ’24, August 25–29, 2024, Barcelona, Spain
Event OverviewPast 24 HoursRecent 1 HourFuture 24 HoursEvent Word Cloud
Occurrences PredictionPredictionsGround-TruthEvent Risk
Meteorological ImpactPrecipitationTemperatureWind SpeedCategory ChangesCategories
DistrictsPredictionsChangesYear-on-year
Month-on-monthHistorical Max
Event GraphCategories
Figure 9: Screenshot of the management system of Prophet System. ST-T3has been integrated Prophet System. The part inside
the green box shows the comparison between the predicted event counts (bar chart) and the actual values (line chart) based on
ST-T3for event number prediction. It is worth noting that the information in this system was originally presented in Chinese as
it serves the city of Shanghai, China. For the sake of reader understanding and presentation purposes, we manually translated
certain necessary and valuable information into English.
6047KDD ’24, August 25–29, 2024, Barcelona, Spain Yi Xie et al.
data, particularly in applications such as financial market analy-
sis and social network dynamics. Expanding upon the traditional
Hawkes process, Mei et al. [ 37] introduced the Neural Hawkes
Process (NHP). This model innovatively utilizes a recurrent neural
network (RNN) to dynamically determine event intensities from the
hidden state. The NHP approach, akin to a deterministic finite-state
automaton, elegantly encapsulates the past history as a quantifiable
and deterministic function, offering a nuanced understanding of
temporal patterns.
Despite its sophistication and continuous, infinite state space,
the NHP does encounter its set of challenges. Notably, it struggles
with capturing long-term dependencies within event streams, a
limitation stemming from the intrinsic weaknesses of RNNs such
as gradient vanishing or exploding. Additionally, training NHP
models poses significant computational challenges, often requiring
extensive data and computational resources.
To address these limitations, the Transformer Hawkes Process
(THP) [ 65] emerged as a groundbreaking development. Built upon
the principles of the Transformer architecture, known for its effec-
tiveness in natural language processing, the THP efficiently cap-
tures both short-term and long-term dependencies in event data. It
leverages self-attention modules, a key innovation that enables the
model to directly map dependencies among events by assigning con-
textually relevant attention scores. This mechanism is particularly
adept at capturing mutual excitation between events, providing a
more robust and nuanced understanding of event interactions.
Further augmenting this field, several studies have incorporated
the Transformer architecture to enhance predictive performance
[56,60]. These advancements have not only broadened our under-
standing of temporal point processes but have also opened new
avenues for real-world applications, such as predictive maintenance
in industrial settings, epidemiological modeling in public health,
and more sophisticated algorithms in the financial sector.
B.2 Urban Anomaly Events Analysis
Numerous studies have delved into the forecasting of urban anom-
alies, highlighting the critical role of early detection and the im-
plementation of preemptive strategies. This area of research, thor-
oughly examined in a comprehensive review [ 59], aims to empower
individuals to make informed decisions, mitigate risks, enhance the
efficiency of resource distribution, and improve the effectiveness
of responses. The pursuit of creating more accurate and depend-
able models and algorithms for anomaly prediction has ignited
considerable interest within the scientific community [34].
The significance of predicting urban anomalies is particularly
pronounced in city environments, where the intricacies of urban
landscapes and human activities pose distinct challenges [ 15,44].
Cities, as centers of human enterprise, are susceptible to various
anomalies that can severely affect the safety and well-being of
individuals and communities. These anomalies have the potential
to disrupt the economy, traffic flow, and public services extensively.
Therefore, the precise forecasting of urban anomalies is crucial for
city management, public safety, and disaster preparedness efforts
[36].
Researchers often concentrate on particular anomaly types to
better comprehend and anticipate their occurrence. For example,crime prediction models are designed to estimate the probability
of criminal activities in specified locations and times, aiding law
enforcement in optimizing patrols and distributing resources effec-
tively [ 23,27,32,61]. Similarly, traffic accident prediction models
identify likely accident hotspots to enhance road safety and alleviate
congestion [ 18,19,40]. Fire risk prediction aids fire departments in
allocating resources to areas at greater risk, while models predicting
unexpected mass gatherings assist in planning and implementing
measures to address safety risks and manage traffic during such
events [3].
Moreover, disease outbreak prediction models focus on forecast-
ing the emergence and spread of diseases in particular regions,
enabling public health authorities to proactively allocate resources,
and enact preventative and control strategies to curb disease trans-
mission and its impacts [ 2,7,16,31,47]. Predictions about crowd
events aim at foreseeing large-scale gatherings or social distur-
bances, facilitating the preparation of government and public safety
bodies to maintain order and safeguard public security [14, 58].
C APPLICATIONS
Our proposed method has been implemented for Shanghai govern-
mental usage. Specifically, it has been applied in "Xianzhi" (Prophet)
system, which is a meteorology-centered multi-functional system
of smart cities.
D DATA PRE-PROCESSING
We outline the transformation process of the raw data to fit our
model, which might help us to understand the data that to be
released. The procedure involves several steps:
•Timestamp transformation: Each event’s timestamp is
adjusted relative to the initial event, with seconds elapsed
then scaled by 0.01.
•Meteorological indicator normalization: meteorological
indicators are standardized to manage diverse value ranges
for compatibility.
•Linear interpolation for meteorological data: To align
with hourly meteorological data updates, linear interpolation
ensures more precise indicator values per event.
•Integration of event information: Transformed times-
tamps, location (town), and normalized meteorological indi-
cators are integrated into an "event record". Together, they
form the "event stream", our model’s input.
E PRIVACY DESENSITIZATION AND DATA
AVAILABILITY
We release data spanning from January 2019 to December 2021 in
Fengxian District except for during Covid-19 epidemic. To address
privacy considerations, we anonymize the data by:
•Timings: We convert specific absolute time information
into relative timestamps. Hence, our data uses timestamps
relative to the first event rather than real timestamps.
•Locations: Instead of providing specific longitude and lati-
tude, we present the index value of the event’s town. Con-
currently, we include the towns’ adjacency relationships to
model the spatial agglomeration effect.
6048