Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity
Juren Li∗
jrlee@zju.edu.cn
Zhejiang University
Hangzhou, ChinaFanzhe Fu∗
ffanz@zju.edu.cn
Zhejiang University
Hangzhou, ChinaRan Wei
ranwei@diagens.com
Hangzhou Diagens Biotechnology
Co., Ltd.
Hangzhou, China
Yifei Sun
yifeisun@zju.edu.cn
Zhejiang University
Hangzhou, ChinaZeyu Lai
jerrylai@zju.edu.cn
Zhejiang University
Hangzhou, ChinaNing Song
ningsong@diagens.com
Hangzhou Diagens Biotechnology
Co., Ltd.
Hangzhou, China
Xin Chen
xin.21@intl.zju.edu.cn
Zhejiang University
Hangzhou, ChinaYang Yang†
yangy@zju.edu.cn
Zhejiang University
Hangzhou, China
ABSTRACT
Pathogenic chromosome abnormalities are very common among
the general population. While numerical chromosome abnormali-
ties can be quickly and precisely detected, structural chromosome
abnormalities are far more complex and typically require consider-
able efforts by human experts for identification. This paper focuses
on investigating the modeling of chromosome features and the
identification of chromosomes with structural abnormalities. Most
existing data-driven methods concentrate on a single chromosome
and consider each chromosome independently, overlooking the cru-
cial aspect of homologous chromosomes. In normal cases, homolo-
gous chromosomes share identical structures, with the exception
that one of them is abnormal. Therefore, we propose an adaptive
method to align homologous chromosomes and diagnose struc-
tural abnormalities through homologous similarity. Inspired by the
process of human expert diagnosis, we incorporate information
from multiple pairs of homologous chromosomes simultaneously,
aiming to reduce noise disturbance and improve prediction perfor-
mance. Extensive experiments on real-world datasets validate the
effectiveness of our model compared to baselines.
∗Both authors contributed equally to this research.
†Corresponding author.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
KDD ’24, August 25–29, 2024, Barcelona, Spain
©2024 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3671642CCS CONCEPTS
•Applied computing →Life and medical sciences; Bioinfor-
matics.
KEYWORDS
Chromosome modeling, Homologous Similarity, Chromosome Struc-
tural Abnormality, Deep Neural Networks
ACM Reference Format:
Juren Li, Fanzhe Fu, Ran Wei, Yifei Sun, Zeyu Lai, Ning Song, Xin Chen,
and Yang Yang. 2024. Chromosomal Structural Abnormality Diagnosis by
Homologous Similarity. In Proceedings of the 30th ACM SIGKDD Conference
on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024,
Barcelona, Spain. ACM, New York, NY, USA, 12 pages. https://doi.org/10.
1145/3637528.3671642
1 INTRODUCTION
chromosomal abnormalities, which include missing, extra, or ir-
regular portions of chromosomal DNA [ 25], are the root cause of
various genetic and hereditary diseases. It is estimated that 6 of ev-
ery 1,000 newborns have chromosomal abnormalities, which often
result in dysmorphism, malformations, and developmental disabil-
ities [52]. These chromosomal changes caused by abnormalities
lead to serious consequences, e.g. 25% of all miscarriages and still-
births, and 50%–60% of first-trimester miscarriages [ 19]. With the
help of chromosomal abnormality detection, clinicians can identify
more abnormalities that may result in birth defects and take fur-
ther preventive measures, which is of great significance to people’s
livelihood and social development.
There are two types of chromosomal abnormalities: numerical
abnormality andstructural abnormality [11]. Numerical abnormal-
ities involve the absence or addition of entire chromosomes [ 14].
For example, an extra copy of chromosome 21 will cause Down
syndrome. Structural abnormality refers to the deletion, excess, in-
version, or translocation of a certain segment of one chromosome to
5317
KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
Figure 1: The homologous chromosomes with structural ab-
normality. (a) shows corresponding healthy region where
structural abnormality occurred on (b). As for (c) and (d) are
the data preprocessing we applied. (e) and (f) are the embed-
ding of (c) and (d) by CMSBlock from HomNet model.
another chromosome [ 3]. For example, a partial deletion of chromo-
some 4 causes Wolf–Hirschhorn syndrome. Numerical abnormalities
can be easily detected by assessing the quantity of chromosomes.
However, structural abnormalities are more challenging as they are
associated with chromosome mutation1[58], which makes it im-
possible to diagnose simply by the number of chromosomes as the
numerical abnormality. The detection of structural abnormalities
demands the expertise of professionals well-versed in karyotype2
analysis. Besides, to enhance the accuracy of diagnosing, clinicians
typically need to analyze chromosomes from more than 10 cells for
one patient. Given that there are 46 chromosomes in each human
cell [ 15], experts are required to visually inspect over 460 chromo-
some diagrams from the karyotypes. Admittedly, this inspection
process is time-consuming, labor-intensive, and therefore expen-
sive. Thus, we propose to design a deep learning-based model to
automatically diagnose chromosomal structural abnormalities, aim-
ing to expedite diagnosis, assist rapid decision-making, and reduce
manual labor for clinicians, ultimately improving efficiency and
accuracy in patient care.
Despite the superior performance achieved by deep learning in
various applications, challenges persist in detecting chromosomal
structural abnormalities. The first challenge arises from the diverse
morphology of chromosomes. Structural abnormalities can occur
on any of the 46 chromosomes, each with its own unique morphol-
ogy, that is, different chromosomes may have different diagrams.
Even within the same chromosome, variations exist due to their
1Chromosome mutation means a change in a chromosomal segment, involving more
than one gene [43].
2Karyotype is the overall visual representation of the entire set of chromosomes within
the cells of an individual organism, including information about their sizes, quantities,
and shapes [26].origins from different cells, potentially at different cell cycle [ 16], re-
sulting in differing morphologies. Thus, it is necessary to design of a
method capable of detecting chromosomal structural abnormalities
across various chromosomal morphologies. The second challenge is
the label imbalance. Compared to normal chromosomes, those with
structural abnormalities are relatively rare. Indeed, in our data, less
than 4% of the chromosomes have structural abnormalities. While
the imbalance problem has been addressed in many fields [ 28], to
the best of our knowledge, it has not been well studied in the con-
text of detecting chromosomal structural abnormalities. The third
challenge lies in the inconsistent data distribution. Chromosomes
obtained from different hospitals may exhibit variations in their
chromosomal diagrams due to differences in equipment and en-
vironmental conditions. Additionally, the distribution of type of
structural abnormalities varies from hospital to hospital, resulting
in a different distribution of data from different hospitals. These
factors make the data distribution of chromosomes inconsistent
and make it challenging to diagnose the structural abnormalities.
To address the aforementioned challenges, we propose a domain
knowledge based framework, HomNet , to model chromosomes and
then diagnose structural abnormalities. To tackle the first challenge,
we aim to capture common characteristics of structural abnormali-
ties across chromosomes with varying morphologies. For a pair of
homologous chromosomes3, their diagrams exhibit high similarity,
since they share the same chromosome type and in the same cell.
However, when a pair of homologous chromosomes has a struc-
tural abnormality, their diagrams typically manifest differences in
the region where the abnormality occurs, as illustrated in Figure 1.
Therefore, we propose to diagnose structural abnormalities by cap-
turing the differences between homologous chromosomes based on
the homologous similarity. Addressing the label imbalance problem,
where there are only a few abnormal samples, we utilize a large
number of normal chromosomes from healthy individuals to con-
struct artificial structural abnormalities based on the occurrence of
real-world structural abnormalities. Then, a self-supervised task is
designed to train the HomNet to detect pairs of homologous chro-
mosomes with artificial structural abnormalities, enabling HomNet
to diagnose structural anomalies using homology similarity. To
mitigate the problem of inconsistent data distribution across differ-
ent hospitals, we employ pre-training strategy with self-supervised
tasks to pre-train HomNet and then fine-tune it on different hospital
datasets. Fine-tuning enables the model to adapt to different data
distributions. Thus, the problem of inconsistent distribution can be
overcome. In addition, we collected data of 61350 chromosomes di-
agrams from 102 real-world patients with structural abnormalities
and data of 458876 chromosomes diagrams from 1581 real-world
healthy people. The data is anonymized to protect the privacy. The
ample number of chromosome data from healthy people enables
HomNet to capture common characteristics of chromosomes and
develop the capability to diagnose structural abnormalities.
HomNet integrates an end-to-end pipeline with AutoVision [ 54],
an AI analysis system for karyotypes. And it has undergone multi-
center clinical trials in three Grade A tertiary hospitals in China.
3Homologous chromosomes refer to a pair of chromosomes in a biological organism’s
cell that share similar gene sequences and structural features. Typically, one chromo-
some in the pair is inherited from the father, while the other is inherited from the
mother. [7]
5318Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity KDD ’24, August 25–29, 2024, Barcelona, Spain
Figure 2: The chromosomal sequences are the gray mean
sequences of the left and right parts of the chromosome
diagram.
Overall, the contribution of this article can be summarized as fol-
lows:
•To the best of our knowledge, we are the first to study data-driven
methods for identifying chromosomal structural abnormalities.
•Inspired by domain knowledge, we introduce HomNet , designed
to diagnose chromosomal structural abnormalities through ho-
mologous similarity.
•We propose a self-supervised learning strategy to train Hom-
Net, enabling it to capture chromosome features and address the
challenge of inconsistent distribution across different hospitals.
•We conduct extensive experiments on real-world dataset involv-
ing multiple chromosomes with structural abnormalities. Our
results validate the effectiveness of HomNet on chromosomal
structural abnormality diagnosis.
2 PRELIMINARIES
To clearly illustrate our work, this section first introduces the
dataset and the preprocessing steps. Detailed and formal defini-
tions of the dataset and the problem formulation will be provided
in this section.
2.1 Dataset and Preprocessing
Each chromosome data in the dataset contains two sequences sam-
pled from the chromosome diagram. As shown in Figure 1 (a) and
(b), the chromosome diagrams indicate a unidirectional flow of in-
formation, suggesting that the information density aligns with the
chromosome’s direction. Typically, image data exhibits information
density along two perpendicular directions. Therefore, we propose
converting the original data into chromosomal sequences for our
dataset.
As shown in Figure 2, the chromosomal sequences represent the
gray mean sequences derived from the left and right parts of the
corresponding chromosome diagram. In a chromosome diagram,
sister chromatids cross over the left and right sides of the chromo-
some. A sister chromatid refers to the identical copies (chromatids)
formed by the DNA replication of a chromosome [ 41]. In theory,
both of them would look the same in chromosome diagram. How-
ever, the left and right sides of the chromosome diagram are not
completely symmetrical due to the bending of the chromosome and
uneven staining of stains. Thus, we need to sample both the left and
right sequences. For convenience, we use the term“chromosome”
to represent the sampled chromosomal sequence.In addition to data from diagrams, the corresponding chromo-
some type and band level4can be obtained. Human beings have
22 pairs of autosomes (common to both men and women) and 1
pair of sex chromosomes (XX for women, XY for men), resulting in
24 types of chromosomes. Different cells may be in different cell
cycles [ 1], which makes their chromosomes different in shape. In
other words, the same chromosomes in different cells may have
different band levels. We collected chromosomal data from four hos-
pitals, denoted as Hos#1 ,Hos#2 ,Hos#3 andHos#4 to meet privacy
and data security requirements. The respective patient counts for
these hospitals are 24, 27, 30, and 21. For each patient, we gathered
multiple chromosomes from different cells, including both normal
and abnormal chromosomes. Each patient exhibited only one type
of chromosomal structural abnormality. After excluding unidentifi-
able chromosomes due to mutual occlusion between chromosomes
and excessive bending, each hospital’s dataset contained 14196,
14840, 16920, and 13496 pairs of normal homologous chromosomes,
along with 428, 457, 590, and 378 pairs of homologous chromosomes
with structural abnormalities. The proportion of abnormal chro-
mosomes in each dataset was less than 4%. Additionally, we also
collected chromosomal data from 1581 healthy individuals at Hos#1 ,
resulting in a total of 458876 pairs of homologous chromosomes.
The subsequent table provides breakdown of patient samples
across each hospital:
Table 1: Hospital Sample Data
Hospital Patient Normal sample Abnormal sample
Hos#1 24 14196 428
Hos#2 27 14840 457
Hos#3 30 16920 590
Hos#4 21 13496 378
2.2 Problem definition
Inspired by the diagnostic process of human experts, we find that
considering the information of multiple-pairs homologous chro-
mosomes at the same time can make the judgment more reliable.
This also reduces the noise disturbance of considering only one
pair of homologous chromosomes. Thus we combine multi-pair
homologous chromosomes to form a bag, denoted by 𝑋.
Each homologous chromosome in 𝑋is denoted by 𝐻𝑖.
Then we get 𝑋={𝐻1,𝐻2,...,𝐻𝑚}, where𝑚is the number of
homologous pairs. All the homologous chromosomes 𝐻𝑖∈𝑋are
from different cells of the same patient, and their chromosome type
are the same, denoted by 𝑐.𝑐is one-hot vector with the length of 24.
As mentioned above, the band levels of chromosomes of cells may
be different. In the dataset, band level is denoted by 𝑏, a one-hot
vector with the length of 4. Because there are four types of band
level in our dataset: 300, 400, 550 and 700, which also covers most
of the common band types. Each 𝐻𝑖consists of two chromosomes,
where homologous chromosome 1 and 2 are denoted by 𝐻𝑖,1∈R2×𝑑
and𝐻𝑖,2∈R2×𝑑, respectively. 𝑑is the length.
4The bands on chromosomes correspond to distinct segments of the DNA molecule,
and the band level is determined by the number of bands in a set of distinct chromo-
somes [16].
5319KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
The chromosomal structural abnormalities detection task is:
given a query tuple (𝑋,𝑐,𝑏)containing the chromosomes bag 𝑋
and the corresponding information (chromosome type 𝑐and band
level𝑏), determining whether this query tuple (𝑋,𝑐,𝑏)is from chro-
mosomes with structural abnormalities.
3 METHODOLOGY
In this section, we introduce the proposed model HomNet for di-
agnosing chromosomal structural abnormalities by homologous
similarity.
3.1 Overview
The framework of HomNet is depicted in Figure 3, comprising three
main components: 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 ,𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 , and𝐵𝑎𝑔𝐵𝑙𝑜𝑐𝑘 . To cap-
ture common characteristics of structural abnormalities across chro-
mosomes with varying morphologies, we design HomNet based on
homologous similarity. We generate five types of artificial abnormal
chromosome sequences as negative samples based on real-world
structural abnormalities. Subsequently, we devise a self-supervised
training strategy to utilize the chromosomes of healthy individ-
uals and the artificially generated chromosomes. To address the
data inconsistent distribution problem across different hospitals,
we propose fine-tuning the model for each specific hospital. For
each query tuple(𝑋,𝑐,𝑏),𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 extracts the distinguishable
features𝑅′′
𝑖,𝑗from each chromosome in 𝑋, where𝑗∈1,2. Subse-
quently,𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 aligns each pair of homologous chromosomes
and captures the differences between them based on homologous
similarity, denoted as 𝐻′
𝑖. Finally,𝐵𝑎𝑔𝐵𝑙𝑜𝑐𝑘 considers all the 𝐻′
𝑖to
diagnose the structural abnormalities.
More specifically, 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 first captures the features of the
chromosomes. During this process, 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 utilizes prior infor-
mation band level 𝑏and chromosome type 𝑐to help HomNet to
extract the features. Generally, there is at most one chromosome
with structural abnormality in any pair of homologous chromo-
somes. Thus, we propose to detect the chromosomal structural
abnormalities by homologous similarity. However, it is challenging
to capture the differences since the shape of each chromosome
varies and the diagram of chromosome pair may be flipped over, i.e.,
they are not perfectly aligned. To align each part, 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 uses an
inter-attention based strategy to capture the difference 𝐻′
𝑖between
the representations 𝐻′
𝑖,1and𝐻′
𝑖,2of homologous chromosome 1 and
2. As mentioned above, in order to reduce noise disturbance and
increase judgment reliability, HomNet considers multiple pairs of
homologous chromosomes simultaneously in 𝐵𝑎𝑔𝐵𝑙𝑜𝑐𝑘 . After get-
ting all the difference representation (𝐻′
1,𝐻′
2,...,𝐻′𝑚)of the Bag𝑋,
𝐵𝑎𝑔𝐵𝑙𝑜𝑐𝑘 makes a prediction ˆ𝑌according to these representations.
3.2 Self-supervised Learning with Artificial
Abnormalities
Due to the significant imbalance between the number of chromo-
somes with structural abnormalities and those without, it becomes
challenging to identify distinctive features for abnormality detec-
tion [ 27]. On the bright side, we possess a substantial amount of
chromosome data from healthy individuals. Leveraging this dataalongside artificially generated structural abnormalities, we pre-
train the model. To simulate various types of structural abnor-
malities observed in real-world scenarios, we create five types of
artificial chromosomes with structural abnormalities, as detailed in
the Appendix. Our self-supervised learning task involves classify-
ing normal and artificial abnormal chromosome pairs to capture
diverse structural abnormality manifestations. To prevent HomNet
from solely relying on the presence of artificial data when assess-
ing abnormal chromosome pairs, we also incorporate chromosome
pairs from various types as abnormal samples. Given the length
discrepancies among different chromosome types, we categorize
the chromosomes into seven groups based on their length [ 35],
ensuring each group of chromosomes is similar in length. Conse-
quently, we exclusively form abnormal chromosome pairs using
chromosomes from the same group within a cell. This approach
enables our model to capture chromosome features and understand
fundamental structural abnormality characteristics. Subsequently,
we fine-tune the model using chromosomes from different hospitals.
3.3 Modeling the Feature of Chromosomes
Before capturing the differences between homologous chromo-
somes, we model features of chromosomes. Each chromosome,
𝐻𝑖,𝑗, is from a chromosome diagram with or without structural
abnormality. We propose 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 to extract the features of each
chromosome. As Figure 3 shows, the 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 first merges two
sequences into one, and get 𝐻𝑚𝑔
𝑖,𝑗. Then,𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 utilizes𝐻𝑚𝑔
𝑖,𝑗,
band type𝑏and chromosome type 𝑐to obtain the chromosomal
representation 𝑅′′
𝑖,𝑗.
Merge two chromosome sequences. The chromosome data
we obtain consists of two sequences: 𝐻𝑖,𝑗∈R2×𝑑. As previously
mentioned, these sequences represent the mean sequences of the
left and right portions of the chromosome diagrams, respectively.
Given the partial differences between the left and right sequences
within𝐻𝑖,𝑗, both containing crucial chromosome information, a
simple merging approach using average, maximum, or minimum
values would result in substantial information loss. Therefore, we
opt to merge these sequences using a learnable method. Specifically,
we employ a convolution operation, and get the representation
𝐻𝑚𝑔
𝑖,𝑗.
𝐻𝑚𝑔
𝑖,𝑗=𝐶𝑜𝑛𝑣(𝐻𝑖,𝑗) (1)
Model the feature of regions. Subsequently, 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 extracts
the features of each chromosome, obtaining the feature representa-
tion𝑅′′
𝑖,𝑗. As depicted in Figure 2, the chromosome diagram displays
multiple grayscale bands along the chromosomes, which are re-
ferred to as regions [ 35]. When a structural abnormality occurs,
the region where the abnormality happens will correspondingly
change. For instance, in the case of a chromosomal deletion [ 35],
the corresponding region will also be missing. Therefore, HomNet
detects structural abnormalities by analyzing the differences in
regions between homologous chromosomes. Therefore, we divide
𝐻𝑚𝑔
𝑖,𝑗into multiple subsequences, each representing a region of the
chromosome. Additionally, leveraging the prior knowledge that
chromosome types and band levels can aid in modeling the chro-
mosomes, we fuse the feature of chromosome type 𝑐and band level
5320Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity KDD ’24, August 25–29, 2024, Barcelona, Spain
Figure 3: The framework of HomNet . The arrow heads refer to the dataflow of a pair of homologous chromosomes.
𝑏𝑖into each subsequence.
𝑅𝑖,𝑗=𝐷𝑖𝑣(𝑊𝑖𝑛𝑓𝑜(𝑐⊕𝑏𝑖))+𝐷𝑖𝑣(𝐻𝑚𝑔
𝑖,𝑗) (2)
where⊕denotes the concatenation operation and 𝐷𝑖𝑣represents
the segmentation operation. For 𝐻𝑚𝑔
𝑖,𝑗, the𝐷𝑖𝑣operation is carried
out as per Eq 1, using convolution with a kernel size of (2,𝑘𝑚𝑔), a
stride of(2,𝑘𝑚𝑔), and with𝑙𝑟output channels. Consequently, the
output after the convolution produces a matrix where each row,
having a length of 𝑙𝑟, corresponds to a region of length 𝑘𝑚𝑔. As for
𝑊𝑖𝑛𝑓𝑜(𝑐⊕𝑏𝑖), the𝐷𝑖𝑣operation is implemented through reshaping,
where𝑊𝑖𝑛𝑓𝑜 denotes a learnable parameter matrix. Thus, the matrix
of regions representation 𝑅𝑖,𝑗∈R𝑛𝑟×𝑙𝑟, where𝑛𝑟represents the
number of regions depending on 𝑘𝑚𝑔and the length of 𝐻𝑖,𝑗.
For each region representation in 𝑅𝑖,𝑗, we use the same method to
extract similar texture features, which is also called weight sharing:
𝑅′
𝑖,𝑗=𝜎(𝑅𝑖,𝑗𝑊𝑅1)𝑊𝑅2+𝑅𝑖,𝑗 (3)
where𝑊𝑅1and𝑊𝑅2are learnable parameter matrices. Eq 3 extracts
the features of each chromosome region, also referred to as local
features.
However, there are also some types of structural abnormalities
where a region of a chromosome can be found in a similar region
of another normal chromosome. For example, in chromosome du-
plication abnormality [ 34], the duplicated region originates from
a part of the normal chromosomes. Consequently, HomNet may
struggle to capture the differences between homologous chromo-
somes, as their corresponding regions are similar. Despite this, a
particular structural abnormality, the Robertsonian translocation,
indicates that an entire chromosome has attached to another [ 56].
This results in data with this structural abnormality exhibiting
more texture features due to the addition of another chromosome.
Thus, capturing the global features of the chromosome will help
the model better detect such abnormalities. By transposing 𝑅′
𝑖,𝑗,
𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 can capture the cross-region features, also referred to
as global features.
𝑅′′
𝑖,𝑗=(𝜎(𝑅′
𝑖,𝑗𝑇𝑊𝑅3)𝑊𝑅4)𝑇+𝑅′
𝑖,𝑗(4)After feature extraction, we obtain the segmented features repre-
sentation of chromosomes, 𝑅′′
𝑖,𝑗.
3.4 Capture the Differences between
Homologous Chromosomes
Based on expert detection processes, HomNet diagnoses structural
abnormalities through homologous similarity. As depicted in Fig-
ure 1, diagrams of homologous chromosome pairs with structural
abnormalities differ, while those of normal homologous chromo-
somes are similar. However, most existing anomaly detection meth-
ods concentrate on individual objects and do not leverage the dis-
tinctions between homologous chromosomes with structural abnor-
malities. Therefore, we introduce 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 to capture the differ-
ences between homologous chromosomes, based on their feature
representations, 𝑅′′
𝑖,1and𝑅′′
𝑖,2.
Adaptive region alignment in homologous pairs. As men-
tioned above, obtaining the difference of homologous chromosomes
involves comparing the distinctions between the feature represen-
tations of corresponding regions in a pair of homologous chromo-
somes. However, due to the free oscillation of chromosomes in
cells, and potential inversion of chromosome diagrams, the rep-
resentations 𝑅′′
𝑖,1and𝑅′′
𝑖,2, which encode chromosomal structural
information, are not well aligned. Mere subtraction or stacking of
these representations without proper alignment introduces bias.
Therefore,𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 employs an adaptive alignment method to
capture homologous differences by aligning each region between
homologous chromosomes. 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 adaptively aligns each row
of𝑅′′
𝑖,1with each row of 𝑅′′
𝑖,2. Here,𝑟𝑒
𝑖,𝑗represents the 𝑒𝑡ℎrow of
𝑅′′
𝑖,𝑗and also the 𝑒𝑡ℎregion in the chromosome.
𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 initially computes the similarity between correspond-
ing regions. For instance, considering the 𝑒𝑡ℎregion of homologous
chromosome 1, 𝑟𝑒
𝑖,1, we calculate the similarity between all regions
of homologous chromosome 2. Subsequently, we utilize the similar-
ity score as the alignment coefficient, allowing 𝑟𝑒
𝑖,1to focus more on
regions with high similarity. This process can be achieved through
5321KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
an attention mechanism.
𝑎𝑒,𝑧
𝑖,1=(𝑊𝑞𝑟𝑒
𝑖,1)·(𝑊𝑘𝑟𝑧
𝑖,2)/√︁
𝑑𝑎 (5)
Capture the differences in each region. Eq 5 denotes the sim-
ilarity between the 𝑒𝑡ℎregion of homologous chromosome 1 and
the𝑧𝑡ℎregion of homologous chromosome 2. Here, 𝑑𝑎denotes
the dimension of(𝑊𝑞𝑟𝑒
𝑖,1)and(𝑊𝑘𝑟𝑧
𝑖,2). Once the similarity score
is obtained, 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 adaptively aligns the regions based on the
similarity score. This alignment process allows the capture of differ-
ences between regions, providing crucial information for HomNet
to detect structural abnormalities.
˜𝑟𝑒
𝑖,1=Í𝑛𝑟
𝑧=1𝑎𝑒,𝑧
𝑖,1(𝑊𝑣𝑟𝑧
𝑖,2)
Í𝑛𝑟
𝑧=1𝑎𝑒,𝑧
𝑖,1(6)
˜𝑟𝑒
𝑖,1represents the aligned result of the 𝑒𝑡ℎregion in homologous
chromosome 1. Subsequently, 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 captures the difference
between𝑟𝑒
𝑖,1and the aligned result ˜𝑟𝑒
𝑖,1. In our approach, we employ
a multi-headed attention mechanism for alignment Specifically, ˜𝑟𝑒,1
𝑖,1
and ˜𝑟𝑒,2
𝑖,1denote the alignment results from the first and second at-
tention heads, respectively. Thus, the differences between extracted
regions can be expressed as:
ˆ𝑟𝑒
𝑖,1=𝑊𝑑𝑖𝑓𝑓(𝑟𝑒
𝑖,1+𝑊ℎ𝑒𝑎𝑑(˜𝑟𝑒,1
𝑖,1⊕˜𝑟𝑒,2
𝑖,1⊕···⊕ ˜𝑟𝑒,𝑛ℎ
𝑖,1)) (7)
where𝑛ℎis the number of heads. ˆ𝑟𝑒
𝑖,1represents the difference fea-
ture representation of the 𝑒𝑡ℎregion. The collection of all obtained
ˆ𝑟𝑒
𝑖,𝑗forms the difference matrices ˆ𝑅𝑖,𝑗. Consequently, we integrate
these difference features of the regions to obtain the difference
representation 𝐻′
𝑖of the homologous chromosome pair:
𝐻′
𝑖=𝜎(𝑊ℎ𝑜𝑚(𝐹𝑙𝑎𝑡(ˆ𝑅𝑖,1)⊕𝐹𝑙𝑎𝑡(ˆ𝑅𝑖,2))) (8)
where𝐹𝑙𝑎𝑡()is to flatten matrix to vector and 𝑊ℎ𝑜𝑚 is a learnable
parameter matrix.
Resolve data distribution inconsistency by multi-pair ho-
mologous chromosomes. As discussed in Section 2.1, the data
may be susceptible to noise disturbance. Relying solely on one
pair of homologous chromosomes could potentially lead to less
accurate predictions. Hence, we introduced 𝐵𝑎𝑔𝐵𝑙𝑜𝑐𝑘 to enable
a comprehensive prediction by incorporating data from multiple
pairs of homologous chromosomes. This approach draws inspira-
tion from the diagnostic process of human experts. Similar to how
human experts diagnose chromosomal structural abnormalities
by considering multiple chromosome diagrams, our method aims
to improve the reliability of diagnostic results. By simultaneously
integrating information from multiple pairs of homologous chro-
mosomes, HomNet not only enhances the reliability of detection
results but also mitigates the impact of noise disturbance. Structural
abnormalities in some chromosome diagrams are obvious, while
others may be obscure. This is why experts need to combine chro-
mosome information from multiple cells to make a diagnosis. In
this case, the contribution of the difference representation 𝐻𝑝𝑟𝑖𝑚𝑒
𝑖
to the identification of the structural abnormality varies. Simply
adding or concatenating them directly may not yield optimal results.
Therefore, we compute an aggregate weight 𝛼𝑖for the abnormal
representation 𝐻𝑝𝑟𝑖𝑚𝑒
𝑖. The abnormal representations 𝐻′
𝑖are then
summed based on the aggregate weight 𝛼𝑖, and HomNet makespredictions.
𝛼𝑖=𝑆𝑖𝑔𝑚𝑜𝑖𝑑(𝑀𝐿𝑃(𝐻′
𝑖)) (9)
ˆ𝑌=𝜎(𝑊𝑏𝑎𝑔(Σ𝑚
𝑖=1𝛼𝐻′
𝑖)) (10)
where𝑊𝑏𝑎𝑔are learnable parameter matrices and ˆ𝑌is the prediction
result. Ultimately, we employ cross-entropy loss as the objective
function to optimize HomNet .
L=𝐿𝐶𝐸(ˆ𝑌,𝑌) (11)
where𝑌is the ground truth.
4 EXPERIMENT
4.1 Experiment Setting
Datasets . As mentioned in Section 2.1, we use the dataset sampled
from healthy people for self-supervised learning. Additionally, we
also use the artificial samples with and without structural abnormal-
ities. After self-supervised training, we fine tune HomNet on each
dataset from patients with chromosomal structural abnormalities
from𝐻𝑜𝑠#1,𝐻𝑜𝑠#2,𝐻𝑜𝑠#3and𝐻𝑜𝑠#4. The number of homologous
chromosome pair in a bag is set as 5, that is, 𝑚is set as 5. Due to
the privacy and sensitivity of chromosome data with structural
abnormalities, almost all public datasets contain only normal chro-
mosomes. Therefore, we constructed artificial structural abnormal
chromosome data on the public chromosome dataset Pki-3 [ 44].
Experiments are also performed on this dataset for supplemen-
tal reference. More details about the dataset can be found in the
Appendix.
Baseline. We compare our proposed model, HomNet , with several
baseline models. Specifically, we initially compare our model with a
classical machine learning method: Logistic Regression (LR) based
on feature engineering. Additionally, we conduct experiments using
commonly employed unsupervised methods for anomaly detection,
including OC-SVM [ 51], Deep-SVDD [ 46], and an AutoEncoder (AE)
based method [ 61]. Furthermore, we compare our model with su-
pervised methods, such as MLP-Mixer [ 57], Vit [ 12], Xception [ 10],
ResNet [ 20], DensNet [ 23], and MobileNet [ 22]. In addition, we also
conduct an experiment with a recent contrastive learning-based
method for detecting structural anomalies [ 5]. This method employs
a Siamese architecture and allows for interchangeable backbone
models, hence it is abbreviated as “Siamese”.
Training. For the pre-training stage, we utilize normal samples
and samples with artificial abnormalities. During this stage, we
implement Adam as the optimizer, setting learning rate at 0.001
with a batch size of 512. A validation set, which does not overlap
with the training set, is also used to identify the optimal pre-trained
model. We then incorporate an early stopping mechanism to moni-
tor model convergence closely. Specifically, if there’s no observed
enhancements in the validation set over 10 consecutive epochs, the
training is discontinued. For the fine-tuning stage, we freeze the
parameters of CMSBlock and the first layer of HomBlock. This strat-
egy helps transfer learned knowledge from the pre-training stage.
The Adam optimizer, with a learning rate of 0.00001, is once again
used here. We also employ the same early stopping mechanism
here.
Evaluation metrics and implementation details. We evaluate
the prediction preformance of HomNet and baseline methods with
F1 score and AUC-ROC score, capturing both the precision-recall
5322Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity KDD ’24, August 25–29, 2024, Barcelona, Spain
balance and the model’s overall ranking ability across varying
decision thresholds. Besides, we use Adam [ 30] optimizer with
a learning rate of 0.001 for self-supervised learning and that of
0.00001 for fine-tuning, and the batch size is set as 512. During the
fine-tuning, we freeze the parameters of 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 and the first
difference extraction layer in 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 , namely the first attention
layer. More details on the baseline and experimental setup can be
found in the Appendix. The code is available at https://github.com/
zjunet/HomNet.
Table 2: Experimental results on four real-world hospital
datasets.
Metho
dHospital𝐻
𝑜𝑠#1𝐻𝑜𝑠#2𝐻𝑜𝑠#3𝐻𝑜𝑠#4
AUC F1 AUC F1 AUC F1 AUC F1
𝐿
𝑅 72.43 19.51 75.23 20.54 81.72 23.47 75.56 19.10
OC-SVM 49.8 11.0 47.9 9.23 65.6 13.97 17.38 17.38
𝐷𝑒𝑒𝑝−𝑆𝑉𝐷𝐷 46.91 10.28 59.31 12.56 64.83 14.67 51.13 13.01
𝐴𝐸 60.27 14.78 63.74 21.14 65.82 17.63 61.41 21.50
𝑀
𝐿𝑃−𝑀𝑖𝑥𝑒𝑟 90.76 50.02 92.83 56.27 85.24 39.49 91.20 41.65
𝑉𝑖𝑡 84.42 24.81 88.08 35.84 83.80 34.12 89.31 27.84
ResNet 86.84 24.26 85.09 26.72 80.98 32.37 90.0 34.09
Xception 89.38 39.62 88.95 40.15 79.39 23.0 94.24 40.08
MobileNet 86.08 28.32 86.57 35.29 80.57 28.97 88.78 34.37
DensNet 87.59 38.21 87.95 25.04 81.69 35.85 91.66 41.64
Siamese 58.73 12.84 58.74 12.85 49.2 11.6 70.97 12.22
𝐻
𝑜𝑚𝑁𝑒𝑡 91.64 52.91 95.73 66.30 91.64 52.65 98.25 66.32
Table 3: Experimental results on Pki-3 with artificial struc-
tural abnormalities.
Metho
d LR OC-SVM Deep-SVDD AE MLP-Mixer Vit
AUC 60.82 45.72 48.51 49.73 50.22 40.51
F1 53.79 49.38 37.59 15.66 43.53 51.89
Metho
d ResNet Xception MobileNet DensNet Siamese HomNet
AUC 51.68 48.88 70.31 50.58 74.09 75.71
F1 38.28 38.15 58.97 31.87 59.95 64.04
4.2 Performance Evaluation
We present the performance of all methods in chromosomal struc-
tural abnormalities detection across four hospital datasets in Table 2.
The results for 𝐻𝑜𝑠#4outperform those of other hospitals, while
the outcomes for 𝐻𝑜𝑠#1and𝐻𝑜𝑠#3are marginally less favorable.
The varying performances across different hospitals highlight the
inconsistency in the distribution of chromosome data, emphasizing
the need to individually fine-tune the data from each hospital based
on these experimental findings.
Overall, HomNet demonstrates superior performance across all
four hospitals. On the one hand, the manual feature-based logis-
tic regression method only exhibits limited capability in detecting
chromosomal structural abnormalities. On the other hand, the tradi-
tional anomaly detection method OC-SVM performs poorly, facingchallenges in detecting anomalies in high-dimensional data [ 62],
especially in the context of the 4×512dimension of homologous
chromosomes data. Similarly, the performance of the deep anomaly
detection models Deep-SVDD and the AE-based model lags behind
that of logistic regression, as they primarily capture characteristics
of normal chromosomes during training, without effectively lever-
aging the information from structural abnormalities. The Siamese
method, utilizing contrastive learning, fails to yield optimal results
as it does not incorporate a dedicated feature extraction backbone
network tailored to chromosome characteristics. In the case of the
MLP-Mixer network, which use the strategy of dividing patches re-
sembling chromosome regions, results in suboptimal performance
across most experiments. In contrast, HomNet leverages the homol-
ogous similarity of chromosomes for diagnosing structural abnor-
malities, while also effectively modeling the chromosome regions.
HomNet also considers information from multiple pairs of homolo-
gous chromosomes from multiple cells, thereby enabling it to obtain
more reliable diagnostic results. Therefore, it performs the best in
both AUC-ROC and F1 score.
The experimental results for all baseline methods and HomNet
on the public dataset Pik-3 with artificial structural abnormalities
are presented in Table 3. Once again, HomNet emerges as the top
performer. Notably, in comparison to experiments conducted on
datasets with real abnormalities, Siamese demonstrates improved
performance on Pik-3 and almost rivals HomNet . This discrepancy
may arise from a distribution shift between artificial and real struc-
tural abnormalities. This observation further emphasizes the impor-
tance of fine-tuning on datasets with real structural abnormalitis
after pre-training with artificial abnormalities.
Table 4: In-deep analysis on the difference of HomNet . The
“w/o Pair" indicates that only one chromosome is used, but
the bag strategy using chromosome data from multiple cells
is still used. The “w/o Bag" indicates that the bag strategy
is not used. “align →MLP" and “align→CNN" rows indicate
that we replace the alignment part of HomNet with MLP and
convolution neural networks. The last five rows changes the
#merge range in the 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 with difference length.
V
ariantHospital 𝐻
𝑜𝑠#1 𝐻𝑜𝑠#2 𝐻𝑜𝑠#3 𝐻𝑜𝑠#4
AUC F1 AUC F1 AUC F1 AUC F1
w/o
Pair 78.13 17.45 79.42 16.42 75.31 19.48 91.63 16.51
align→MLP
87.82 46.98 86.19 39.20 71.40 28.17 97.32 58.65
align→CNN 78.12 17.42 79.43 16.38 75.33 19.82 91.65 16.45
w/o
Bag 88.91 42.05 88.13 45.28 88.23 47.45 93.91 46.30
range#8
90.41 52.72 94.03 62.81 91.52 51.91 98.19 66.76
range#16 91.43 46.12 92.34 58.85 91.12 50.78 97.04 58.00
range#32 91.64 52.91 95.73 66.30 91.64 52.65 98.25 66.32
range#48 58.32 13.56 67.63 17.82 60.51 13.73 74.04 15.07
range#64 50.61 11.03 54.64 12.06 59.60 12.13 49.62 9.45
4.3 Ablation Study
HomNet utilizes the homologous similarity between aligned homol-
ogous chromosomes (Pair strategy) to diagnose structural abnormal-
ities. Additionally, HomNet considers multiple pairs of homologous
chromosome information (Bag strategy) to improve prediction reli-
ability and reduce noise disturbance, rather than just a single pair
5323KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
of homologous chromosomes. To investigate the impact of the Pair
strategy, Bag strategy and other part of HomNet on the performance,
we conduct ablation studies in this section.
Effect of homologous similarity of homologous chromo-
somes (Pair strategy) . Inspired by domain knowledge indicating
that homologous chromosomes with structural abnormalities differ
from each other, we designed HomNet to diagnose structural abnor-
malities by comparing the differences between a pair of homologous
chromosomes. To investigate whether comparing the differences
based on homologous similarity is effective, we detect structural
abnormalities using data from just a single chromosome in a ho-
mologous pair while retaining the Bag strategy, which involves
considering multiple chromosomes simultaneously. According to
the results shown in Table 4, without comparing homologous chro-
mosomes, the model’s performance decreased the most. Therefore,
comparing homologous chromosomes based on similarity is the
most crucial aspect of the model for detecting structural abnormal-
ities.
Effect of alignment . According to Table 2, the performance of
methods based on supervised learning is considerably worse than
that of HomNet . One of the main reasons is that they do not align
homologous chromosomes but directly extract features and then
make judgments. HomNet extracts the difference between regions
of homologous chromosomes using an adaptive alignment based on
attention mechanism. We compare the model with replacements for
attention using MLP and Convolutional Neural Networks (CNNs).
According to the result shown in Table 4 , in the absence of an
aligned model, the performance degradation is large and MLP out-
performs CNNs.
Effect of multiple pairs (Bag strategy) of homologous chro-
mosomes . When human experts diagnose chromosomes with
structural abnormalities, they observe information from multiple
pairs of homologous chromosomes to make more reliable judg-
ments. The proposed model HomNet also takes advantage of this
idea by considering information from multiple pairs of homologous
chromosomes simultaneously. To intuitively demonstrate the effec-
tiveness of multiple pairs, we use information from only one pair
of homologous chromosomes. According to the result shown in
Table 4 , it is important to utilize information from multiple pairs
of homologous chromosomes simultaneously.
The appropriate #merge range . As mentioned in Section 3, we
divide𝐻𝑚𝑔
𝑖,𝑗into multiple subsequences, each representing a region
of the chromosome with a length of #merge range . In order to ex-
plore the most appropriate #merge range , we conduct experiments
with various ranges . In HomNet , we set the #merge range to 32 . Ac-
cording to the result shown in Table 4 , When #merge range is too
small, such as 8 or 16, it may not be sufficient to cover a region, re-
sulting in a slight degradation in HomNet ’s performance. For 𝐻𝑜𝑠#4,
the F1 score of the HomNet improves by 0.44% when #merge range
is set as 8. However, it should be noted that the #merge range is one
quarter of the original HomNet , so the number of subsequences will
increase fourfold, requiring more training time and GPU memory
space. When #merge range is set too large, such as 48 or 64, they
may cover more than one region, causing information loss or com-
pression, and thus leading to a decrease in performance. Therefore,
when #merge range is too large, the performance decreases themost. Overall, an #merge range of 32 for the HomNet is the most
appropriate setting.
4.4 Running Time Comparison
We evaluated the running time of HomNet in comparison with other
models by testing the completion of 100 batches and measuring
the convergence time on the pre-training dataset. The following
results, presented in seconds, are obtained:
Method 100 batches Convergence
LR 0.08 3543
OC-SVM 41.16 23812
Deep-SVDD 11.72 5067
AE 16.51 11398
MLP-Mixer 1.62 1549
Vit 2.45 3832
Xception 9.33 9772
MobileNet 1.80 5948
DenseNet 13.49 10998
Siamese 18.18 10229
HomNet 5.39 2468
Table 5: Running Time Comparison
While HomNet is not the fastest, it requires a comparatively
lesser amount of time. And it is more time-efficient than Siamese,
another model for diagnosing chromosomal structural abnormali-
ties. For clinical diagnostic applications (as presented in Section 5),
HomNet is capable of diagnosing a patient in under 5 milliseconds,
which comfortably meets the basic speed requirements.
5 APPLICATION
For practical clinical diagnostic applications, HomNet integrates an
end-to-end pipeline with AutoVision [ 54], an AI analysis system
for karyotypes developed by Hangzhou Diagens Biotechnology Co.,
Ltd., China. To begin with, physicians upload their patients’ kary-
otypes to AutoVision, which has been enhanced with the integration
of HomNet. Subsequently, the enhanced AutoVision, now incorpo-
rating HomNet, optimizes and organizes the karyotypes, yielding
chromosome diagrams and band level identifications within an
impressive 3 seconds, as depicted in Figure Figure 4. The chromo-
some diagrams are then converted into sequence data, as detailed
in Section 2.1. This sequence data, along with the chromosome type
and band levels, serves as input for HomNet , which diagnoses the
presence of structural abnormalities. The final diagnosis results are
directly output to the physicians. Notably, HomNet can diagnose
chromosomal structural abnormalities using data from a single pa-
tient, encompassing 115 pairs of homologous chromosomes from
five cells, in less than 5 milliseconds.
AutoVision, integrated with HomNet , has undergone multicenter
clinical trials in three Grade A tertiary hospitals in East, Central,
and West China. Presently, 1518 cases have been enrolled, with
6NMPA is a national bureau responsible for drug supervision under the State Council
of China.
6The CE mark on a product indicates that the manufacturer or importer of that product
affirms its compliance with the relevant EU legislation.
5324Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity KDD ’24, August 25–29, 2024, Barcelona, Spain
Figure 4: AutoVision, equipped with HomNet , is an advanced
intelligent chromosome karyotype analysis system, which
registered in NMPA (National Medical Products Administra-
tion)5and obtained CE mark6.
499 sample analyses completed. Preliminary results demonstrate
that AutoVision exhibits 75% sensitivity7, 99% specificity8, and a
diagnostic accuracy of 98.4% in automated analysis, showcasing its
precision and efficiency in clinical applications. The product was
honored with the first prize in technological achievements by the
China Birth Defects Intervention Assistance Fund.
6 RELATED WORK
For clarity, we first review methods related to anomaly detection,
then introduce works about detecting chromosomes with structural
abnormalities.
Anomaly detection is an important topic in diverse research
fields and application domains [ 8,9,24]. Anomalies are also re-
ferred to as outliers , deviants or abnormalities [ 2]. Chromosomes
with structural abnormalities that are different from normal chromo-
somes can also be called anomalies. Traditional anomaly detection
methods include Principal Component Analysis (PCA) based meth-
ods [ 21,53], Nearest Neighbor (NN) based methods [ 6,31], and
the One-Class Support Vector Machine (OC-SVM) [ 51] that learns
a decision function for novelty detection, that is, classifying new
data as similar or different one to the training set. These methods
are unsupervised. Because in the anomaly detection setting, even
if abnormalities are available, it is usually insufficient to make a
supervised approach ffective [45].
7Sensitivity (true positive rate) is the probability of a positive test result, conditioned
on the individual truly being positive.
8Specificity (true negative rate) is the probability of a negative test result, conditioned
on the individual truly being negative.As deep learning [ 32] has made substantial progress in dealing
with many machine learning problems, some deep learning-based
anomaly detection methods have also been proposed. A substantial
amount of deep learning methods on anomaly detection choose
to use autoencoder (AE) and its variants [ 39,42]. Deep Support
Vector Data Description (Deep-SVDD) [ 46], a variant of one-class
neural network methods, trains a neural network and minimizes
the volume of a hypersphere that maps the normal instances closely
to the center of sphere. Besides, there are some other popular deep
one-class classification based approaches [ 13,37,47]. Method based
on one deep generative models [ 49,50,59] and self-supervised
methods [17, 55] are also applied in anomaly detection.
In recent years, some anomaly detection methods have been
applied in the medical field [ 29,48]. These methods employed state-
of-the-state techniques in anomaly detection and improved perfor-
mance compared to traditional methods. But only a few works focus
on chromosomal structural abnormality detection. [ 5] proposes to
use the method of contrastive learning to detect chromosomal struc-
tural abnormalities using Siamese network. Most of these methods
do not take advantage of the homologous similarity between ho-
mologous chromosomes.
7 CONCLUSION
In this paper, we study the problem of chromosomal structural
abnormalities diagnosis. Inspired by the homologous similarity of
chromosomes and the diagnostic process of doctors, we propose
a novel model, HomNet , to model features of chromosomes and
diagnose chromosomal structural abnormalities by homologous
similarity.
Central to our approach is the innovative utilization of multi-
ple homologous chromosome pairs: a strategy akin to how skilled
diagnosticians compare multiple diagrams for accuracy. HomNet
simultaneously considers the information of multiple pairs of ho-
mologous chromosomes and detects structural abnormalities by
capturing the differences between homologous chromosomes.
Additionally, we artificially construct chromosomal samples with
structural abnormalities according to different types of real-world
structural abnormalities. And self-supervised learning has been
adopted to enable HomNet to fully learn chromosomes with data of
normal chromosomes and artificial structural abnormalities. Then,
we fine-tune HomNet with data from different hospital to address
the challenge of inconsistent distribution.
Experimental results show that HomNet achieved significantly
better performance than other baselines on real-world dataset and
public datset with artificial abnormalities. In addition, ablation
studies further underscore the indispensability of each component
within HomNet , highlighting the synergistic effect of its carefully
crafted design.
ACKNOWLEDGMENTS
This work is supported by National Natural Science Foundation of
China (No. 62176233, No. 62441605) and SMP-IDATA Open Youth
Fund.
5325KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
REFERENCES
[1]Michael Abercrombie, Clarence James Hickman, and Minnie L Johnson. 2017. A
dictionary of biology. Routledge.
[2]Charu C Aggarwal. 2017. An introduction to outlier analysis. In Outlier analysis.
Springer, 1–34.
[3]Genetic Alliance, New York-Mid-Atlantic Consortium for Genetic, New-
born Screening Services, et al .2009. Understanding genetics: a New York, mid-
Atlantic guide for patients and health professionals. (2009).
[4]Nilesh K Banavali. 2013. Partial base flipping is sufficient for strand slippage near
DNA duplex termini. Journal of the American Chemical Society 135, 22 (2013),
8274–8282.
[5]Mohammed El Amine Bechar, Jean-Marie Guyader, Marwa El Bouz, Nathalie
Douet-Guilbert, Ayman Al Falou, and Marie-Bérengère Troadec. 2023. Highly
performing automatic detection of structural chromosomal abnormalities using
siamese architecture. Journal of Molecular Biology 435, 8 (2023), 168045.
[6]Markus M Breunig, Hans-Peter Kriegel, Raymond T Ng, and Jörg Sander. 2000.
LOF: identifying density-based local outliers. In Proceedings of the 2000 ACM
SIGMOD international conference on Management of data. 93–104.
[7]Sean B Carroll, John Doebley, Anthony JF Griffiths, and Susan R Wessler. 2015.
Introduction to genetic analysis. Springer.
[8]Ziwei Chai, Siqi You, Yang Yang, Shiliang Pu, Jiarong Xu, Haoyang Cai, and
Weihao Jiang. 2022. Can abnormality be detected by graph neural networks?. In
IJCAI. 1945–1951.
[9]Junru Chen, Yang Yang, Tao Yu, Yingying Fan, Xiaolong Mo, and Carl Yang. 2022.
BrainNet: Epileptic Wave Detection from SEEG with Hierarchical Graph Diffusion
Learning. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining (Washington DC, USA) (KDD ’22). Association for
Computing Machinery, New York, NY, USA, 2741–2751. https://doi.org/10.1145/
3534678.3539178
[10] François Chollet. 2017. Xception: Deep learning with depthwise separable con-
volutions. In Proceedings of the IEEE conference on computer vision and pattern
recognition. 1251–1258.
[11] Queremel Milani DA and Tadi P. 2023. Genetics, Chromosome Abnormali-
ties. [Updated 2023 Apr 24]. In: StatPearls [Internet]. Treasure Island (FL):
StatPearls Publishing; 2024 Jan-. Available from: https://www.ncbi.nlm.nih.gov/
books/NBK557691/.
[12] Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xi-
aohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al .2020. An image is worth 16x16 words: Transformers
for image recognition at scale. arXiv preprint arXiv:2010.11929 (2020).
[13] Sarah M Erfani, Sutharshan Rajasegarar, Shanika Karunasekera, and Christopher
Leckie. 2016. High-dimensional and large-scale anomaly detection using a linear
one-class SVM with deep learning. Pattern Recognition 58 (2016), 121–134.
[14] RJ MKinlay Gardner, Grant R Sutherland, and Lisa G Shaffer. 2012. Chromosome
abnormalities and genetic counseling. Number 61. OUP USA.
[15] Stanley M Gartler. 2006. The chromosome number in humans: a brief history.
Nature Reviews Genetics 7, 8 (2006), 655–660.
[16] Katherine B Geiersbach, Anna E Gardiner, Andrew Wilson, Shashirekha Shetty,
Hélène Bruyère, James Zabawski, Debra F Saxe, Rebecca Gaulin, Cynthia
Williamson, and Daniel L Van Dyke. 2014. Subjectivity in chromosome band–level
estimation: a multicenter study. Genetics in Medicine 16, 2 (2014), 170–175.
[17] Izhak Golan and Ran El-Yaniv. 2018. Deep anomaly detection using geometric
transformations. Advances in neural information processing systems 31 (2018).
[18] Leland Hartwell, Michael L Goldberg, Janice A Fischer, Leroy E Hood, and
Charles F Aquadro. 2018. Genetics: from genes to genomes. McGraw-Hill Ed-
ucation.
[19] T Hassold, N Chen, J Funkhouser, T Jooss, B Manuel, J Matsuura, A Matsuyama, C
Wilson, JA Yamane, and PA Jacobs. 1980. A cytogenetic study of 1000 spontaneous
abortions. Annals of human genetics 44, 2 (1980), 151–164.
[20] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016. Deep residual
learning for image recognition. In Proceedings of the IEEE conference on computer
vision and pattern recognition. 770–778.
[21] Heiko Hoffmann. 2007. Kernel PCA for novelty detection. Pattern recognition 40,
3 (2007), 863–874.
[22] Andrew G Howard, Menglong Zhu, Bo Chen, Dmitry Kalenichenko, Weijun
Wang, Tobias Weyand, Marco Andreetto, and Hartwig Adam. 2017. Mobilenets:
Efficient convolutional neural networks for mobile vision applications. arXiv
preprint arXiv:1704.04861 (2017).
[23] Gao Huang, Zhuang Liu, Laurens Van Der Maaten, and Kilian Q Weinberger.
2017. Densely connected convolutional networks. In Proceedings of the IEEE
conference on computer vision and pattern recognition. 4700–4708.
[24] Xuanwen Huang, Yang Yang, Yang Wang, Chunping Wang, Zhisheng Zhang,
Jiarong Xu, Lei Chen, and Michalis Vazirgiannis. 2022. DGraph: A Large-
Scale Financial Dataset for Graph Anomaly Detection. In Advances in
Neural Information Processing Systems , S. Koyejo, S. Mohamed, A. Agar-
wal, D. Belgrave, K. Cho, and A. Oh (Eds.), Vol. 35. Curran Associates,
Inc., 22765–22777. https://proceedings.neurips.cc/paper_files/paper/2022/file/
8f1918f71972789db39ec0d85bb31110-Paper-Datasets_and_Benchmarks.pdf[25] National Human Genome Research Institute. 2020. Chromosome Abnormalities
Fact Sheet. https://www.genome.gov/about-genomics/fact-sheets/Chromosome-
Abnormalities-Fact-Sheet
[26] National Human Genome Research Institute. 2024. KARYOTYPE. https://www.
genome.gov/genetics-glossary/Karyotype
[27] Nathalie Japkowicz and Shaju Stephen. 2002. The class imbalance problem: A
systematic study. Intelligent data analysis 6, 5 (2002), 429–449.
[28] Justin M Johnson and Taghi M Khoshgoftaar. 2019. Survey on deep learning with
class imbalance. Journal of Big Data 6, 1 (2019), 1–54.
[29] Samir Khan and Takehisa Yairi. 2018. A review on the application of deep learning
in system health management. Mechanical Systems and Signal Processing 107
(2018), 241–265.
[30] Diederik P Kingma and Jimmy Ba. 2014. Adam: A method for stochastic opti-
mization. arXiv preprint arXiv:1412.6980 (2014).
[31] Edwin M Knorr, Raymond T Ng, and Vladimir Tucakov. 2000. Distance-based
outliers: algorithms and applications. The VLDB Journal 8, 3 (2000), 237–253.
[32] Yann LeCun, Yoshua Bengio, and Geoffrey Hinton. 2015. Deep learning. nature
521, 7553 (2015), 436–444.
[33] R. Lewis. 2005. Human Genetics: Concepts and Applications. WCB/McGraw-Hill
(2005).
[34] Wen-Hsiung Li, Jing Yang, and Xun Gu. 2005. Expression divergence between
duplicate genes. TRENDS in Genetics 21, 11 (2005), 602–607.
[35] Jean McGowan-Jordan, Ros J Hastings, and Sarah Moore. 2020. ISCN 2020: An
International System for Human Cytogenomic Nomenclature (2020). Reprint Of:
Cytogenetic and Genome Research 2020, Vol. 160, No. 7-8. Karger, S.
[36] Aubrey Milunsky and Jeff M Milunsky. 2015. Genetic disorders and the fetus:
diagnosis, prevention, and treatment. John Wiley & Sons.
[37] Poojan Oza and Vishal M Patel. 2018. One-class convolutional neural network.
IEEE Signal Processing Letters 26, 2 (2018), 277–281.
[38] Theophilus S Painter. 1933. A new method for the study of chromosome re-
arrangements and the plotting of chromosome maps. Science 78, 2034 (1933),
585–586.
[39] Nick Pawlowski, Matthew CH Lee, Martin Rajchl, Steven McDonagh, Enzo Fer-
rante, Konstantinos Kamnitsas, Sam Cooke, Susan Stevenson, Aneesh Khetani,
Tom Newman, et al .2018. Unsupervised lesion detection in brain CT using
bayesian convolutional autoencoders. (2018).
[40] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M.
Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cour-
napeau, M. Brucher, M. Perrot, and E. Duchesnay. 2011. Scikit-learn: Machine
Learning in Python. Journal of Machine Learning Research 12 (2011), 2825–2830.
[41] Jan-Michael Peters and Tomoko Nishiyama. 2012. Sister chromatid cohesion.
Cold Spring Harbor Perspectives in Biology 4, 11 (2012), a011130.
[42] Emanuele Principi, Fabio Vesperini, Stefano Squartini, and Francesco Piazza. 2017.
Acoustic novelty detection with adversarial autoencoders. In 2017 International
Joint Conference on Neural Networks (IJCNN). IEEE, 3324–3330.
[43] Rigomar Rieger, Arnd Michaelis, and Melvin M Green. 2012. Glossary of genetics
and cytogenetics: classical and molecular. Springer Science & Business Media.
[44] G. Ritter and G. Schreib. 2000. Profile and feature extraction from chromosomes.
InProceedings 15th International Conference on Pattern Recognition. ICPR-2000,
Vol. 2. 287–290 vol.2. https://doi.org/10.1109/ICPR.2000.906069
[45] Lukas Ruff, Jacob R Kauffmann, Robert A Vandermeulen, Grégoire Montavon,
Wojciech Samek, Marius Kloft, Thomas G Dietterich, and Klaus-Robert Müller.
2021. A unifying review of deep and shallow anomaly detection. Proc. IEEE 109,
5 (2021), 756–795.
[46] Lukas Ruff, Robert Vandermeulen, Nico Goernitz, Lucas Deecke, Shoaib Ahmed
Siddiqui, Alexander Binder, Emmanuel Müller, and Marius Kloft. 2018. Deep
one-class classification. In International conference on machine learning. PMLR,
4393–4402.
[47] Mohammad Sabokrou, Mohammad Khalooei, Mahmood Fathy, and Ehsan Adeli.
2018. Adversarially learned one-class classifier for novelty detection. In Proceed-
ings of the IEEE conference on computer vision and pattern recognition. 3379–3388.
[48] Daisuke Sato, Shouhei Hanaoka, Yukihiro Nomura, Tomomi Takenaga, Soichiro
Miki, Takeharu Yoshikawa, Naoto Hayashi, and Osamu Abe. 2018. A primitive
study on unsupervised anomaly detection with an autoencoder in emergency
head CT volumes. In Medical Imaging 2018: Computer-Aided Diagnosis , Vol. 10575.
SPIE, 388–393.
[49] Thomas Schlegl, Philipp Seeböck, Sebastian M Waldstein, Georg Langs, and
Ursula Schmidt-Erfurth. 2019. f-AnoGAN: Fast unsupervised anomaly detection
with generative adversarial networks. Medical image analysis 54 (2019), 30–44.
[50] Thomas Schlegl, Philipp Seeböck, Sebastian M Waldstein, Ursula Schmidt-Erfurth,
and Georg Langs. 2017. Unsupervised anomaly detection with generative ad-
versarial networks to guide marker discovery. In International conference on
information processing in medical imaging. Springer, 146–157.
[51] Bernhard Schölkopf, John C Platt, John Shawe-Taylor, Alex J Smola, and Robert C
Williamson. 2001. Estimating the support of a high-dimensional distribution.
Neural computation 13, 7 (2001), 1443–1471.
[52] Lisa G Shaffer and James R Lupski. 2000. Molecular mechanisms for constitutional
chromosomal rearrangements in humans. Annual review of genetics 34, 1 (2000),
5326Chromosomal Structural Abnormality Diagnosis
by Homologous Similarity KDD ’24, August 25–29, 2024, Barcelona, Spain
297–329.
[53] Mei-Ling Shyu, Shu-Ching Chen, Kanoksri Sarinnapakorn, and LiWu Chang.
2003. A novel anomaly detection scheme based on principal component classifier.
Technical Report. Miami Univ Coral Gables Fl Dept of Electrical and Computer
Engineering.
[54] Ning Song, Chaoyu Wu, and MA Weiqi. 2021. Chromosome recognition method
based on deep learning. US Patent App. 17/272,254.
[55] Jihoon Tack, Sangwoo Mo, Jongheon Jeong, and Jinwoo Shin. 2020. Csi: Novelty
detection via contrastive learning on distributionally shifted instances. Advances
in neural information processing systems 33 (2020), 11839–11852.
[56] E Therman, B Susman, and C Denniston. 1989. The nonrandom participation
of human acrocentric chromosomes in Robertsonian translocations. Annals of
human genetics 53, 1 (1989), 49–65.
[57] Ilya Tolstikhin, Neil Houlsby, Alexander Kolesnikov, Lucas Beyer, Xiaohua Zhai,
Thomas Unterthiner, Jessica Yung, Daniel Keysers, Jakob Uszkoreit, Mario Lu-
cic, et al .2021. Mlp-mixer: An all-mlp architecture for vision. arXiv preprintarXiv:2105.01601 (2021).
[58] Gail H. Vance. 2020. 30 - Cytogenetics/cytogenomics. In Rodak’s Hematology
(Sixth Edition) (sixth edition ed.), Elaine M. Keohane, Catherine N. Otto, and
Jeanine M. Walenga (Eds.). Elsevier, St. Louis (MO), 525–539. https://doi.org/10.
1016/B978-0-323-53045-3.00039-8
[59] Houssam Zenati, Manon Romain, Chuan-Sheng Foo, Bruno Lecouat, and Vijay
Chandrasekhar. 2018. Adversarially learned anomaly detection. In 2018 IEEE
International conference on data mining (ICDM). IEEE, 727–736.
[60] Jianzhi Zhang. 2003. Evolution by gene duplication: an update. Trends in ecology
& evolution 18, 6 (2003), 292–298.
[61] Yue Zhao, Zain Nasrullah, and Zheng Li. 2019. PyOD: A Python Toolbox for
Scalable Outlier Detection. Journal of Machine Learning Research 20, 96 (2019),
1–7. http://jmlr.org/papers/v20/19-011.html
[62] Arthur Zimek, Erich Schubert, and Hans-Peter Kriegel. 2012. A survey on unsu-
pervised outlier detection in high-dimensional numerical data. Statistical Analysis
and Data Mining: The ASA Data Science Journal 5, 5 (2012), 363–387.
5327KDD ’24, August 25–29, 2024, Barcelona, Spain Juren Li et al.
A APPENDIX
A.1 Artificial abnormality
According to the real world chromosomes with structural abnormal-
ities in our datasets, we construct five types of artificial structural
abnormality chromosome sequences:
•Deleted. Part of the sampled chromosome sequences is deleted,
which makes the length of the chromosome sequence shorter
than before. The corresponding types of real world chromosome
structural abnormality include deletion: a portion of the chromo-
some is missing or has been deleted [ 33], and the donor chromo-
somes in insertion abnormalities: a portion of one chromosome
has been deleted from its normal place and inserted into another
chromosome [4].
•Added with other fragments. The sampled chromosome sequences
are added with a non-self segment, which makes the length of the
chromosome sequences longer than before. The corresponding
types of real world chromosome structural abnormalities include
the receptor chromosomes of insertion abnormality and some
unbalanced translocations: a portion of one chromosome has
been transferred to another chromosome [36].
•Duplicated with self fragments. The sampled chromosome se-
quences are added with a segment of its own, which also makes
the chromosome sequences longer. The corresponding type of
real world chromosome structural abnormality is duplication: a
portion of the chromosome has been duplicated [60].
•Replaced. One segment of a pair of sampled chromosome se-
quences, the left part and right part, is replaced by another, which
doesn’t change the length. If it is replaced by a segment of itself,
the corresponding type of real world chromosome structural ab-
normality is inversion: A portion of the chromosome has broken
off, turned upside down, and reattached [ 38]. If it is replaced by
a segment from another pair of sampled chromosome sequences,
the corresponding type of real world chromosome structural
abnormality is balanced translocations.
•Robertsonian translocation. The chromosome sampling sequence
was symmetrical and repeated, which make the length doubled.
The corresponding type of real world chromosome abnormality
is robertsonian translocation: an entire chromosome has attached
to another at the centromere [18].
A.2 Datasets
As mentioned in Section 2.1, we use the dataset sampled from both
healthy people and patients. We split the datasets according to the
desensitized patient IDs. There is no overlap between the patients
in the training set and test set. In the self-supervised learning stage,the split ratio of training set and test set is about 9: 1. And chromo-
some data with artificial structural abnormalities can avoid data
imbalance. Therefore, the ratio of normal chromosomes bag to bag
of chromosomes with artificial structural abnormalities is balanced.
In the fine tuning stage, we split the dataset into training set and
test set with a ratio of 1: 4. The ratio of chromosome with and
without structural abnormalities is less than 4%. Each type of chro-
mosome data for each patient corresponds to multiple query tuples
(𝑋,𝑐,𝑏). For each type of chromosome of each person, there are
multiple chromosome diagrams from different cell. In the dataset,
the average number of homologous chromosomes pair of each type
of chromosome from one person is 6 for the healthy person dataset
of𝐻𝑜𝑠#1, because some of the chromosome photos are incomplete
due to occlusion and some other reasons. And the average number
is 13 for the patients datasets of 𝐻𝑜𝑠#1,𝐻𝑜𝑠#2,𝐻𝑜𝑠#3and𝐻𝑜𝑠#4.
In our experiment, in order to cover as many patients as possible in
the datasets, we let each bag, 𝑋, contain five pairs of homologous
chromosome. In other words, 𝑚, the number of homologous pairs,
is set as 5. Additionally, for the same type of chromosome data of
the same patient, we randomly combined multiple bags.
A.3 Experiment setting
For feature engineering-based LR, we carefully extract features of
one chromosome including mean, variance, on-peak and off-peak of
the sampled sequence data, and features between the chromosomes
in a homologous pair including DTW distance, the correlation
coefficient and covariance. For anomaly detection methods, such
as OC-SVM, Deep-SVDD and AE-based method, we use the data
of normal chromosomes from healthy people as the training set.
For the supervised-learning based method, we change the opera-
tion of dividing the image into multiple patches in the first step
into the operation of dividing the sampled sequence into multiple
subsequences or transfer the Conv2D into Conv1D to handle the
sequential chromosome data. For LR and OC-SVM, We used the
sk-learn [ 40] library for our experiments. For Deep-SVDD and AE-
based method, we use the PyOD [ 61] libary for our experiments. The
codes of MobileNet, Xception, DensNet and ResNet refer to https:
//github.com/weiaicunzai/pytorch-cifar100. The code of MLP-Mixer
refers to https://github.com/google-research/vision_transformer.
The code of Vit refers to https://github.com/lucidrains/vit-pytorch.
The code of Siamese refers to https://github.com/MEABECHAR/
ChromosomeSiameseAD. Besides, we use Adam [ 30] optimizer
with a learning rate of 0.001 for self-supervised learning and that of
0.00001 for fine-tuning, and the batch size is set as 512. During the
fine-tuning, we freeze the parameters of 𝐶𝑀𝑆𝐵𝑙𝑜𝑐𝑘 and the first
difference extraction layer in 𝐻𝑜𝑚𝐵𝑙𝑜𝑐𝑘 , namely the first attention
layer.
5328