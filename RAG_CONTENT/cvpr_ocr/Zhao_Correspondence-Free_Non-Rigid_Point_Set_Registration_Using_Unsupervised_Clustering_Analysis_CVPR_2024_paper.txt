Correspondence-Free Non-Rigid Point Set Registration Using
Unsuper vised
Clustering Analysis
Mingyang Zhao1Jingen Jiang2Lei Ma3*Shiqing Xin2Gaofeng Meng1,4,5Dong-Ming Yan4,5*
1CAIR, HKISI, CAS2Shandong University3Peking University4MAIS, CASIA5UCAS
Figure 1. Non-rigid registration on 3D point sets. The blue and gray models represent the source and target point clouds, respectively, while
theyello
w models are our registration results. Our method achieves successful registrations even for shapes with challenging deformations.
Abstract
This paper pr
esents a novel non-rigid point set regis-
tration method that is inspired by unsupervised clustering
analysis. Unlike previous approaches that treat the source
and target point sets as separate entities, we develop a
holistic framework where they are formulated as cluster-
ing centroids and clustering members, separately. We then
adopt Tikhonov regularization with an ℓ1-induced Lapla-
cian k ernel
instead of the commonly used Gaussian ker-
nel to ensure smooth and more robust displacement ﬁelds.
Our formulation delivers closed-form solutions, theoretical
guarantees, independence from dimensions, and the ability
to handle large deformations. Subsequently, we introduce
a clustering-improved Nystr ¨om method to effectively reduce
the computational complexity and storage of the Gram ma-
trix to linear, while providing a rigorous bound for the low-
rank approximation. Our method achieves high accuracy
results across various scenarios and surpasses competitors
by a signiﬁcant margin, particularly on shapes with sub-
stantial deformations. Additionally, we demonstrate the
versatility of our method in challenging tasks such as shape
transfer and medical registration. [Code release]
*Corresponding Authors.1.
Introduction
Non-rigid point set
registration is to optimize a non-linear
displacement ﬁeld that accurately aligns one geometric
shape with another. Due to its fundamental importance,
non-rigid registration plays a dominant role in a wide range
of applications, such as scene reconstruction [ 35,52,54],
pose tracking [
34], animation [38], deformable shape ma-
nipulation and editing
[42], and so on.
Howev
er, given two point sets, one acting as the source
and the other as the target, non-rigid registration presents
a highly ill-posed and much more complex challenge com-
pared to the rigid counterpart. This increased complexity
is primarily attributed to the additional freedom of defor-
mations allowed in non-rigid registration, especially when
dealing with shapes that exhibit large deformations (Fig. 1).
To enhance
the registration quality for shapes under-
going large deformations, numerous pioneering methods
have been actively researched. Rather than directly opti-
mizing the registration process, these methods usually em-
ploy a two-step approach [30, 36,47,48]. First, they per-
form shape matching by
identifying corresponding points
between the source and target shapes without considering
geometry deformations. Then, they estimate the alignment
transformation based on the established correspondences
via off-the-shelf registration techniques. While there has
This CVPR paper is the Open Access version, provided by the Computer Vision Foundation.
Except for this watermark, it is identical to the accepted version;
the final published version of the proceedings is available on IEEE Xplore.
21199
been signiﬁcant attention and research dedicated to the ini-
tialshape
matching stage, the exploration of direct registra-
tionmethods for handling large deformations, without rely-
ing on shape matching, is comparatively limited and poses
substantial challenges [ 20].
In this w
ork, we address the problem of non-rigid point
set registration without correspondences, with a speciﬁc
emphasis on point sets exhibiting large deformations. To
overcome this challenge, we present a fresh perspective and
introduce a novel method. Our approach reformulates the
non-rigid deformation process as an unsupervised cluster-
ing problem within the context of machine learning. Unlike
previous approaches that treat the two point sets as separate
entities, we consider them as integral parts of a whole.
Concretely, we designate the source point set as the clus-
tering centroids, while the target one as the clustering sam-
ples. This holistic treatment enables us to leverage the in-
terplay between these two sets. Then the dynamic opti-
mization and update of the clustering centroids correspond
to the underlying deformation of the source shape. We
highlight the advantages of our novel registration function,
which is built on clustering analysis, from both information
theory and convex optimization perspectives. Furthermore,
we provide closed-form solutions to our objective function
during each iteration, which enables fast and efﬁcient im-
plementations. We introduce a sparsity-induced Laplacian
kernel (ℓ1-norm) in the Tikhonov regularization to ensure
that the displacement
ﬁeld of clustering centroids remains
as smooth as possible. This differs from the commonly used
Gaussian kernel and exhibits higher robustness, as demon-
strated by experimental results. Additionally, we leverage
clustering analysis to adopt the improved Nystr ¨om low-rank
approximation [51], which reduces the computational com-
plexity and
storage requirements of the Gram matrix to lin-
ear. Meanwhile, we give a rigorous proof of the approxima-
tion error bound associated with the Laplacian kernel.
Our method is independent of spatial dimensions, allow-
ing us to evaluate and compare its performance in both 2D
and 3D settings. The experimental results demonstrate the
superiority of our method compared to baselines by a large
margin. This is particularly evident in scenarios involving
large deformations, such as shape transfer and medical data
registration.
Our contributions can be summarized as follows:
• We propose a novel and correspondence-free method for
non-rigid point set registration, utilizing unsupervised
clustering analysis. The method achieves impressive re-
sults across various settings and mitigates the challenge
without explicit correspondences.
• We incorporate the Laplacian kernel function for robust
displacement regularization and provide a rigorous theo-
retical analysis to prove the approximation error bound of
the Nystr ¨om low-rank method.• Our method is dimension-independent, offering closed-
form solutions during optimization, and signiﬁcantly im-
proves performance in handling large deformations.
2. Related Work
We review the work that is closely aligned with ours. Read-
ers are directed to [14, 41] for comprehensive studies.
Non-rigid r egistration. Dif
fering from shape match-
ing that focuses on ﬁnding inlier correspondences, non-
rigid registration aims to optimize the displacement ﬁeld.
Various pioneering algorithms employ an optimization
paradigm that minimizes both the data and penalty terms
simultaneously. Amberg et al. [1] extended the rigid itera-
tive
closest point algorithm [4] to non-rigid settings, while
Yao et al .
[47, 48] recently improved non-rigid ICP re-
garding both
accuracy and efﬁciency through deformation
graph optimization. Coherent Point Drift (CPD) [33] and
GMM [23
] developed probabilistic frameworks by mini-
mizing the ne
gative logarithm likelihood function to en-
hance the robustness for non-rigid point set registration.
Maet al . [30] further incorporated the shape context de-
scriptor [2
] to establish shape correspondences for better
2D registration.
Hirose [20, 21] recently formulated CPD
in a Bayesian
setting, which effectively overcomes CPD’s
limitations and delivers impressive results.
With the advancement of deep learning, neural network-
based methods have also been proposed for non-rigid point
set registration [22, 25,36]. Most of them utilize neural net-
works to
extract features for point correspondences and then
apply classical methods such as non-rigid ICP for registra-
tion. Instead of focusing on shape matching and heavily
rely on data annotations, our method is unsupervised and
reasons from a case-by-case geometric perspective. This
allows us to achieve faithful registrations that are more gen-
eralizable to unknown categories.
Deformation representation. The representation of the
deformation ﬁeld is a key component in non-rigid registra-
tion. Several existing works are based on thin plate spline
functions [12, 23,37], which can be viewed as a regular-
ization of the
second-order derivatives of the transforma-
tions [33]. Another line of researches utilize kernel func-
tions or a
reproducing kernel Hilbert space to describe the
deformation ﬁeld [28, 29,33,43]. However, many of these
methods are limited
to the Gaussian kernel due to the re-
liance on fast Gauss transform [18]. Recently, the Multi-
Layer Per
ception (MLP) network has been employed to rep-
resent the deformation ﬁeld by mapping input coordinates
to signal values [24, 26,35] and the deformation degree
is controlled by
frequencies. These methods have shown
promising results in dynamical reconstruction and scene
ﬂow estimation, which are typically considered less chal-
lenging tasks compared to dealing with large deformations.
21200
3. Preliminaries on Clustering Analysis
Asone
of the representative unsupervised learning frame-
works, clustering analysis plays a fundamental role in var-
ious scientiﬁc research domains [ 46]. The pioneering
work [
27,53] explored clustering metrics for rigid point
cloud registration.
In contrast, we distinguish ourselves by
addressing a more challenging non-rigid problem, which we
have completely reformulated as a clustering process with a
different objective function. We present a concise overview
on two commonly used clustering approaches: fuzzy clus-
tering andElkan k-means clustering analysis.
3.1. Fuzzy Clustering Analysis
Given a dataset X={xi∈Rn}M
i=1, fuzzy clustering anal-
ysis solv es
the following problem:
min
U,VC/summationdisplay
j=1M/summationdisplay
i=1(uij)r|
|xi−vj||2
2,s.t.C/summationdisplay
j=1uij=
1,uij∈[0,1],(1)
whereU=
[uij]M×C∈RM×Cis the fuzzy membership
degr
ee matrix, V={vj∈Rn}C
j=1is the set of clustering
centroids consisting of C∈Z+classes,
andr∈[1,+∞ )is
thefuzzy factor, which controls the clustering fuzziness. To
enhance the clustering performance on unbalanced datasets,
Miyamoto et al. [32] proposed the inclusion of cluster size
controlling
variables α= [³1,···,³C]∈RCin Eq. (1),
and thus classes
with more samples may lead to higher
fuzzy membership degree. Since Euclidean distance-based
clustering algorithms are primarily suitable for spherical
data, Mahalanobis distance is latter introduced to general-
ize the fuzzy clustering analysis to accommodate ellipsoidal
structures [19]. Recently, [9] combined the merits of previ-
ous fuzzy clustering
approaches and developed a novel clus-
tering framework based on the ℓ2,pnorm, which achieves
appealing results on
a set of clustering analysis tasks:
min
U,V,Σ,αC/summationdisplay
j=1M/summationdisplay
i=1uij|
|Σ−1
2
j(xi−vj)||p
2+uijlog |Σj|+λuijlogui
j
αj,
s.t.|
Σj|=θj,C/summationdisplay
j=1uij=
1,C/summationdisplay
j=1αj= 1,
uij, α j∈[0,1].
(2)
where¼∈R+is
a regularization parameter, and Σj∈
Sn
++≜{A∈Rn×n|xTAx>0,∀x∈Rn}denotes the
cov
ariance matrix of the j-th class, with the corresponding
determinant equivalent to |Σj| ∈R. We explore the ap-
plication of
this clustering analysis framework to non-rigid
point set registration and demonstrate its superior perfor-
mance over previous registration approaches.
3.2. Elkan k­Means Clustering
In contrast to fuzzy clustering analysis, the k-means algo-
rithm [31] has emerged as one of the most widely usedclustering methods due
to its simplicity. Elkan k-means
clustering further introduced the triangle inequality into the
k-means framework to avoid unnecessary distance calcula-
tions, which dramatically speeds up the primary k-means
clustering process. More details of Elkan k-means cluster-
ing can be found in [15].
4.Proposed
Method
Problem formulation. Given two point sets X={xi∈
Rn}M
i=1andY={yj∈Rn}N
j=1, whereXandYare
named as the
target and the source, separately, the objec-
tive of non-rigid point set registration is to ﬁnd the optimal
deformation map Tthat minimizes the shape deviation be-
tweenT(Y)≜Y+¿(Y)andX, where¿represents the
displacement ﬁled acting on each source point yj.
4.1. Clustering­Induced Non­Rigid
Registration
Observations. We notice that during the clustering pro-
cess, the spatial position of clustering centroids Vare dy-
namically updated until the distance between the centroids
and their members is minimized. This dynamic process
bears resemblance to the iterative update of each source
pointT(yj). Inspired by this, we propose to formulate non-
rigid re
gistration as an unsupervised clustering process. We
considerYas the clustering centroids and Xas the cluster-
ing members. We customize Eq. ( 2) to optimize the overall
clustering loss by
m
inF(U,α,Σ,ν)=C/summationdisplay
j=1M/summationdisplay
i= 1uij|
|Σ−1
2
j(xi−(yj+ν(yj)))||2
2
+uijlog
|Σj|+λuijlogui
j
αj,
s.t.|
Σj|=θj,C/summationdisplay
j=1uij=
1,C/summationdisplay
j=1αj= 1,
uij, α j∈[0,1].
(3)
Here
we setp= 2 to ease the computation, which also
ensures closed-form solutions as derived in the following.
Regularization. As in [20, 33], we incorporate Tikhonov
r
egularization [17] to promote smoothness in the displace-
ment ﬁeld of
clustering centroids. Thus, our objective func-
tion is optimized to ﬁnd the optimal locations of clustering
centroids as follows:
minF(U,α,Σ,ν)+ζR(ν), (4)
where·is
a trade-off parameter. R(·)is an operator that
penalizes the high-frequency component of ¿if we consider
it in the Fourier domain, i.e.,
R(ν) =/integraldisplay
Rnds||˜ν(s)||2
2
˜K(s). (5)
K(s)is a kernel function regarding the frequency variable
s, and˜findicates
the Fourier transform of the function f.
21201
4.2. Virtues of the Newly­Deﬁned Function
We
provide a theoretical analysis of Eq. (3) from both infor-
mation theory and
optimization perspectives. This analysis
allows us to highlight the virtues of our newly introduced
loss function for non-rigid point set registration.
Information theory view. We re-write F(U,α,Σ,¿)as
C,M/summationdisplay
j=1,i=1uij|
|Σ−1
2
j(xi−(yj+ν(yj)))||2
2+ui jlog(|Σj|
αλ
j)−λH(U),
whereH(U) =−/summationtextC
j=1/summationtextM
i=1uijl og(uij)is the entropy
ofU. From
the perspective of information theory, this
entropy regularization term serves to push F(U,α,Σ,¿)
towardsUwith a uniform distribution that makes H(U)
the maximal and thus drags F(U,³,Σ,¿)away from the
sparseU. This not only enhances the smoothness of the fea-
sible set, but also improves the computational stability dur-
ing optimization, i.e., avoiding lim
uij→0log(uij) =−∞ [13 ].
Optimization view. Alternati
vely, from an optimization
point of view, uijlog(uij)is a convex function in terms of
uijwith¼controlling the de gree of convexity. Moreover,
uijlog(uij)acts as a barrier function that restrictsuijto
the range of [
0,1]and prevents it from taking values outside
this range [49].
4.3. Closed­Form
Solutions
Our method enables closed-form solutions for each variable
during the optimization step as derived in the following.
Update of U.We ﬁxα,Σ,¿ and update U, which be-
comes a convex optimization problem. Utilizing the La-
grangian multiplier and ignoring parameters that are irrele-
vant toU, we obtain
L(U,β)=C/summationdisplay
j=1M/summationdisplay
i=1uij|
|Σ−1
2
j(xi−(yj+ν(yj)))||2
2
+ui
jlog|Σj|+λuijlogui
j
αj+M/summationdisplay
i=1βi(C/summationdisplay
j=1uij−1
),
whereβ={´i∈R
}M
i=1are the set of Lagrangian multipli-
ers. By equating∂L
∂U=0, we have
U= (diag(A1 C))−1A (6)
HereA=
exp(−D/¼) diag(α»|Σ|),D= [dij]M×C∈
RM×Cis a squared Euclidean distance matrix with dij=
∥Σ−1
2
j(xi−(yj+¿(yj)))∥2
2,exp(·)is the element-wise
e
xponential operator of matrices, diag(z)is an operator that
creates a square diagonal matrix with the vector zon its
main diagonal, and |Σ|= [|Σ1|,···,|ΣC|]T∈RC.1Cis
theC-dimensional v ector
of all ones, and »represents the
element-wise Hadamard product of two matrices or vectors.-10 -5 0 5 1000.20.40.60.81
Gaussian
Laplacian
-10 -5 0 5 1000.20.40.60.81
Figure 2. Left: Comparison between the Gaussian kernel and
Laplacian k
ernel with the same bandwidth γ= 3, where the lat-
ter delivers considerably thicker lower and upper tails, indicating
higher robustness. Right: Laplacian kernel with different γ.
Update of α.Likewise, the closed-form solution with re-
spect toαisα=1
MUT1M,whichformally quantiﬁes the
clustering size for
each class.
Update of Σ.For simplicity, we relax each clustering
centroid’s covariance matrix to be isotropic, i.e.,Σj=Ã2I,
whereI∈Rn×nis the identity matrix. This ensures a
closed-form solution to
varianceÃ2:
σ2=tr(XTdiag(UT1M)X−(2(UX)T+TTd iag(U1C))T )
n×M,
wheretr(·)isthe matrix trace operator.
Update of ¿.By leveraging the Riesz’s representation
theorem [10], the closed-form solution to the regularization
term¿can be e
xpressed as
¿(y) =C/summationdisplay
j=1cjK(y,yj)+N/summationdisplay
η=1dηÈη(¿), (7)
where{cj∈R}C
j=1are the coefﬁcient scalars, K(·,·)is
the k ernel
function deﬁned in Eq. (5), and {Èη}N
η=1repre-
sent a set
of basis in the N-dimensional null space of R(¿),
which is typically composed by a set of polynomials for
most choices of the stabilizer R(¿).
In contrast to previous approaches that commonly utilize
aGaussian Radial Basis Function (RBF) [30, 33], we adopt
the sparsity-induced Laplacian k
ernel with the robust ℓ1-
norm to characterize
the displacement ﬁeld ¿,i.e.,
K(yi,yj) = exp(−µ∥yi−yj∥1), µ >0 (8)
in which∥
yi−yj∥1is the Manhattan distance between the
tw
o input vectors. Compared to the RBF kernel, the Lapla-
cian kernel exhibits stronger robustness due to its consider-
ably thicker tails, as illustrated in Fig. 2. We also validate
this conclusion through
subsequent experiments. Since the
Laplacian kernel is positive deﬁnite, we obtain Èη≡0[17].
By ev
aluating¿(y)atY={yj∈Rn}C
j=1, follow-
ing [ 20
,33], the coefﬁcient vector c= [c1,c2,· ··,cC]T∈
RCis
recovered from the following linear system:
c= (L+ζσ2d iag(U1C)−1)−1(d iag(U1C)−1UX−Y),(9)
21202
whereListhe Gram matrix with lij=K(yi,yj). There-
fore, the
newly deformed shape Tfrom the source point set
YbecomesT=T(Y) =Y+Lc.
4.4. Improved Nystr ¨om Low­Rank Approximation
The matrix inverse operation in Eq. ( 9) leads to a computa-
tional complexity
ofO(C3)and a memory requirement of
O(C2). Previous approaches often employ the fastGauss
tr
ansform (FGT) [18] to reduce memory usage and accel-
erate computation. Ho
wever, FGT is merely limited to the
Gaussian kernel. To circumvent this issue, BCPD [20] com-
bined the Nystr ¨om
method [11] and the KD tree search [3]
for acceleration. Ho
wever, there are still two major is-
sues that remain unresolved. (1) Due to the random sam-
pling scheme used in BCPD, it is unclear how effective the
Nystr ¨om approximation performs. (2) In order to address
convergence issues when Ã2becomes small, BCPD need
to switch from
Nystr ¨om approximation to KD tree search.
This transition may affect the optimization trajectory.
To overcome these challenges, we opt to use clustering
analysis instead of random sampling. Concretely, we ﬁrst
employ the fast Elkan k-means algorithm (Sec. 3.2) to par-
titionYintoC′disjoint clusters Pi¢Y, with the corre-
sponding clustering
centroids as {zi∈Rn}C′
i=1(C′jC).
Then, we adopt
the improved Nystr ¨om approximation [51]
for efﬁcient
and consistent optimization:
L≈EW−1ET, (10)
whereE= [eij]∈RC×C′andW= [wij]∈RC′×C′
are the lo
w-rank Laplacian kernel matrices, with elements
eij=K(yi,zj)andwij=K(zi,zj).
By incorporating clustering
analysis, we achieve two
key beneﬁts: (1) rigorously proving the error bound of the
Nystr ¨om approximation for our utilized Laplacian kernel,
and (2) as demonstrated through experiments, providing en-
couraging results for non-rigid point set registration without
compromising the optimization trajectory.
Proposition 1. The low-rank approximation error ϵ=
∥L−EW−1ET∥Fin terms of the Laplacian kernel is
bounded by
ϵf4√
2T3/2µ/radicalbig
C′q+2C′µ2Tq∥ W−1∥F, (11)
where∥·
∥Fis the matrix Frobenious norm, T= max i|Pi|,
q=/summationtextC
j=1∥yj−zc′(j)∥2
2is
the clustering quantization er-
ror withc′(j)
= argmini=1,···,C′∥yj−zi∥2, andµis the
Laplacian k
ernel bandwidth deﬁned in Eq. ( 8).
Proof. Please see
theSupplementary Material.
5. Experimental Results
We
perform extensive experiments to demonstrate the per-
formance of the proposed method and compare it with state-
of-the-art approaches from both 2D and 3D categories.Implementation details. Given a pair of point sets, for
better numerical stability, we ﬁrst perform shape normal-
ization to make them follow the standard normal distribu-
tion. However, the registration evaluation is still based on
the original inputs through denormalization. The Laplacian
kernel bandwidth µis set to2by default, and the number
of clustering centroids in Elkan k-means equals to 0.3C
for better trade-off between registration accuracy and efﬁ-
ciency. During optimization, we ﬁx the two weight coef-
ﬁcients¼= 0.5and·= 0.1, which deliver impressive
performance across various scenes. Our algorithm is im-
plemented in MATLAB, on a computer running AMD Core
Ryzen 5 3600XT (3.8GHz). We leverage publicly avail-
able implementations of baseline approaches for assess-
ment, with their parameters either ﬁne-tuned by ourselves
or ﬁxed by the original authors to achieve their best results.
Evaluation criteria. As in [20], we adopt the Root Mean
Squar ed
Error (RMSE) to quantitatively assess the regis-
tration accuracy. For point sets with known ground-truth
correspondences, we compute the squared distance between
corresponding points directly. However, for point sets with-
out annotated correspondences, such as distinct types of ge-
ometries, we identify the corresponding point pairs through
the nearest neighbor search. Accordingly, the RMSE is de-
ﬁned as:
RMSE(T(Y),X)=/radicalBig
Tr{(T(Y)−X)T(T(Y)−X)}/M,
whereT(Y)andXare
the deformed and the target point
sets, respectively.
5.1. 2D Non­Rigid Point Set Registration
For 2D non-rigid point set registration, we utilize the bench-
mark IMM hand dataset [40] for evaluation. This dataset
encompasses 40 real
images, showing the left hands of four
distinct subjects, and each contains 10 images. As illus-
trated in Fig. 3, the hand shape is described through 56 key
points extracted
from the contour of the hand. We employ
the ﬁrst pose from each group of hands as our target point
set, while the remaining poses of the same subject serve as
the source point sets. The quantitative comparison results
with state-of-the-art 2D registration approaches including
MR-RPM [30], BCPD [20], GMM [23], and ZAC [45] are
reported in T
ab.1. We report the average RMSE for each
subject along with
the average registration timing of each
method. As observed, our method consistently outperforms
the comparative approaches with higher registration accu-
racy and efﬁciency across all subjects. Although without the
need for constructing the initial point correspondences, like
shape context [2] used in MR-RPM, our method still de-
livers
RMSE that is orders of magnitude lower than that of
most competitors, highlighting its compelling advantages.
The qualitative comparison results regarding the inputs in
the third row of Fig. 3are presented in Fig. 4.
21203
Figure 3. Test samples from the 2D hand pose dataset with differ-
entsubjects.
The red∗and the blue ◦indicate the source and the
target point
sets, respectively.
Robustness. We further investigate the robustness of the
designed method against external disturbances including
noise and occlusion. We add a set of Gaussian noise with
zero mean and varying standard deviations Ã∈[0.01,0.06]
to all of the source point sets deﬁned in the above section.
Additionally, we randomly erase several points, around
3%∼20% of the source, to construct a range of occlusion
geometries. Fig. 5summarizes the average RMSE values
across all subjects.
It can be observed that our method still
achieves the highest or comparable registration accuracy on
all settings, highlighting its stability and robustness. Qual-
itative comparison results are presented in the Supplemen-
tary Material.
Table 1. Quantitative comparisons on the 2D hand pose dataset.
Bold values stand
for the top performer.
Method Subject 1 Subject 2 Subject 3 Subject 4 Time (s)
MR-RPM [30] 0.0940 0.0834 0.1028 0.1388 0.2382
BCPD [
20] 0.1027 0.1055 0.1080 0.1579 0.6890
GMM [
23] 0.0571 0.0547 0.0734 0.0917 0.1140
ZAC
[45] 0.4886 0.4566 0.4879 0.4935 0.4254
Ours 0.0383 0.0481 0.0537 0.0879 0.1074
5.2. 3D Non­Rigid Point Cloud Registration
Since our
method is dimension-independent, we further
substantiate its efﬁcacy on 3D point clouds and com-
pare it with eight state-of-the-art 3D registration or defor-
mation approaches, including BCPD [ 20], GBCPD [20],
Fast RNRR [50], AMM NRR [48], Sinkhorn [16], as
well as netw
ork-based ones Nerﬁes [35], NDP [26], and
NSFP [24
]. For efﬁciency, we downsample the point clouds
from datasets F
AUST [5] and TOSCA [6] using voxel grid
ﬁltering, with a
point size of 3,000∼4,000. More experi-
ments are presented in the Supplementary Material.
Registration for real human scans. Tab. 2and Fig. 6re-
port the quantitati
ve and qualitative comparison results on
the FAUST human dataset, respectively. The evaluation is
conducted using six sets of subjects in six different and chal-
lenging poses for each subject. We ﬁrst perform intra-class
Figure 4. Qualitative comparisons on the 2D hand pose dataset.
0.01 0.02 0.03 0.04 0.05 0.06
Noise Level0.050.10.150.20.250.30.350.40.450.5RMSEMR-RPM
BCPD
GMM
ZAC
Ours
2 4 6 8 10 12
Occlusion Level0.050.10.150.20.250.30.350.40.45RMSEMR-RPM
BCPD
GMM
ZAC
Ours
Figure 5. Robustness comparisons against external disturbances.
registration, i.e
., deforming the ﬁrst human geometry to
match the other poses for the same subject. Then, to validate
the capability of the designed approach against large defor-
mations, we further conduct an inter-class registration test
by aligning the ﬁrst human pose of the i-th subject to all the
poses of the (i+2)-th subject (i = 1,2,3,4). The statistical
results summarized in Tab. 2demonstrate that our method
achieves
the highest registration accuracy across all subjects
and outperforms competitors by a signiﬁcant margin, even
several orders of magnitude higher. Notably, while achiev-
ing remarkable accuracy, our method also maintains efﬁ-
ciency comparable to most competitors, making it a highly
practical and effective solution. The qualitative comparison
results in Fig. 6indicate that our method not only ensures
higher-quality deformations
but also recovers the geomet-
ric details as well as the topology of the target subject more
accurately and faithfully.
Registration for larger deformations. We further ver-
ify whether the proposed method improves the registration
performance for point cloud pairs with much larger de-
formations. We evaluate four classes of animals from the
TOSCA dataset [6] and report the average RMSE for each
class of them.
As illustrated in Fig. 7, the source and tar-
21204
Table 2. Quantitative comparisons on the real-world FAUST human scan dataset.
MethodSettingsIntra-1 Intra-2 Intra-3 Intra-4 Intra-5 Intra-6 Inter-1 Inter-2 Inter-3 Inter-4 Average Time (s)
BCPD [20] 0.0913 0.1011 0.0872 0.0577 0.1004 0.0746 0.1196 0.0705 0.0935 0.0923 0.0888 3.0359
GBCPD [
21] 0.0285 0.0212 0.0211 0.0260 0.0244 0.0339 0.0359 0.0340 0.0212 0.0190 0.0265 1.9346
FastRNRR [47] 0.0430 0.0487 0.0397 0.0504 0.0429 0.0391 0.1358 0.0743 0.0477 0.0358 0.0557 0.6324
AMM NRR [48] 0.0544 0.0486 0.0400 0.0539 0.0405 0.0393 0.0838 0.0686 0.0422 0.0399 0.0511 2.0438
Sinkhorn [16
] 0.0654 0.0638 0.1372 0.1096 0.0749 0.0821 0.2467 0.0781 0.1400 0.1720 0.1170 2.0377
Nerﬁes [
35] 0.0120 0.0107 0.0138 0.0129 0.0135 0.0118 0.0121 0.0144 0.0140 0.0140 0.0129 9.4287
NDP [
26] 0.0183 0.0199 0.0192 0.0152 0.0170 0.0149 0.0181 0.0198 0.0164 0.0155 0.0174 1.7590
NSFP [
24] 0.0126 0.0134 0.0132 0.0118 0.0137 0.0142 0.0167 0.0162 0.0148 0.0166 0.0143 2.4607
Ours 0.0086 0.0089 0.0103 0.0096 0.0089 0.0081 0.0097 0.0099 0.0094 0.0081 0.0092 2.3746
Source BCPD GBCPD Sinkhorn Nerfies NDP NSFPOurs Target
Figure 6. Qualitative comparisons on the FAUST dataset. The top and the bottom rows represent the test registrations of intra and inter-
subject, respecti
vely.
Table 3. Quantitative comparisons on the TOSCA dataset.
Method Cat Centaur Dog Gorilla Average
BCPD [20] 3.9884 8.1017 7.2800 5.6253 5.9935
GBCPD [
21] 1.5631 2.9480 1.5300 3.5751 2.6523
Nerﬁes [
35] 3.2704 2.8826 1.3612 2.2809 2.3211
NDP [
26] 4.3639 3.4373 3.1285 2.8312 3.2560
NSFP [
24] 1.8774 2.6425 1.6734 2.2044 2.0710
Ours 1.3496 1.8125 1.2088 1.6807 1.5247
get point sets exhibit signiﬁcant pose differences, making
there
gistration quite challenging. Tab. 3summarizes the
quantitative
comparison results. We exclude Fast RNRR,
AMM NRR, and Sinkhorn from our analysis because they
exhibit
signiﬁcant deviations from the target poses, render-
ing the error metrics unreliable. Our method consistently
outperforms all the baselines by a large margin. Fig. 7
demonstrates that our method delivers highly stable and ac-
curate registration
results for point clouds with large defor-
mations, even without the point-wise correspondences.
5.3. Ablation Study
Effect of the improved Nystr ¨om method. Fig.8reports
the re gistration
error, running time, and the matrix approx-
imation error (deﬁned in Proposition 1), between the im-
Source BCPD GBCPD Nerfies NDP NSFP Ours TargetFigure 7. Qualitative comparisons on the TOSCA dataset, where
much lar
ger shape deformations exist.
proved or clustered Nystr ¨om approximation method (Ours)
and the random one on two randomly extracted FAUST
models. We vary the approximation ratio R∈[0.02,0.4]
with∆R= 0.02. It can be seen that our method obtains
signiﬁcant registration and timing performance boost and
decrease in matrix approximation error by a large margin,
especially on lower ratios.
Laplacian VS. Gaussian. Fig. 9summarizes both the
quantitative
and qualitative comparison results between the
kernel functions of Gaussian and Laplacian. We validate the
merits and robustness of the Laplacian Kernel by aligning
the source Bunny model [39] contaminated by a set of noise
(Ã∈[0,0
.06]) to a randomly deformed Bunny. The kernel
bandwidthµis varied in [1,3]. We report the RMSE and
21205
0 0.1 0.2 0.3 0.40.0150.020.0250.030.0350.040.045Average ErrorTest 1-Ours
Test 2-Ours
Test 1-Nystrom
Test 2-Nystrom
0 0.1 0.2 0.3 0.4020406080Timing (Second)Test 1-Ours
Test 2-Ours
Test 1-Nystrom
Test 2-Nystrom
0 0.1 0.2 0.3 0.4380390400410420430440Approximation ErrorTest 1-Ours
Test 2-Ours
Test 1-Nystrom
Test 2-Nystrom
Figure 8. Comparisons between the Nystr ¨omlo w-rank approximation and our clustering-improved one for non-rigid registration.
0 0.01 0.02 0.03 0.04 0.05 0.06
Noise Level0.020.0250.030.035RMSE Gaussian ( =1)
Gaussian ( =2)
Gaussian ( =3)
Laplacian ( =1)
Laplacian ( =2)
Laplacian ( =3)
0 0.01 0.02 0.03 0.04 0.05 0.06
Noise Level0102030405060708090Number of IterationsGaussian
Laplacian
Figure 9. Comparisons between the Gaussian and the Laplacian
kernel
functions. Left: Results with various kernel bandwidth γ∈
[1,3]. Right: The number of iterations when algorithms converge.
the average number of iterations when algorithms converge
in Fig. 9.
We ﬁnd that the Laplacian kernel consistently out-
performs the Gaussian
kernel across all settings, suggesting
the merits of the sparsity-induced ℓ1norm. Moreover, the
Laplacian kernel
delivers faster convergence and more ac-
curate registration results (see the Supplementary Material).
5.4. Applications
Shape transfer. As depicted in Fig. 10, we apply the
proposed method to
transfer shapes belonging to different
categories that require substantial deformations. We ﬁrst
transfer two geometries with the identical topology (sphere
and cube) and then proceed to transfer CAD models from
ShapeNet [8], which presents a more challenging task. Re-
sults indicate the
effectiveness of our method in achiev-
ing accurate shape deformation while faithfully preserving
the geometric details of the source shapes. Notably, our
method consistently produces high-quality deformation re-
sults even when the shapes possess signiﬁcantly distinct
topology. More results on shape transfer are presented in
theSupplementary Material.
Medical registration. Deforming a standard medical
template to match those captured from individual patients
is a crucial step in the ﬁeld of medical data analysis. In
Fig.11, we demonstrate the efﬁcacy of our method by align-
inga 3D
inhale lung volume to two exhale lungs [7] and two
brain vessels
[44], extracted from real-world CT and MRA
images. Despite the
presence of complex structures, large
deformations, and mutual interference, our method consis-
tently achieves impressive results in accurately deforming
the template models to align the target shapes.
CubeSphere Sphere2Cube
Cube2SphereTable
ChairTable2Chair
Chair2TableLamp Lamp2Lamp
Lamp Lamp2LampFigure 10. Application of the proposed method to shape transfer.
Inhale Lung Exhale Lung Brain Vessel 
Figure 11. Application of our method to medical data registration.
6.Conclusions
Weproposed
an algorithm for solving non-rigid point set
registration without prescribed correspondences. The key
contribution of our method lies in reformulating non-rigid
registration as an unsupervised clustering process that en-
ables holistic optimization, dimension-independent, closed-
form solutions, and handling large deformations simultane-
ously. Moreover, we introduce the ℓ1-induced Laplacian
kernel to
achieve a more robust solution than the Gaussian
kernel and provide a rigorous approximation bound for the
Nystr ¨om method. Our method achieves higher-quality re-
sults than traditional methods and recent network models,
particularly on geometries that exhibit signiﬁcant deforma-
tions. We also showcase its applicability in challenging
tasks such as shape transfer and medical registration.
Acknowledgements. This work is partially funded by
the Strategic Priority Research Program of the Chinese
Academy of Sciences (XDB0640000), National Science
and Technology Major Project (2022ZD0116305),
National Natural Science Foundation of China
(62172415,62272277,62376267), and the innoHK project.
21206
References
[1]Brian
Amberg, Sami Romdhani, and Thomas Vetter. Optimal
step nonrigid icp
algorithms for surface registration. In Proc.
IEEE Conf. Comput. Vis. Pattern Recog., pages 1–8, 2007. 2
[2] Serge Belongie, Jitendra Malik, and Jan Puzicha. Shape
matching and object
recognition using shape contexts. IEEE
Trans. Pattern Anal. Mach. Intell., 24(4):509–522, 2002. 2,
5
[3] Jon Louis Bentley. Multidimensional binary search trees
used for associati
ve searching. Commun. ACM, 18(9):509–
517, 1975. 5
[4] PJ Besl and HD McKay. A method for registration of 3-
d shapes. IEEE T
rans. Pattern Anal. Mach. Intell., 14(2),
1992. 2
[5] Federica Bogo, Javier Romero, Matthew Loper, and
Michael J. Black.
FAUST: Dataset and evaluation for 3D
mesh registration. In Proc. IEEE Conf. Comput. Vis. Pattern
Recog., Piscataway, NJ, USA, 2014. 6
[6] Alexander M Bronstein, Michael M Bronstein, and Ron
Kimmel. Numerical geometry
of non-rigid shapes. 2008.
6
[7] Richard Castillo, Edward Castillo, David Fuentes, Moiz Ah-
mad, Abbie M
Wood, Michelle S Ludwig, and Thomas Guer-
rero. A reference dataset for deformable image registra-
tion spatial accuracy evaluation using the copdgene study
archive. Phys. Med. Biol., 58(9):2861, 2013. 8
[8] Angel X Chang, Thomas Funkhouser, Leonidas Guibas,
Pat Hanrahan,
Qixing Huang, Zimo Li, Silvio Savarese,
Manolis Savva, Shuran Song, Hao Su, et al. Shapenet:
An information-rich 3d model repository. arXiv preprint
arXiv:1512.03012, 2015. 8
[9] Qiang Chen, Feiping Nie, Weizhong Yu, and Xuelong Li.
l2,p-norm and mahalanobis distance based robust fuzzy c-
means. IEEE Tr
ans Fuzzy Syst, 2023. 3
[10] Zhe Chen and Simon Haykin. On different facets of regu-
larization theory. Neur
al Comput. , 14(12):2791–2846, 2002.
4
[11] KI Christopher, Matthias Seeger, et al. Using the nystr ¨om
method to speed
up kernel machines. Proc. Int. Conf. Neural
Inf. Process. Syst., 13:682–688, 2001. 5
[12] Haili Chui and Anand Rangarajan. A new point matching al-
gorithm for non-rigid
registration. Comput. Vis. Image. Und.,
89(2-3):114–141, 2003. 2
[13] Marco Cuturi. Sinkhorn distances: Lightspeed computation
of optimal transport. Pr
oc. Int. Conf. Neural Inf. Process.
Syst., 26, 2013. 4
[14] Bailin Deng, Yuxin Yao, Roberto M Dyke, and Juyong
Zhang. A surv
ey of non-rigid 3d registration. In Comput.
Graph. Forum, pages 559–589, 2022. 2
[15] Charles Elkan. Using the triangle inequality to accelerate
k-means. In Proc.
Int. Conf. Mach. Learn., pages 147–153,
2003. 3
[16] Jean Feydy, Thibault S ´ejourn ´e, Franc ¸ ois-Xavier Vialard,
Shun-ichi Amari, Alain Trouv ´e, and Gabriel Peyr ´e. Inter-
polating between optimal transport and mmd using sinkhorn
divergences. In Int. Conf. Artif. Intell. Stat., pages 2681–
2690. PMLR, 2019. 6,7[17] Federico Girosi, Michael Jones, and Tomaso Poggio. Regu-
larization theory and
neural networks architectures. Neural
Comput., 7(2):219–269, 1995. 3,4
[18] Leslie Greengard and John Strain. The fast gauss transform.
SIAM J.
Sci. Stat. Comput., 12(1):79–94, 1991. 2,5
[19] Donald E Gustafson and William C Kessel. Fuzzy clustering
with a fuzzy
covariance matrix. In 1978 IEEE conf. Decis.
Control Including the 17th Sym. Adaptive Processes, pages
761–766, 1979. 3
[20] Osamu Hirose. A bayesian formulation of coherent point
drift. IEEE T r
ans. Pattern Anal. Mach. Intell., 2020. 2,3,4,
5,6,7
[21] Osamu Hirose. Geodesic-based bayesian coherent point
drift. IEEE Tr
ans. Pattern Anal. Mach. Intell., 45(5):5816–
5832, 2022. 2,7
[22] Jiahui Huang, Tolga Birdal, Zan Gojcic, Leonidas J Guibas,
and Shi-Min Hu.
Multiway non-rigid point cloud registration
via learned functional map synchronization. IEEE Trans.
Pattern Anal. Mach. Intell., 45(2):2038–2053, 2022. 2
[23] Bing Jian and Baba C Vemuri. Robust point set registration
using gaussian
mixture models. IEEE Trans. Pattern Anal.
Mach. Intell., 33(8):1633–1645, 2010. 2,5,6
[24] Xueqian Li, Jhony Kaesemodel Pontes, and Simon Lucey.
Neural scene ﬂo
w prior. Proc. Int. Conf. Neural Inf. Process.
Syst., 34:7838–7851, 2021. 2,6,7
[25] Yang Li and Tatsuya Harada. Lepard: Learning partial point
cloud matching
in rigid and deformable scenes. In Proc.
IEEE Conf. Comput. Vis. Pattern Recog., pages 5554–5564,
2022. 2
[26] Yang Li and Tatsuya Harada. Non-rigid point cloud regis-
tration with neural
deformation pyramid. Proc. Int. Conf.
Neural Inf. Process. Syst., 35:27757–27768, 2022. 2,6,7
[27] Qianfang Liao, Da Sun, and Henrik Andreasson. Point set
registration for
3d range scans using fuzzy cluster-based met-
ric and efﬁcient global optimization. IEEE Trans. Pattern
Anal. Mach. Intell., 43(9):3229–3246, 2020. 3
[28] Jiayi Ma, Weichao Qiu, Ji Zhao, Yong Ma, Alan L Yuille,
and Zhuowen
Tu. Robust l{2}eestimation of transforma-
tion for non-rigid registration. IEEE Trans. Signal Process.,
63(5):1115–1129, 2015. 2
[29] Jiayi Ma, Ji Zhao, and Alan L Yuille. Non-rigid point set
registration by
preserving global and local structures. IEEE
Trans. Image Process., 25(1):53–64, 2015. 2
[30] Jiayi Ma, Jia Wu, Ji Zhao, Junjun Jiang, Huabing Zhou, and
Quan Z Sheng.
Nonrigid point set registration with robust
transformation learning under manifold regularization. IEEE
Trans. Neural Netw. Learn. Syst., 30(12):3584–3597, 2018.
1,2,4,5,6
[31] James MacQueen et al. Some methods for classiﬁcation
and analysis of
multivariate observations. In Proc. Berkeley
Symp. Math. Stats. Pbty, pages 281–297, 1967. 3
[32] Sadaaki Miyamoto, Hodetomo Ichihashi, Katsuhiro Honda,
and Hidetomo Ichihashi. Algorithms
for fuzzy clustering.
2008. 3
[33] Andriy Myronenko and Xubo Song. Point set registration:
Coherent point drift. IEEE
Trans. Pattern Anal. Mach. Intell.,
32(12):2262–2275, 2010. 2,3,4
21207
[34] Richard A Newcombe, Dieter Fox, and Steven M Seitz.
Dynamicfusion: Reconstruction
and tracking of non-rigid
scenes in real-time. In Proc. IEEE Conf. Comput. Vis. Pat-
tern Recog., pages 343–352, 2015. 1
[35] Keunhong Park, Utkarsh Sinha, Jonathan T Barron, Soﬁen
Bouaziz, Dan B
Goldman, Steven M Seitz, and Ricardo
Martin-Brualla. Nerﬁes: Deformable neural radiance ﬁelds.
InProc. IEEE Int. Conf. Comput. Vis., pages 5865–5874,
2021. 1,2,6,7
[36] Zheng Qin, Hao Yu, Changjian Wang, Yuxing Peng, and Kai
Xu. Deep graph-based
spatial consistency for robust non-
rigid point cloud registration. In Proc. IEEE Conf. Comput.
Vis. Pattern Recog., pages 5394–5403, 2023. 1,2
[37] Zsolt S ´anta and Zoltan Kato. Correspondence-less non-rigid
registration of triangular surface meshes. In Proc. IEEE
Conf. Comput. Vis. Pattern Recog., pages 2275–2282, 2013.
2
[38] Aliaksandr Siarohin, Willi Menapace, Ivan Skorokhodov,
Kyle Olsze
wski, Jian Ren, Hsin-Ying Lee, Menglei Chai,
and Sergey Tulyakov. Unsupervised volumetric animation.
InProc. IEEE Conf. Comput. Vis. Pattern Recog., pages
4658–4669, 2023. 1
[39] Stanford. The Stanford 3D Scanning Repository. http:
//graphics
.stanford.edu/data/3Dscanrep/ .
7
[40] Mikkel B Stegmann and David Delgado Gomez. A brief
introduction to statistical
shape analysis. Informatics and
mathematical modelling, Technical University of Denmark,
DTU, 15(11), 2002. 5
[41] Gary KL Tam, Zhi-Quan Cheng, Yu-Kun Lai, Frank C Lang-
bein, Yonghuai
Liu, David Marshall, Ralph R Martin, Xian-
Fang Sun, and Paul L Rosin. Registration of 3d point clouds
and meshes: A survey from rigid to nonrigid. IEEE Trans.
Vis. Comput. Graph., 19(7):1199–1217, 2012. 2
[42] Jiapeng Tang, Lev Markhasin, Bi Wang, Justus Thies, and
Matthias Nießner .
Neural shape deformation priors. Proc.
Int. Conf. Neural Inf. Process. Syst., 35:17117–17132, 2022.
1
[43] Te Tang, Changhao Wang, and Masayoshi Tomizuka. A
framework
for manipulating deformable linear objects by
coherent point drift. IEEE Robot. Autom. Lett., 3(4):3426–
3433, 2018. 2
[44] TubeTK. The TubeTK Testing Data. https://public.
kitware.com/Wiki/TubeTK/Data .8
[45] Fudong Wang, Nan Xue, Jin-Gang Yu, and Gui-Song Xia.
Zero-assignment constraint for
graph matching with outliers.
InProc. IEEE Conf. Comput. Vis. Pattern Recog., pages
3033–3042, 2020. 5,6
[46] Rui Xu and Donald Wunsch. Survey of clustering algo-
rithms. IEEE Tr
ans. Neural Netw. Learn. Syst., 16(3):645–
678, 2005. 3
[47] Yuxin Yao, Bailin Deng, Weiwei Xu, and Juyong Zhang.
Quasi-newton solv
er for robust non-rigid registration. In
Proc. IEEE Conf. Comput. Vis. Pattern Recog., 2020. 1,2,7
[48] Yuxin Yao, Bailin Deng, Weiwei Xu, and Juyong Zhang.
Fast and
robust non-rigid registration using accelerated
majorization-minimization. IEEE Trans. Pattern Anal.
Mach. Intell., 2023. 1,2,6,7[49] Alan L Yuille and JJ Kosowsky. Statistical physics algo-
rithms that con
verge. Neural Comput., 6(3):341–356, 1994.
4
[50] Juyong Zhang, Yuxin Yao, and Bailin Deng. Fast and ro-
bust iterati
ve closest point. IEEE Trans. Pattern Anal. Mach.
Intell., 2021. 6
[51] Kai Zhang, Ivor W Tsang, and James T Kwok. Improved
Nystr ¨om low-rank
approximation and error analysis. In
Proc. Int. Conf. Mach. Learn., pages 1232–1239, 2008. 2,
5
[52] Mingyang Zhao, Lei Ma, Xiaohong Jia, Dong-Ming Yan,
and T iejun
Huang. Graphreg: dynamical point cloud regis-
tration with geometry-aware graph signal processing. IEEE
Trans. Image Process., 31:7449–7464, 2022. 1
[53] Mingyang Zhao, Xiaoshui Huang, Jingen Jiang, Luntian
Mou, Dong-Ming Y
an, and Lei Ma. Accurate registration
of cross-modality geometry via consistent clustering. IEEE
Trans. Vis. Comput. Graph., 2023. 3
[54] Michael Zollh ¨ofer, Matthias Nießner, Shahram Izadi,
Christoph Rehmann, Christopher Zach, Matthew Fisher,
Chenglei Wu, Andrew Fitzgibbon, Charles Loop, Christian
Theobalt, et al. Real-time non-rigid reconstruction using an
rgb-d camera. ACM Trans. Graph., 33(4):1–12, 2014. 1
21208
