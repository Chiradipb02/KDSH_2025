Published in Transactions on Machine Learning Research (7/2024)
Dynamic Structure Estimation from Bandit Feedback using
Nonvanishing Exponential Sums
Motoya Ohnishi* mohnishi@cs.washington.edu
Paul G. Allen School of Computer Science & Engineering
University of Washington
Isao Ishikawa* ishikawa.isao.zx@ehime-u.ac.jp
Ehime University
RIKEN Center for Advanced Intelligence Project
Yuko Kuroki yuko.kuroki@centai.eu
CENTAI Institute
Masahiro Ikeda masahiro.ikeda@riken.jp
RIKEN Center for Advanced Intelligence Project
Keio University
Reviewed on OpenReview: https: // openreview. net/ forum? id= xNkASJL0F6
Abstract
This work tackles the dynamic structure estimation problems for periodically behaved dis-
crete dynamical system in the Euclidean space. We assume the observations become se-
quentially available in a form of bandit feedback contaminated by a sub-Gaussian noise.
Under such fairly general assumptions on the noise distribution, we carefully identify a set
of recoverable information of periodic structures. Our main results are the (computation
and sample) efficient algorithms that exploit asymptotic behaviors of exponential sums to
effectively average out the noise effect while preventing the information to be estimated
from vanishing. In particular, the novel use of the Weyl sum, a variant of exponential sums,
allows us to extract spectrum information for linear systems. We provide sample complex-
ity bounds for our algorithms, and we experimentally validate our theoretical claims on
simulations of toy examples, including Cellular Automata.
1 Introduction
System identification has been of great interest in controls, economics, and statistical machine learning
(cf. Tsiamis & Pappas (2019); Tsiamis et al. (2020); Lale et al. (2020); Lee (2022); Kakade et al. (2020);
Ohnishi et al. (2024); Mania et al. (2022); Simchowitz & Foster (2020); Curi et al. (2020); Hazan et al.
(2018); Simchowitz et al. (2019); Lee & Zhang (2020)). In particular, estimations of periodic information,
including eigenstructures for linear systems, under noisy and partially observable environments, are essen-
tial to a variety of applications such as biological data analysis (e.g., Hughes et al. (2017); Sokolove &
Bushell (1978); Zielinski et al. (2014); also see Furusawa & Kaneko (2012) for how gene oscillation affects
differentiation of cells), earthquake analysis (e.g., Rathje et al. (1998); Sabetta & Pugliese (1996); Wolfe
(2006); see Allen & Kanamori (2003) for the connections of the frequencies and magnitude of earthquakes),
chemical/asteroseismic analysis (e.g., Aerts et al. (2018)), and communication and information systems (e.g.,
Couillet & Debbah (2011); Derevyanko et al. (2016)), just to name a few.
* equal contributions
1Published in Transactions on Machine Learning Research (7/2024)
In this paper, we focus on the periodic structure estimation problem for nearlyperiodically behaved discrete
dynamical systems (cf. Arnold (1998); specifically, we mainly study theoretical aspects of recovering struc-
tural information under a novel set of model assumptions. We allow systems that are not exactlyperiodic
with sequentially available bandit feedback. Due to the presence of noise and partial observability, our prob-
lem setups do not permit the recovery of the full set of period/eigenvalues information in general; as such
we particularly ask the following question: what subset of information on dynamic structures can be statisti-
cally efficiently estimated? This work successfully answers this question by identifying and mathematically
defining recoverable information, and proposes algorithms for efficiently extracting such information.
The technical novelty of our approach is highlighted by the careful adoption of the asymptotic bounds
on the exponential sums that effectively cancel out noise effects while preserving the information to be
estimated. When the dynamics is driven by a linear system, the use of the Weyl sum Weyl (1916), a variant
of exponential sums, enables us to extract more detailed information. To our knowledge, this is the first
attempt of employing asymptotic results of the Weyl sum for statistical estimation problems, and further
studies on the relations between statistical estimation theory and exponential sums (or even other number
theoretical results) are of independent interests.
With this summary of our work in place, we present our dynamical system model below followed by a brief
introduction of the properties of the exponential sums used in this work.
Dynamic structure in bandit feedback. We defineD⊂Rdas a (finite or infinite) collection of arms to
be pulled. Let (ηt)∞
t=1be a noise sequence. Let Θ⊂Rdbe a set of latent parameters. We assume that there
exists adynamical system fonΘ, equivalently, a map f: Θ→Θ. At each time step t∈{1,2,...}, a learner
pulls an arm xt∈Dand observes a reward
rt(xt) :=ft(θ)⊤xt+ηt,
for someθ∈Θ. In other words, the hidden parameters for the rewards may vary over time but follow only
a rulefwith initial value θ. The function rtcould be viewed as the specific instance of partial observation
(cf. Ljung (2010)).
Brief overview of the properties of the exponential sums used in this work. Exponential sums,
also known as trigonometric sums, have developed as a significant area of study in number theory, employing
various methods from analytical and algebraic number theory (see Arkhipov et al. (2004) for an overview).
An exponential sum consists of a finite sum of complex numbers, each with an absolute value of one, and its
absolute value can trivially be bounded by the number of terms in the sum. However, due to the cancellation
amongterms, nontrivialupperandlowerboundscansometimesbeestablished. Severalclassesofexponential
sums with such nontrivial bounds are known, and in this study, we apply bounds from a class known as
Weyl sums to extract information from dynamical systems using bandit feedback. In the mathematical
community, these bounds are valuable not only in themselves but also for applications in fields like analysis
within mathematics (Katz, 1990). This research represents an application of these bounds in the context of
machine learning (statistical learning/estimation problem) and is cast as one of the first attempts to open
the applications of number theoretic results to learning theory.
In fact, even the standard results utilized in discrete Fourier transform can be leveraged, with their
(non)asymptotic properties, to provably handle noisy observations to extract (nearly) periodic informa-
tion. This process is illustrated in Figure 1 (the one for period estimation); where we show that one can
effectively average out the noise through the exponential sum (which is denoted by Rin Figure 1) while
preventing the correct period estimation from vanishing. By multiplying the (scalar) observations by certain
exponential value, the bounds of the Weyl sum (which is denoted by Win Figure 1) can be applied to
guarantee the survival of desirable target eigenvalue information; this is illustrated in Figure 1 (the one for
eigenstructure estimation).
Our contributions. The contributions of this work are three folds: First, we mathematically identify and
define a recoverable set of periodic/eigenvalues information when the observations are available in a form
of bandit feedback. The feedback is contaminated by a sub-Gaussian noise, which is more general than
2Published in Transactions on Machine Learning Research (7/2024)
Figure 1: Overview of how the exponential sum techniques are used in the work. For (nearly) period estimation
problem, it is an application of discrete Fourier transform in our statistical settings, which ensures that the correct
estimate remains while noise effect or wrong estimates are properly suppressed. When the system follows linear
dynamics in addition to the (nearly) periodicity, our application of the Weyl sum, a variant of exponential sums,
preserves some set of the eigenstructure information.
those usually considered in system identification work. Second, we present provably correct algorithms for
efficiently estimating such information; this constitutes the first attempt of adopting asymptotic results on
the Weyl sum. Lastly, we implemented our algorithms for toy and simulated examples to experimentally
validate our claims.
Summary of technical contributions and challenges. Here, we showcase a summary of technical
contributions and challenges to be overcome:
•Exploiting the exponential sum techniques (including the discrete Fourier transform) studied in
number theory community as a filteringwithin the context of statistical estimation problems.
•Adapt the Weyl sum technique to deal with eigenvalues by extending it to matrix sum.
•Defining novel mathematical concepts: (aliquot) nearly period and(θ,k)-distinct eigenvalues .
•Concurrently applying a set of filterings to statistically identify correct periodic structure (we call
this asconcurrent application of filterings in Algorithm 1).
•System recovery through maintenance of isomorphic structure in observation (we call it as isomor-
phicity maintenance lemma ; see Lemma C.1).
Notations. Throughout this paper, R,R≥0,N,Z>0,Q,Q>0, andCdenote the set of the real numbers, the
nonnegative real numbers, the natural numbers ( {0,1,2,...}), the positive integers, the rational numbers,
the positive rational numbers, and the complex numbers, respectively. Also, [T] :={1,2,...T}forT∈Z>0.
The Euclidean norm is given by ∥x∥Rd=/radicalbig
⟨x,x⟩Rd=√
x⊤xforx∈Rd, where (·)⊤stands for transposition.
∥M∥and∥M∥Fare the spectral norm and Frobenius norm of a matrix Mrespectively, and I(M)and
N(M)are the image space and the null space of M, respectively. If ais a divisor of b, it is denoted by
a|b. The floor and the ceiling of a real number ais denoted by⌊a⌋and⌈a⌉, respectively. Finally, the least
common multiple and the greatest common divisor of a set Lof positive integers are denoted by lcm(L)and
gcd(L), respectively.
3Published in Transactions on Machine Learning Research (7/2024)
Figure 2: Illustration of loss of dynamic information through concentration of measure. Left: An example of the law
of large numbers showing the sample mean of the numbers given by throwing dice many times will converge towards
the expected value as the number of throws increases. Right: An intuitive understanding of how the concentration
of measures or process of averaging out the observations may erase not only the noise effect but also the dynamics
information; in this case, the dynamics on the left side is a fixed point attractor and the right one is a limit cycle
attractor, both of which may return (0,0)when averaging the states over long time.
2 Motivations
As our main body of the work is largely theoretical with a new problem formulation, this section is intended
to articulate the motivations behind this work from scientific (theoretical) and practical perspectives followed
by the combined aspects for our formulation.
2.1 Scientific (theoretical) motivation
When dealing with noisy observation, it is advised to use concentrations of measure to extract the true target
value by averaging out the noise effect over sufficiently many samples. On the other hand, when the samples
are generated by a dynamical system, averaging over the samples will have an effect of averaging over time,
which could lose some information on the evolution of dynamics.
Dynamic information recovery from noisy observation. Consider for example a fixed point attractor
and a limit cycle attractor dynamics as depicted in Figure 2; when averaging over samples generated by
sufficiently long time horizon, both cases would output values that are close to (0,0)which ambiguates the
dynamical properties. In particular, properties of long-time average of the dynamics have been studied in
ergodic theory (cf. Walters (2000)), and studying dynamical systems from both time and measure is of
independent interest.
Dynamic information recovery from scalar observations. Also, linear bandit feedback system is a
special case of partially observable systems, and specifically considers scalar (noisy) observations.
For reconstruction of attractor dynamics from noiseless scalar observations, as will be mentioned in Section
3, Takens’ theorem (or delay embedding theorem; Takens (1981)) is famous, where an observation function
is used to construct the embedding. It identifies the dynamical system properties that are preserved through
the reconstruction as well.
If the noise is also present, the problems become extensively complicated and some attempts on the analysis
have been made (Casdagli et al., 1991); which discusses the trade-off between the distortion and estimation
errors.
2.2 Practical motivation
Practically, periodicinformationestimationisofgreatinterestaswehavementionedinSection1; inaddition,
eigenvalue estimation problems are particularly important for analyzing linear systems.
4Published in Transactions on Machine Learning Research (7/2024)
Physical constant estimation. Some of the important linear systems include electric circuits and vi-
bration (or oscillating) systems which are typically used to model an effect of earthquakes over buildings.
Eigenvalue estimation problems in such cases reduce to the estimation of physical constants. Also, they have
been studied for channel estimation (Van De Beek et al., 1995) as well.
Dynamic mode decomposition. At the same time, analyzing the modesof a target dynamical system by
the technique named (extended) dynamic mode decomposition ((E)DMD; cf. Tu (2013); Kutz et al. (2016);
Williams et al. (2015)) has been extensively researched. The results give spectrum information about the
dynamics.
Attractor reconstruction. With Takens’ theorem, obtaining dynamic structure information of attractors
in a finite-dimensional space from a finite number of scalar observations is useful in practice as well; see
(Bakarji et al., 2022) for an application in deep autoencoder. Our problems are not dealing with general
nonlinear attractor dynamics; however, the use of exponential sums in the estimation process would become
a foundation for the future applications for modeling target dynamics.
Communication capacity. There has been an interest of studying novel paradigms for coding, trans-
mitting, and processing information sent through optical communication systems (Turitsyn et al., 2017);
when encoding information in (nearly) periodic signals to transmit, computing communication capacity that
properly takes communication errors into account is of fundamental interest. If the observation is made as
a mix of the outputs of multiple communication channels, the problem becomes relevant to bandit feedback
as well.
Bandit feedback – single-pixel camera. As widely studied in a context of compressed sensing (cf.
Donoho (2006); Eldar & Kutyniok (2012); Candes et al. (2006)), reconstruction of the target image from
the single-pixel camera (e.g., Duarte et al. (2008)) observations relies on a random observation matrix (or
vector) to obtain a single pixel value for each observation. It is advantageous to concentrate light to one
pixel for the cases where the light intensity is very low. Bandit feedback naturally coincides with a random
observation matrix that the user can design. The observation through a random matrix coupled with
compressed sensing has been studied for channel estimation, magnetic resonance imaging, visualization of
black holes, and vibration analysis as well.
Bandit feedback – recommendation system. Reward maximization problems from bandit feedback
have been applied to recommendation system (e.g., Li et al. (2010)) for example, where the observations are
in scalar form. Other applications of bandit problems include healthcare, dynamic pricing, dialogue systems
and telecommunications. Although our problem formulation is not meant to maximize any reward, it is
seamlessly connected to the bandit problems as described below.
Connection to reward maximization problems. As we will briefly describe in Appendix E, thanks to
the problem formulations in this work, one could use our estimation algorithms for downstream bandit prob-
lems (i.e., reward maximization problem with bandit feedback). A naive approach is an explore-then-commit
type algorithm (cf. Robbins (1952); Anscombe (1963)) where the “explore” stage utilizes our estimation
mechanism to identify the dynamics structure behind the system parameter. Devising efficient dynamic
structure estimation algorithms for other types of information than the periodicity and eigenstructure under
bandit feedback scenarios may also be an interesting direction of research.
2.3 Combined aspects
In our work, we essentially consider periodic (and eigenstructure) information recovery from observation
data, which as mentioned is crucial in some application domains. In particular, our formulation cares about
the situation where the observation is made by a bandit feedback which produces a sequence of scalar
observations. We mention that the bandit feedback is essentially just a (noisy) scalar observation where
(possibly random) observation vectors are selected by users.
5Published in Transactions on Machine Learning Research (7/2024)
Figure 3: Illustration of the example practical case where our techniques may be applied; in this example, the target
object is following nearly periodic motion, and requires concentration of light to be captured. A random filter could
be employed and we observe a single value sequentially to predict its periodic information.
One possible example scenario in which bandit feedback and dynamic structure estimation meet is illustrated
in Figure 3 where the target system has some periodicity and the noisy observation is made through a single-
pixel camera equipped with a random filter to be used to determine the periodic structure of the target
system.
Also, as mentioned, we emphasize again that reconstruction of dynamical systems characteristics such as
their attractor dynamics through (noisy, user-selected) scalar observation is an important area of research;
we believe the use of exponential sums in the reconstruction of dynamics opens up further research directions
and applications in a similar manner to Takens’ theorem (see Section 3 as well).
3 Related work
As we have seen in Section 2, our broad motivation stems from the reconstruction of dynamical system
information from noisy and partial observations. The most relevant lines of work to this problem are (1) that
of Takens (Takens, 1981) and its extensions, and (2) system identifications for partially observed dynamical
systems.
While the former studies more general nonlinear attractor dynamics from a sequence of scalar observations
made by certain observation function having desirable properties, it is originally for the noiseless case.
Although there exist some attempts on extending it to noisy situations (e.g., Casdagli et al. (1991)), provable
estimation of some dynamic structure information with sample complexity guarantees (or nonasymptotic
result) under fairly general noise case is not elaborated. On the other hand, our work may be viewed
as a special instance of system identifications for partially observed dynamical systems. Existing works for
samplecomplexityanalysisofpartiallyobservedlinearsystems(e.g., Mendaetal.(2020);Hazanetal.(2018);
Simchowitz et al. (2019); Lee & Zhang (2020); Tsiamis & Pappas (2019); Tsiamis et al. (2020); Lale et al.
(2020); Lee (2022); Adams et al. (2021); Bhouri & Perdikaris (2021); Ouala et al. (2020); Uy & Peherstorfer
(2021); Subramanian et al. (2022); Bennett & Kallus (2021); Lee et al. (2020)) typically consider additive
Gaussian noise and make controllability and/or observability assumptions (for autonomous case, transition
with Gaussian noise with positive definite covariance is required). While (Mhammedi et al., 2020) considers
nonlinear observation, it still assumes Gaussian noise and controllability. The work (Hazan et al., 2018)
considers adversarial noise but with limited budget; we mention its wave-filtering approach is interesting
and our use of exponential sums could also be viewed as filtering. Also, the work (Simchowitz et al., 2019)
considers control inputs and bounded semi-adversarial noise, which is another set of strong assumptions.
Our work is based on the different set of assumptions and aims at estimating a specific set of information;
i.e., while we restrict ourselves to the case of (nearly) periodic systems and allow observations in the form of
bandit feedback, our goal is to estimate (nearly) periodic structure of the target system. In this regard, we
are not proposing “better” algorithms than the existing lines of work but are considering different problem
6Published in Transactions on Machine Learning Research (7/2024)
Figure 4: Illustration of the position of our work as a study of reconstruction of dynamical system properties.
We assume sub-Gaussian noise, bandit feedback (user-defined linear feedback contaminated by noise), autonomous
system, and (nearly) periodicity which is the information to be extracted. To our knowledge, our assumptions do
not subsume or are subsumed by those of other work as a problem of provably estimating periodic structure. In
comparison to existing system identification techniques for partially observed dynamical systems, we do notassume
Gaussian (or bounded) noise, limited budget for adversarial noise, controllability, observability or noisy transition,
while we assume bandit feedback to identify a recoverable set of dynamic structure information.
setupsthatwebelievearewell motivatedfromboththeoreticaland practical perspectives(seeSection 2). We
mention that there exist many period estimation methods (e.g., Moore et al. (2014); Tenneti & Vaidyanathan
(2015)), and in the case of zero noise, this becomes a trivial problem. For intuitive understandings of how
our work may be placed in the literature, we show the illustration in Figure 4.
We also mention that our model of bandit feedback is commonly studied within stochastic linear bandit
literature (cf. Abe & Long (1999); Auer (2003); Dani et al. (2008); Abbasi-Yadkori et al. (2011)). Also, as we
consider the dynamically changing system states (or reward vectors ), it is closely related to adversarial bandit
problems (e.g., Bubeck & Cesa-Bianchi (2012); Hazan (2016)). Recently, some studies on non-stationary
rewards have been made (cf. Auer et al. (2019); Besbes et al. (2014); Chen et al. (2019); Cheung et al. (2022);
Luo et al. (2018); Russac et al. (2019); Trovo et al. (2020); Wu et al. (2018)) although they do not deal with
periodically behaved dynamical system properly (see discussions in (Cai et al., 2021) as well). For discrete
action settings, (Oh et al., 2019) proposed the periodic bandit, which aims at minimizing the total regret.
Also, if the period is known, Gaussian process bandit for periodic reward functions was proposed (Cai et al.,
2021) under Gaussian noise assumption. While our results could be extended to the regret minimization
problemsbyemployingouralgorithmsforestimatingtheperiodicinformationbeforecommittingtoarmsina
certain way, we emphasize that our primary goal is to estimate such periodic information in provably efficient
ways. We thus mention that our work is orthogonal to the recent studies on regret minimization problems
for non-stationary environments (or in particular, periodic/seasonal environments). Refer to (Lattimore &
Szepesvári, 2020) for bandit algorithms that are not covered here.
4 Problem definition
Inthissection, wedescribeourproblemsetting. Inparticular, weintroducesomedefinitionsontheproperties
of dynamical system.
7Published in Transactions on Machine Learning Research (7/2024)
4.1 Nearly periodic sequence
First, we define a general notion of nearly periodic sequence:
Definition 4.1 (Nearly periodic sequence) .Let(X,d)be a metric space. Let µ≥0and letL∈Z>0. We
say a sequence (yt)∞
t=1⊂Xisµ-nearly periodic of lengthLifd(ys+Lt,ys)< µfor anys,t∈Z>0. We also
callLthe length of the µ-nearly period.
Intuitively, there exist Lballs of diameter µinXand the sequence y1,y2,...moves in the balls in order
if(yt)∞
t=1isµ-nearly periodic of length L. Obviously, nearly periodic sequence of length Lis also nearly
periodic sequence of length mLfor anym∈Z>0. We say a sequence is periodic if it is 0-nearly periodic.
We introduce a notion of aliquot nearly period to treat estimation problems of period:
Definition 4.2 (Aliquot nearly period) .Let(X,d)be a metric space. Let ρ > 0andλ≥1. Assume a
sequence{yt}∞
t=1⊂Xisµ-nearly periodic of lengthLfor someµ≥0andL∈Z>0. A positive integer ℓis a
(ρ,λ)-aliquot nearly period ((ρ,λ)-anp) of(yt)∞
t=1ifℓ|Land the sequence (yt)∞
t=1is(ρ+2λµ)-nearly periodic.
We may identify the (ρ,λ)-anp with a 2λµ-nearly period under an error margin ρ. When we estimate the
lengthLof the nearly period of unknown sequence (yt)t, we sometimes cannot determine the Litself, but
an aliquot nearly period.
Example 4.1. A trajectory of finite dynamical system is always periodic and it is the most simple but
important example of (nearly) periodic sequence. We also emphasize that if we know the upper bound of
the number of underlying space, the period is bounded above by the upper bound as well. These facts are
summarized in Proposition 4.1. The cellular automata on finite cells is a specific example of finite dynamical
systems. We will treat LifeGame Conway et al. (1970), a special cellular automata, in our simulation
experiment (see Section 6).
Proposition 4.1. Letf: Θ→Θbe a map on a set Θ. If|Θ|<∞, then for any t≥|Θ|andθ∈Θ,
ft+L(θ) =ft(θ)for some 1≤L≤|Θ|.
Proof.Since|{θ,f(θ),...,f|Θ|(θ)}|>|Θ|, there exist 0≤i<j≤|Θ|such thatfi(θ) =fj(θ)by the pigeon
hole principal. Thus, ft(θ) =fj−i+t(θ)for allt≥|Θ|.
If a linear dynamical system generates a nearly periodic sequence, we can show the linear system has a
specific structure as follows:
Proposition 4.2. LetM:Rd→Rdbe a linear map. Let Cd=⊕αVαbe the decomposition via generalized
eigenspaces of M, whereαruns over the eigenvalues of MandVα:=N((αI−M)d). Assume that there
existsµ≥0, for anyθ∈Rd,(Mtθ)∞
t=t0isµ-nearly periodic for some t0∈N. Letθ=/summationtext
αθα∈⊕αVα. Then,
each eigenvalue αsuch thatθα̸= 0satisfies|α|≤1, in addition, if|α|= 1andθα̸= 0,Mθα=αθα.
Proof.We note that{Mtv}t≥0is bounded for any v∈Rdby the assumption on M. Thus,Mcannot have
an eigenvalue of magnitude greater than 1. We show that αis in the form of α=ei2πqfor someq∈Qif
|α|= 1. Suppose that α=ei2πγfor an irrational number γ∈R. Then, for an eigenvector wforθαwith
∥w∥Rd>µ,{Mtw}t>t0cannot become a µ-periodic sequence. Thus, we conclude α=ei2πqfor someq∈Q.
Next, we show Mθα=αθαif|α|= 1andθα̸= 0. Suppose (M−αI)θα̸= 0. Since (M−αI)dθα= 0, there
exists 1≤d′<dsuch that (M−αI)d′+1θα= 0but(M−αI)d′θα̸= 0. Letw′:= (M−αI)d′−1θα. Then,
we see that (M−αI)2w′= 0but(M−αI)w′̸= 0. By direct computation, we see that
∥Mtw′∥Rd=∥(M−αI+αI)tw′∥Rd≥t∥(M−αI)w′∥Rd−∥w′∥Rd.
Thus, we have∥Mtw′∥Rd→∞ast→∞, which contradicts the fact that {Mtw′}t≥0is a bounded sequence.
The last statement is obvious.
LetWbe a linear subspace of Cdgenerated by the trajectory {Mθ,M2θ,...}and denote dim(W)byd0.
Note that restriction of MtoWinduces a linear map from WtoW. We denote by Mθthe induced linear
8Published in Transactions on Machine Learning Research (7/2024)
map fromWtoW. LetW=⊕α∈ΛWαbe the decomposition via the generalized eigenspaces of Mθ, where
Λis the set of eigenvalues of MθandWα:=N((αI−Mθ)d0). We define
W=1:=⊕|α|=1Wα,
W<1:=⊕|α|<1Wα.
Then, we have the following statement as a corollary of Proposition 4.2:
Corollary 4.3. There exist linear maps M1,M<1:W→Wsuch that
1.Mθ=M1+M<1,
2.M1M<1=M<1M1=O,
3.M1is diagonalizable and any eigenvalue of M1is of magnitude 1, and
4. any eigenvalue of M<1is of magnitude smaller than 1.
Proof.Letp:W→W=1be the projection and let i:W=1→Wbe the inclusion map. We define
M1:=iMθp. We can construct M<1in the similar manner and these matrices are desired ones.
Example 4.2. LetGbe a finite group and let ρbe a finite dimensional representation of G, namely, a
group homomorphism ρ:G→GLm(C), where GLm(C)is the set of complex regular matrices of size m. Fix
g∈G. LetB∈Cn×nbe a matrix whose eigenvalues have magnitudes smaller than 1. We define a matrix
of sizem+nby
M:=/parenleftbigg
ρ(g) 0
0B/parenrightbigg
.
Then, (Mtx)∞
t=t0is aµ-nearly periodic sequence for any µ>0,x∈Cm, and sufficiently large t0. Moreover,
we know that the length of the nearly period is |G|. We treat the permutation of variables in Rdin the
simulation experiment (see Section 6), namely the case where Gis the symmetric group Sdandρis a
homomorphism from GtoGLd(C)defined by ρ(g)((xj)d
j=1) := (xg(j))d
j=1, which is the permutation of
variable via g.
4.2 Problem setting
Here, we state our problem settings. We use the notation introduced in the previous sections. First, we
summarize our technical assumptions as follows:
Assumption 1 (Conditions on arms) .The set of arms Dcontains the unit hypersphere.
Assumption 2 (Assumptions on noise) .The noise sequence {ηt}∞
t=1is conditionally R-sub-Gaussian ( R∈
R≥0), i.e., given t,
∀λ∈R,E/bracketleftbig
eληt|Ft−1/bracketrightbig
≤eλ2R2
2,
andE[ηt|Ft−1] = 0,Var[ηt|Ft−1]≤R2, where{Fτ}τ∈Nis an ascending family and we assume that
x1,...,xτ+1,η1,...,ητare measurable with respect to Fτ.
Assumption 3 (Assumptions on dynamical systems) .There exists µ > 0such that for any θ∈Θ, the
sequence (ft(θ))∞
t=t0isµ-nearly periodic of length Lfor somet0∈N. We denote by Bθthe radius of the
smallest ball containing {ft(θ)}∞
t=0.
Remark 4.4. Assumption 1 excludes the lower bound arguments of the minimally required samples for
our work since taking sufficiently large vector (arm) makes the noise effect negligible. Considering more
restrictive conditions for discussing lower bounds is out of scope of this work.
Then, our questions are described as follows:
•Can we estimate the length Lfrom the collection of rewards (rt(xt))T
t=1efficiently ?
9Published in Transactions on Machine Learning Research (7/2024)
Algorithm 1 Period estimation (DFT)
Input: Current time t0∈Z>0;Tp;ϵ>0;Lmax>1; orthogonal basis {u1,...,ud}ofRd
Output: Estimated length ˆL
1:ℓ←1;β←1
2:form= 1,...,ddo
3:fort=t0,t0+ 1,...,t 0+Tp−1do
4: Sample arm umand observe rt(um)
5:end for
6:whileℓ·β≤Lmaxdo
7:ℓ←ℓ+ 1
8:for(s,b) = (0,1),(0,2),..., (0,ℓ−1),(1,1),(1,2),..., (β−1,ℓ−1)do
9: if/vextendsingle/vextendsingle/vextendsingleR/parenleftig
(rt0+s+βt(um))⌊Tp/β⌋
t=1 ;b/ℓ/parenrightig
}/vextendsingle/vextendsingle/vextendsingle2
>ϵthen
10: β←βℓ
11: ℓ←1
12: Break
13: end if
14: end for
15:end while
16:t0←t0+Tp
17:end for
18:ˆL←β
•If we assume the dynamical system is linear, can we further obtain the eigenvalues of ffrom a
collection of rewards ?
•How many samples do we need to provably estimate the length Lor eigenvalues of f?
We will answer these questions in the following sections and via simulation experiments.
5 Algorithms and theory
With the above settings in place, we present a (computationally efficient) algorithm for each presented
problem, and show its sample complexity for estimating certain information.
5.1 Period estimation
Here, we describe an algorithm for period estimation followed by its theoretical analysis. The overall pro-
cedure is summarized in Algorithm 1. Line 8 executes concurrent application of filterings . To analyze the
sample complexity of this estimation algorithm, we first introduce an exponential sum that plays a key role:
Definition 5.1. For a positive rational number q∈Q>0andTcomplex numbers a1,...,aT∈C, we define
R/parenleftbig
(at)T
t=1;q) :=1
TT/summationdisplay
j=1ajei2πqj.
For aµ-nearly periodic sequence a:= (at)∞
t=1of lengthL, we define the supremum of the standard deviations
of theLsequential data of a:
σL(a) := sup
t0≥1/radicaltp/radicalvertex/radicalvertex/radicalvertex/radicalbt1
Lt0+L−1/summationdisplay
t=t0/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleat−1
Lt0+L−1/summationdisplay
j=t0aj/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
.
10Published in Transactions on Machine Learning Research (7/2024)
The exponential sum R(·;·)can extract a divisor of the nearly period of a µ-nearly periodic sequence if µ
is “sufficiently smaller” than the variance of the sequence even when the sequence is contaminated by noise;
more precisely, we have the following lemma:
Lemma 5.1. Leta:= (aj)∞
j=1be aµ-nearly periodic sequence of length L. Then, we have the following
statements:
1. ifL>1, then there exists s∈Z>0withs<Lsuch that
/vextendsingle/vextendsingleR/parenleftbig
(aj)T
j=1;s/L/parenrightbig/vextendsingle/vextendsingle>/radicalbigg
σ2−2µσ
L−µ−Lsupt≥1|at|
T, (5.1)
2. ifβis not a divisor of L, then for any α∈Z>0,
/vextendsingle/vextendsingleR/parenleftbig
(aj)T
j=1;α/β/parenrightbig/vextendsingle/vextendsingle<µ+L2C0(µ+ supt≥1|at|)
T, (5.2)
whereC0:= 1 + 2/√
2π(3/4)π2/6= 1.72257196806914 ....
Proof.As(at)∞
t=1isµ-almost periodic, there exist (bt)∞
t=1of periodLand(ct)∞
t=1with supt≥1|ct|<µsuch
thatat=bt+ct.
First, we prove (5.1). Let
˜b:=1
LL/summationdisplay
t=1bt,ˆbq:=1
LL/summationdisplay
t=1btei2πtq,(q∈Q).
We claim that
L·sup{|ˆbs/L|2}L−1
s=1>L−1/summationdisplay
s=1|ˆbs/L|2=1
LL/summationdisplay
t=1|bt−˜b|2≥σ2−2µσ. (5.3)
In fact, the first inequality is obvious. The equality follows from the Plancherel formula for a finite abelian
group (see, for example, (Serre, 1977, Excercise 6.2)). As for the last inequality, take arbitrary t0∈Z>0and
define ˜a=L−1/summationtextt0+L−1
t=t0atand˜c=L−1/summationtextt0+L−1
t=t0ct. Then, we have
1
LL/summationdisplay
t=1|bt−˜b|2≥1
Lt0+L−1/summationdisplay
t=t0|at−˜a|2+1
Lt0+L−1/summationdisplay
t=t0|ct−˜c|2−2
Lt0+L−1/summationdisplay
t=t0|at−˜a|·|ct−˜c|
≥1
Lt0+L−1/summationdisplay
t=t0|at−˜a|2+1
Lt0+L−1/summationdisplay
t=t0|ct−˜c|2
−2/radicaltp/radicalvertex/radicalvertex/radicalbt1
Lt0+L−1/summationdisplay
t=t0|at−˜a|2·/radicaltp/radicalvertex/radicalvertex/radicalbt1
Lt0+L−1/summationdisplay
t=t0|ct−˜c|2
≥1
Lt0+L−1/summationdisplay
t=t0|at−˜a|2−2µσ.
Here, we used the Cauchy-Schwartz inequality in the second inequality. Since t0is arbitrary, we have (5.3).
Lets∈argmaxs=1,...,L−1|ˆbs/L|2and letq:=s/L. LetT=LT′+γfor someT′,γ∈Nwith 0≤γ < L.
Then, we have
/vextendsingle/vextendsingleR/parenleftbig
(aj)T
j=1;q/parenrightbig/vextendsingle/vextendsingle≥/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
T′T′−1/summationdisplay
t=0/bracketleftigg
1
LL/summationdisplay
s=1aLt+sei2πqs/bracketrightigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle−Lsupt≥1|at|
T
>|ˆbq|−µ−Lsupt≥1|at|
T
≥/radicalbigg
σ2−2µσ
L−µ−Lsupt≥1|at|
T.
11Published in Transactions on Machine Learning Research (7/2024)
Next, we prove (5.2). As in the same computation as above, we have
/vextendsingle/vextendsingleR/parenleftbig
(aj)T
j=1;α/β/parenrightbig/vextendsingle/vextendsingle≤LT′
T/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
T′T′−1/summationdisplay
t=0ei2παLt/β/bracketleftigg
1
LL/summationdisplay
s=1aLt+sei2παs/β/bracketrightigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle+Lsupt>0|at|
T
<LT′
T/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
T′T′−1/summationdisplay
t=0ei2παLt/β/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle·/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
LL/summationdisplay
s=1bsei2παs/β/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle+µ+Lsupt>0|at|
T
<2/vextendsingle/vextendsingle1−ei2παL/β/vextendsingle/vextendsingle·/parenleftbigg
µ+ sup
t≥1|at|/parenrightbigg
·L
T+µ+Lsupt>0|at|
T.
Since|1−ei2πa|≥√
2(1−a2)π2/6afora∈(0,1)by (Chesneau & Bagul, 2020, Proposition 3.2), we have
/vextendsingle/vextendsingleR/parenleftbig
(aj)T
j=1;α/β/parenrightbig/vextendsingle/vextendsingle</parenleftbigg
µ+ sup
t≥1|at|/parenrightbigg2βL√
2(3/4)π2/6T+µ+Lsupt≥1|at|
T
<µ+LβC0(µ+ supt≥1|at|)
T.
Then, we obtain the explicit lower bound of the samples for period estimation:
Proposition 5.2. Leta:= (at)∞
t=1be aµ-nearly periodic sequence of length L. Fix a positive integer
Lmax>1withL≤Lmax,δ∈(0,1),ξ∈(0,1), andσ0>0. Let (ηt)∞
t=1be a noise sequence satisfying
Assumption 2. Put γ:= 1/(1 +√4Lmax+ 1)andλ:=µ/(σ0γ). We define
ε:=σ0γξ.
Ifµ/(γξ)<σ0≤σL(a), then, for any
T≥8LmaxR2log(4/δ)
σ2
0(ξ−λ)2+36L5/2
maxsupt≥1|at|
σ0(ξ−λ),
the set of rational numbers
ST,ε:=/braceleftbig
q∈Q∩(0,1) :qL∈Z>0and/vextendsingle/vextendsingleR/parenleftbig
(at+ηt)T
t=1;q/parenrightbig/vextendsingle/vextendsingle>ε/bracerightbig
is non-empty with probability at least 1−δ.
If we apply several collections of rewards (rt(xt))T
t=1for sufficiently large Tindicated in Proposition 5.2,
we obtain various divisors of L. Finally, we provide the precise inputs and output of Algorithm 1 in the
following Theorem:
Theorem 5.3. Suppose Assumptions 1, 2 and 3 hold. Let r∈[0,1)be a non-negative real number, and
supposeρ>0andδ∈(0,1)are given. Fix a positive integer Lmax>1withL≤Lmax. We define
ε:=ρ
6√
dLmax. (5.4)
Assume that rε≥µ. LetTpbe an integer satisfying
Tp≥72dAL2
max
ρ2(1−r)2+108Bθ√
dL3
max
ρ(1−r), (5.5)
whereA:=R2log(4dL2
maxlogLmax/δ). Then, the output ˆLof Algorithm 1 is a (ρ,√
d)-anp of (ft(θ))∞
t=t0
with probability at least 1−δ.
Ifµis sufficiently small, we may set ras a small positive number, in particular r= 0if the system is periodic.
Remark 5.4. If random arm selection is adopted rather than the orthogonal basis, it may underestimate an
error margin on some dimensions, which could lead to the nearly period with much larger error margin than
expected; considering failure probability of such a case may potentially produce a variant of our algorithm.
12Published in Transactions on Machine Learning Research (7/2024)
Algorithm 2 Eigenvalue estimation
Input: Effective sample size N∈Z>0; threshold γ(N)
Output: MatrixA1(N)ˆA0(N)†
1:Independently draw random unit vectors ˜xm, m∈[d], from uniform distribution over the unit sphere
inRd.
2:WaitNtime steps.
3:fort=N+ 1,···,N+ 2Nd2do
4:m0←{(t−N−1) mod 2d2}+ 1
5:m←⌈m0/2d⌉
6:Sample arm xt= ˜xmand observe ˜rt:=rt(˜xm).
7:end for
8:Construct matrices A0(N)andA1(N)as in (5.6), respectively.
9:Obtain the low rank approximation ˆA0(N)ofA0(N)via SVD with the threshold γ(N).
10:OutputA1(N)ˆA0(N)†.
5.2 Eigenvalue estimation
If the underlying system has certain structures, more detailed information about the system is expected to
be obtained. In this section, we assume the following condition, linearity of the underlying dynamical system
fonΘ, in addition to Assumption 1, 2, and 3:
Assumption 4 (Linear dynamical systems) .The dynamical system f: Θ→Θis linear and is represented
by a matrix M∈Rd×d.
LetCd=⊕αVαbe the decomposition via generalized eigenspaces of M, whereαruns over the eigenvalues
ofMandVα:=N((αI−M)d). We describe θ=/summationtext
αθαwithθα∈Vα. We remark that an eigenvalue αof
Msuch thatθα̸= 0is in the form of e2πiℓ/Lunless|α|<1by Proposition 4.2.
Our objective is to estimate some of, if not all of, the eigenvalues of Mwith high probability within some
error that decreases by the sample size. To this end, we define the meaningful subset of eigenvalues of M.
Definition 5.2 ((θ,k)-distinct eigenvalues) .For a vector θ∈Cdandk∈Z>0, we define a (θ,k)-distinct
eigenvalue by an eigenvalue βofMksuch that|β|= 1andθβ̸= 0.
In our case, starting from a vector θ, the effect of the eigenvalues that are not of (θ,d)-distinct eigenvalues
ofMmay not be observable. Basically, once being able to ignore the effects of eigenvalues of magnitudes
less than 1, the system becomes nearly periodic and we aim at estimating (θ,d)-distinct eigenvalues as we
obtain more samples.
Our eigenvalue estimation algorithm is summarized in Algorithm 2; it maintains the following matrices. For
N∈Z>0,drandom unit vectors ˜x1,..., ˜xd, ands= 0,1, we define the matrix As(N)∈Cd×dso that its
(k,ℓ)element is given by
N−1/summationdisplay
j=0r2(k−1)d+sd+2d2j+N+ℓ(˜xk)ei2πj2
4L. (5.6)
That is, after Nsteps, the reward multiplied by exp(i2πj2/4L)is placed from the top row of A0and then the
top row ofA1, followed by the second rows of them, and so on. Then, those values are summed up for every
2d2steps or every jth cycle. Here, after throwing away Nsamples, the effects of eigenvalues of magnitude
less than 1become negligible, and the trajectory becomes nearly periodically behaved under Assumption
4. The rest of the samples is used to average out the observation noise while maintaining some meaningful
information about M.
TheaforementionedexponentialsumcanbecharacterizedbytheWeyl-typesumofmatrices, akeymachinery
for our algorithm, which we define below:
13Published in Transactions on Machine Learning Research (7/2024)
Definition 5.3. LetWbe a linear space and let M1,...,MNforN∈Z>0be linear maps on W. For
L∈Z>0, we define
W((M1,...,MN)) :=1
NN−1/summationdisplay
j=0Mj+1ei2πj2
4L.
Remark 5.5. LetEs,n:= (η2di+N+sd+j+1+2d2n)i,j=0,...,d−1be a noise matrix for s= 0,1. Let
X:=
˜x⊤
1M1
x⊤
2M2d+1
...
˜x⊤
dM2(d−1)d+1
andK:= (Mθ,...,Mdθ).
Then,As(N)has an alternative description as follows:
As(N) =XW/parenleftig
(M2d2j)N−1
j=0/parenrightig
Msd+N−1K+W/parenleftbig
(Es,j)N−1
j=0/parenrightbig
. (5.7)
As in Proposition 5.7 below, the Weyl-type sum has a crucial property. Define κ≥1by
κ:= inf
P/braceleftbig
∥P∥∥P−1∥:P−1MP =JM/bracerightbig
,
whereJMis a Jordan normal form of M. Also, we define ∆∈(0,1]to be a value such that, for any eigenvalue
αofMsatisfying|α|<1,|α|≤1−∆(define ∆ = 1if no such eigenvalue exists). Note by Proposition 4.2,
the existence of such spectral gap is guaranteed without any further assumptions.
Roughly speaking, Algorithm 2 estimates “ A1(N)A0(N)−1=XMdX−1”. Of course, the formula in “...” is
notvalidas X,K,andtheWeyl-typesumarenotnecessarilyinvertibleandwecannotrecoverfullinformation
ofMdin general. However, we can still reconstruct information of Mdrestricted on the eigenspaces for (θ,d)-
distinct eigenvalues.
To see this, we introduce the Weyl sum and its lower bound:
Lemma 5.6 (Lower bound on the Weyl sum Bourgain (1993); Oh) .Define the Weyl sum by
W(N,b,q ) :=N/summationdisplay
j=0ei2π(j2b
4q+j21
4q),
for someb∈N, q∈Z>0, b<qandN∈Z>0. Then, for N≥16q2, it holds that
|W(N,b,q )|∈Ω/parenleftbiggN√q/parenrightbigg
.
Proof.It is immediate from Proposition 3.1 in Oh because gcd(1,4q) = 1,4q≡0 mod 4 , and 2bis even.
We defineCws(L)>0by
Cws(L) := inf/braceleftbigg
C > 0 :C−1</vextendsingle/vextendsingle/vextendsingle/vextendsingle1
NW(N,b,L )/vextendsingle/vextendsingle/vextendsingle/vextendsingle<Cfor anyN≥16L2,0≤b<L/bracerightbigg
.
Then, we have the following proposition:
Proposition 5.7. LetM1andM<1be matrices as in Corollary 4.3. We define linear maps on Wby
QN(M1) :=W/parenleftig
(M2d2j
1)N−1
j=0/parenrightig
QN(M<1) :=W/parenleftig
(M2d2j
<1)N−1
j=0/parenrightig
.
Then, we have the following statements:
14Published in Transactions on Machine Learning Research (7/2024)
1.W/parenleftig
(M2d2j
θ)N−1
j=0/parenrightig
=QN(M1) +QN(M<1),
2. for anyN≥16L2,QN(M1)is invertible on W=1,
3. for anyr≥0and for any N≥16L2,∥Mr
1QN(M1)|W=1∥,∥(Mr
1QN(M1))|−1
W=1∥≤κCws(L),
4. for anyr≥2(d−1), we have
∥Mr
<1QN(M<1)∥≤d2κe−∆(r−d+1)
N∆d−1.
Proof.We prove 1. By the properties 1 and 2 in Corollary 4.3, we have W((M2d2j)N−1
j=0) =QN(M1) +
QN(M<1). Next, we prove 2. When we regard QN(M1)|W=1as a linear map on W=1, it is represented
as a diagonal matrix diag(W(N,b 1,L),...,W(N,bm,L)), wherem= dimW=1. Therefore, by Lemma 5.6,
QN(M1)is a bijective linear map on W=1. Next, we prove 3. We estimate ∥Mr
1QN(M1)∥. Letp:Cd→W
be the orthogonal projection and let i:W→Cdbe the inclusion map. Let ˜M1:=iM1p∈Cd×d. Then, we
have
∥QN(M1)∥=∥QN(˜M1)∥≤κCws(L).
Next, we estimate ∥Mr
<1QN(M<1)∥. Let ˜M<1:=iM<1p. Then,iMr
<1QN(M<1)p=W((˜M2d2j+r
<1 )N−1
j=0)and
∥iMr
<1QN(M<1)p∥=∥Mr
<1QN(M<1)∥. LetPbe a regular matrix such that
˜M<1=PJP−1,
whereJis the Jordan normal form. Then, for r≥2(d−1), we see that
∥Mr
<1QN(M<1)∥=∥iMr
<1QN(M<1)p∥
≤κ
NN−1/summationdisplay
j=0∥J2d2j+r∥<d2κ
N∞/summationdisplay
j=0/parenleftbigg2d2j+r
d−1/parenrightbigg
(1−∆)2d2j+r−d+1
≤d2κ(1−∆)r−d+1
N∆d−1≤d2κe−∆(r−d+1)
N∆d−1.
The second last inequality is proved as follows: for |a|<1,n≥1andr≥m≥0,
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle∞/summationdisplay
j=0/parenleftbiggnj+r
m/parenrightbigg
anj−m+r/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
m!dm
dxm∞/summationdisplay
j=0xnj+r/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
x=a/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤1
m!m/summationdisplay
j=0/parenleftbiggm
j/parenrightbiggr!
(r−m+j)!|a|r−m+j/vextendsingle/vextendsingle/vextendsingle/vextendsingledj
dxj1
1−xn/vextendsingle/vextendsingle/vextendsingle/vextendsingle
x=a/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤1
m!m/summationdisplay
j=0/parenleftbiggm
j/parenrightbiggr!
(r−m+j)!j!|a|r−m+j
(1−|a|)j=m/summationdisplay
j=0/parenleftbiggr
j/parenrightbigg|a|r−m+j
(1−|a|)j,
where, the last inequality follows from
/vextendsingle/vextendsingle/vextendsingle/vextendsingledm
dxm1
1−xn/vextendsingle/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
ζn=1m!ζ1−n
n(ζ−x)m/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤m!
(1−|x|)m.
Thus, we have
m/summationdisplay
j=0/parenleftbiggr
j/parenrightbigg|a|r−m+j
(1−|a|)j≤|a|r−mr/summationdisplay
j=0/parenleftbiggr
j/parenrightbigg/parenleftbigg|a|
1−|a|/parenrightbiggj
≤|a|r−m
(1−|a|)m.
15Published in Transactions on Machine Learning Research (7/2024)
Proposition 5.7 plays an essential role in our analysis and guarantees that the information in As(N)about
(θ,d)-distinct eigenvalues does not vanish while noise effects are canceled out. Now, we state our main
theoretical result for the eigenvalue estimation algorithm. Before stating the theorem, we introduce lower
rank approximation via the singular value threshold.
Definition 5.4. LetA∈Cn×mbe a matrix. Let A=U(D O)V∗be a singular valued decompo-
sition ofAwhereU∈Cn×nandV∈Cm×mare unitary matrices and D:= diag(σ1,...,σr,o⊤)is
a diagonal matrix with nonnegative components. Let γ > 0. We define a low rank approximation
AγofAvia the singular value threshold γby the matrix Aγdefined by Aγ=U(DγO)V∗, where,
Dγ:= diag( 1[γ,∞)(σ1)σ1,...,1[γ,∞)(σr)σr,o⊤)and1Iis defined to be the characteristic function supported
onI⊂R.
Given this definition, we are ready to present the following main result:
Theorem 5.8. Suppose Assumptions 1, 2, 3, and 4 hold. Given δ∈(0,1], let the effective sample size
N≥max/braceleftbigg
16L2,−(d−1) log ∆
∆+log(Bθκ2) +d+ 6
∆+d/bracerightbigg
, (5.8)
andγ(N) = (/radicalbig
4d2R2log (4d2/δ) + 1)/√
N. Then, there exists a matrix Awhose eigenvalues are zeros
except for (θ,d)-distinct eigenvalues of M, such that the output of Algorithm 2, i.e. A1(N)ˆA0(N)†, satisfies,
with probability at least 1−δ, that
/vextenddouble/vextenddouble/vextenddoubleA−A1(N)ˆA0(N)†/vextenddouble/vextenddouble/vextenddouble≤C/parenleftbiggR2(log (1/δ) + 1) + 1√
N/parenrightbigg
. (5.9)
Here, ˆA0(N)†is the Moore-Penrose pseudo inverse of a lower rank approximation of A0(N)via the singular
value threshold γ(N). The constant C > 0depends on θ,M,d,(˜xm)d
m=1, andCws(L).
We mention that by using the results shown in Song (2002), the bound on spectral norm (5.9) can be
translated to the bounds on eigenvalues, where the constant depends on the form of A. As described in
Theorem 5.8, the constant is not the absolute constant for any problem instance but depends on several
factors; however, for the same execution, this rate is useful to judge how many samples one collects to
estimate eigenvalues.
Remark 5.9. We note that we can reconstruct the (θ,1)-distinct eigenvalues of Mvia Algorithm 2 using
the following trick: Fix non-negative integer r≥0. Taked+rrandom unit vectors ˜x1,..., ˜xd+r. Then, for
s= 0,1, we may define a matrix As(N;r)∈C(d+r)×(d+r)so that its (k,ℓ)element is given by
N−1/summationdisplay
j=0r2(k−1)(d+r)+s(d+r)+2(d+r)2j+N+ℓ(˜xk)ei2πj2
4L.
Then, weseethatAlgorithm2outputsamatrix ˜A(r)thatwellapproximatesthe (θ,d+r)-distincteigenvalues
ofMsince the matrix As(N;r)coincides with As(N)in the case when we replace MandθwithM(r)and
θ(r)defined by
M(r) :=/parenleftbigg
M O
O O/parenrightbigg
∈C(d+r)×(d+r),θ(r) :=/parenleftbigg
θ
o/parenrightbigg
∈Cd+r.
Letrbe an integer such that r+dis prime to Land fix a positive integer msuch thatm(r+d)≡1 modL.
Then, the eigenvalues of ˜A(r)mis close to those of (θ,1)-distinct eigenvalues if we take sufficiently large N.
6 Simulated experiments
In this section, we present simulated experiments that complement the theoretical claims. In particular,
we conducted period estimations for an instance of LifeGame Conway et al. (1970), which is a special case
16Published in Transactions on Machine Learning Research (7/2024)
Figure 5: Left: Illustration of a period eight instance of LifeGame; (top) original transitions. (down) an instance of
noisy observation. Right: µ-nearly periodic dynamics (6.1).
of cellular automata Von Neumann et al. (1966), and for a nearly periodic toy system, and an eigenvalue
estimation for a linear system, where some dimensions are for permutations and the rest is for shrinking.
Period estimation: LifeGame. We use a specific instance of LifeGame which is illustrated in Figure 5.
As shown on the top eight pictures, starting from certain configuration of cells, it shows transitions of period
eight. The sample size is computed as the smallest integer satisfying (5.5), and the threshold εis given by
(5.4). To prevent the dimension from becoming too large, we used five cells that correctly display period
eight; that is d= 5. Noiseηtis given by i.i.d. Gaussian with proxy R= 0.3, and the down eight pictures
of Figure 5 are some instances of noisy observations. We tested 50 different random seeds (i.e., 1, 51, 101,
151, ... , 2451), and computed the error rate (the number of runs producing a wrong estimate other than
the fundamental period eight, which is divided by 50); and it was zero.
Period estimation: Simple µ-nearly periodic system. We consider the following µ-nearly periodic
system that circulates over a circle with small variations:
rt+1=µ/parenleftbigg
αrt−1
µ−⌈αrt−1
µ⌉/parenrightbigg
+ 1, θt+1=θt+2π
L, (6.1)
whererandθare the radius and angle, and α /∈Q. We useµ= 0.001,L= 5, andα=π. Noiseηtis drawn
i.i.d. from the uniform distribution within [−R,R]forR= 0.3. We tested 50 different random seeds (i.e., 1,
51, 101, 151, ... , 2451), and computed the error rate; and it was zero.
Eigenvalue estimation: Permutation and shrink. We used= 5, andM∈R5×5is made such that 1)
the first four dimensions are for permutation (i.e., each of row and column of 4×4sub-matrix has only one
nonzero element that is one.), and 2) the last dimension is simply shrinking; we gave 0.7for(5,5)-element of
M. Initial vector θ0and each arm ˜xm, m∈[d],are uniformly sampled from the unit sphere in R5. The value
Lis computed by 4! = 24. We used the smallest integer Nthat satisfies (5.8), multiplied by Csim>0. The
results are shown in Table 1; it is observed that the more samples we use the more accurate the estimates
become to (θ0,5)-distinct eigenvalues of M. Noiseηtis drawn i.i.d. from the uniform distribution within
[−R,R]forR= 0.3, and the Table 1 is of the random seed 1234. We also tested 50 different random seeds
(i.e., 1, 51, 101, 151, ... , 2451) for Csim= 30, and computed the mean absolute error between the true
(θ0,5)-distinct eigenvalues and their nearest estimated values; it was 0.0019, which is sufficiently small.
Attempt on applications to more realistic data: Worm simulation. Finally, we present an attempt
on applications to more realistic situation, which will demonstrate some of the important aspects that need
to be taken into account when naively applying our algorithms to the real world problems. In particular,
we use OpenWorm (https://openworm.org/) (Szigeti et al., 2014) to simulate a worm motion (we ran more
than around 10hours for simulations); example images from this simulation is shown in Figure 6 (left). It is
known that the behavior of worm has some periodicity (e.g., Ahamed et al. (2021)). We resized the images
to6×6(i.e.,d= 36), and downsampled the video by extracting one per eight images. Also, we repeat the
same video in the way that the entire video still shows smooth flow (i.e., cut the video so that the end image
is similar to the image in the beginning, and concatenate the same videos) so that we can sample a large
number of data.
17Published in Transactions on Machine Learning Research (7/2024)
Table 1: Results for the eigenvalue estimation. The top-most row shows the true eigenvalues of M5, and the second
row shows its (θ0,5)-distinct eigenvalues. From the third to sixth row, it shows the estimated eigenvalues for different
values ofCsim.
eigenvalues of M51.000 1.000−0.500−0.866i−0.500 + 0.866i0.168
(θ0,5) 1.000 0−0.500−0.866i−0.500 + 0.866i 0
whenCsim= 1 1.000 + 0.008i 0−0.489−0.860i−0.510 + 0.869i 0
whenCsim= 5 0.999−0.000i 0−0.495−0.867i−0.501 + 0.862i 0
whenCsim= 10 1.000 + 0.003i 0−0.497−0.867i−0.501 + 0.864i 0
whenCsim= 30 1.000 + 0.001i 0−0.500−0.866i−0.500 + 0.864i 0
Figure 6: Left: OpenWorm (https://openworm.org/) simulation of a worm motion. Middle: The extracted sequence
of images with 6×6resolution for our experiment. Right: Diagram of how the worm motion is viewed as a (nearly)
periodic motion.
First, we assume we have no access to reasonable values for the hyperparameters, and show what happens
when we use hyperparameters that do not reflect the target system. With such a choice of parameters (see
Appendix F.4), the algorithm outputs an estimate that contradicts to the hyperparemters; with the value
Lmax= 25, it outputs the estimate 40. In particular, there exist dimensions that output the estimates 8
and20, from which the final estimate becomes 40. Note that, in this experiment, we use a fixed number of
samplesTpsince we have no access to the reasonable hyperparameters. On the other hand, we increased the
marginρsignificantly, and then the output becomes 20≤Lmaxwhere each dimension shows 1or20in this
case. In fact, one segment of our video data (recall we concatenate the same video to create a sequence of
an indefinite number of images) consists of 120images and contains 6periods of sequence.
We mention that the aforementioned fact implies that the choice of hyperparameters may be practically
validated by confirming that the outputs are consistent to the parameters.
Next, we assume that the system is linear and run the DMD over this canonical basis of the state space. Let
MDMDbe the solution to the exact DMD over the video data, and we compute the eigenvalues of Md
DMDand
of the output of Algorithm 2. We tested the algorithm with the fixed hyperparameters given in Appendix
F.4 and with varying number of N, namely, 103,104, and 105. For the cases of 103and104, we only obtained
one eigenvalue which is close to 1 + 0iand the others were almost zero. For N= 105, we obtained three
nonzero eigenvalues which are plotted in Figure 7 against the top four eigenvalues of Md
DMD. The actual
nonzero eigenvalues and the estimated errors for all three cases are given in Table 2.
From the results, we argue that, for some real applications where the system is not exactly linear, the
eigenvalue estimation algorithm may not work well although it does not output insanevalues.
18Published in Transactions on Machine Learning Research (7/2024)
Figure 7: Estimated eigenvalues having large magni-
tudes (red) and the top four DMD eigenvalues (blue).NNonzero eigenvalues Errors
1031.000 + 0.002i 0.199
1041.000 + 0.002i 0.199
1.001 + 0.001i
1050.288 + 0.884i 0.172
0.290 + 0.867i
Table 2: Estimated nonzero eigenvalues for N =
103,104,105, and the total errors to the true DMD matrix
Md
DMD.
7 Discussion and conclusion
This work proposed novel algorithms for estimating periodic information about the dynamical systems from
bandit feedback contaminated by a sub-Gaussian noise. Since we consider a rather novel problem setup, the
setting itself would be seen as a limitation of our work, and we present a potentially important list of future
works below.
Choice of hyperparameters such as Lmax,N:If those hyperparameters are correctly chosen for nearly
periodic systems, the outputs of our algorithms are consistent and reasonable across runs, which follows
the theoretical insights; therefore, practically, one can check if the hyperparameters are properly chosen
by running the algorithms. Refer to Section 6 for related discussions; in short, inappropriate choice of
hyperparameters leads to contradicting outputs (e.g., period estimate larger than the assumed maximum
value). On the other hand, studying if it is possible to theoretically ensure correctness of hyperparameters
(e.g., by standard doubling trick (Cesa-Bianchi et al., 1997) for efficient guessing) or to identify non-periodic
systems is an important future work.
Extensiontogeneralspectruminformationestimationproblems: Weonlyimposenearlyperiodicity
on the dynamical systems on top of the linearity for the eigenvalue estimation problem. Nevertheless,
additional studies are needed to allow other forms of observations (not limited to bandit feedback) and
non-periodic systems to consider eigenvalues with arguments of 2πtimes irrational numbers. Actually, the
asymptotic bounds of the Weyl sum themselves are still valid when it is sufficiently well approximated
by a rational number (Bourgain, 1993; Oh). Moreover, allowing control inputs would make eigenvalues of
magnitudes smaller than one efficiently recoverable.
Extensions to random dynamical systems: This work studied deterministic dynamical systems; how-
ever, we conjecture that, under the condition that the variance of trajectories generated by a random dynam-
ical system (RDS) (cf. Arnold (1998)) is sufficiently small, the similar estimation procedure is adopted for
such RDSs. It is important to study if the estimation problem becomes easier when the system is driven by
a particular noise as it could be treated as a random control input. Also, studying other dynamic structures
such as the Lyapunov exponents for nonlinear systems is an interesting future work.
Study of statistical estimation leveraged by other number theoretical results: The proper use of
exponential sums enables us to average out the noise while preserving particular information. Studying when
this separation is feasible for different sets of information, noise, and class of problems should be important.
Optimality of the results: Although we gave a sufficient number of samples for provably guaranteeing
(approximate) correctness of the estimates, it is unclear if our sample complexity is what one can best
achieve under particular problem settings. Recall that the current problem settings without an assumption
19Published in Transactions on Machine Learning Research (7/2024)
on boundedness of the set of arms Dexclude the lower bound arguments of the minimally required samples
as mentioned in Remark 4.4.
As such, instead of arguing the tightness, to justify the complexity of our algorithms, we hence mention that
the very naive approach for (nearly) period estimation would cost the order of Lmax!sample complexity. To
see this, suppose we know the maximum possible (nearly) period Lmaxthen it follows that Lmax!is a true
(nearly)periodasamultipleofthefundamental(nearly)period. Assuch, onecouldemploytheconcentration
of measures to average out the sample. With sufficiently many sequences of length Lmax!depending on the
rate of concentration, one could approximately reconstruct the original (noiseless) sequence of length Lmax!
from which one could estimate a desired L≤Lmaxwhich is an (aliquot) nearly period.
Lower bound of the minimally required samples may be discussed by using similar arguments to the best arm
identification problems (cf. Kaufmann et al. (2016)); however, our problems consider dynamical systems,
and we have no clue on potential technical tools to deal with the arguments at this point.
Acknowledgments
We thank the constructive comments by anonymous reviewers for improving this work. Motoya Ohnishi
thanks Sham Kakade, Yoshinobu Kawahara, Emanuel Todorov, Jacob Sacks, Tomoharu Iwata, and Hiroya
Nakao for valuable discussions and thanks Sham Kakade for computational supports. This work of Motoya
Ohnishi, Isao Ishikawa, and Masahiro Ikeda was supported by JST CREST Grant, Number JPMJCR1913,
including AIP challenge program, Japan. Also, Motoya Ohnishi is supported in part by Funai Overseas
Fellowship. Isao Ishikawa is supported by JST ACT-X Grant, Number JPMJAX2004, Japan. This work of
Yuko Kuroki was supported by Microsoft Research Asia and JST ACT-X JPMJAX200E.
References
Y. Abbasi-Yadkori, D. Pál, and C. Szepesvári. Improved algorithms for linear stochastic bandits. Advances
in neural information processing systems , 24, 2011.
N. Abe and P. M. Long. Associative reinforcement learning using linear probabilistic concepts. In ICML,
pp. 3–11, 1999.
J. Adams, N. Hansen, and K. Zhang. Identification of partially observed linear causal models: Graphical
conditions for the non-Gaussian and heterogeneous cases. Advances in Neural Information Processing
Systems, 34, 2021.
C. Aerts, G. Molenberghs, M. Michielsen, MG. Pedersen, R. Björklund, C. Johnston, JSG. Mombarg, DM.
Bowman, B. Buysschaert, PI. Pápics, et al. Forward asteroseismic modeling of stars with a convective
core from gravity-mode oscillations: parameter estimation and stellar model selection. The Astrophysical
Journal Supplement Series , 237(1):15, 2018.
T. Ahamed, A. C. Costa, and G. J. Stephens. Capturing the continuous complexity of behaviour in
Caenorhabditis elegans. Nature Physics , 17(2):275–283, 2021.
R. M. Allen and H. Kanamori. The potential for earthquake early warning in southern California. Science,
300(5620):786–789, 2003.
F. J. Anscombe. Sequential medical trials. Journal of the American Statistical Association , 58(302):365–383,
1963.
G. I. Arkhipov, V. N. Chubarikov, and A. A. Karatsuba. Trigonometric Sums in Number Theory and
Analysis. De Gruyter, Berlin, New York, 2004.
L. Arnold. Random dynamical systems . Springer-Verlag, 1998.
P. Auer. Using confidence bounds for exploitation-exploration trade-offs. Journal of Machine Learning
Research , 3:397–422, 2003.
20Published in Transactions on Machine Learning Research (7/2024)
P. Auer, Y. Chen, P. Gajane, C. Lee, H. Luo, R. Ortner, and C. Wei. Achieving optimal dynamic regret
for non-stationary bandits without prior information. In Conference on Learning Theory , pp. 159–163.
PMLR, 2019.
J. Bakarji, K. Champion, J. N. Kutz, and S. L. Brunton. Discovering governing equations from partial
measurements with deep delay autoencoders. arXiv preprint arXiv:2201.05136 , 2022.
A. Bennett and N. Kallus. Proximal reinforcement learning: Efficient off-policy evaluation in partially
observed Markov decision processes. arXiv preprint arXiv:2110.15332 , 2021.
O. Besbes, Y. Gur, and A. Zeevi. Stochastic multi-armed-bandit problem with non-stationary rewards.
Advances in neural information processing systems , 27, 2014.
J. Bezanson, A. Edelman, S. Karpinski, and V. B. Shah. Julia: A fresh approach to numerical computing.
SIAM review , 59(1):65–98, 2017.
M. A. Bhouri and P. Perdikaris. Gaussian processes meet NeuralODEs: A Bayesian framework for learning
the dynamics of partially observed systems from scarce and noisy data. arXiv preprint arXiv:2103.03385 ,
2021.
J.Bourgain. Fouriertransformrestrictionphenomenaforcertainlatticesubsetsandapplicationstononlinear
evolution equations. Geometric & Functional Analysis GAFA , 3(3):209–262, 1993.
S.BubeckandN.Cesa-Bianchi. Regretanalysisofstochasticandnonstochasticmulti-armedbanditproblems.
Foundations and Trends ®in Machine Learning , 5:1–122, 2012.
H. Cai, Z. Cen, L. Leng, and R. Song. Periodic-GP: Learning periodic world with Gaussian process bandits.
arXiv preprint arXiv:2105.14422 , 2021.
E. J. Candes, J. K. Romberg, and T. Tao. Stable signal recovery from incomplete and inaccurate measure-
ments.Communications on Pure and Applied Mathematics: A Journal Issued by the Courant Institute of
Mathematical Sciences , 59(8):1207–1223, 2006.
M. Casdagli, S. Eubank, J. D. Farmer, and J. Gibson. State space reconstruction in the presence of noise.
Physica D: Nonlinear Phenomena , 51(1-3):52–98, 1991.
N. Cesa-Bianchi, Y. Freund, D. Haussler, D. P. Helmbold, R. E. Schapire, and M. K. Warmuth. How to use
expert advice. Journal of the ACM , 44(3):427–485, 1997.
Y. Chen, C. Lee, H. Luo, and C. Wei. A new algorithm for non-stationary contextual bandits: Efficient,
optimal and parameter-free. In Conference on Learning Theory , pp. 696–726. PMLR, 2019.
C. Chesneau and Y. J. Bagul. A note on some new bounds for trigonometric functions using infinite products.
Malaysian Journal of Mathematical Sciences , 14:273–283, 07 2020.
W. Cheung, D. Simchi-Levi, and R. Zhu. Hedging the drift: Learning to optimize under nonstationarity.
Management Science , 68(3):1696–1713, 2022.
J. Conway et al. The game of life. Scientific American , 223(4):4, 1970.
R. Couillet and M. Debbah. Random matrix methods for wireless communications . Cambridge University
Press, 2011.
S. Curi, F. Berkenkamp, and A. Krause. Efficient model-based reinforcement learning through optimistic
policy search and planning. Advances in Neural Information Processing Systems , 33:14156–14170, 2020.
V. Dani, T. P. Hayes, and S. M. Kakade. Stochastic linear optimization under bandit feedback. In 21st
Annual Conference on Learning Theory , pp. 355–366, 2008.
S. A. Derevyanko, J. E. Prilepsky, and S. K. Turitsyn. Capacity estimates for optical transmission based on
the nonlinear Fourier transform. Nature communications , 7(1):12710, 2016.
21Published in Transactions on Machine Learning Research (7/2024)
D. L. Donoho. Compressed sensing. IEEE Trans. Information Theory , 52(4):1289–1306, 2006.
M.F.Duarte, M.A.Davenport, D.Takhar, J.N.Laska, T.Sun, K.F.Kelly, andR.G.Baraniuk. Single-pixel
imaging via compressive sampling. IEEE Signal Processing Magazine , 25(2):83–91, 2008.
Y. C. Eldar and G. Kutyniok. Compressed sensing: theory and applications . Cambridge university press,
2012.
C. Furusawa and K. Kaneko. A dynamical-systems view of stem cell biology. Science, 338(6104):215–217,
2012.
E. Hazan. Introduction to online convex optimization. Foundations and Trends ®in Optimization , 2(3-4):
157–325, 2016.
E. Hazan, H. Lee, K. Singh, C. Zhang, and Y. Zhang. Spectral filtering for general linear dynamical systems.
Advances in Neural Information Processing Systems , 31, 2018.
M. E. Hughes, K. C. Abruzzi, R. Allada, R. Anafi, A. B. Arpat, G. Asher, P. Baldi, C. De Bekker, D. Bell-
Pedersen, J. Blau, et al. Guidelines for genome-scale analysis of biological rhythms. Journal of Biological
Rhythms , 32(5):380–393, 2017.
S. Kakade, A. Krishnamurthy, K. Lowrey, M. Ohnishi, and W. Sun. Information theoretic regret bounds for
online nonlinear control. Advances in Neural Information Processing Systems , 33:15312–15325, 2020.
N. M. Katz. Exponential Sums and Differential Equations. (AM-124) . Princeton University Press, 1990.
E. Kaufmann, O. Cappé, and A. Garivier. On the complexity of best-arm identification in multi-armed
bandit models. The Journal of Machine Learning Research , 17(1):1–42, 2016.
J. N. Kutz, S. L. Brunton, B. W. Brunton, and J. L. Proctor. Dynamic mode decomposition: data-driven
modeling of complex systems . SIAM, 2016.
S. Lale, K. Azizzadenesheli, B. Hassibi, and A. Anandkumar. Logarithmic regret bound in partially ob-
servable linear dynamical systems. Advances in Neural Information Processing Systems , 33:20876–20888,
2020.
T. Lattimore and C. Szepesvári. Bandit algorithms . Cambridge University Press, 2020.
A. X. Lee, A. Nagabandi, P. Abbeel, and S. Levine. Stochastic latent actor-critic: Deep reinforcement
learning with a latent variable model. Advances in Neural Information Processing Systems , 33:741–752,
2020.
H. Lee. Improved rates for prediction and identification of partially observed linear dynamical systems. In
International Conference on Algorithmic Learning Theory , pp. 668–698. PMLR, 2022.
H. Lee and C. Zhang. Robust guarantees for learning an autoregressive filter. In Algorithmic Learning
Theory, pp. 490–517. PMLR, 2020.
L. Li, W. Chu, J. Langford, and R. E. Schapire. A contextual-bandit approach to personalized news article
recommendation. In Proc. International Conference on World Wide Web , pp. 661–670, 2010.
L. Ljung. Perspectives on system identification. Annual Reviews in Control , 34(1):1–12, 2010.
H. Luo, C. Wei, A. Agarwal, and J. Langford. Efficient contextual bandits in non-stationary worlds. In
Conference on Learning Theory , pp. 1739–1776. PMLR, 2018.
H. Mania, M. I. Jordan, and B. Recht. Active learning for nonlinear system identification with guarantees.
Journal of Machine Learning Research , 23(32):1–30, 2022.
K. Menda, J. De B., J. Gupta, I. Kroo, M. Kochenderfer, and Z. Manchester. Scalable identification of
partially observed systems with certainty-equivalent EM. In ICML, pp. 6830–6840, 2020.
22Published in Transactions on Machine Learning Research (7/2024)
L. Meng and B. Zheng. The optimal perturbation bounds of the Moore-Penrose inverse under the Frobenius
norm.Linear algebra and its applications , 432(4):956–963, 2010.
Z. Mhammedi, D. J. Foster, M. Simchowitz, D. Misra, W. Sun, A. Krishnamurthy, A. Rakhlin, and J. Lang-
ford. Learning the linear quadratic regulator from nonlinear observations. Advances in Neural Information
Processing Systems , 33:14532–14543, 2020.
A. Moore, T. Zielinski, and A. J. Millar. Online period estimation and determination of rhythmicity in
circadian data, using the BioDare data infrastructure. In Plant Circadian Networks , pp. 13–44. Springer,
2014.
S. Oh, A. M. Appavoo, and S. Gilbert. Periodic bandits and wireless network selection. In 46th International
Colloquium on Automata, Languages, and Programming (ICALP 2019) , pp. 149:1–149:15, 2019.
T. Oh. Note on a lower bound of the Weyl sum in Bourgain’s NLS paper (GAFA’93).
M.Ohnishi, I.Ishikawa, K.Lowrey, M.Ikeda, S.M.Kakade, andY.Kawahara. Koopmanspectrumnonlinear
regulators and efficient online learning. Transactions on Machine Learning Research , 2024.
S. Ouala, D. Nguyen, L. Drumetz, B. Chapron, A. Pascual, F. Collard, L. Gaultier, and R. Fablet. Learning
latent dynamics for partially observed chaotic systems. Chaos: An Interdisciplinary Journal of Nonlinear
Science, 30, 2020.
E. M. Rathje, N. A. Abrahamson, and J. D. Bray. Simplified frequency content estimates of earthquake
ground motions. Journal of Geotechnical and Geoenvironmental Engineering , 124(2):150–159, 1998.
H. Robbins. Some aspects of the sequential design of experiments. Bulletin of the American Mathematical
Society, 58(5):527–535, 1952.
Y. Russac, C. Vernade, and O. Cappé. Weighted linear bandits for non-stationary environments. Advances
in Neural Information Processing Systems , 32, 2019.
F. Sabetta and A. Pugliese. Estimation of response spectra and simulation of nonstationary earthquake
ground motions. Bulletin of the Seismological Society of America , 86(2):337–352, 1996.
J.-P. Serre. Linear Representations of Finite Groups . Springer New York, NY, 1977. doi: https://doi.org/
10.1007/978-1-4684-9458-7.
M. Simchowitz and D. Foster. Naive exploration is optimal for online LQR. In ICML, pp. 8937–8948. PMLR,
2020.
M. Simchowitz, R. Boczar, and B. Recht. Learning linear dynamical systems with semi-parametric least
squares. In Conference on Learning Theory , pp. 2714–2802. PMLR, 2019.
P. G. Sokolove and W. N. Bushell. The Chi square periodogram: its utility for analysis of circadian rhythms.
Journal of Theoretical Biology , 72(1):131–160, 1978.
Y. Song. A note on the variation of the spectrum of an arbitrary matrix. Linear algebra and its applications ,
342(1-3):41–46, 2002.
J. Subramanian, A. Sinha, R. Seraj, and A. Mahajan. Approximate information state for approximate
planning and reinforcement learning in partially observed systems. Journal of Machine Learning Research ,
23(12):1–83, 2022.
C. Summers, K. Lowrey, A. Rajeswaran, S. Srinivasa, and E. Todorov. Lyceum: An efficient and scalable
ecosystem for robot learning. In Learning for Dynamics and Control , pp. 793–803. PMLR, 2020.
B. Szigeti, P. Gleeson, M. Vella, S. Khayrulin, A. Palyanov, J. Hokanson, M. Currie, M. Cantarelli, G. Idili,
and S. Larson. OpenWorm: an open-science approach to modeling Caenorhabditis elegans. Frontiers in
Computational Neuroscience , 8:137, 2014.
23Published in Transactions on Machine Learning Research (7/2024)
F. Takens. Detecting strange attractors in turbulence. In Dynamical systems and turbulence , pp. 366–381.
Springer, 1981.
S. V. Tenneti and P. Vaidyanathan. Nested periodic matrices and dictionaries: New signal representations
for period estimation. IEEE Transactions on Signal Processing , 63(14):3736–3750, 2015.
F. Trovo, S. Paladino, M. Restelli, and N. Gatti. Sliding-window Thompson sampling for non-stationary
settings. Journal of Artificial Intelligence Research , 68:311–364, 2020.
A. Tsiamis and G. J. Pappas. Finite sample analysis of stochastic system identification. In IEEE CDC , pp.
3648–3654, 2019.
A. Tsiamis, N. Matni, and G. Pappas. Sample complexity of Kalman filtering for unknown systems. In
Learning for Dynamics and Control , pp. 435–444. PMLR, 2020.
J. H. Tu. Dynamic mode decomposition: Theory and applications . PhD thesis, Princeton University, 2013.
S. K. Turitsyn, J. E. Prilepsky, S. T. Le, S. Wahls, L. L. Frumin, M. Kamalian, and S. A. Derevyanko.
Nonlinear Fourier transform for optical data processing and transmission: advances and perspectives.
Optica, 4(3):307–322, 2017.
W. I. T. Uy and B. Peherstorfer. Operator inference of non-Markovian terms for learning reduced models
from partially observed state trajectories. Journal of Scientific Computing , 88(3):1–31, 2021.
J. Van De Beek, O. Edfors, M. Sandell, S. K. Wilson, and P. O. Borjesson. On channel estimation in
ofdm systems. In IEEE 45th Vehicular Technology Conference. Countdown to the Wireless Twenty-First
Century, volume 2, pp. 815–819, 1995.
J. Von Neumann, A. W. Burks, et al. Theory of self-reproducing automata. IEEE Transactions on Neural
Networks , 5(1):3–14, 1966.
P. Walters. An introduction to ergodic theory , volume 79. Springer Science & Business Media, 2000.
P. Wedin. Perturbation theory for pseudo-inverses. BIT Numerical Mathematics , 13(2):217–232, 1973.
H. Weyl. Über die gleichverteilung von zahlen mod eins. Math. Ann. , 77:31–352, 1916.
M.O.Williams, I.G.Kevrekidis, andC.W.Rowley. Adata–drivenapproximationoftheKoopmanoperator:
Extending dynamic mode decomposition. Journal of Nonlinear Science , 25:1307–1346, 2015.
C. J. Wolfe. On the properties of predominant-period estimators for earthquake early warning. Bulletin of
the Seismological Society of America , 96(5):1961–1965, 2006.
Q. Wu, N. Iyer, and H. Wang. Learning contextual bandits in a non-stationary environment. In The 41st
International ACM SIGIR Conference on Research & Development in Information Retrieval , pp. 495–504,
2018.
T. Zielinski, A. M. Moore, E. Troup, K. J. Halliday, and A. J. Millar. Strengths and limitations of period
estimation methods for circadian data. PloS one , 9(5):e96462, 2014.
24Published in Transactions on Machine Learning Research (7/2024)
A Proof of Proposition 5.2
Proof.
B:=Lmaxsup
t>0|at|,
C:=/radicalbig
4R2log(4/δ),
D:=L2
maxC0/parenleftbigg
µ+ sup
t≥1|at|/parenrightbigg
.
Then,√
T >0satisfies the following inequality
√
T≥max/braceleftigg
C+/radicalbig
C2+ 4(ε−µ)B
2(ε−µ),C+/radicalbig
C2+ 4(ε−µ)D
2(ε−µ)/bracerightigg
if and only if
ε≤2ε−µ−Lmaxsupt>0|at|
T−/radicalbigg
4R2log(4/δ)
T,and
ε≥µ+L2
maxC0(µ+ supt≥1|at|)
T+/radicalbigg
4R2log(4/δ)
T.
SinceLmax≥2,D≥B,µ<γ supt≥1|at|,C0(1 +γ)<3, and
ε−µ=σ0(1−λ)√Lmax·√Lmax
1 +√4Lmax+ 1
≥σ0(1−λ)
2√
2√Lmax,
max/braceleftigg
C+/radicalbig
C2+ 4(ε−µ)B
2(ε−µ),C+/radicalbig
C2+ 4(ε−µ)D
2(ε−µ)/bracerightigg
=C+/radicalbig
C2+ 4(ε−µ)D
2(ε−µ)
≤2/radicaligg
LmaxC2
4(ε−µ)2+D
(ε−µ)
≤2/radicaligg
2L2maxC2
σ2
0(ξ−λ)2+6√
2L5/2
maxsupt≥1|at|
σ0(ξ−λ)
≤2/radicaligg
2L2maxC2
σ2
0(ξ−λ)2+9L5/2
maxsupt≥1|at|
σ0(ξ−λ),
where we used√1−2γ= 2γ√Lmax. Since 2ε≤/radicalbig
(σ2
0−2µσ0)/Lmax, the statement follows from Lemma
5.1.
25Published in Transactions on Machine Learning Research (7/2024)
B Proof of Theorem 5.3
Proof.LetKbe the set of all combinations (m,β,s,q )such thatm∈[d],β∈[Lmax],s∈{0,1,...,β−1}
and{q=α/ℓ:α∈{1,...,ℓ−1}}. We remark that
|K|≤d/summationdisplay
m=1Lmax/summationdisplay
β=1/summationdisplay
ℓ≤Lmax/βℓ−1/summationdisplay
α=1β−1/summationdisplay
s=01 =dLmax/summationdisplay
β=1/summationdisplay
ℓ≤Lmax/ββ(ℓ−1)
≤dLmax/summationdisplay
β=1Lmax
2/parenleftbiggLmax
β−1/parenrightbigg
≤dL2
maxlogLmax
2.
Also, letETpκbe the event such that, for the combination κ∈K,
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
⌊Tp/β⌋⌊Tp/β⌋−1/summationdisplay
j=0/braceleftig
ηt0+βj+sei2παj
ℓ/bracerightig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicaligg
4R2log (4dL2maxlogLmax/δ)
⌊Tp/β⌋.
Because the error sequence satisfies conditionally R-sub-Gaussian, using Lemma D.1 and from the fact that
any subsequence of the filtration {Fτ}is again a filtration, we obtain, for each κ∈K,
Pr/bracketleftbig
ETp
κ/bracketrightbig
≥1−δ
dL2maxlogLmax.
DefineETp:=/intersectiontext
κ∈KETpκ. Then, it follows from the Fréchet inequality that
Pr/bracketleftbig
ETp/bracketrightbig
= Pr/bracketleftigg/intersectiondisplay
κ∈KETp
κ/bracketrightigg
≥|K|/parenleftbigg
1−δ
dL2maxlogLmax/parenrightbigg
−(|K|−1)
= 1−δ|K|
dL2maxlogLmax≥1−δ.
Let/hatwideLbe the output of Algorithm 1. We show that, with probability 1−δ,/hatwideLis(ρ,√
d)-anp ofL. In fact,
suppose/hatwideLis not (ρ,√
d)-anp. We note that /hatwideL<L. There exists s∈{0,...,/hatwideL−1}andt1,t2∈Z>0,
∥fs+/hatwideLt1(θ)−fs+/hatwideLt2(θ)∥Rd>ρ+ 2√
dµ.
Letm′∈argmaxm=1,...,d/vextendsingle/vextendsingle/vextendsinglefs+/hatwideLt1(θ)⊤um−fs+/hatwideLt2(θ)⊤um/vextendsingle/vextendsingle/vextendsingle. Putat:=fs+/hatwideLt(θ)⊤um′. Then, for any t,t′∈
Z>0, we have
|at−at′|≥|at1−at2|−2µ
≥∥fs+/hatwideLt1(θ)−fs+/hatwideLt2(θ)∥Rd√
d−2µ
>ρ√
d.
Thus, by definition, we have
σL//hatwideL((at)t)≥ρ
2/radicalig
dL//hatwideL≥ρ
2√dLmax.
26Published in Transactions on Machine Learning Research (7/2024)
Letσ0=ρ/2√dLmaxandξ:=γ−1/3√Lmax. Then,µ/(γξ)<σ0≤σL//hatwideL((at)t), and
8LmaxR2log(4/δ)
σ2
0(ξ−λ)2+36L5/2
maxsupt≥1|at|
σ0(ξ−λ)
≤32ξ−2dL2
maxR2log(4/δ)
ρ2(1−r)2+72ξ−1√
dL3
maxsupt≥1|at|
ρ(1−r)
≤72dL2
maxR2log(4/δ)
ρ2(1−r)2+108√
dL3
maxsupt≥1|at|
ρ(1−r).
The last inequality follows from ξ≥2/3. Thus, by Proposition 5.2, the algorithm finds β >/hatwideLinm′-th loop,
and the output becomes an integer larger than /hatwideL, which is contradiction.
C Proof of Theorem 5.8
Here, we provide the proof of Theorem 5.8.
C.1 Proof
Let
K:= (Mθ,...,Mdθ) :Cd→W,
Es(N) :=W/parenleftbig
(Es,j)N−1
j=0/parenrightbig
:Cd→Cd.
For a linear map M:W→W, we define linear maps:
X(M) :=
˜x⊤
1M1
˜x⊤
2M2d+1
...
˜x⊤
dM2(d−1)d+1
:W→Cd,
QN(M) :=W/parenleftig
(M2d2j)N−1
j=0/parenrightig
:W→W.
Fors= 0,1, we define linear maps on Cdby
As(N;M) :=X(M)QN(M)Msd+N−1K+Es(N),
Bs(N;M) :=X(M)QN(M)Msd+N−1K.
We note that As(N;Mθ)is identical to As(N)defined in (5.7). We impose the following assumption on
X(Mθ):
Assumption 5. The kernel of the linear map X(M1)is the same asN(M1).
Note that this assumption holds with probability 1 if we randomly choose ˜x1,..., ˜xd(see Lemma C.7).
The following isomorphicity maintenance lemma provides an explicit description of B0(N;M1)†.
Lemma C.1 (Isomorphicity maintenance lemma) .Suppose Assumption 5 holds. Assume N≥16L2. Let
U1:=I(B0(N;M1))⊂Cd,
U2:=N(B0(N;M1))⊂Cd,
U3:=I(M1) =W=1⊂W.
Leti:U1→Cdbe the inclusion map and p:Cd→U⊥
2the orthogonal projection. Then, restriction of X(M1)
(resp.M1K) toU3(resp.U⊥
2) induces an isomorphism onto U1(resp.U3). If we denote the isomorphism
by˜X(resp, ˜K). Then,B0(N;M1)†is given by
B0(N;M1)†=p∗˜K−1M1|2−N
U3QN(M1)|−1
U3˜X−1i∗.
27Published in Transactions on Machine Learning Research (7/2024)
Proof.Since we have N(M1) =N(Mr+1
1)for allr≥0and Assumption 5, surjectivity of Kby Proposition
C.5, and bijectivity of QN(M1)onU3by Proposition 5.7, we have
U1=I(X(M1)|U3),
U2=N(M1K).
Thus, the restriction of X(M1)(resp.K) toU3(resp.U⊥
2) induces an isomorphism onto U1(resp.U3). Let
us denote the isomorphism by ˜X(resp. ˜K). Then, the last statement follows from Proposition C.4.
Lemma C.2. AssumeN≥16L2. Let
A:=B1(N;M1)B0(N;M1)†.
Then,Ais independent of Nand its eigenvalues are zeros except for (θ,d)-distinct eigenvalues of M.
Proof.We use the notation as in Lemma C.1. By Lemma C.1, we obtain
B1(N;M1)B0(N;M1)†=i˜XMd
1˜X−1i∗,
which is independent of Nand its eigenvalues are zeros except for (θ,d)-distinct eigenvalues of M.
The following result will be used in the proof of Theorem 5.8 (but not essential).
Lemma C.3. We have
∥X(M1)∥≤κ√
d,
∥X(M<1)∥≤κ(d+ 1)2d.
Proof.Considering the Jordan normal form, the first inequality is obvious. As for the second inequality, we
defineJ∈Rd×dby the nilpotent matrix
J:=
0 1 O
......
1
O 0
.
Then, we have
κ−1∥X(M1)∥≤d/summationdisplay
r=1∥(I+J)∥1
=d/summationdisplay
r=1d/summationdisplay
j=0/parenleftbiggr
j/parenrightbigg
(d−j)
=d/summationdisplay
j=0(d−j)d/summationdisplay
r=1/parenleftbiggr
j/parenrightbigg
=d+d/summationdisplay
j=1(d−j)d/summationdisplay
r=1/parenleftbiggr
j/parenrightbigg
=d+d/summationdisplay
j=1(d−j)/parenleftbiggr+ 1
j+ 1/parenrightbigg
=d+ (d+ 1)2d−(d+ 1)d−(d+ 1)
<(d+ 1)2d.
28Published in Transactions on Machine Learning Research (7/2024)
Proof of Theorem 5.8. LetAbe the matrix introduced in Lemma C.2. Let
γ(N) :=/radicalbig
4d2R2log(4d2/δ) + 1√
N.
LetM1andM<1be matrices as in Corollary 4.3. Then, by Proposition 4.2, we see that
As(N,M ) =As(N,M 1) +As(N,M<1),
Bs(N,M ) =Bs(N,M 1) +Bs(N,M<1).
We denote by ˆAs(N;M)(resp, ˆBs(N;M)) the low rank approximation via the singular value threshold γ(N)
(see Definition 5.4). By direct computations, we have
∥A−A1(N;M)ˆA0(N;M)†∥
≤∥A1(N;M)∥·∥ˆA0(N;M)†−B0(N;M1)†∥+∥A1(N;M)−B1(N;M1)∥·∥B0(N;M1)†∥
≤(∥B1(N;M1)∥+∥B1(N;M<1)∥+∥E1(N)∥)·∥ˆA0(N;M)†−B0(N;M1)†∥
+∥B1(N;M<1) +E1(N)∥·∥B0(N;M1)†∥.
By Proposition 5.7, for s= 0,1and forN≥max{2d,16L2}, we have
∥Bs(N;M1)∥≤∥X(M1)∥·∥MN+sd−1
1QN(M1)∥·∥K∥
≤κCws(L)∥X(M1)∥∥K∥
≤Bdκ2Cws(L)
∥Bs(N;M<1)∥≤∥X(M<1)∥·∥MN+sd−1
<1QN(M<1)∥·∥K∥
≤∥X(M<1)∥·∥K∥·d2κe−∆(N+sd−d)
N∆d−1
≤Bκ√
d(d+ 1)2d·d2κe−∆(N+sd−d)
N∆d−1
≤Bκ2ed+6−∆(N+sd−d)
N∆d−1,
where we used∥K∥≤√
dB(Assumption 3), and ∥X(M<1)∥≤κ(d+1)2d(Lemma C.3), and√
d(d+1)d22d<
ed+6. By Lemma C.1 with Proposition 5.7, we see that
∥B0(N;M1)†∥≤κCws(L)∥˜X−1∥·∥˜K−1∥.
By using Lemma D.1 and union bounds, we obtain
max(∥E0(N)∥F,∥E1(N)∥F)≤γ(N)−1√
N,
with probability at least 1−δ. Assume that
N≥−(d−1) log ∆
∆+log(Bκ2) +d+ 6
∆+d.
Then, we see that ∥Bs(N;M<1)∥≤1/N. Thus, by Lemma C.6, with probability at least 1−δ, we have
∥ˆA0(N;M)†−B0(N;M1)†∥≤8(∥E0(N)∥+∥B0(N;M<1)∥)·∥B0(N,M 1)†∥2(√
d+ 1)
≤8γ(N)·∥B0(N,M 1)†∥2(√
d+ 1)
≤8(1 +√
d)κ2Cws(L)2∥˜X−1∥2·∥˜K−1∥2γ(N).
Therefore, there exists C > 0depending on∥X(M)∥,∥K∥,κ,Cws(L),∥˜X−1∥,∥˜K−1∥, anddsuch that
∥A−A1(N;M)ˆA0(N;M)†∥<C/parenleftbiggR2(log (1/δ) + 1) + 1√
N/parenrightbigg
,
with probability at least 1−δ.
29Published in Transactions on Machine Learning Research (7/2024)
C.2 Miscellaneous
We provide an expression of Moore-Penrose pseudo inverse:
Proposition C.4. LetA:Cm→Cnbe a linear map. Let i:I(A)→Cnbe the inclusion map and let
p:Cm→N(A)⊥be the orthogonal projection. Let ˜A:=A|N(A):N(A)⊥→I(A)be an isomorphism.
Then, the Moore-Penrose pseudo inverse A†coincides with i∗˜A−1p∗.
Proof.LetB:=p∗˜A−1i∗. We remark that A=i˜Ap,i∗i= id,pp∗= id, we see that ABA =A,BAB =B,
(AB)∗=AB, andBA= (BA)∗. By the uniqueness of Moore-Penrose pseudo inverse, B=A†.
Proposition C.5. LetA∈Cd×dbe a matrix and let v∈Cdbe a vector. Let V⊂Cdbe a linear subspace
generated by{Ajv}∞
j=1. Then,V=I/parenleftbig
(Av,A2v,...,Adv)/parenrightbig
.
Proof.PutW=I/parenleftbig
(Av,A2v,...,Adv)/parenrightbig
. The inclusion W⊂Vis obvious, we prove the opposite inclusion.
It suffices to show that Ajv∈Wfor any positive integer j > d. By the Cayley-Hamilton theorem, Ad=/summationtextd
j=1cjAd−jfor somecj∈C. Thus, by induction Ajis a linear combination of A,A2,...,Ad, namely,
Ajv∈W.
We give several lemmas here.
Lemma C.6 (Perturbation bounds of the Moore-Penrose inverse) .SupposeA∈Cd×dis a matrix. Let
E∈Cd×dbe a matrix satisfying
∃C > 0,∀N∈Z>0,∥E∥≤C1√
N,
and let ˆAE∈Cd×dbe the low rank approximation of A+Evia SVD with the singular value threshold C/√
N.
Then, we obtain
/vextenddouble/vextenddouble/vextenddoubleA†−ˆA†
E/vextenddouble/vextenddouble/vextenddouble≤8C∥A†∥2/parenleftig√
d+ 1/parenrightig
√
N.
Proof.Letσmin=∥A†∥−1be the minimal singular value of A. From (Meng & Zheng, 2010, Theorem 1.1)
(or originally Wedin (1973)) and from the fact
/vextenddouble/vextenddouble/vextenddoubleˆAE−A/vextenddouble/vextenddouble/vextenddouble≤∥E∥+√
dC√
N,
we obtain
/vextenddouble/vextenddouble/vextenddoubleA†−ˆA†
E/vextenddouble/vextenddouble/vextenddouble≤1 +√
5
2max/braceleftbigg/vextenddouble/vextenddoubleA†/vextenddouble/vextenddouble2,/vextenddouble/vextenddouble/vextenddoubleˆA†
E/vextenddouble/vextenddouble/vextenddouble2/bracerightbigg/parenleftig√
d+ 1/parenrightigC√
N.
ForNsuch that 1≤N≤4C2/σ2
min, we have/vextenddouble/vextenddouble/vextenddoubleˆA†
E/vextenddouble/vextenddouble/vextenddouble≤√
N/C≤2/σmin. Suppose singular values σk, k∈[d],
ofA, and ˆσk, k∈[d], ofA+Eare sorted in descending order. Then, it holds that
|σk−ˆσk|≤∥E∥.
Therefore, for N > 4C2/σ2
min, the minimum singular value ˆσdis greater than σmin/2. In this case, ˆAE=
A+E, and it follows that/vextenddouble/vextenddouble/vextenddoubleˆA†
E/vextenddouble/vextenddouble/vextenddouble≤2/σmin. Hence, for all N≥1, we obtain
/vextenddouble/vextenddouble/vextenddoubleˆA†
E/vextenddouble/vextenddouble/vextenddouble≤2
σmin,
30Published in Transactions on Machine Learning Research (7/2024)
from which, it follows that
/vextenddouble/vextenddouble/vextenddoubleA†−ˆA†
E/vextenddouble/vextenddouble/vextenddouble≤2C/parenleftbig
1 +√
5/parenrightbig/parenleftig√
d+ 1/parenrightig
σ2
min√
N≤8C∥A†∥2/parenleftig√
d+ 1/parenrightig
√
N.
Lemma C.7 (Null space of random matrix) .SupposeMk∈Rd×d, k∈[d], have the same null space. Then,
the null space of
X:=
x⊤
1M1
x⊤
2M2
...
x⊤
dMd
,
wherexk, k∈[d], are unit vectors independently drawn from the uniform distribution over the unit hyper-
sphere, is the same as those of Mkwith probability one.
Proof.Given anyk−1dimensional linear subspace in N(Mk)⊥for anyk∈[d], it holds that the probability
thatx⊤
kMklies on that space is zero. Therefore, by union bound, and by the fact that the row space is the
orthogonal complement of the null space, we obtain the result.
D Azuma-Hoeffding inequality for exponential sum
Lemma D.1. Let{Xj}n
j=1forn∈Z>0be sub-Gaussian martingale difference with variance proxy R2and
a filtration{Fj}. Also, let{aj}⊂Cbe a sequence of complex numbers satisfying |aj|≤1for allj∈[n].
Then, the followings hold, where ∗[·]stands for Re[·]orIm[·].
Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle∗
n/summationdisplay
j=1ajXj
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
2R2log (2/δ)
n
≥1−δ,
Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglen/summationdisplay
j=1ajXj/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
4R2log (4/δ)
n
≥1−δ.
Proof.For a filtration{Fi}i≤n, we have
E/bracketleftbigg
eλRe/bracketleftbig/summationtextn
j=1ajXj/bracketrightbig/bracketrightbigg
≤E/bracketleftbigg
eλRe/bracketleftbig/summationtextn−1
j=1ajXj/bracketrightbig
E/bracketleftig
eλRe[anXn]/vextendsingle/vextendsingleFn−1/bracketrightig/bracketrightbigg
≤eλ2R2
2E/bracketleftbigg
eλRe/bracketleftbig/summationtextn−1
j=1ajXj/bracketrightbig/bracketrightbigg
,
where the first inequality follows from the assumption of filtration, and the second inequality follows from
E/bracketleftig
eλRe[anXn]/vextendsingle/vextendsingleFn−1/bracketrightig
=E/bracketleftig
eλXnRe[an]/vextendsingle/vextendsingleFn−1/bracketrightig
≤eλ2R2
2.
By induction, we obtain
E/bracketleftbigg
eλRe/bracketleftbig/summationtextn
j=1ajXj/bracketrightbig/bracketrightbigg
≤enλ2R2
2.
By using Markov inequality and the union bound, it follows that
Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRe
n/summationdisplay
j=1ajXj
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle>ϵ
≤2e−nϵ2
2R2.
31Published in Transactions on Machine Learning Research (7/2024)
Similarly, we have
Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleIm
n/summationdisplay
j=1ajXj
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle>ϵ
≤2e−nϵ2
2R2.
Therefore, we obtain
Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglen/summationdisplay
j=1ajXj/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
4R2log (4/δ)
n

≥Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRe
n/summationdisplay
j=1ajXj
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
2R2log (4/δ)
n

+ Pr
1
n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleIm
n/summationdisplay
j=1ajXj
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
2R2log (4/δ)
n
−1
≥/parenleftbigg
1−δ
2/parenrightbigg
+/parenleftbigg
1−δ
2/parenrightbigg
−1≥1−δ,
where the first inequality follows from the Fréchet inequality.
E Applications to bandit problems
We briefly cover the applicability of our proposed algorithms to bandit problems (e.g., regret minimization)
which is mentioned in the introduction.
A naive approach is an explore-then-commit type algorithm (cf. Robbins (1952); Anscombe (1963)). One
employs our algorithm to estimate a nearly period, followed by a certain periodic bandit algorithm such as
the work in Cai et al. (2021) to obtain an asymptotic order of regret. Caveat here is, because our estimate is
only an aliquot nearly period, one may need to take into account the regret caused by this misspecification
when running bandit algorithms (e.g., ρandµmay lead to (small) linear regret). Avoiding this small linear
regret would require the system to be 0-nearly periodic and that there exists a sufficiently large gapensuring
µ-nearly period with sufficiently small µimplies 0-nearly period.
If one aims at designing an anytime algorithm, the straightforward application of our algorithms may not
give near optimal asymptotic rate of expected regret because the failure probability of periodic structure
estimations cannot be adjusted later. To remedy this, one can employ our algorithm repetitively, and
gradually increase the span of such procedure. Importantly, samples from separated spans can contribute
to the estimate together when the surplusbeyond a multiple of period is properly dealt with. Since failure
probability decreases exponentially with respect to sample size, we conjecture that increasing the span for
bandit algorithm by a certain order will lead to the same rate (up to logarithm) of expected regret of the
adopted bandit algorithm.
F Simulation setups and results
Throughout, we used the following version of Julia Bezanson et al. (2017); for each experiment, the running
time was less than a few minutes.
Julia Version 1.6.3
Platform Info:
OS: Linux (x86_64-pc-linux-gnu)
CPU: Intel(R) Core(TM) i7-6850K CPU @ 3.60GHz
WORD_SIZE: 64
LIBM: libopenlibm
32Published in Transactions on Machine Learning Research (7/2024)
Table 3: Hyperparameters used for period estimation of LifeGame.
LifeGame hyperparameter Value Algorithm hyperparameter Value
height 12accuracy for estimation ρ 0.98
width 12failure probability bound δ 0.2
observed dimension 5maximum possible period Lmax 10
observation noise proxy R 0.3
ball radius B√
5
Figure 8: The area we focus on for the cellular automata experiment.
LLVM: libLLVM-11.0.1 (ORCJIT, broadwell)
Environment:
JULIA_NUM_THREADS = 12
We also used some tools and functionalities of Lyceum Summers et al. (2020). The licenses of Julia and
Lyceum are [The MIT License; Copyright (c) 2009-2021: Jeff Bezanson, Stefan Karpinski, Viral B. Shah, and
other contributors: https://github.com/JuliaLang/julia/contributors], and [The MIT License; Copyright (c)
2019 Colin Summers, The Contributors of Lyceum], respectively.
In this section, we provide simulation setups, including the details of parameter settings.
F.1 Period estimation: LifeGame
The hyperparameters of LifeGame environment and the algorithm are summarized in Table 3. Note µ= 0
because it is a periodic transition. Here, we used 12×12blocks of cells and we focused on the five blocks
surrounded by the red rectangle in Figure 8. The transition rule is given by
1. If the cell is alive and two or three of its surrounding eight cells are alive, then the cell remains alive.
2. If the cell is alive and more than three or less than two of its surrounding eight cells are alive, then
the cell dies.
3. If the cell is dead and exactly three of its surrounding eight cells are alive, then the cell is revived.
F.2 Period estimation: Simple µ-nearly periodic system
The dynamical system
rt+1=µ/parenleftbigg
αrt−1
µ−⌈αrt−1
µ⌉/parenrightbigg
+ 1, θt+1=θt+2π
L,
isµ-nearly periodic. See Figure 9 for the illustrations when µ= 0.2, L= 5, α=π. It is observed that there
are fiveclusters. We mention that this system is not exactly periodic. The hyperparameters of this system
and the algorithm are summarized in Table 4.
33Published in Transactions on Machine Learning Research (7/2024)
Table 4: Hyperparameters used for µ-nearly periodic system.
System hyperparameter Value Algorithm hyperparameter Value
dimension 2accuracy for estimation ρ 0.3
µ 0.001failure probability bound δ 0.2
α πmaximum possible nearly period Lmax 8
observation noise proxy R 0.3
ball radius B 2
Figure 9: An example of µ-nearly periodic system.
F.3 Eigenvalue estimation
We used the matrix Mgiven by
M:=
0 0 0 1 0
0 1 0 0 0
1 0 0 0 0
0 0 1 0 0
0 0 0 0 0 .7
.
The first 4×4block matrix is for permutation. After Nsteps, it is expected that the last dimension shrinks
so that the system becomes nearly periodic. It follows that 4! = 24is a multiple of the length L. Eigenvalues
ofM5are given by 1.000,1.000,−0.500−0.866i,−0.500+0.866i,0.168, and the (θ0,5)-distinct eigenvalues
are1.000,−0.500−0.866i,−0.500 + 0.866i.
34Published in Transactions on Machine Learning Research (7/2024)
The hyperparameters of the environment and the algorithm are summarized in Table 5. Note we don’t
necessarily need κ,B, and ∆to run the algorithm as long as the effective sample size is sufficiently large;
we used the values (satisfying the conditions) in Table 5 for simplicity.
Table 5: Hyperparameters used for eigenvalue estimation.
Hyperparameter Value Hyperparameter Value
κ 6a nearly period L 24
∆ 0.1failure probability bound δ 0.2
dimension 5observation noise proxy R 0.3
ball radius B 1
F.4 Realistic simulation
The hyperparameters used for period estimation that outputs an invalid estimate are summarized in Table
6 while those for a reasonable output are summarized in Table 7. Also, the hyperparameters used for the
eigenvalue estimation are summarized in Table 8. Note for all of them, we used the fixed number of sample
sizes.
Table 6: Hyperparameters used for worm simulation that outputs incorrect value.
System hyperparameter Value Algorithm hyperparameter Value
dimension 36accuracy for estimation ρ 1.0
sample number Tp 3×105maximum possible nearly period Lmax 25
observation noise proxy R 0
Table 7: Hyperparameters used for worm simulation that outputs reasonable value.
System hyperparameter Value Algorithm hyperparameter Value
dimension 36accuracy for estimation ρ 20.0
sample number Tp 3×105maximum possible nearly period Lmax 25
observation noise proxy R 0
Table 8: Hyperparameters used for eigenvalue estimation of worm simulation.
Hyperparameter Value Hyperparameter Value
sample number N 103,104,105failure probability bound δ 0.2
dimension 36 observation noise proxy R 1.0
a nearly period L 20
35