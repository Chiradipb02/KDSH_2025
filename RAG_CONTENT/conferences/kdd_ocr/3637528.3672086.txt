Long-Term Vessel Trajectory Imputation with Physics-Guided
Diffusion Probabilistic Model
Zhiwen Zhang
School of Artificial Intelligence
Jilin University
Changchun, China
zhiwen@locationmind.comZipei Fan∗
School of Artificial Intelligence
Jilin University
Changchun, China
fanzipei@jlu.edu.cnZewu Lv
School of Artificial Intelligence
Jlin University
Changchun, China
lvzewu865@gmail.com
Xuan Song∗†
School of Artificial Intelligence
Jilin University
Changchun, China
songxuan@jlu.edu.cnRyosuke Shibasaki
Research & Development Department
LocationMind Inc.
Tokyo, Japan
shiba@locationmind.com
Abstract
Maritime traffic management increasingly relies on vessel position
information provided by terrestrial and satellite networks of the
Automatic Identification System (AIS). Unfortunately, the problem
of missing AIS data can lead to long-term gaps in vessel trajec-
tory, raising corresponding security concerns regarding collision
risks and illicit activities. Existing imputation approaches are often
constrained by vehicle-based low-sampling trajectories, hindering
their ability to address unique characteristics of maritime trans-
portation systems and long-term missing scenarios. To tackle these
challenges, we propose a novel generative framework for long-term
vessel trajectory imputation. Our framework considers irregular
tracks of vessels, which differ from those of cars due to the ab-
sence of a structured road network, and ensures the continuity of
multi-point imputed trajectories. Specifically, we first utilize a pre-
trained trajectory embedding block to capture patterns of vessel
movements. Subsequently, we introduce a diffusion-based model for
generating missing trajectories, where observed trajectory model-
ing with transformer encoding architecture and embeddings of both
historical vessel trajectory and external factors serve as conditional
information. In particular, we design a physics-guided discriminator
in the training stage, which imposes kinematic constraints between
locations and angles to improve the continuity of the imputed tra-
jectories. Comprehensive experiments and analysis on a real-world
AIS dataset confirm the effectiveness of our proposed approach.
CCS Concepts
•Information systems →Spatial-temporal systems.
∗Corresponding authors.
†Also with Research Institute of Trustworthy Autonomous Systems, Southern Univer-
sity of Science and Technology (SUSTech), Shenzhen, China.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
KDD ’24, August 25–29, 2024, Barcelona, Spain
©2024 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 979-8-4007-0490-1/24/08
https://doi.org/10.1145/3637528.3672086Keywords
Vessel trajectory imputation, Trajectory embedding, Diffusion prob-
abilistic model, Physics-Guided discriminator
ACM Reference Format:
Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, and Ryosuke Shibasaki. 2024.
Long-Term Vessel Trajectory Imputation with Physics-Guided Diffusion
Probabilistic Model. In Proceedings of the 30th ACM SIGKDD Conference
on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024,
Barcelona, Spain. ACM, New York, NY, USA, 10 pages. https://doi.org/10.
1145/3637528.3672086
1 INTRODUCTION
Maritime transportation, vital for nearly 90% of global trade, ne-
cessitates effective maritime traffic management for safety and
efficiency. Meanwhile, the recovery of the global economy has led
to a significant surge in international trade volumes, resulting in a
rapid expansion of vessel transportation [ 17]. In this context, the
proliferation of maritime transportation has facilitated the need for
a substantial volume of high-quality vessel trajectories. With the
technology adaptation of the Internet of Things (IoT) and satellite
technology [ 34], maritime surveillance systems [ 30] increasingly
rely on the vast amount of data made available by terrestrial and
satellite networks of Automatic Identification System (AIS) sta-
tions designed to receive radio messages broadcast by ships [ 27].
These messages include their current position indicated by latitude
(LAT) and longitude (LON) coordinates, Speed Over Ground (SOG),
Course Over Ground (COG), and voyage-related static information
(e.g., Maritime Mobile Service Identity number and the vessel’s
name). Consequently, AIS stands as a crucial tool, providing an
accessible data source for vessel tracking [ 38], collision avoidance
[16], and search and rescue efforts [11].
However, incomplete AIS data can result from a combination of
technical or intentional factors [ 7,19]. These signal interruptions
may lead to long-term gaps in vessel trajectory, thereby raising
significant security concerns related to collision risks [ 22] and
illicit activities [ 9]. As depicted in Fig. 1, we have identified all
instances of AIS signal missing (with signal interruptions exceeding
6 Hours) within a maritime zone surrounding Denmark, spanning
from October 2022 to March 2023. It becomes evident from our
analysis that the problem of long-term AIS signal missing is a
4398
KDD ’24, August 25–29, 2024, Barcelona, Spain Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, & Ryosuke Shibasaki
(a) One example for AIS signal missing
Interruption time
6 hours
12 hours
24 hours
20 40 60 80 100
Interruption number
(b) Map visualization of AIS signal missing. Here, the circle’s radius corresponds to
the signal interruption duration, and its color indicates the frequency of interruptions.
2022-10-15 2022-11-04 2022-11-24 2022-12-14 2023-01-03 2023-01-23 2023-02-12 2023-03-04 2023-03-24406080100120140160Interruption number
(c) Temporal statistics for AIS signal missing
Figure 1: Motivation of long-term AIS signal missing problem
(with signal interruptions exceeding 6 Hours).
prevalent issue both spatially and temporally. This motivates us
to develop an effective framework for long-term vessel trajectory
imputation. Meanwhile, we also acknowledge the heterogeneity
of AIS data, encompassing both position-based information and
attitude-based information (e.g., the course of vessel).
Existing studies about trajectory imputation, especially within
the realm of vehicle-based transportation, have garnered signifi-
cant attention and led to the development of many state-of-the-art
approaches [ 2,8]. However, transferring these recent advances tolong-term vessel trajectory imputation poses a considerable chal-
lenge. On one hand, the movements of vehicles are highly con-
strained by road lanes and intersections with a well-defined road
network [ 12]. In contrast, extracting and representing the maritime
traffic network is a more challenging task for vessels, even though
they adhere to common movement patterns due to traffic regula-
tions and fuel consumption optimization [ 6]. On the other hand,
the complex nature of vessel trajectory and its inherent irregular
characteristics pose challenges in generating imputation results
for highly missing scenarios. However, most previous studies [ 26]
concentrated on the recovery of low-sampling trajectory points
(2~6 minutes). Given these considerations, we are confronted with
two formidable problems in vessel imputation: i) how to represent
vessel movements and encode them into the imputation model ; and ii)
how to generate long-term vessel imputation results with both high
accuracy and ensuring the trajectory continuity.
Bearing these in mind, the advances of the diffusion probabilistic
model [ 14] show promise for generating high-quality trajectories
[40]. The core idea is to reconstruct trajectories from white noise
using conditional information through a reverse trajectory denois-
ing process. Moreover, many recent studies [ 15,28] have proposed
to integrate physics-based differential equations with deep learn-
ing techniques, giving birth to a field called “Physics-Guided Deep
Learning”. This approach allows for the incorporation of additional
physics-based penalties into the loss function, enabling the inclu-
sion of kinematic constraints to enhance trajectory smoothness
during the training stage of the diffusion model. Therefore, we
propose a novel physics-guided diffusion probabilistic model for
long-term vessel trajectory imputation. The main contributions of
this paper can be summarized as follows.
•We propose a novel physics-guided diffusion model for long-
term vessel trajectory imputation. To the best of our knowledge,
it is the first attempt to integrate the diffusion model with a
physics-guided discriminator for trajectory imputation tasks. It
achieves precise imputations with better continuity of trajectory.
•We employ a pre-trained trajectory embedding block based on
probabilistic network representations to capture patterns of ves-
sel movements.
•For denoising network architecture, we employ a Traj-UNet that
integrates multi-scale feature fusion to predict the noise level
during the reverse process, where observed trajectory model-
ing with transformer encoding architecture and embeddings of
both historical vessel trajectory and external factors serve as
conditional information.
•We validate the effectiveness of the proposed framework using
public AIS datasets and report its superiority across various
missing scenarios.
2 RELATED WORK
Trajectory imputation methods can be classified into two groups:
network-based and network-free imputation methods.
Network-based Imputation Method. The network-based im-
putation method leverages the structure of road network as prior
knowledge [ 36] to infer potential routes between non-adjacent
road segments. Previous approaches have employed Markov-based
4399Long-Term Vessel Trajectory Imputation with Physics-Guided Diffusion Probabilistic Model KDD ’24, August 25–29, 2024, Barcelona, Spain
mean and std of log weights 
…		𝑥!		𝑥"#$		𝑥%		𝑥"…𝑞(𝑥!|𝑥!"#,𝑥$%&)𝑝'(𝑥!"#!(|𝑥!!(,𝑥$%&)Historical AIS Trajectory Embedding<LAT, LON, SOG, COG>𝑒&VRNN		𝑒!		𝑧!ℎ!ℎ!"#Maximizing log𝑝(𝑒)|ℎ))
𝜖'Sinusoidal𝑡TransfomerEncoderTraj-UNetEmbedding
<Time, Ship id>		𝑥"	𝑥!()ℒ*Denoising step 𝜏		𝑧&Physics-guided Discriminatorℒ+1D-Conv……𝜕𝑢𝜕𝜆MaxpoolingDense	𝑢	𝜆	𝑠	𝑐		𝑥*
Figure 2: An illustration of our proposed framework. (Top) Pre-trained trajectory embedding block. (Middle) Forward and
reverse process of vessel trajectory imputation. (Bottom) Network structure for reverse denoising during the training stage.
models [ 1,21] and heuristic search algorithms such as dynamic pro-
gramming [ 20] and inverse reinforcement learning [ 35] to derive
spatial transition probabilities [ 13] of road segment pairs based on
the characteristics and connectivity of road network. But they rely
on a probabilistic model and can not effectively capture complex
temporal dependencies. Recently, trajectory mining has garnered
attention, leading to the development of numerous deep learning-
based frameworks aimed at recovering unobserved locations based
on road network. Some studies [ 3,26] proposed a Seq2seq model
with multi-task learning to recover map-matched high-sampling
points directly on road networks. In particular, Chen et al. [ 3] uti-
lized a graph model to learn the embedding features of each road
segment and capture rich spatial-temporal features for trajectory
imputation.
Network-free Imputation Method. Differing from the afore-
mentioned studies, network-free imputation methods focus on ob-
served or candidate location points rather than the road network.
Sequential architectures, such as RNN [ 4] and Transformer [ 32], are
particularly significant for uncovering spatial-temporal patterns
in trajectory sequences. For example, Wang et al. [ 33] employed
an RNN-based Seq2seq framework with attention mechanisms to
capture spatial-temporal dependencies. Moreover, Sun et al. [ 29]
and Xu et al. [ 37] further incorporated Graph Neural Networks
(GNNs) to model individual trajectories, thereby enhancing theability to capture transition patterns. In addition, Elshrif et al. [ 8]
did not assume the knowledge of the underlying road network and
identify the shortest set of consecutive candidate points between
origin and destination based on the search process of candidate
points.
While the aforementioned methods have demonstrated promis-
ing results, they may not be directly applicable to our vessel tra-
jectory imputation problem due to two notable limitations. Firstly,
vehicle movements are heavily constrained by a well-defined road
network. In contrast, how to represent the maritime traffic network
poses a more challenging task for vessels. Secondly, these methods
may struggle with handling long-term vessel imputation scenarios,
although some studies [ 7,19,24] attempted to encode vessel trajec-
tory information and reconstruct low-sampling trajectory points
using simplified models.
3 METHODOLOGY
3.1 Problem Formulation
In this study, our objective is to develop a generative framework for
long-term vessel trajectory imputation. The diffusion probabilistic
model has garnered increasing attention in recent years due to its
success in various data generation tasks [ 14]. This model comprises
two main processes: a forward process that gradually perturbs the
4400KDD ’24, August 25–29, 2024, Barcelona, Spain Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, & Ryosuke Shibasaki
data distribution with noise, and a reverse (denoising) process that
aims to recover the original data distribution. Furthermore, our
physics-guided diffusion model incorporates kinematic constraints
to impose smoothness-based penalties during the training stage of
noise level prediction, distinguishing it from the standard diffusion
process. Building upon these discussions, we begin by introducing
some fundamental definitions and outlining the diffusion model
within our proposed imputation framework.
Definition 1. Vessel Trajectory. One vessel trajectory is defined
by a series of sampled GPS points, denoted by 𝑥={𝑙1,𝑙2,...,𝑙𝑖}. The
𝑖−𝑡ℎlocation point is represented as a tuple 𝑙𝑖=[𝑢𝑖,𝜆𝑖], where𝑢𝑖
and𝜆𝑖denote the position of the vessel (LAT and LON).
Definition 2. Observed and Masked Trajectory. For our vessel
trajectory imputation problem, we apply a continuous mask to each
trajectory sample 𝑥. Consequently, we denote a collection of true
trajectories with masked segments as 𝑥0, and the observed trajectories
as𝑥𝑐𝑜
0. Specifically, the 𝑖-th location point of each sample in 𝑥𝑐𝑜
0is
represented as a tuple 𝑙𝑖=[𝑢𝑖,𝜆𝑖,𝑠𝑖,𝑐𝑖], where𝑢𝑖,𝜆𝑖,𝑠𝑖, and𝑐𝑖denote
LAT, LON, SOG and COG respectively.
Definition 3. Forward Process. The forward process adds Gauss-
ian noiseN(·) to𝑥0for𝑇time-steps, where 𝑇is an adjustable pa-
rameter for diffusion step.
Then the forward or diffusion process can be defined as a Markov
chain from ground truth 𝑥0to the latent variable 𝑥𝑇:
𝑞(𝑥1:𝑇|𝑥0)=𝑇Ö
𝑡=1𝑞(𝑥𝑡|𝑥𝑡−1) (1)
𝑞(𝑥𝑡|𝑥𝑡−1)=N
𝑥𝑡;√︁
1−𝛽𝑡𝑥𝑡−1,𝛽𝑡I
(2)
where{𝛽𝑡∈(0,1)}𝑇
𝑡=1(𝛽1<𝛽2<...<𝛽𝑇)represents the corre-
sponding forward process variances.
Definition 4. Reverse Process. The reverse process, also known
as the denoising process, aims to recover the original data distribution
from the noisy data 𝑥𝑇∈N( 0,I).
Accordingly, this denoising process can be formulated by the
following Markov chain:
𝑝𝜃(𝒙0:𝑇)=𝑝(𝑥𝑇)𝑇Ö
𝑡=1𝑝𝜃(𝑥𝑡−1|𝑥𝑡) (3)
𝑝𝜃(𝑥𝑡−1|𝑥𝑡)=N
𝑥𝑡−1;𝜇𝜃(𝒙𝑡,𝑡),𝜎𝜃(𝑥𝑡,𝑡)2I
(4)
where𝜇𝜃(𝑥𝑡,𝑡)and𝜎𝜃(𝑥𝑡,𝑡)are the mean and variance computed
by noise prediction model parameter 𝜃, respectively. The parame-
terizations of 𝑥𝑡,𝜇𝜃and𝜎𝜃follow literature [14, 40].
Definition 5. Physics-Guided Discriminator. Compared with
standard diffusion model, the main difference lies in the training stage
of noise prediction. The physics-guided discriminator 𝑓𝑝(·)directly
models the𝜏−𝑡ℎdenoised data 𝑥𝜏, which is hypothetically equivalent
to the output of executing (𝑇−𝜏)denoising steps. Then we impose
kinematic constraints to 𝑓𝑝(𝑥𝜏)and compute physics-based loss.
Note that physics-based discriminator denoising steps 𝜏are sig-
nificantly fewer than total denoising steps 𝑇for the purpose of
training efficiency. Thus, the objective of our trajectory imputation
task is to learn a diffusion model 𝜃that can generate imputed GPStrajectories through 𝑥𝑡𝑎
𝑡,𝑡,𝑥𝑐𝑜
0and other embeddings (i.e., historical
vessel trajectory).
3.2 Trajectory Embedding Module
Unlike car-based trajectories, the irregularity and heterogeneity of
AIS data necessitate capturing spatial-temporal features to enhance
the performance of the diffusion model. Additionally, Gaussian
noise is employed in the forward process of the diffusion probabilis-
tic model. Therefore, we integrate a trajectory embedding module to
generate a probabilistic representation of vessel movement patterns
based on historical vessel trajectories.
Before implementation for probabilistic representation, we need
first embed input AIS trajectory observations 𝑜0:𝐼, where𝐼denotes
the length of historical observations and each timestamped observa-
tion𝑜𝑖is a 4-dimension real-value vector (i.e., LAT, LON, SOG, and
COG). Furthermore, we transform the real-value 𝑜0:𝐼into discrete
representations using a similar transformation as presented in [ 24].
This is because we need to learn the data representation of AIS
data to assist the diffusion model at a given embedding resolution,
and the inherent error introduced by this transformation is negli-
gible for long-term vessel trajectory prediction [ 23], even though
it adds an error equivalent to half the resolution of the bins of 𝑜𝑖.
Consequently, we utilize the embedding method [ 10] to convert
each discretized attribute into a real-valued AIS data vector 𝑒𝑖.
Motivated by [ 25], we employ a Variational Recurrent Neural
Network (VRNN) to capture the variations and uncertainties inher-
ent in the AIS data 𝑒𝑖. VRNN extends the capabilities of traditional
RNN by incorporating stochastic elements to enhance the network’s
modeling capacity. To accommodate these variations and uncer-
tainties, probabilistic RNN introduces latent stochastic variables,
denoted as𝑧𝑖, which follow a prior distribution 𝑧𝑖∼𝑝(𝑧𝑖|ℎ𝑖).
At each time step 𝑖, the joint probability of 𝑒𝑖and𝑧𝑖can be
factorized as:
𝑝(𝑒𝑖,𝑧𝑖|ℎ𝑖)=𝑝(𝑒𝑖|𝑧𝑖,ℎ𝑖)𝑝(𝑧𝑖|ℎ𝑖) (5)
whereℎ𝑖represents the dynamics of RNN, and 𝑒𝑖∼𝑝(𝑒𝑖|𝑧𝑖,ℎ𝑖)
denotes the emission distribution. Then 𝑝(𝑒𝑖|ℎ𝑖)can be obtained
by integrating out 𝑧𝑖:
𝑝(𝑒𝑖|ℎ𝑖)=E𝑝(𝑧𝑖|𝑒𝑖,ℎ𝑖)[𝑝(𝑒𝑖|𝑧𝑖,ℎ𝑖)𝑝(𝑧𝑖|ℎ𝑖)]. (6)
In the final, we maximize log𝑝(𝑒𝑖|ℎ𝑖)by using an approxima-
tion of𝑞(𝑧𝑖|𝑒𝑖,ℎ𝑖)for the training of trajectory embedding block,
as is introduced in [5].
Overall, the process of trajectory embedding is outlined in Fig. 2
(Top). Meanwhile, we observe that the mean and variance of log
weights are reasonable; clear ship lanes are distributed around
the mean, while relatively large standard deviations are observed
around the land. Once we obtain the probabilistic representation 𝑧𝑖,
we will incorporate it as prior knowledge in the noise prediction of
the diffusion model.
3.3 Transformer Encoder for Observed
Trajectories
This section introduces the transformer encoder for observed tra-
jectories𝑥𝑐𝑜
0, as is depicted in Fig. 3. Here, the 𝑖-th location point
of each sample in 𝑥𝑐𝑜
0is represented as a tuple 𝑙𝑖=[𝑢𝑖,𝜆𝑖,𝑠𝑖,𝑐𝑖].
Considering the crucial role of multi-modal correlations of 𝑥𝑐0
0, it is
essential to effectively encode these complex correlations into the
4401Long-Term Vessel Trajectory Imputation with Physics-Guided Diffusion Probabilistic Model KDD ’24, August 25–29, 2024, Barcelona, Spain
𝑥!"#Transformer Block (3x)Multi-head Self AttentionLayer NormFeed ForwardLayer NormSpatial and Temporal EmbeddingLATLONSOGCOG𝐴𝐸
Figure 3: The model architecture of transformer encoder for
observed trajectories.
model. Therefore, we adopt a spatial and temporal encoding method
[18] based on learnable Fourier features to address the above chal-
lenges. We aim to learn an encoding function Φ(𝑥):R𝑚→R𝑑,
which maps the original feature to a 𝑑dimensional Fourier feature
representation. The function is defined as follows:
Φ(𝑥)=1√
𝑑[cos𝑥W𝑟∥sin𝑥W𝑟] (7)
where∥denotes the concatenation operation, and W𝑟∈R𝑚×𝑑/2
represents the learnable parameter determining the orientation and
the wavelength of Fourier features. In this context, the feature 𝑥
could either represent position information (i.e., 𝑢𝑖||𝜆𝑖) or attitude
information (i.e., 𝑠𝑖||𝑐𝑖). Then the dot-product between two features
Φ(𝑥)andΦ(𝑦)is computed by:
Φ(𝑥)·Φ(𝑦)=K(𝑥,𝑦)=1
𝑑∑︁
(cos(𝑥−𝑦)W𝑟) (8)
This indicates that the mapping function in Eq. (7) corresponds
to a translation-invariant kernel parameterized by W𝑟, enabling
the learning of diverse gap information across multi-modal 𝑥𝑐𝑜
0,
together with distinctions between before-mask and after-mask
conditions. Consequently, we derive the input embeddings (e 𝑖∈𝐸)
for the subsequent transformer as follows:
e𝑖=Φ(𝑢𝑖||𝜆𝑖)||Φ(𝑠𝑖||𝑐𝑖) (9)
As depicted in Fig. 3, the transformer block comprises a stack of
transformer layers characterized by multi-head self-attention and
feed-forward network. Multi-head attention is the core operation
of transformers, enabling the modeling of alignments where each
token in the sequence learns to aggregate information from other
tokens. This mechanism allows us to capture inter-correlations
within the above embeddings 𝐸. Here,𝐸∈R𝑆×𝑑represents the
observed trajectory sequence 𝑥𝑐𝑜
0with a length of 𝑆and a feature
dimension of 𝑑. The operation of a single head is defined as:
𝐴𝑡𝑡𝑒𝑛𝑡𝑖𝑜𝑛(𝑄,𝐾,𝑉)=𝑆𝑜𝑓𝑡𝑚𝑎𝑥
𝛼𝑄𝐾𝑇
𝑉, (10)
where𝑄=𝐸W𝑞,𝐾=𝐸W𝑘and𝑉=𝐸W𝑣represent linear
transformations, and the matrices W𝑞,W𝑘,W𝑣∈R𝑑×𝑑/𝑁are
the learnable parameters for the query, key and value projections,
respectively, and 𝑁is the number of heads. The scaling factor
𝛼controls the magnitude. This design allows the transformer to
directly retrieve information from several time steps in the past, a
critical feature compared to RNN networks. The output of the final
layer of the transformer block is represented by 𝐴∈R𝑆×𝑑′
.
3.4 Physics-guided Diffusion Framework
We divide the training of diffusion model into two parts: (1) Training
of Noise Prediction Model; and (2) Physics-guided Discriminator.3.4.1 Training of Noise Prediction Model. After obtaining both the
historical vessel trajectory embedding 𝑧𝑖and feature representa-
tions𝐴learned by 𝑥𝑐𝑜
0, we also incorporate the embeddings of
external factors (i.e., time and ship id). Subsequently, we transform
these representations into the same dimension as the aforemen-
tioned conditional representations using dense layers, resulting in
the final conditional representations: 𝑐𝑜=𝑧𝑖′⊕𝐴′⊕𝑒𝑚𝑏𝑒𝑑′.
We illustrate the network structure for noise prediction in Fig. 2
(Bottom) to predict the noise level at each diffusion time step 𝑡,
conditioned on 𝑐𝑜. Specifically, we begin by employing Sinusoidal
embedding [ 32] for the diffusion time step 𝑡, followed by the uti-
lization of the Traj-UNet architecture (the structure details are
introduced in [ 40]). The Traj-UNet structure comprises two parts:
down-sampling and up-sampling, each featuring multiple 1D-CNN-
based stacked residual network blocks. These blocks are employed
to predict the noise level based on 𝑐𝑜and the embedding of the
diffusion time step 𝑡. We opt for this approach due to its superior
performance in the diffusion-based trajectory generation task [ 40].
Therefore, we can redefine the specific objective of our impu-
tation framework (refer to Fig. 2 (Middle)): Given a random noise
𝑥𝑇∼N( 0,𝑰), our framework generates an imputation trajectory
𝑥𝑡𝑎
0, conditioned on the observation representation 𝑐𝑜. Then the
reverse trajectory denoising process can be summarized as learn-
ing the Gaussian noise 𝜖𝜃 𝑥𝑡𝑎
𝑡,𝑡|𝑐𝑜through𝑥𝑡𝑎
𝑡,𝑡and𝑐𝑜. This
process can be trained by the following objective:
L𝑛=min
𝜃E𝑡,𝑥0,𝜖𝜖−𝜖𝜃√¯𝛼𝑡𝑥0+√1−¯𝛼𝑡𝜖,𝑡2
. (11)
Where and ¯𝛼𝑡=Î𝑡
𝑖=1(1−𝛽𝑖). The above equations demon-
strate that the essence of training the diffusion model lies in mini-
mizing the mean squared error between the Gaussian noise 𝝐and
the predicted noise level 𝝐𝜃 𝒙𝑡𝑎
𝑡,𝑡|𝑐𝑜.
3.4.2 Physics-guided Discriminator. In addition to noise level pre-
diction using the standard diffusion model, we integrate kinematic
constraints into the training stage of our diffusion model, which
employs a physics-guided discriminator to aid the noise prediction
in the denoising process.
In physics, the partial differential equation about vessel trajectory
continuity describes the kinematic relations among LAT, LON, SOG
and COG [39], which can be expressed as:(
𝜕𝑢
𝜕𝑡=𝑠·𝑐𝑜𝑠(𝑐)
𝑅
𝜕𝜆
𝜕𝑡=𝑠·𝑠𝑖𝑛(𝑐)
𝑅·𝑐𝑜𝑠¯𝑢(12)
where𝑅denotes the radius of the Earth, and cos¯𝑢represents
the conversion factor ( ¯𝑢=56◦). Prior to implementation, we evalu-
ate the fitting performance of our vessel trajectory data for these
two differential equations. The fitting performance is 3.46𝑒−6for
latitude and 8.78𝑒−6for longitude in degrees, confirming the effec-
tiveness of our kinematic constraint equations.
Consequently, the physics-guided discriminator 𝑓𝑝(·)directly
models the𝜏-th denoised data 𝑥𝜏, which hypothetically corresponds
to the output of executing (𝑇−𝜏)denoising steps. For 𝑓𝑝(·), we
utilize a Temporal Convolutional Networks (TCN) to learn 𝑥𝜏. Thus,
we derive the physics-based loss by incorporating the losses of
the partial differential equations and the mean squared error of
kinematic variables ( 𝑢,𝜆,𝑠,𝑐 ) during the training stage:
4402KDD ’24, August 25–29, 2024, Barcelona, Spain Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, & Ryosuke Shibasaki
L𝑝=𝛽1·(L𝜕𝑢+L𝜕𝜆)+L𝑢+L𝜆+L𝑠+L𝑐 (13)
where𝛽1controls the weights of partial differential equations. In
the final, we derive the overall loss of our proposed model by in-
corporating physics-based losses into the joint learning objective:
L=L𝑛+𝛽2·L𝑝, (14)
where𝛽2controls the weights of physics-based losses. It’s important
to note that the physics-guided discriminator only operates during
the training stage. For the testing stage, we employ the standard
reverse process to obtain the output 𝑥𝑡𝑎
𝑡from the noisy data 𝑥𝑇.
4 EXPERIMENTS
4.1 Datasets
AIS Dataset. We evaluate our long-term vessel imputation frame-
work on a publicly available AIS dataset provided by the Danish
Maritime Authority1. We extract AIS observations of cargo and
tanker vessels recorded from July 01, 2022, to March 31, 2023. The
experimental target region is defined by a bounding box, ranging
from 53.5◦and59.0◦in latitude and 7.5◦and14.0◦in longitude.
In the data pre-processing phase, we first remove abnormal speed
records (≥30knots) and moored or at-anchor vessels. Then we
split non-contiguous voyages into contiguous ones by a predefined
maximum time interval (here 2 hours) and remove those AIS tra-
jectories whose length is smaller than 20 or whose duration is less
than 4 hours. In the final, we down-sample each trajectory into
5-minute intervals, and long trajectories are segmented with a max-
imum sequence length of 12 hours. As a result, we obtain a total of
120,700 vessel trajectory samples, and the length of each trajectory
sample is fixed at 144.
4.2 Experimental Setup
For pre-trained embedding block, we utilize a collection of vessel
trajectories recorded from July 01, 2022, to September 30, 2022. Then
we split the remaining vessel trajectory dataset into training set,
validation and test set with a splitting ratio of 7 : 1 : 2. According to
Fig. 1, long-term incomplete AIS signal has become a major concern
of maritime safety and security. Thus, this study considers continu-
ous mask scenarios and further varies the imputation mask length
of each trajectory sample in the set {6𝐻𝑜𝑢𝑟𝑠, 8𝐻𝑜𝑢𝑟𝑠, 10𝐻𝑜𝑢𝑟𝑠}
to evaluate the robustness of our proposed imputation model. The
start location of the mask for each trajectory is randomly set. In
these scenarios, the trajectory data is completely missing during
continuous masked time periods. The experiments are implemented
with PyTorch 1.6.0 and Python 3.6, and trained with an RTX2080
GPU. The platform runs on Ubuntu 16.04 OS. We train the models
using Adam optimizer with an initial learning rate of 10−4, and the
batch size is set to 512.
The main hyper-parameter settings of our proposed framework
are described as follows:
•In the pre-trained trajectory embedding, the embedding reso-
lution for AIS data includes 0.01◦for LAT and LON, 1 knot for
SOG, and 5◦for COG. With these resolutions, the corresponding
embedding sizes are 256, 256, 128, and 128, respectively.
1https://dma.dk/safety-at-sea/navigational-information/ais-data•In the transformer-based module for observed vessel trajectory,
the hidden size and the number of heads are set to 128 and 4,
respectively.
•The number of diffusion time steps 𝑇is set to 500. For reverse
process, each down-sampling and up-sampling module in Traj-
UNet consists of two stacked Resnet blocks. The kernel size of
1D-CNN belonging to each ResNet block is set to 3.
•For physics-guided discriminator, the discriminator step 𝜏is set
to 20.𝛽1and𝛽2are set to 0.2 and 0.1 respectively. Here, TCN
belonging to this discriminator includes two 1D-Conv layers and
two dense layers.
4.3 Baseline Methods and Metrics
4.3.1 Baseline Methods. We compare the performance with five
representative imputation baselines and three model variants to
validate the effectiveness of the proposed method.
•(1) LI: It employs a linear interpolation method for two sam-
pled trajectory points and predicts locations within a specified
distance from the interpolated straight line.
•(2) TraImpute: It [ 8] is a network-free heuristic search algorithm
that determines imputed locations based on the frequencies ob-
served in historical trajectories.
0.01° 0.05° 0.1°
Embedding Resolution0.000.020.040.060.080.100.12RMSELAT LON
(a) Varying of embedding resolution in the pre-trained embedding block
5 10 15 20 25
3738394041424344RMSE
6 Hours
8 Hours
10 Hours
(b) Varying of discriminator step 𝜏
Figure 4: Hyper-parameter Tuning.
4403Long-Term Vessel Trajectory Imputation with Physics-Guided Diffusion Probabilistic Model KDD ’24, August 25–29, 2024, Barcelona, Spain
Table 1: Overall imputation performance comparison (MAE/RMSE) across different missing scenarios with mask lengths of 6, 8
and 10 hours. We highlight the best performances in bold. Note that MAE and RMSE are in degrees of LAT and LON.
Mo
del6 Hours 8 Hours 10 Hours
LA
T LON LA
T LON LA
T LON
LI
0.0612/0.0902 0.0997/0.1444 0.0920/0.1323
0.1406/0.1989 0.1246/0.1765
0.1859/0.2608
TraImpute 0.0439/0.0843 0.0761/0.1289 0.0538/0.1233
0.0851/0.1916 0.0629/0.1242
0.1051/0.1681
Transformer 0.0433/0.0835 0.0749/0.1089 0.0475/0.0901
0.9009/0.1609 0.0518/0.0824
0.0893/0.1457
Multi-task AIS 0.0427/0.0810 0.0773/0.1197 0.0436/0.0833
0.0821/0.1709 0.0642/0.0944
0.1003/0.1566
CSDI 0.0328/0.0468 0.0542/0.0819 0.0391/0.0572
0.0755/0.1223 0.0492/0.0862
0.0832/0.1311
Ours-NR
0.0307/0.0459 0.0504/0.0796 0.0369/0.0516
0.0639/0.0987 0.0420/0.0671
0.0793/0.1243
Ours-NP 0.0268/0.0390 0.0482/0.0725 0.0329/0.0506
0.0606/0.0974 0.0374/0.0602
0.0625/0.1050
Ours 0.0296/0.0424 0.0478/0.0723 0.0324/0.0500
0.0592/0.0962 0.0366/0.0593
0.0607/0.1036
(a) CSDI (6 Hours)
 (b) Ours-NR (6 Hours)
 (c) Ours (6 Hours)
 (d) Ground truth (6 Hours)
(e) CSDI (10 Hours)
 (f) Ours-NR (10 Hours)
 (g) Ours (10 Hours)
 (h) Ground truth (10 Hours)
Figure 5: Heatmap comparison of imputation trajectories (about 24,000 tracks) for 6-Hour and 10-hour missing scenarios.
Table 2: Ablation study about the continuity of imputation
trajectory. Note that the computation results of trajectory
angles (MAE/RMSE) are in degrees.
Model 6 Hours 8 Hours 10 Hours
Ours-NR 28.64/47.14 29.10/47.23 31.83/48.14
Ours-NP 20.77/37.94 22.72/40.54 25.51/43.73
Ours-ADD 25.00/44.21 23.63/42.67 29.12/47.59
Ours 20.58/37.46 22.22/39.80 23.68/41.89
•(3) Transformer: It [ 32] is a Seq2seq model widely used and
enhanced with a self-attention mechanism. The recovered tra-
jectory is generated within the decoder.
•(4) Multi-task AIS: It [ 24] implements recurrent neural networks
with latent variable modeling for AIS data representation and
vessel trajectory reconstruction.•(5) CSDI: It [ 31] is a recent conditional score-based diffusion
model for the time-series imputation method that utilizes score-
based diffusion models conditioned on observed data.
In addition, three model variants of our proposed framework
for ablation study: (6) Ours_NR - In this variant, we remove pre-
trained trajectory embedding module to disable this variant from
vessel trajectory representations. (7) Ours_NP - we remove this
physics-guided discriminator to disable this variant from kinematics
constraints for trajectory continuity. Especially, we also design one
model variant of the physics-guide discriminator - (8) Ours_ADD,
which replaces the physics-based loss function with direct loss
computation of trajectory angles for a fair comparison of trajectory
continuity.
4.3.2 Evaluation Metrics. We adopt two distance measurements
RMSE (Root Mean Square Error) and MAE (Mean Absolute Error)
to evaluate our vessel trajectory imputation performance across
varying mask lengths by comparing ground truth with imputed
4404KDD ’24, August 25–29, 2024, Barcelona, Spain Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, & Ryosuke Shibasaki
values (i.e., LON and LAT). In addition, trajectory continuity is also
an important criterion for trajectory imputation tasks. Therefore, as
the ablation study of our proposed physics-guided discriminator, we
compute the trajectory angles between any two consecutive points
for both ground-truth and imputed trajectories, as introduced in
[8]. It’s worth noting that we count the intersection angle due to
the periodic nature of angles when utilizing RMSE and MAE for
trajectory angles.
4.4 Experimental Results
4.4.1 Overall Imputation Performance. Table 1 presents the overall
imputation performance vessel trajectory (i.e., LAT and LON) at var-
ious missing scenarios (6 hours, 8 hours, and 10 hours). The perfor-
mance comparison reveals that our proposed framework basically
outperforms other methods for all missing scenarios. While CSDI
demonstrates superior performance compared to representative
approaches in both MAE and RMSE metrics, our proposed diffusion-
based framework exhibits a notable reduction in error accumulation
for highly missing scenarios when compared to competitive base-
lines. This superior predictive capability can be attributed to two
key factors. Firstly, our model incorporates an effective trajectory
embedding module, enabling it to capture implicit patterns of ves-
sel movements. This is evident in the performance comparison
between Our_NR and Ours, where the former experiences a notice-
able decrease in performance. Furthermore, recent AIS imputation
method (i.e., multi-task AIS), struggle to achieve higher accuracy
without complex modeling for long-term imputation problem. Sec-
ondly, when comparing Ours with Ours_NP, it is evident that while
the design of the physics-guided discriminator primarily focuses
on ensuring the trajectory continuity, it also effectively learns the
kinematic constraints of the imputed trajectories. This contributes
to better imputation results, particularly in highly missing scenes.
4.4.2 Ablation Study of Imputation Trajectory Continuity. While
Table 1 presents an imputation error comparison among Ours_NR,
Ours_NP and Ours, we conduct another ablation study for impu-
tation trajectory continuity. In Table 2, we calculate the trajec-
tory angles between consecutive points for both ground-truth and
imputed trajectories. Subsequently, we compare the MAE/RMSE
performance for trajectory angle errors across various missing sce-
narios. Meanwhile, we introduce a model variant, Ours_ADD, to
validate the effectiveness of the physics-guided discriminator for
diffusion model. Based on the result comparisons, we can observe
that the physics-guided discriminator yields more continuous tra-
jectory imputation results at each missing scenario. On the contrary,
directly adding an angle loss component (Ours_ADD) shows no
discernible effect. This outcome is reasonable considering the close
relationship between locations and angles. Consequently, employ-
ing a single angle loss is insufficient for imputation model. These
experimental results further confirm the efficacy of the key designs
in our diffusion probabilistic model for long-term imputation task.
4.4.3 Hyper-parameter Tuning. Apart from evaluating the com-
ponents of our proposed framework, there are two crucial param-
eters in our model. In Fig. 4(a), we first access our model under
different combinations of embedding resolution belonging to pre-
trained trajectory embedding module in the range of 0.01◦,0.05◦and0.1◦. We get the best imputation performance with an embed-
ding resolution of 0.01◦, while the performance gets worse as the
resolution increases. It indicates that our diffusion model bene-
fits from fine-grained trajectory embedding. Meanwhile, Fig. 4(b)
reports the influence of different discriminator steps 𝜏in physics-
guided discriminator. We observe that: i) when 𝜏is too small, the
physics-guided discriminator attempts to learn a more sophisticated
distribution, leading to worse trajectory continuity performance;
and ii) when 𝜏is too large, it has already captured the denoised
distribution, encountering a performance bottleneck.
Example1Example2
(a) Map visualization of two imputation examples
0 20 40 60 80 100 120 140
Trajectory Length0255075100125150175200Angle
Ground-truth
Ours_NP
Ours_ADD
Ours
Masked Part
(b) Changes of imputation trajectory angles for example 1
0 20 40 60 80 100 120 140
Trajectory Length80100120140160180200AngleGround-truth
Ours_NP
Ours_ADD
Ours
Masked Part
(c) Changes of imputation trajectory angles for example 2
Figure 6: Two Screenshots of trajectory imputation (10-hour
missing scenarios).
4.5 Case Study
To further investigate the capability of our framework in both
accuracy and continuity of trajectory imputation, we conduct the
following two case study : (1) heatmap comparison among main
baseline and model variants; (2) examples of imputation trajectory
continuity.
On one hand, we present imputation visualizations for both 6-
hour and 10-hour missing scenarios, encompassing short and long
masks. Fig. 5 provides a heatmap comparison of imputation tra-
jectories based on the entire test set. We observe that our model
4405Long-Term Vessel Trajectory Imputation with Physics-Guided Diffusion Probabilistic Model KDD ’24, August 25–29, 2024, Barcelona, Spain
exhibits similar patterns to the ground truth, displaying more de-
tailed route lines compared to CSDI and Ours_NR, particularly in
highly missing scenarios. However, CSDI and Ours_NR provide a
coarse heatmap of imputation results, underscoring the effective-
ness of the pre-trained trajectory embedding module.
On the other hand, we take two practical examples to evalu-
ate the continuity of imputed trajectories in Fig. 6. Here, we fo-
cus on the 10-hour missing scenario to highlight the challenge of
trajectory continuity. We observe that our proposed framework
exhibits smaller angle errors compared to model variants lacking a
physics-guided discriminator. This observation suggests that our
combination of the physics-guided discriminator with the diffusion
model enhances the smoothness of long-term imputation tasks.
5 CONCLUSION
In this paper, we aim to address the main concerns of long-term
AIS signal missing problem and propose a novel diffusion-based
generative framework for vessel trajectory imputation, with the
consideration of both accuracy and continuity of imputed trajecto-
ries. The experimental results illustrate that our proposed approach
surpasses several state-of-the-art baseline methods. These findings
are significant for enhancing maritime traffic management and
contributing to the safety and security of maritime transportation.
As future work, we plan to extend the proposed model by incorpo-
rating more complex physics constraints (e.g., weather factors) for
vessel movements.
6 ACKNOWLEDGMENTS
This work was partially supported by the grants of National Key
Research and Development Project (2021YFB1714400) of China,
Jilin Provincial International Cooperation Key Laboratory for Super
Smart City and Zhujiang Project (2019QN01S744).
References
[1]Prithu Banerjee, Sayan Ranu, and Sriram Raghavan. 2014. Inferring uncertain
trajectories from partial observations. In 2014 IEEE International Conference on
Data Mining. IEEE, 30–39.
[2]Yile Chen, Gao Cong, and Cuauhtemoc Anda. 2023. TERI: An Effective Framework
for Trajectory Recovery with Irregular Time Intervals. Proceedings of the VLDB
Endowment 17, 3 (2023), 414–426.
[3]Yuqi Chen, Hanyuan Zhang, Weiwei Sun, and Baihua Zheng. 2023. Rntrajrec:
Road network enhanced trajectory recovery with spatial-temporal transformer.
In2023 IEEE 39th International Conference on Data Engineering (ICDE). IEEE,
829–842.
[4]Kyunghyun Cho, Bart Van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau,
Fethi Bougares, Holger Schwenk, and Yoshua Bengio. 2014. Learning phrase
representations using RNN encoder-decoder for statistical machine translation.
arXiv preprint arXiv:1406.1078 (2014).
[5]Junyoung Chung, Kyle Kastner, Laurent Dinh, Kratarth Goel, Aaron C Courville,
and Yoshua Bengio. 2015. A recurrent latent variable model for sequential data.
Advances in neural information processing systems 28 (2015).
[6]Pasquale Coscia, Paolo Braca, Leonardo M Millefiori, Francesco AN Palmieri,
and Peter Willett. 2018. Multiple Ornstein–Uhlenbeck processes for maritime
traffic graph representation. IEEE Trans. Aerospace Electron. Systems 54, 5 (2018),
2158–2170.
[7]Andrej Dobrkovic, Maria-Eugenia Iacob, and Jos van Hillegersberg. 2018. Mar-
itime pattern extraction and route reconstruction from incomplete AIS data.
International journal of Data science and Analytics 5 (2018), 111–136.
[8]Mohamed M Elshrif, Keivin Isufaj, and Mohamed F Mokbel. 2022. Network-
less trajectory imputation. In Proceedings of the 30th International Conference on
Advances in Geographic Information Systems. 1–10.
[9]Jessica H Ford, David Peel, David Kroodsma, Britta Denise Hardesty, Uwe Rose-
brock, and Chris Wilcox. 2018. Detecting suspicious activities at sea based on
anomalies in Automatic Identification Systems transmissions. PLoS One 13, 8
(2018), e0201640.[10] Yarin Gal and Zoubin Ghahramani. 2016. A theoretically grounded application of
dropout in recurrent neural networks. Advances in neural information processing
systems 29 (2016).
[11] Dawei Gao, Yongsheng Zhu, and C Guedes Soares. 2023. Uncertainty modelling
and dynamic risk assessment for long-sequence AIS trajectory based on mul-
tivariate Gaussian Process. Reliability Engineering & System Safety 230 (2023),
108963.
[12] Jiyang Gao, Chen Sun, Hang Zhao, Yi Shen, Dragomir Anguelov, Congcong Li,
and Cordelia Schmid. 2020. Vectornet: Encoding hd maps and agent dynamics
from vectorized representation. In Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition. 11525–11533.
[13] Chenjuan Guo, Bin Yang, Jilin Hu, and Christian Jensen. 2018. Learning to route
with sparse trajectory sets. In 2018 IEEE 34th International Conference on Data
Engineering (ICDE). IEEE, 1073–1084.
[14] Jonathan Ho, Ajay Jain, and Pieter Abbeel. 2020. Denoising diffusion probabilistic
models. Advances in neural information processing systems 33 (2020), 6840–6851.
[15] Jiahao Ji, Jingyuan Wang, Zhe Jiang, Jiawei Jiang, and Hu Zhang. 2022. STDEN:
Towards physics-guided neural networks for traffic flow prediction. In Proceedings
of the AAAI Conference on Artificial Intelligence, Vol. 36. 4048–4056.
[16] Gözde Boztepe Karataş, Pinar Karagoz, and Orhan Ayran. 2021. Trajectory pattern
extraction and anomaly detection for maritime vessels. Internet of Things 16
(2021), 100436.
[17] Dengyuhui Li, Jianbin Jiao, Shouyang Wang, and Guanghui Zhou. 2023. Supply
Chain Resilience from the Maritime Transportation Perspective: A Bibliometric
Analysis and Research Directions. Fundamental Research (2023).
[18] Yang Li, Si Si, Gang Li, Cho-Jui Hsieh, and Samy Bengio. 2021. Learnable fourier
features for multi-dimensional spatial positional encoding. Advances in Neural
Information Processing Systems 34 (2021), 15816–15829.
[19] Maohan Liang, Ryan Wen Liu, Qianru Zhong, Jingxian Liu, and Jinfeng Zhang.
2019. Neural network-based automatic reconstruction of missing vessel trajectory
data. In 2019 IEEE 4th International Conference on Big Data Analytics (ICBDA).
IEEE, 426–430.
[20] Wuman Luo, Haoyu Tan, Lei Chen, and Lionel M Ni. 2013. Finding time period-
based most frequent path in big trajectory data. In Proceedings of the 2013 ACM
SIGMOD international conference on management of data. 713–724.
[21] Wesley Mathew, Ruben Raposo, and Bruno Martins. 2012. Predicting future
locations with hidden Markov models. In Proceedings of the 2012 ACM conference
on ubiquitous computing. 911–918.
[22] Thomas Mestl, Ken Tore Tallakstad, and R Castberg. 2016. Identifying and
analyzing safety critical maneuvers from high resolution AIS data. TransNav:
International Journal on Marine Navigation and Safety of Sea Transportation 10, 1
(2016), 69–77.
[23] Duong Nguyen and Ronan Fablet. 2024. A Transformer Network with Sparse
Augmented Data Representation and Cross Entropy Loss for AIS-based Vessel
Trajectory Prediction. IEEE Access (2024).
[24] Duong Nguyen, Rodolphe Vadaine, Guillaume Hajduch, René Garello, and Ronan
Fablet. 2018. A multi-task deep learning architecture for maritime surveillance
using AIS data streams. In 2018 IEEE 5th International Conference on Data Science
and Advanced Analytics (DSAA). IEEE, 331–340.
[25] Duong Nguyen, Rodolphe Vadaine, Guillaume Hajduch, René Garello, and Ronan
Fablet. 2021. GeoTrackNet—A maritime anomaly detector using probabilistic
neural network representation of AIS tracks and a contrario detection. IEEE
Transactions on Intelligent Transportation Systems 23, 6 (2021), 5655–5667.
[26] Huimin Ren, Sijie Ruan, Yanhua Li, Jie Bao, Chuishi Meng, Ruiyuan Li, and Yu
Zheng. 2021. Mtrajrec: Map-constrained trajectory recovery via seq2seq multi-
task learning. In Proceedings of the 27th ACM SIGKDD Conference on Knowledge
Discovery & Data Mining. 1410–1419.
[27] MD Robards, GK Silber, JD Adams, J Arroyo, D Lorenzini, K Schwehr, and J
Amos. 2016. Conservation science and policy applications of the marine vessel
Automatic Identification System (AIS)—a review. Bulletin of Marine Science 92, 1
(2016), 75–103.
[28] Rongye Shi, Zhaobin Mo, and Xuan Di. 2021. Physics-informed deep learning
for traffic state estimation: A hybrid paradigm informed by second-order traffic
models. In Proceedings of the AAAI Conference on Artificial Intelligence , Vol. 35.
540–547.
[29] Hao Sun, Changjie Yang, Liwei Deng, Fan Zhou, Feiteng Huang, and Kai Zheng.
2021. Periodicmove: shift-aware human mobility recovery with graph neural
network. In Proceedings of the 30th ACM International Conference on Information
& Knowledge Management. 1734–1743.
[30] Zygmunt L Szpak and Jules R Tapamo. 2011. Maritime surveillance: Tracking
ships inside a dynamic background using a fast level-set. Expert systems with
applications 38, 6 (2011), 6669–6680.
[31] Yusuke Tashiro, Jiaming Song, Yang Song, and Stefano Ermon. 2021. Csdi: Con-
ditional score-based diffusion models for probabilistic time series imputation.
Advances in Neural Information Processing Systems 34 (2021), 24804–24816.
[32] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. Advances in neural information processing systems 30 (2017).
4406KDD ’24, August 25–29, 2024, Barcelona, Spain Zhiwen Zhang, Zipei Fan, Zewu Lv, Xuan Song, & Ryosuke Shibasaki
[33] Jingyuan Wang, Ning Wu, Xinxi Lu, Wayne Xin Zhao, and Kai Feng. 2019. Deep
trajectory recovery with fine-grained calibration using kalman filter. IEEE Trans-
actions on Knowledge and Data Engineering 33, 3 (2019), 921–934.
[34] Erik F Wilthil, Andreas L Flåten, Edmund F Brekke, Morten Breivik, et al .2018.
Radar-based maritime collision avoidance using dynamic window. In 2018 IEEE
aerospace conference. IEEE, 1–9.
[35] Hao Wu, Jiangyun Mao, Weiwei Sun, Baihua Zheng, Hanyuan Zhang, Ziyang
Chen, and Wei Wang. 2016. Probabilistic robust route recovery with spatio-
temporal dynamics. In Proceedings of the 22nd ACM SIGKDD International Con-
ference on Knowledge Discovery and Data Mining. 1915–1924.
[36] Ning Wu, Xin Wayne Zhao, Jingyuan Wang, and Dayan Pan. 2020. Learning
effective road network representation with hierarchical graph neural networks.
InProceedings of the 26th ACM SIGKDD international conference on knowledge
discovery & data mining. 6–14.[37] Yi Xu, Armin Bazarjani, Hyung-gun Chi, Chiho Choi, and Yun Fu. 2023. Uncov-
ering the Missing Pattern: Unified Framework Towards Trajectory Imputation
and Prediction. In Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition. 9632–9643.
[38] Xiaocai Zhang, Xiuju Fu, Zhe Xiao, Haiyan Xu, and Zheng Qin. 2022. Vessel
trajectory prediction in maritime transportation: Current approaches and beyond.
IEEE Transactions on Intelligent Transportation Systems (2022).
[39] Rong Zhen, Ziqiang Shi, Zheping Shao, and Jialun Liu. 2022. A novel regional
collision risk assessment method considering aggregation density under multi-
ship encounter situations. The Journal of Navigation 75, 1 (2022), 76–94.
[40] Yuanshao Zhu, Yongchao Ye, Shiyao Zhang, Xiangyu Zhao, and James Yu. 2023.
DiffTraj: Generating GPS Trajectory with Diffusion Probabilistic Model. In Thirty-
seventh Conference on Neural Information Processing Systems.
4407