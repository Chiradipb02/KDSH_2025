GENOT: Entropic (Gromov) Wasserstein Flow
Matching with Applications to Single-Cell Genomics
Dominik Klein∗†
Helmholtz Munich
dominik.klein@helmholtz-munich.deThéo Uscidda∗
CREST-ENSAE
theo.uscidda@ensae.fr
Fabian Theis
Helmholtz Munich
fabian.theis@helmholtz-munich.deMarco Cuturi
Apple
cuturi@apple.com
Abstract
Single-cell genomics has significantly advanced our understanding of cellular be-
havior, catalyzing innovations in treatments and precision medicine. However,
single-cell sequencing technologies are inherently destructive and can only mea-
sure a limited array of data modalities simultaneously. This limitation underscores
the need for new methods capable of realigning cells. Optimal transport (OT)
has emerged as a potent solution, but traditional discrete solvers are hampered by
scalability, privacy, and out-of-sample estimation issues. These challenges have
spurred the development of neural network-based solvers, known as neural OT
solvers, that parameterize OT maps. Yet, these models often lack the flexibility
needed for broader life science applications. To address these deficiencies, our
approach learns stochastic maps (i.e. transport plans), allows for any cost function,
relaxes mass conservation constraints and integrates quadratic solvers to tackle the
complex challenges posed by the (Fused) Gromov-Wasserstein problem. Utilizing
flow matching as a backbone, our method offers a flexible and effective framework.
We demonstrate its versatility and robustness through applications in cell develop-
ment studies, cellular drug response modeling, and cross-modality cell translation,
illustrating significant potential for enhancing therapeutic strategies.
1 Introduction
Discrete Optimal Transport in Single-Cell Genomics. Due to the destructive nature of single-cell
sequencing technologies, it is fundamental to realign distributions of sequenced cells. Discrete
optimal transport (OT) has proven useful in this task. For example, it is standard practice to leverage
the framework of OT to reconstruct cellular trajectories across developmental time points [ 72]
and to study the response of cells to external perturbations like drugs or gene knockouts [ 18]. In
these settings, both distributions, i.e. earlier and later time point and before perturbation and after
perturbation, respectively, live in the same space, a setting which we refer to as linear OT. In contrast,
most applications of OT in single-cell genomics require maps across (partially) incomparable spaces,
the setting which we refer to as quadratic OT. For example, analysis of spatial transcriptomics
datasets requires the quadratic formulation of OT as the coordinate systems of two different slices
are warped and rotated, thus not living in the same coordinate space [ 60]. Similarly, adding spatial
information as a prior has been shown to improve the performance of modeling the trajectory of
cells in the discrete setting [ 39]. Analogously, adding information from lineage tracing readouts [ 89]
∗Equal contribution
†Work done during internship at Apple
38th Conference on Neural Information Processing Systems (NeurIPS 2024).recovers the evolution of cells more faithfully [ 42]. Another prevalent task in single-cell genomics
which is commonly approached with quadratic OT solvers is the alignment of cells across modalities
[17]. Most single-cell technologies capture only one modality, which is insufficient to obtain a
comprehensive representation of the cellular state. As single-cell datasets grow larger [ 65], traditional
OT solvers become less applicable to tasks in single-cell genomics due to their high computational
complexity. Thanks to recent advancements in low-rank OT [ 69,70,71], the aforementioned OT-
based algorithms are more accessible to single-cell biologists [ 39]. Yet, the non-parametric nature
of discrete OT solvers entails issues with respect to data privacy and prevents their application to
large scale single-cell atlases capturing millions of cells [ 65]. Moreover, out-of-samples estimation is
limited to very specific scenarios [63].
Current Limitations of Neural Optimal Transport in Single-Cell Genomics. To overcome these
limitations, neural OT solvers have been leveraged to study cellular perturbations [ 7,8,86] and to
model cellular trajectories [ 21,83]. Yet, these methods estimate Monge maps, i.e., deterministic
maps, contradicting the assumption that cells evolve stochastically [ 19]. Stochastic formulations are
also favorable as they can produce a conditional distribution that can be used to quantify uncertainty
[25]. In the discrete setting, stochastic maps can be obtained from entropy-regularized OT (EOT) [ 13].
Recently, a number of works have addressed learning EOT plans [ 29,41,76,84,85] in the neural
setting. Yet, all of these methods are limited in the choice of the cost function, with most of them being
restricted to the squared Euclidean cost. Single-cell genomics data is known to be non-Euclidean
[57] and thus requires a flexible choice of the cost function in OT applications as demonstrated
in the discrete OT setting in Demetci et al. [17], Huguet et al. [35], Klein et al. [39]. The third
requirement for applying OT to single-cell genomics is the option to lift the mass conservation
constraint, allowing for unbalanced optimal transport [ 11,24,74]. Unbalanced OT is crucial to
model cellular growth and death as well as for automatically discarding outliers, which are prevalent
in highly noisy measurements in single-cell genomics. Eyring et al. [20], Lübeck et al. [50], Yang
and Uhler [94] proposed ways to incorporate unbalancedness into deterministic linear OT maps,
while unbalanced formulations for entropic neural OT have barely been explored. The most severe
shortcoming of the existing plethora of neural OT estimators is their limitation to the linear OT
scenario, i.e., to learning maps within spaces. Yet, most applications in single-cell genomics require
the Gromov-Wasserstein (GW) [ 54] or the fused Gromov-Wasserstein (FGW) [ 88] formulation. To
the best of our knowledge, the only neural formulation for GW proposed thus far learns deterministic,
balanced maps for the inner product costs, using a min-max-min optimization procedure, severely
limiting its applications [ 58]. Hence, we arrive at four necessities that need to be fulfilled andhave to
be flexibly combinable to make neural OT generally applicable to problems in single-cell genomics:
•N1: modeling the evolution of cells stochastically as opposed to deterministically,
•N2: flexibly choosing cost functions due to non-Euclidean geometry of single-cell genomics data,
•N3: allowing for unbalanced OT to model cellular growth and death or accounting for outliers,
•N4: mapping across completely orpartially incomparable spaces.
Contributions. Hence, we propose GENOT (Generative Entropic Neural Optimal Transport), a
powerful and flexible neural OT framework that satisfies all of the above requirements:
•GENOT is the first method that parameterizes linear and quadratic EOT couplings for anycost by
modeling their conditional distributions, using flow matching [45] as a backbone.
•We extend GENOT to the unbalanced setting, resulting in U-GENOT, to flexibly allow for mass
variations in both the linear and the quadratic setting.
•We extend (U-)GENOT to address the fused problem and this way propose, to the best of our
knowledge, the first neural OT solver for the FGW problem.
•We showcase GENOT’s ability to handle common challenges in single-cell biology: we (i) quantify
lineage branching events in the developing mouse pancreas, (ii) predict cellular responses to drug
perturbations, along with a well-calibrated uncertainty estimation, and (iii) translate ATAC-seq to
RNA-seq with GW and introduce a novel method to perform this translation task with FGW.
2 Background
Notations. LetX ⊂Rp,Y ⊂Rqcompact sets, referred to as the source and the target domain,
respectively. In general, p̸=q. The set of positive (resp. probability) measures on Xis denoted by
M+(X)(resp.M+
1(X)). For π∈ M+(X × Y ),π1:=p1♯πandπ2:=p2♯πdenote its marginals.
2Then, for µ∈ M+(X), ν∈ M+(Y),Π(µ, ν) ={π:π1=µ, π 2=ν}.dµ
dνdenotes the relative
density of µw.r.t.ν, s.t.µ=dµ
dν·ν. Forρ, γ∈ M+(X),KL(ρ|γ) =R
Xlog(dρ
dγ) dρ−R
Xdγ+R
Xdρ.
Linear Entropic OT. Letc:X ×Y → Rbe a continuous cost function, µ∈ M+
1(X), ν∈ M+
1(Y)
andε≥0. The linear entropy-regularized OT problem reads
min
π∈Π(µ,ν)Z
X×Ycdπ+εKL(π|µ⊗ν). (LEOT)
A solution π⋆
εof(LEOT) always exists and is unique when ε >0.(LEOT) is also known as the static
Schrödinger bridge (SB) problem [ 52]. With ε= 0, we recover the Kantorovich [38] problem. For
discrete µandν, we can solve (LEOT) with the Sinkhorn algorithm [ 13], whose complexity for n
points is O(n2)in time, and O(n)orO(n2)in memory, depending on c.
Quadratic Entropic OT. As opposed to considering an inter-domain cost defined on X ×Y , quadratic
entropic OT is concerned with seeking couplings that minimize the distortion of the geometries
induced by intra-domain cost functions cX:X × X → RandcY:Y × Y → R:
min
π∈Π(µ,ν)Z
(X×Y )2DcX,cYd(π⊗π) +εKL(π∥µ⊗ν), (QEOT)
where DcX,cY(x,y,x′,y′) :=|cX(x,x′)−cY(y,y′)|2quantifies the pointwise cost distortion.
A solution π⋆
εto Prob. (QEOT) always exists (see B.1). With ε= 0, we recover the Gromov-
Wasserstein [ 54] problem, which is the standard OT formulation for transporting measures supported
onincomparable spaces. In addition to statistical benefits [ 95], using ε >0also offers computational
benefits, since for discrete µandν, we can solve (QEOT) with a mirror descent scheme iterating
the Sinkhorn algorithm [ 62]. For measures on npoints, its time complexity is O(n2)orO(n3),
depending on cXandcY[70, Alg. 1&2], while its memory complexity is always O(n2).
Unbalanced Extensions. The EOT formulations presented above can only handle measures with the
same total mass. Unbalanced optimal transport (UOT) [ 11,44] lifts this constraint by penalizing the
deviation of p1♯πtoµandp2♯πtoνwith a divergence. Using the KLand introducing weightings
λ1, λ2>0the unbalanced extension of (LEOT) reads
min
π∈M+(X×Y )Z
X×Ycdπ+εKL(π|µ⊗ν) +λ1KL(π1|µ) +λ2KL(π2|ν). (ULEOT)
This problem can be solved efficiently in the discrete setting using a variant of the Sinkhorn algorithm
[24, 80]. Analogously, quadratic OT also admits an unbalanced generalization, which reads
min
π∈M+(X×Y )Z
(X×Y )2DcX,cYd(π⊗π) +εKL⊗(π|µ⊗ν) +λ1KL⊗(π1|µ) +λ2KL⊗(π2|ν),
(UQEOT)
where KL⊗(ρ|γ) = KL( ρ⊗ρ|γ⊗γ). A solution π⋆
ε,τto Prob. (UQEOT) always exists (see B.1).
In the discrete setting, Prob. (UQEOT) can be solved using an extension of Peyré et al. [62]’s
scheme introduced by Séjourné et al. [81]. Each solver has the same time and memory complexity
as its balanced counterpart. For both (ULEOT) and(UQEOT) , instead of selecting λi, we introduce
τi=λi
λi+εs.t. we recover the marginal constraint for τi= 1, when λi→+∞. We write τ= (τ1, τ2).
Flow Matching (FM). Given a prior ρ0∈ M+
1(Rd)and a time-dependent vector field (vt)t∈[0,1],
one can define a probability path ptstarting from ρ0using the flow ϕtsolving
d
dtϕt(z) =vt(ϕt(z)), ϕ 0(z) =z, (1)
by setting pt=ϕt♯ρ0. We then say that vtgenerates the path pt. Continuous Normalizing Flows
[9] (CNFs) model vt,θwith a neural network , which is trained to match a terminal condition
p1=ρ1∈ M+
1(Rd). FM [ 45] is a simulation-free technique to train CNFs by constructing
individual paths between samples, and minimizing
Et,Z0∼ρ0,Z1∼ρ1[∥vt,θ([Z0, Z1]t)−(Z1−Z0)∥2
2], (2)
where [Z0, Z1]t:= (1−t)Z0+tZ1witht∼ U([0,1]). If this loss is 0, the flow maps ρ0toρ1, i.e.,
ϕ1♯ρ0=ρ1. This property is often referred to as FM preserving the marginal distribution.
3<latexit sha1_base64="4JKhVpflD1grH9ybr7DjoMX6cnE=">AAACSnicbVDBTttAFFyHtA0pLaE9clkRIXGKbISAIw2X3gioIUhxGq3Xz2GV9drafY6ILH9Pf6ZcqfobuVVc2DhWBYSRVhrNvPd2NEEqhUHX/evUNurv3n9obDY/bn36vN3a+XJtkkxz6PNEJvomYAakUNBHgRJuUg0sDiQMgun50h/MQBuRqB84T2EUs4kSkeAMrTRuffMR7rC8k3czrfBCMzWBIi/1IMpnxfg/94qC+kJRP2Z4GwT5VfEzLMattttxS9B14lWkTSr0xq2FHyY8i0Ehl8yYoeemOMqZRsElFE0/M5AyPmUTGFqqWAxmlJcRC7pvlZBGibZPIS3V5xs5i42Zx4GdXIY0r72l+JY3zDA6HeVCpRmC4quPokxSTOiyNxoKDRzl3BLGtbBZKb9lmnG07b64FM5EaqrUd6vYTVuS97qSdXJ92PGOO8eXR+2zblVXg+ySPXJAPHJCzsh30iN9wskvck8eyB/nt7Nw/jmPq9GaU+18JS9Qqz8BC5q2oQ==</latexit>v12Rd
Conditioning on FlowConditionalSamples(Shared) features<latexit sha1_base64="Jnuvx+QLnQjz/41Wlx1CBcU/r2s=">AAAC0XicbVFNa9tAEF0p/UjVpHWaYy+ippCWYCR/5xbcS29JaJ0ELFesViNnyWoldlepjbJQeu0v7KH/pSvZJI6TgYW3b95jhjdRzqhUnvfXsreePX/xcvuV83pn983bxt67c5kVgsCYZCwTlxGWwCiHsaKKwWUuAKcRg4vo+kvVv7gBIWnGv6tFDtMUzzhNKMHKUGHjZ5DTsAxusIBcUpZx/ePzQUDiTN0GCuaqnlAKiHVZ/6OknOvwDvta60N3TTkqBFcnAvMZ3DuKDccnxwkbTa/l1eU+Bv4KNNGqTsM9axTEGSlS4IowLOXE93I1LbFQlDDQTlBIyDG5xjOYGMhxCnJa1ltp96NhYjfJhHlcuTW77ihxKuUijYwyxepKbvYq8qnepFDJcFpSnhcKOFkOSgrmqsyt4nZjKoAotjAAE0HNri65wgITZY7yYMp8uaoTxJCYYz4Rp5hFuvRaR/6g3x14veGw3em1j7qHJrde119nOxW3IfM7ukrd38z4MThvt/x+q3/WbR6PVvlvo/foAzpAPhqgY/QVnaIxIuiftWXtWLv2N3th/7J/L6W2tfLsowdl//kPrfHcvg==</latexit>⇡⇤"(·|x1,u1)
<latexit sha1_base64="t3fMdQqeBszpE9wSak/khjUS0F4=">AAACxHicbVFda9swFFXcfXTeV9o97sUsDDoowcp330oGY2/rYGkLcTCyfJ1olWUjXY8Ez/uNe90f2eumOGFL014QHJ17ju7lKMqlMOj7vxrOwYOHjx4fPnGfPnv+4mXz6PjSZIXmMOGZzPR1xAxIoWCCAiVc5xpYGkm4im7er/tX30AbkakvuMphlrK5EongDC0VNr8G+UKE9CTgcYbfA4Ql1o+WGuKqrO9RUi6r8B+mVVWdejvKcaEVftJMzeG/o9hzvHPdsNny235d3l1At6BFtnURHjXGQZzxIgWFXDJjptTPcVYyjYJLqNygMJAzfsPmMLVQsRTMrKy3qry3lom9JNP2KPRqdtdRstSYVRpZZcpwYfZ7a/K+3rTAZDQrhcoLBMU3g5JCeph564S9WGjgKFcWMK6F3dXjC6YZR/sPt6YsN6u6QQyJ/b974tTzqCr99hkdDnpDvz8adbr9zlnv1ObW79Fdtrvm9mS0W61Tp/sZ3wWXnTYdtAefe63z8Tb/Q/KavCEnhJIhOScfyQWZEE5+kt/kT4M4HxzpGKfYSJ3G1vOK3Crnx1/aM9i0</latexit> 1(·|x1,u1)
<latexit sha1_base64="BQrJZaUqSKxz3IPwDcLJe601EVc=">AAACtnicbVHLbtswEKTVV6q+nPaYC1GjQA+BIfqdW+BecksK1EkAyzUoaqUQoSiBpAobAn+uf9E/6LX9glCy0TpOFiAwnJ3hLoZRIbg2QfCr5T15+uz5i4OX/qvXb96+ax++v9R5qRjMWC5ydR1RDYJLmBluBFwXCmgWCbiKbr/U/asfoDTP5TezLmCR0VTyhDNqHLVsh6GBlWneqRTEtmruUVKt7PIfJtbaY7yjnJZKmnNFZQr/HeWew/eX7U7QDZrCDwHZgg7a1sXysDUN45yVGUjDBNV6ToLCLCqqDGcCrB+WGgrKbmkKcwclzUAvqmYpiz85JsZJrtyRBjfsrqOimdbrLHLKjJobvd+rycd689Ikk0XFZVEakGwzKCkFNjmuM8UxV8CMWDtAmeJuV8xuqKLMuOTvTVltVvXDGBL3Y4+kqdLIVkH3hIxHg3EwnEx6/WHvZHDschsOyC7br7k9GenbOnWyn/FDcNnrklF39HXQOZ1u8z9AR+gj+owIGqNTdIYu0Awx9BP9Rn/QX2/ifffASzdSr7X1fED3yivuAB4S1Cc=</latexit>x1,u1
<latexit sha1_base64="YHyEB202SgxscN2PGM8b52AG838=">AAAC4HicjVJNaxsxENVuv1K3TZ322IuoKSRQzG4IaXoLCZQcWuJCnARsYyTtrCOi1S7SKNhs9t5byTU/pf+k/6by2rQbJ4cOCB5v3psZZsQLJS1G0e8gfPT4ydNna89bL16+Wn/d3nhzanNnBPRFrnJzzpkFJTX0UaKC88IAy7iCM355OM+fXYGxMtcnOCtglLGJlqkUDD01bv/aHCJMsS5UcuWgKmuCp+WsGv/Fsqqqj7QhPXBG47FhetJwXK04tq6b1Q0k/6TThjT+r+JuxbE1bneiblQHvQ/iJeiQZfTGG8H6MMmFy0CjUMzaQRwVOCqZQSkUVK2hs1AwcckmMPBQswzsqKxnqugHzyQ0zY1/GmnNNh0ly6ydZdwrM4YXdjU3Jx/KDRyme6NS6sIhaLFolDpFMafzi9FEGhCoZh4wYaSflYoLZphAf9c7XaaLUVvDBFL/Hx5Y5tHJt69VCXzv83ZStfwG49V93Qen2914t7v7faezf7Dc5Rp5R96TTRKTT2SfHJEe6RMR0OBLcBz0Qh7+CH+GNwtpGCw9b8mdCG//AJa68F0=</latexit>(yi,vi)|(x1,u1)
Sourceµ<latexit sha1_base64="3w2oFpmXv1bTesnubkd905c+Kh4=">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</latexit>
Noise⇢<latexit sha1_base64="OrD+SJkKXvFtuOHr4VnqbK5x3h0=">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</latexit>
Target⌫<latexit sha1_base64="I9g82bC/eW6hRp96VF2A/zi0C5A=">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</latexit>
x1
<latexit sha1_base64="uip11OscUolNM5UcKgPJMrAiMt0=">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</latexit>
zi
<latexit sha1_base64="WrfTyk8LHqMpbjcigo6IrSDolNk=">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</latexit>
<latexit sha1_base64="8iFpWp8MZ6TojnxTRZXEtXaYLmI=">AAACEXicbVC7SgNBFJ2Nrxhfq5Y2i0FIFXaDRMugjWUE84AkhNnJ3WTI7IOZu5Kw7C/Y+Cs2ForY2tn5N042QTTxwMCZc+69c+e4keAKbfvLyK2tb2xu5bcLO7t7+wfm4VFThbFk0GChCGXbpQoED6CBHAW0IwnUdwW03PH1zG/dg1Q8DO5wGkHPp8OAe5xR1FLfLHURJpjNSSQM0iS7u14ySfs/vJKmad8s2mU7g7VKnAUpkgXqffOzOwhZ7EOATFClOo4dYS+hEjkTkBa6sYKIsjEdQkfTgPqgekm2SWqdaWVgeaHUJ0ArU393JNRXauq7utKnOFLL3kz8z+vE6F32Eh5EMULA5g95sbAwtGbxWAMugaGYakKZ5HpXi42opAx1iAUdgrP85VXSrJSdarl6e16sXS3iyJMTckpKxCEXpEZuSJ00CCMP5Im8kFfj0Xg23oz3eWnOWPQckz8wPr4BraKfdA==</latexit>x2
y1
<latexit sha1_base64="QJJyLmb2n1oBZKCHV7f7eYUf50E=">AAACMHicbVDLSsNAFJ34rPVVdekmWERXJZGKLotuXFawD2hLmUxv2qGTBzM3pSXkE/wZ3ep/6ErcuvQLnKYRbOuBgcM59945HCcUXKFlvRsrq2vrG5u5rfz2zu7efuHgsK6CSDKosUAEsulQBYL7UEOOApqhBOo5AhrO8HbqN0YgFQ/8B5yE0PFo3+cuZxS11C2ctRHGmN6JHRFBEqeC48aTpPtL7STpFopWyUphLhM7I0WSodotfLd7AYs88JEJqlTLtkLsxFQiZwKSfDtSEFI2pH1oaepTD1QnToMk5qlWeqYbSP18NFP170ZMPaUmnqMnPYoDtehNxf+8VoTudSfmfhgh+Gz2kRsJEwNz2o7Z4xIYiokmlEmus5psQCVlqDucu9Qb8VBlqcez2Hldkr1YyTKpX5Tscunyvlys3GR15cgxOSHnxCZXpELuSJXUCCOP5Jm8kFfjyXgzPozP2eiKke0ckTkYXz+yzayc</latexit>
<latexit sha1_base64="4JKhVpflD1grH9ybr7DjoMX6cnE=">AAACSnicbVDBTttAFFyHtA0pLaE9clkRIXGKbISAIw2X3gioIUhxGq3Xz2GV9drafY6ILH9Pf6ZcqfobuVVc2DhWBYSRVhrNvPd2NEEqhUHX/evUNurv3n9obDY/bn36vN3a+XJtkkxz6PNEJvomYAakUNBHgRJuUg0sDiQMgun50h/MQBuRqB84T2EUs4kSkeAMrTRuffMR7rC8k3czrfBCMzWBIi/1IMpnxfg/94qC+kJRP2Z4GwT5VfEzLMattttxS9B14lWkTSr0xq2FHyY8i0Ehl8yYoeemOMqZRsElFE0/M5AyPmUTGFqqWAxmlJcRC7pvlZBGibZPIS3V5xs5i42Zx4GdXIY0r72l+JY3zDA6HeVCpRmC4quPokxSTOiyNxoKDRzl3BLGtbBZKb9lmnG07b64FM5EaqrUd6vYTVuS97qSdXJ92PGOO8eXR+2zblVXg+ySPXJAPHJCzsh30iN9wskvck8eyB/nt7Nw/jmPq9GaU+18JS9Qqz8BC5q2oQ==</latexit>v12Rd
<latexit sha1_base64="clrXTDtAVPMko4y7X+xjoEFBDc4=">AAADE3icjVLLatwwFJXdV+q+Ju2yi4oOhS7CYM07uzCl0FWTQicJzAyDLF9PRGTZSHKYwfVn9GNKd6XbfkD/prJnaB0ni14QHM495+pypCAVXBvf/+24d+7eu/9g76H36PGTp89a+89PdZIpBlOWiESdB1SD4BKmhhsB56kCGgcCzoLLd2X/7AqU5on8bDYpLGK6kjzijBpLLVvf5gbWppqTByKDIq+IIMo3xfIv5kVRHOCadJIpaY4Vlaua46rhwF9qDgXhP+W6piT/NTtrODxv2Wr7Hb8qfBOQHWijXZ0s953JPExYFoM0TFCtZ8RPzSKnynAmoPDmmYaUsku6gpmFksagF3m1VIHfWCbEUaLskQZXbN2R01jrTRxYZUzNhW72SvK23iwz0XiRc5lmBiTbXhRlApsElw+GQ66AGbGxgDLF7a6YXVBFmbHPeu2W9XZVbx5CZL/DLWmqVVDkfueQjIb9kT8Yj7u9Qfewf2BzG/RJne2VXENGekWZOmlmfBOcdjtk2Bl+6rePJrv899BL9Bq9RQSN0BH6gE7QFDHnlfPe+egcu1/d7+4P9+dW6jo7zwt0rdxffwCKBvsX</latexit>yi,vi|x1,u1
<latexit sha1_base64="YHyEB202SgxscN2PGM8b52AG838=">AAAC4HicjVJNaxsxENVuv1K3TZ322IuoKSRQzG4IaXoLCZQcWuJCnARsYyTtrCOi1S7SKNhs9t5byTU/pf+k/6by2rQbJ4cOCB5v3psZZsQLJS1G0e8gfPT4ydNna89bL16+Wn/d3nhzanNnBPRFrnJzzpkFJTX0UaKC88IAy7iCM355OM+fXYGxMtcnOCtglLGJlqkUDD01bv/aHCJMsS5UcuWgKmuCp+WsGv/Fsqqqj7QhPXBG47FhetJwXK04tq6b1Q0k/6TThjT+r+JuxbE1bneiblQHvQ/iJeiQZfTGG8H6MMmFy0CjUMzaQRwVOCqZQSkUVK2hs1AwcckmMPBQswzsqKxnqugHzyQ0zY1/GmnNNh0ly6ydZdwrM4YXdjU3Jx/KDRyme6NS6sIhaLFolDpFMafzi9FEGhCoZh4wYaSflYoLZphAf9c7XaaLUVvDBFL/Hx5Y5tHJt69VCXzv83ZStfwG49V93Qen2914t7v7faezf7Dc5Rp5R96TTRKTT2SfHJEe6RMR0OBLcBz0Qh7+CH+GNwtpGCw9b8mdCG//AJa68F0=</latexit>(yi,vi)|(x1,u1)
<latexit sha1_base64="Jnuvx+QLnQjz/41Wlx1CBcU/r2s=">AAAC0XicbVFNa9tAEF0p/UjVpHWaYy+ippCWYCR/5xbcS29JaJ0ELFesViNnyWoldlepjbJQeu0v7KH/pSvZJI6TgYW3b95jhjdRzqhUnvfXsreePX/xcvuV83pn983bxt67c5kVgsCYZCwTlxGWwCiHsaKKwWUuAKcRg4vo+kvVv7gBIWnGv6tFDtMUzzhNKMHKUGHjZ5DTsAxusIBcUpZx/ePzQUDiTN0GCuaqnlAKiHVZ/6OknOvwDvta60N3TTkqBFcnAvMZ3DuKDccnxwkbTa/l1eU+Bv4KNNGqTsM9axTEGSlS4IowLOXE93I1LbFQlDDQTlBIyDG5xjOYGMhxCnJa1ltp96NhYjfJhHlcuTW77ihxKuUijYwyxepKbvYq8qnepFDJcFpSnhcKOFkOSgrmqsyt4nZjKoAotjAAE0HNri65wgITZY7yYMp8uaoTxJCYYz4Rp5hFuvRaR/6g3x14veGw3em1j7qHJrde119nOxW3IfM7ukrd38z4MThvt/x+q3/WbR6PVvlvo/foAzpAPhqgY/QVnaIxIuiftWXtWLv2N3th/7J/L6W2tfLsowdl//kPrfHcvg==</latexit>⇡⇤"(·|x1,u1)X⇢R2
<latexit sha1_base64="posxSwUNapHIbtkAQj7HdD34tJg=">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</latexit>
Y⇢R3
<latexit sha1_base64="E35y4oT7AIBthQQF6Mh5DrNy9do=">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</latexit>
ATAC rep. of cellsRNA rep. of cellsCell featuresX⇢Rp
<latexit sha1_base64="34FwVHTA0/RV+N4vziuLRRAOadY=">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</latexit>
ATAC spaceRNA spaceY⇢Rq
<latexit sha1_base64="d8MzopQubSm0yP7eITPauXhxD5U=">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</latexit>
x1
<latexit sha1_base64="uip11OscUolNM5UcKgPJMrAiMt0=">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</latexit>
<latexit sha1_base64="QhIGeZB9eRtJ64DlF9Inzle+FGE=">AAACEHicbZDLSsNAFIYn9VbrrerSTbCIrkoiUl0W3bisYC/QhjCZnrRDJxdmTsQS8ghufBU3LhRx69Kdb+M0raCtBwY+/v+cmTO/Fwuu0LK+jMLS8srqWnG9tLG5tb1T3t1rqSiRDJosEpHseFSB4CE0kaOATiyBBp6Atje6mvjtO5CKR+EtjmNwAjoIuc8ZRS255eMewj3m96SeSCBLc8Hz03Hm/qCdZW65YlWtvMxFsGdQIbNquOXPXj9iSQAhMkGV6tpWjE5KJXImICv1EgUxZSM6gK7GkAagnDRfJDOPtNI3/UjqE6KZq78nUhooNQ483RlQHKp5byL+53UT9C+clIdxghCy6UN+IkyMzEk6Zp9LYCjGGiiTXO9qsiGVlKHOsKRDsOe/vAit06pdq9Zuzir1y1kcRXJADskJsck5qZNr0iBNwsgDeSIv5NV4NJ6NN+N92lowZjP75E8ZH9+kIJ7f</latexit>y1
<latexit sha1_base64="NpVtkBuft1+uqFu8gH0IKJ+EInk=">AAACSnicbVDLSsNAFJ3Ud31VXboZLIKrkoioSx8bdz6wKjS1TCY3dXAyCTM3Ygn5Hn9Gt4q/4U7cOE2D+DowcDjn3juHE6RSGHTdV6c2Nj4xOTU9U5+dm19YbCwtX5gk0xzaPJGJvgqYASkUtFGghKtUA4sDCZfB7eHQv7wDbUSiznGQQjdmfSUiwRlaqdfY9xHusbyTH2Ra4bFmqg9FXupBlGdF74t7RUF9oagfM7wJgvysuA6LXqPpttwS9C/xKtIkFU56jTc/THgWg0IumTEdz02xmzONgkso6n5mIGX8lvWhY6liMZhuXkYs6LpVQhol2j6FtFS/b+QsNmYQB3ZyGNL89obif14nw2i3mwuVZgiKjz6KMkkxocPeaCg0cJQDSxjXwmal/IZpxtG2++NSeCdSU6W+H8Wu25K835X8JRebLW+7tX261dw7qOqaJqtkjWwQj+yQPXJETkibcPJAnsgzeXEenTfn3fkYjdacameF/EBt/BMJ1rag</latexit>u12Rd
<latexit sha1_base64="4JKhVpflD1grH9ybr7DjoMX6cnE=">AAACSnicbVDBTttAFFyHtA0pLaE9clkRIXGKbISAIw2X3gioIUhxGq3Xz2GV9drafY6ILH9Pf6ZcqfobuVVc2DhWBYSRVhrNvPd2NEEqhUHX/evUNurv3n9obDY/bn36vN3a+XJtkkxz6PNEJvomYAakUNBHgRJuUg0sDiQMgun50h/MQBuRqB84T2EUs4kSkeAMrTRuffMR7rC8k3czrfBCMzWBIi/1IMpnxfg/94qC+kJRP2Z4GwT5VfEzLMattttxS9B14lWkTSr0xq2FHyY8i0Ehl8yYoeemOMqZRsElFE0/M5AyPmUTGFqqWAxmlJcRC7pvlZBGibZPIS3V5xs5i42Zx4GdXIY0r72l+JY3zDA6HeVCpRmC4quPokxSTOiyNxoKDRzl3BLGtbBZKb9lmnG07b64FM5EaqrUd6vYTVuS97qSdXJ92PGOO8eXR+2zblVXg+ySPXJAPHJCzsh30iN9wskvck8eyB/nt7Nw/jmPq9GaU+18JS9Qqz8BC5q2oQ==</latexit>v12Rd<latexit sha1_base64="4JKhVpflD1grH9ybr7DjoMX6cnE=">AAACSnicbVDBTttAFFyHtA0pLaE9clkRIXGKbISAIw2X3gioIUhxGq3Xz2GV9drafY6ILH9Pf6ZcqfobuVVc2DhWBYSRVhrNvPd2NEEqhUHX/evUNurv3n9obDY/bn36vN3a+XJtkkxz6PNEJvomYAakUNBHgRJuUg0sDiQMgun50h/MQBuRqB84T2EUs4kSkeAMrTRuffMR7rC8k3czrfBCMzWBIi/1IMpnxfg/94qC+kJRP2Z4GwT5VfEzLMattttxS9B14lWkTSr0xq2FHyY8i0Ehl8yYoeemOMqZRsElFE0/M5AyPmUTGFqqWAxmlJcRC7pvlZBGibZPIS3V5xs5i42Zx4GdXIY0r72l+JY3zDA6HeVCpRmC4quPokxSTOiyNxoKDRzl3BLGtbBZKb9lmnG07b64FM5EaqrUd6vYTVuS97qSdXJ92PGOO8eXR+2zblVXg+ySPXJAPHJCzsh30iN9wskvck8eyB/nt7Nw/jmPq9GaU+18JS9Qqz8BC5q2oQ==</latexit>v12Rd
<latexit sha1_base64="xM1N2ni6fgDhOyRoCMvkVtW9cD0=">AAACT3icbZBBT9swFMedMgYE2MqmnbhYVEgcUJWMCTgiduE2QCut1JTKdl9aC8fJ7JeJKsqdT7Mr+xo77pPsNuG0OaztnmTrr/979vvrxzMlLQbBb6+x9mr99cbmlr+9s/vmbXPv3Z1NcyOgI1KVmh5nFpTU0EGJCnqZAZZwBV3+8Lnqd7+DsTLVX3GawSBhYy1jKRg6a9g8iBAecfZPwVUOZRFJTaOE4YTz4ra8/1YOm62gHcyKroqwFi1S1/Vwz/sQjVKRJ6BRKGZtPwwyHBTMoBQKSj/KLWRMPLAx9J3ULAE7KGYhSnronBGNU+OORjpz/31RsMTaacLdZJXSLvcq83+9fo7x+aCQOssRtJgvinNFMaUVGTqSBgSqqRNMGOmyUjFhhgl0/Ba2PM6j+tEIYsd9Tu8yNxq/GKbHDqIZ87II2ufHDtTJSXUHpe9AhsvYVsXdx3Z42j69+dS6uKyRbpJ9ckCOSEjOyAW5ItekQwR5Ij/IM/np/fL+eH8b9WjDq8V7slCNrRcyTLK7</latexit>2Rq
<latexit sha1_base64="FAaD+1faGJRSEY9fHURizaFqMGw=">AAACTnicbZDLTuMwFIadcut0uJRBs5qNhwqJBaoSQMASwWZ2wIgCUtOpHOektXCcyD4ZUVlZ8zRs4TXYzouwQ+C0XQyXI9n69R8fn19flEth0Pf/ebWZ2bn5hfqXxtfFpeWV5uq3C5MVmkOHZzLTVxEzIIWCDgqUcJVrYGkk4TK6Pq76l39BG5Gpcxzl0EvZQIlEcIbO6jd/hgg3OP7HaohLGwpFw5ThMIrs7/JPXvabLb/tj4t+FMFUtMi0Tvur3vcwzniRgkIumTHdwM+xZ5lGwSWUjbAwkDN+zQbQdVKxFEzPjjOUdMM5MU0y7Y5COnb/n7AsNWaURu5lldK871XmZ71ugclBzwqVFwiKTxYlhaSY0QoMjYUGjnLkBONauKyUD5lmHB2+N1tuJlEbYQyJwz6Bd1RohSeaqQGUVg+i0vrtgy0Hamenuv2y4UAG77F9FBfb7WCvvXe22zo8miKtkx9knWySgOyTQ/KLnJIO4eSW3JF78uA9ek/es/cyeVrzpjNr5E3V6q9bp7NC</latexit>2Rp
Generate RNA & cell features
Figure 1: Left: What do we do? One task we consider is generating RNA cell profiles from
ATAC measurements and an additional cell feature. This is explained in § 5.2, and demonstrated in
Fig. 4. As the cells live on manifolds in two (partially) incomparable spaces , we rely on the Fused
Gromov-Wasserstein (FGW) formulation, as described in § 3.3. Here, the incomparable structural
information is contained in the ATAC and the RNA measurements, while the comparable information
are the cell features. Right: How do we do it? For each (x,u)in the support of the source µ, we
learn a flow ϕ1(·|x,u)from the noise ρto the conditional π⋆
ε(·|x,u), whose support lies in that of the
targetν. The flow is multi-modal: It allows sampling structural informations y, as well as features v
simultaneously. We highlight this procedure for a specific pair ( x1,u1), with p= 2andq= 3.
3 Generative Entropic Neural OT
We introduce GENOT, a method to learn EOT couplings (thus satisyfing N1) with any cost ( N2) by
learning their conditional distributions. In § 3.1, we focus on balanced OT, and show that GENOT
approximates linear or quadratic EOT couplings ( N4), solutions to (LEOT) or(QEOT) respectively.
Then, in § 3.2, we extend GENOT to the unbalanced setting by loosening the conservation of mass
constraint ( N3). We define U-GENOT, which approximates solutions to (ULEOT) and(UQEOT) .
In § 3.3, we highlight that GENOT also adresses a fused problem, combining (LEOT) and(QEOT)
(N4). Finally, we demonstrate in § 3.4 the GENOT algorithm, that allows to flexibly adapt to different
OT formulations, which is key for easy usability for single-cell genomics analysts.
3.1 Learning Entropic Couplings with GENOT
Letµ∈ M+
1(X),ν∈ M+
1(Y)andπ⋆
εbe an EOT coupling between µandν, which can be a solution
of problem (LEOT) or (QEOT). By the measure disintegration theorem, we get
dπ⋆
ε(x,y) = d µ(x) dπ⋆
ε(y|x).
Knowing µ, we can hence fully describe π⋆
εvia the conditional distributions (π⋆
ε(·|x))x∈X. The
latter are of great practical interest, as they provide a way to transport a point xsampled from µto
the target domain Y; either stochastically by sampling y1, ...,ynfrom π⋆
ε(·|x), ordeterministically
by averaging over conditional samples: Tε(x) :=EY∼π⋆
ε(·|x)[Y]. Moreover, we can assess the
uncertainty of these predictions using any statistic of π⋆
ε(·|x), which is crucial in single-cell genomics.
Learning the Conditional Distributions. Letρ=N(0, Iq)the standard Gaussian on the target space
Rq⊃ Y. From the noise outsourcing lemma [ 37], there exists a collection of conditional generators
{T⋆(·|x)}x∈Xs.t.T⋆(·|x) :Rq→Rqand for each xin the support of µ,π⋆
ε(·|x) =T⋆(·|x)♯ρ.
This means that if Z∼ρ, then Y=T⋆(Z|x)∼π⋆
ε(·|x). Here, we seek to learn a neural collection
{Tθ(·|x)}x∈Xof such conditional generators, fitting the constraint Tθ(·|x)♯ρ=π⋆
ε(·|x), for any xin
the support of µ. We employ the FM framework (see § 2) and parameterize each Tθ(·|x)implicitly, as
the flow induced by a neural vector field vt,θ(·|x) :Rq→Rq. Namely, Tθ(·|x) =ϕ1(·|x) :Rq→Rq
where ϕt(·|x)solves
d
dtϕt(z|x) =vt,θ(ϕt(z|x)|x), ϕ 0(z|x) =z. (3)
4We stress that while x∈ X ⊂ Rd, the flow ϕ1(·|x)from ρtoπ⋆
ε(·|x)is defined on the target space
Rq⊃ Y. Hence, we can map samples within the same space when p=q, but also across incomparable
spaces when p̸=q. In particular, this allows us to consider the quadratic OT problem (QEOT) . Thus,
for each x, we optimize vt,θ(·|x)by minimizing the FM loss (2) to map ρtoπ⋆
ε(·|x), i.e.
Et,Z∼ρ,Y∼π⋆ε(·|x)[∥vt,θ([Z, Y]t|x)−(Y−Z)∥2
2], (4)
where [Z, Y]t= (1−t)Z+tYinterpolates between noise and conditional vectors. Averaging for
allxin the support of µand using Fubini’s Theorem, we derive the GENOT loss:
LGENOT (θ):=Et,Z∼ρ,(X,Y)∼π⋆ε[∥vt,θ([Y, Z]t|X)−(Y−Z)∥2
2]. (5)
In practice, we optimize a sample-based GENOT loss by estimating πn
ε=P
i,jPij
εδ(Xi,Yj), from
X1, . . . , X n∼µandY1, . . . , Y n∼ν, with a discrete EOT solver, see Alg. 1.
GENOT Captures the Signal from the Mini-Batch Couplings. Standard FM only preserves
straight couplings [ 47], while bridge matching (its stochastic counterpart) only preserves the linear
EOT coupling for c(x,y) =∥x−y∥2
2[5]. In contrast, GENOT is a conditional FM model, learning
the conditional distributions of the coupling independently of each other: For each x, we leverage FM
to learn a conditional flow ϕ1(·|x)that maps ρtoπ⋆
ε(·|x). Therefore, as FM preserves the marginal
distributions (see 2), GENOT preserves all couplings. Thus, it always captures the signal carried out
by the mini-batch couplings, in both linear and quadratic settings, and for any cost. We highlight this
property in Fig. 5, comparing GENOT to other OT-based FM approaches [64, 84, 85].
GENOT Handles Any Cost. We can use GENOT to approximate linear or quadratic EOT couplings.
In both cases, we make no assumptions on the cost functions: We only need to evaluate them
on samples to estimate π⋆
εusing a discrete solver, see GENOT Alg. 1, line 5. In particular, we
can use implicitly defined costs, whose evaluation requires a non-differentiable sub-routine. For
instance, we can use the geodesic distance on the data manifold, which can be approximated from the
shortest path distance on the k-nn graph induced by the Euclidean distance [ 12,77]. This approach
has demonstrated its effectiveness in a range of single-cell genomics tasks relying on discrete OT
[17, 35, 39]. We use it with GENOT for both linear (see § 5.1) and quadratic OT (see § 5.2).
GENOT Approximates Conditional Densities. For each x, we build a CNF pt(·|x) =ϕt(·|x)♯ρ
between p0=ρandp1=π⋆
ε(·|x). From the instantaneous change of variables formula [ 9], we can
then approximate the conditional density π⋆
ε(y|x)at an arbitrary point y∈ Y, proving useful to
evaluate the likelihood of one-to-one matches between cells, see Fig.23.
3.2 U-GENOT: Extension to the Unbalanced Setting
Re-Balancing the UOT Problems. In its standard form, GENOT respects marginal constraints, so it
cannot directly handle unbalanced formulations (ULEOT) or(UQEOT) . We show that unbalanced
EOT problems can be re-balanced . Eyring et al. [20], Lübeck et al. [50], Yang and Uhler [93]
introduced previously these ideas in the Monge map estimation setting, namely, in a static and
deterministic setup. Our method stems from the fact that, for both linear and quadratic OT, the
unbalanced EOT coupling π⋆
ε,τbetween µ∈ M+(X),ν∈ M+(Y)solves a balanced EOT problem
between its marginals, which are re-weighted versions ˜µand˜νofµandν, that have the same mass.
Proposition 3.1 (Re-Balancing the unbalanced problems.) .Letπ⋆
ε,τbe an unbalanced EOT coupling,
solution of (ULEOT) or(UQEOT) between µ∈ M+(X)andν∈ M+(Y). We note ˜µ=p1♯π⋆
ε,τ
and˜ν=p2♯π⋆
ε,τits marginals. Then, in both cases, ˜µ(resp. ˜ν) has a density w.r.t. µ(resp. ν). That
is, there exist two re-weighting functions, one on each space, η:X →R+andξ:Y →R+s.t.
˜µ=η·µand˜ν=ξ·ν. Furthermore, ˜µand˜νhave the same total mass and
1. (Linear) π⋆
ε,τsolves the balanced problem (LEOT) between ˜µand˜νwith the same ε.
2.(Quadratic) Provided that cX,cY(or−cX,−cY) are CPD kernels (see Def. B.2), π⋆
ε,τsolves the
balanced problem (QEOT) between ˜µand˜νwithε′=m(π⋆
ε,τ)ε, where m(π⋆
ε,τ) =π⋆
ε,τ(X ×Y ).
Learning the Coupling and the Re-Weightings Simultaneously. Thanks to Prop. 3.1, we aim
to [i] learn a balanced EOT coupling between ˜µand˜νalong with [ii] the re-weighting functions
η, ξ. Learning them is desirable since they model the creation and destruction of mass. We do both
5simultaneously by adapting the GENOT procedure. Formally, we seek to optimize:
LU-GENOT (θ) =Et,Z∼ρ,(X,Y)∼π⋆ε,τ[∥vt,θ([Z, Y]t|X)−(Y−Z)∥2
2][i]
+EX∼µ[(η−ηθ)(X)2] +EY∼ν[(ξ−ξθ)(Y)2], [ii]
where ηθ, ξθare (non-negative) neural re-weighting functions. Crucially, similar to (balanced)
GENOT, we only need to estimate a discrete unbalanced EOT coupling πn
ε,τusing samples
X1, . . . , X n∼µandY1, . . . , Y n∼νto compute the two components, [i] and [ii], of the U-
GENOT loss. We build upon theoretical insights on the linear OT case and extend them to the
quadratic OT case in practice.
Proposition 3.2 (Pointwise estimation of re-weighting functions.) .Letπn
ε,τ=P
i,jPi,j
ε,τδ(Xi,Yj),
solution to (ULEOT) between empirical counterparts of µandν. Leta=Pε,τ1nandb=P⊤
ε,τ1n
its marginals weights. Then, almost surely, n ai→η(Xi)andn bi→ξ(Yi).
Using Prop. 3.1, ˆπn
ε,τis a balanced EOT coupling between its marginals, which are empirical
approximations of ˜µand˜ν. Hence, we estimate the first term [i] of the loss as we do in the balanced
case by sampling from the discrete coupling. Furthermore, Prop.3.2 highlights that the estimation
ofˆπn
ε,τalso provides a consistent estimate of the re-weighting function evaluations at each Xiand
Yi. This enables estimating the second term [ii]. Therefore, switching from GENOT to U-GENOT
simply involves using an unbalanced solver instead of a balanced one, and regressing the neural
re-weighting functions on the marginal weights of the estimated discrete coupling. We detail our
procedure in Alg. 1, showing the additional steps w.r.t. GENOT in teal.
3.3 Combining Linear and Quadratic OT
We show in § 3.1 and § 3.2 how to use GENOT to solve OT problems within the same space or across
incomparable spaces. On the other hand, numerous real-world problems pose the challenge of the
source and target domains being only partially incomparable [ 88]. Therefore, suppose that the source
and target space can be decomposed as X= Ω×˜XandY= Ω×˜Y, respectively. Intuitively, a
sample (u,x)∈Ω×˜Xcan be interpreted as a structural information xequipped with a feature u.
Assume we are given a cost c: Ω×Ω→Rto compare features, along with the intra-domain costs
c˜X, c˜Y. The entropic Fused Gromov-Wasserstein (FGW) problem reads
min
π∈Π(µ,ν)Z
((Ω×˜X)×(Ω×˜Y))2Dc
c˜X,c˜Yd(π⊗π) +εKL(π|µ⊗ν), EFGW
where Dc
c˜X,c˜Y((u,x),(v,y),x′,y′) := (1 −α)c(u,v) +α|c˜X(x,x′)−c˜Y(y,y′)|2andα∈[0,1].
This loss combines the pointwise structural distortion and the feature information. We refer to the
additional cost on the feature information as the fused term . The weighting αallows us to interpolate
between purely linear OT on the feature ( α= 0), and purely quadratic OT ( α= 1) on the structural
information. Problem (EFGW) also admits an unbalanced extension, derived similarly as (UQEOT)
with the quadratic KL⊗[82]. An (un)balanced fused EOT coupling always exists (see B.1), it
minimizes distortion along the structural information and displacement cost along the features.
(U-)GENOT for the Fused Setting. Whether in the balanced or unbalanced setting, we can use
our method to learn a specific coupling as soon as it can be estimated from samples. We stress
that the discrete solvers introduced by Peyré et al. [62] and Séjourné et al. [81] we use for (QEOT)
and(UQEOT) , respectively, are still applicable in the fused setting. As a result, we can approximate
solutions of (EFGW) and its unbalanced counterpart with (U-)GENOT. To illustrate the learning
outcome, take a solution π⋆
αof(EFGW) . Learning π⋆
αwith our method amounts to training vector
fields that are conditioned on pairs of modalities from the source domain vt,θ(·,|u,x), to sample
pairs of modalities from the target domain via the flow: Z∼ρ,ϕ1(Z|u,x) = (V, Y)∼π⋆
α(·|u,x).
The sampled modalities (V, Y)(i) minimize transport cost quantified by calong the feature (ii) while
minimizing the distortion along the structural information quantified by c˜Xandc˜Y. In § 5.2, we use
fused couplings to enhance the translation between different modalities of cells.
Why Does Adding a Fused Term Provide Benefits? Generally, unlike the linear EOT prob-
lem(LEOT) , the solution π⋆
εto the quadratic EOT problem (QEOT) is not unique. This is where
adding a fused term helps, as it introduces more constraints. Intuitively, the fused term on addi-
tional features u,vallows us to ’select’ an optimal GW coupling: we trade some GW optimality
6by choosing a coupling that not only minimizes the distortion of the structural information x,y,
but also reduces the displacement cost, quantified by c, along the features u,v. Empirically, this
significantly mitigates the issue of non-uniqueness in (pure) GW couplings. In § 5.2, we demonstrate
that it enhances the stability of our procedure, particularly for single-cell data, as illustrated in Fig. 4
and Fig. 18. On a related note, but independently of the addition of the fused term, we investigate in
App. E.2 other strategies to mitigate the non-uniqueness of the GW coupling. Notably, we show that
using the geodesic distance on the data manifold as costs, instead of the squared Euclidean distance,
helps address this issue on single-cell data. As an alternative, we also introduce an initialization
scheme to bias the discrete GW solver to a specific solution based on the neural coupling obtained in
the previous iteration (App. E.2). Yet, this approach renders GENOT non-simulation free.
3.4 One algorithm to flexibly switch between neural OT problems
Algorithm 1 U-GENOT. Skip teal steps for GENOT.
1:Require parameters: Batch size n; entropic regulariza-
tionε; unbalancedness parameter τ;linear ,quadratic or
fused discrete OT solver Solver ε,τ.
2:Require network: Time-dependent conditional velocity
fieldvt,θ(·|·) :Rq×Rp→Rq; re-weighting functions
ηθ:Rp→R,ξθ:Rq→R.
3:fort= 1, . . . , T iterdo
4: Sample X1, . . . , X n∼µandY1, . . . , Y n∼ν.
5:Pε,τ←Solver ε,τ({Xi}n
i=1,{Yi}n
i=1)∈Rn×n
+.
6:a←Pε,τ1nandb←P⊤
ε,τ1n.
7: Sample (i1, j1), ...,(in, jn)∼Pε,τ.
8: Sample Z1, ..., Z n∼ρandt1, ..., t n∼ U([0,1]).
9:L(θ)←P
k∥vt,θ([Zk, Yjk]t|Xik)−(Yjk−Zk)∥2
2
10: +P
k(ηθ(Xk)−nak)2+ (ξθ(Yk)−nbk)2.
11: θ←Update (θ,1
n∇L(θ)).
12:end forSingle-cell genomics data is inher-
ently noisy, due to biases incurred
by sequencing protocols and the high
sparsity of the measurements [ 34].
Thus, it is indispensable to flexibly
switch between configurations of the
problem setup. For example, it is of-
ten not clear whether the mass con-
servation constraint should be actu-
ally loosened (for example whether
to allow for modeling cell death), or
whether incorporating prior informa-
tion for trajectory inference via the
quadratic term (e.g. with spatial in-
formation [ 39] or lineage barcoding
[42]) is beneficial. Similarly, trying
different costs is crucial in single-cell
genomics ([ 17,35,39]). The GENOT
formulation offers this flexibility by
introducing only minor changes into the algorithm. We detail our procedure in Alg. 1, showing the
additional steps to switch from GENOT to U-GENOT in teal. Limitations are discussed in § A.
4 Related work and Discussions
Static Neural EOT. While GENOT is the first model to consider the quadratic (and fused) EOT
setting, various methods have been proposed in the linear EOT scenario. The first class of methods
solves (LEOT) ’s dual. While some of them [ 27,73] do not allow direct sampling from to π⋆
ε, Daniels
et al. [15] and Mokrov et al. [55] model π⋆
ε(·|x). However, these methods might be costly and
unstable, as they rely on Langevin sampling during training or inference.
Dynamic Neural EOT. The second class of linear EOT solvers builds upon the link between (LEOT)
and the SB problem [ 10,16,29,87]. Although they operate primarily in the balanced setting,
Gazdieva et al. [26] recently considered the unbalanced one. As simulations are costly in this setting,
recent works consider simulation-free training via bridge matching [ 41,46,61,76,84,85,96]. While
Tong et al. [84,85]use mini-batch OT, our method is fundamentally different, as we do not build
upon the link between EOT and SB. We only use flow matching as a powerful black box to learn a
flow from the noise ρto each conditional π⋆
ε(·|x). Therefore, our approach allows for more flexibility.
First (i), the abovementioned methods assume that X,Y ⊂Rd, since they learn a velocity field (or a
drift) by directly bridging x∈ X,y∈ Y. Then, they map µtoνwith the induced (stochastic) flow.
On the other hand, conditionally to each x∈ X ⊂ Rd, we learn a velocity field vt,θ(·|x) :Rq→Rq
in the target space , by building paths between noise z∈Rqandy∈ Y ⊂ Rq. Then, we map ρto
eachπ⋆
ε(·|x)with the flows ϕ1(·|x), and recover ν=ϕ1(·|·)♯(ρ⊗µ). Second (ii), they can only
approximate the SB for c(x,y) =∥x−y∥2
2. This results from [ 5, Prop. 2]. In contrast, our method
handles any cost, as shown in Fig 5. Third (iii), as they learn a single flow directly transporting
µtoν, they do not approximate the conditional densities π⋆
ε(y|x). Similarly to Tong et al. [85],
Pooladian et al. [64] couple samples from µandν, but they only model deterministic maps and
assume µ=N(0, Id). Finally, Bortoli et al. [5]recently proposed an augmented bridge matching
7Figure 2: Left: Source cell from the early time points (top left) and samples of the conditional
distributions of the EOT coupling learned with GENOT for the geodesic cost dM(middle) and the ℓ2
2
cost (right) projected onto a UMAP [ 53], along with biological assessment of the learnt dynamics
(TSI score, CT error § C.2, Fig. 9). Right: UMAP colored according to the uncertainty score
cos-var(πdM
θ(·|X))of each source cell x. Target cells are colored in gray.
procedure that preserves couplings. However, it still requires X,Y ⊂Rdand does not approximate
conditional densities, limiting its applicability in single-cell genomics tasks.
Mini-batches and Biases Quantifying non-asymptotically the bias resulting from minimizing a
sample-based GENOT loss, and notits population value, is challenging. The OT curse of dimension-
ality [ 91] has been discussed in generative models relying on mini-batch couplings [ 22,27,84,85].
Yet, our goal is notto model non-regularized OT, such as a deterministic Monge map, or a Benamou-
Brenier vector field. We explicitly target the entropy-regularized OT coupling. Thus, using ε≫0
helps to mitigate the curse of dimensionality because of two qualitative factors:
(i)Statistical. For both linear and quadratic OT, all statistical recovery rates that relate to entropic
costs [ 28,95], maps [ 63,66], or couplings [ 90], have a far more favorable regime, with a
parametric rate in ε >0that dodges the curse of dimensionality.
(ii)Computational. While the benefits of employing a large enough εin Sinkhorn’s algorithm are
widely known, Rioux et al. [67] have recently shown that as εincreases, the quadratic OT problem
(QEOT) becomes convex, making discrete solvers faster and more reliable.
To demonstrate this aspect, we empirically study the influence of the batch size on GENOT, using a
recent benchmark [30], with known true linear EOT coupling π⋆
ε, see Fig. 6.
5 Experiments
While there is no evidence that cells exactly evolve according to an entropic OT plan, leveraging
OT is an established way to realign cells. We also evaluate the performance on simulated data in
settings which closed-form solutions of the EOT coupling are available for. Metrics and datasets are
discussed in App. C and App. D, respectively. Further experimental details or results are reported in
App. E. Setups for baselines are listed in App. F. Implementation details can be found in App. G. We
denote by GENOT-L the GENOT model for solving the linear problem (LEOT) ,GENOT-Q for the
quadratic (QEOT) andGENOT-F for the fused (EFGW) one. When considering the unbalanced
counterparts, we add the prefix U . Moreover, when using the conditional mean of a GENOT model,
we add the suffix CM . We denote our learned neural couplings by πθ.
5.1 GENOT-L for modeling cell trajectories
GENOT-L on simulated data We show that GENOT accurately computes EOT couplings using a
recent benchmark [ 30]. Tab. 1 shows that GENOT-L outperforms all baselines considered. These
results are of particular significance since most of the baselines are tailored towards the specific task
of solving (i) the linear EOT problem (LEOT) , (ii) in the balanced setting (iii) with the ℓ2
2cost. In
contrast, the contributions of GENOT go beyond this setting, see N2,N3, and N4. Going beyond
the balanced problem ( N3), we show that U-GENOT learns meaningful unbalanced EOT couplings
between Gaussians [36] (11), which we visualize in Fig. 10.
GENOT-L learns the evolution of cells. Trajectory inference is a prominent task in single-cell
biology. It is key to understand the development of cells from less mature to more mature cell
8Figure 3: Left: Accuracy of cellular response predictions of U-GENOT-L for cancer drugs with
varying unbalancedness parameter τ=τ1=τ2.Smaller τimplies more unbalancedness (3 runs per
τ).Right: Mapping a Swiss roll in R3(µ) to a spiral in R2(ν) with GENOT-Q. Center: Color code
tracks where samples from µ(top) are mapped to (bottom). Right column: samples from µ(top)
and the corresponding conditionals, along with conditional density estimates. The learned QEOT
coupling minimizes the distortion: Points close in support of µgenerate points close in support of ν.
states. In the following, we consider a dataset capturing gene expression of the developing mouse
pancreas at embryonic days 14.5 (source) and 15.5 (target) [ 2]. Using the geodesic distance on the
data manifold dMas cost (§ 3.1) improves the learnt vector field compared to using the ℓ2
2cost (TSI
score in Fig.2, § C.2). The CT error measures to what extent cells follow the manifold (§ C.2, Fig. 9),
which is visually confirmed by samples of the conditional distribution (Fig.2). These results support
the need for a flexible choice of the cost function ( N2). As cells are known to evolve stochastically,
we leverage GENOT’s capability to generate samples from the conditional distribution to model
non-deterministic trajectories ( N1). We follow Gayoso et al. [25] for assessing the uncertainty of
cell trajectories by computing cos-var(πθ(·|x)) = Var Y∼πθ(·|x)[cos-sim(Y,EY∼πθ(·|x)[Y])](§ C.1).
We expect high uncertainty in cell types in early developmental stages and low variance in mature
cell types. Indeed, Fig. 2 and Fig. 8 show that the computed uncertainty is biologically meaningful.
U-GENOT-L predicts single-cell responses to perturbations. Neural OT has been successfully
applied to model cellular responses to perturbations using deterministic maps [ 7]. GENOT has the
comparative advantage to model conditional distributions, allowing for uncertainty quantification.
We consider single cell RNA-seq data measuring the response of cells to 163 cancer drugs [ 78]. Each
drug has been applied to a population of cells that can be partitioned into 3 different cell types. The
source (resp. target) distribution consists of cells before (resp. after) drug application. While there is
no ground truth in the matching between unperturbed and perturbed cells due to the destructive nature
of sequencing technologies (hence the need for realignment), we know which unperturbed subset of
cells is supposed to be mapped to which perturbed subset of cells. We use this to define an accuracy
metric (see App. C.2), while we assess the uncertainty ( N1) of the prediction using cos-var. Fig. 12
shows that for 117 out of 163 drugs, the model is perfectly calibrated (see App. C.1), while it yields a
negative correlation between error and uncertainty only for one drug. We can improve the generation
of cells by accounting for class imbalances between different cell types using U-GENOT. These
imbalances might occur due to biases in the experimental setup or due to cell death [ 78]. Indeed,
Fig. 3 shows that allowing for mass variation increases accuracy for nine different cancer drugs,
selected as they are known to have a strong effect. Fig. 13 and 14 confirm the results visually ( N3).
5.2 GENOT for Quadratic EOT Problems
As outlined in § 1, quadratic OT problems are of particular interest in single-cell genomics ( N4). Here,
we focus on the task of aligning different cellular modalities, which is necessary as most sequencing
technologies are limited to measuring one modality [ 34]. Yet, there exist few protocols measuring
two modalities simultaneously, thus allowing us to assess the alignment as the ground truth matching
is known. We leverage this to assess GENOT-Q’s performance on the task of translating cells from
ATAC-seq to RNA-seq, and also propose a novel way to improve the alignment using GENOT-F.
Before, we demonstrate the task of mapping across incomparable spaces on simulated data.
GENOT-Q and U-GENOT-Q on simulated data. To visualize the problem of quadratic OT, we
transport a Swiss role in R3to a spiral in R2. Fig. 3 shows that GENOT-Q successfully mimics an
isometric alignment. Here, we set ε= 0.01and investigate its influence in more detail in Fig. 15.
To quantitatively assess the performance of GENOT-Q and U-GENOT-Q, we compute (unbalanced)
9Figure 4: Left: Benchmark of GENOT-Q models against discrete GW (GW-LR, App. F) on translating
cells between ATAC space of dim. d1and RNA space of dim. d2, with performance measured with
FOSCTTM score (App. C.2) and Sinkhorn divergence between target and predicted target distribution.
(left) intra-domain costs cX=cY=ℓ2
2, (right) geodesic distances cX=dXandcY=dY. We show
mean and std across 3 runs. Right: Top: UMAP of transported cells with GENOT-F (colored by
cell type) and cells in the target distribution (gray). Cells of the same cell type generate cells which
cluster together in RNA space. Bottom: UMAP of transported cells with a GENOT model trained on
batch-wise independent couplings, thus not using OT, generating cells which are randomly mixed.
entropic OT plans between Gaussian distributions, which the closed form EOT plan is known for
[43]. Fig.19 and Fig.20 show that GENOT-Q is able to meaningfully learn (un-)balanced entropic
EOT plans for lower dimensions, but its performance decreases with increasing dimensionality.
GENOT-Q translates modalities of single cells. We use GENOT-Q to translate ATAC measurements
(source) to gene expression space (target) on a bone marrow dataset [ 51]. As both modalities were
measured in the same cell, the true match of each cell is known for this specific dataset. We compare
GENOT-Q with discrete OT extended out-of-sample with linear regression (GW-LR, see F.2). We
assess the performance using (i) the FOSCTTM (“Fractions of Samples Closer to the True Match”,
see C.2) that measures the optimality of the learned coupling, and (ii) the Sinkhorn divergence [ 23]
between the predicted target and the target to assess distributional fitting. As in § 5.1, we leverage
GENOT’s flexibility and use as intra-domains costs the geodesic distances on the source and target
domain, namely cX=dX,cY=dY(N2). We also estimate the EOT coupling for the ℓ2
2cost for
comparison. Results are shown in Fig. 3. Regarding the FOSCTTM score, we see that (i) using
geodesic costs is crucial in high dimensions and (ii) GW-LR is competitive in low dimensions but not
for higher ones. Regarding distributional fitting, GENOT models outperform by orders of magnitude.
GENOT-F improves modality translation. To enhance the performances attained by purely
quadratic OT-based models, we introduce a novel method for translating between ATAC and RNA.
We extend the idea of translating between cell modalitiies proposed by Demetci et al. [17] to the
fused setting: We approximate RNA data from ATAC measurements using gene activity [ 79], and
we further process the data using a conditional V AE [ 48] to reduce batch effects. This way, we
construct a joint space Ω. Following the notations in § 3.3, RNA (source x∈˜X) and ATAC (target
y∈˜Y) carry the structural information, while features u∈Ωandv∈Ωare obtained from the V AE
embedding. Fig. 21 shows that the additional linear penalty on the feature term helps to obtain a
better alignment compared to GENOT-Q. Fig. 4 visualizes the learned fused coupling compared to
GENOT trained with batch-wise independent couplings. When aligning multiple cell modalities, the
proportions of cell types in the two modalities often differ ( N3). We simulate this setting by removing
cells belonging to certain cell types Tab. 4 shows that U-GENOT-F preserves high accuracy while
learning meaningful rescaling functions.
Conclusion. Motivated by applications in single-cell genomics, we introduce GENOT, a versatile
neural OT framework to learn cost-efficient stochastic maps, within the same space or across incom-
parable spaces. GENOT can be used for learning EOT couplings with any cost function, and allows
for loosening mass constraints if desired.
10References
[1]David Alvarez-Melis and Tommi S Jaakkola. Gromov-wasserstein alignment of word embedding
spaces. arXiv preprint arXiv:1809.00013 , 2018. F.2
[2]Aimée Bastidas-Ponce, Sophie Tritschler, Leander Dony, Katharina Scheibner, Marta Tarquis-
Medina, Ciro Salinno, Silvia Schirge, Ingo Burtscher, Anika Böttcher, Fabian J Theis, et al.
Comprehensive single cell mrna profiling reveals a detailed roadmap for pancreatic endocrino-
genesis. Development , 146(12):dev173849, 2019. 5.1, C.2, D.2, E.1
[3]Jean-David Benamou. Numerical resolution of an “unbalanced” mass transport problem. ESAIM:
Mathematical Modelling and Numerical Analysis , 37(05):851–868, 2003. 4
[4]Jean-David Benamou, Guillaume Carlier, and Luca Nenna. A numerical method to solve
optimal transport problems with coulomb cost, 2015. 5
[5]Valentin De Bortoli, Guan-Horng Liu, Tianrong Chen, Evangelos A. Theodorou, and Weilie
Nie. Augmented bridge matching, 2023. 3.1, 4, 5
[6]James Bradbury, Roy Frostig, Peter Hawkins, Matthew James Johnson, Chris Leary, Dougal
Maclaurin, George Necula, Adam Paszke, Jake VanderPlas, Skye Wanderman-Milne, and
Qiao Zhang. JAX: composable transformations of Python+NumPy programs, 2018. URL
http://github.com/google/jax . G
[7]Charlotte Bunne, Stefan G Stark, Gabriele Gut, Jacobo Sarabia del Castillo, Kjong-Van
Lehmann, Lucas Pelkmans, Andreas Krause, and Gunnar Ratsch. Learning Single-Cell Pertur-
bation Responses using Neural Optimal Transport. bioRxiv , 2021. 1, 5.1
[8]Charlotte Bunne, Andreas Krause, and Marco Cuturi. Supervised training of conditional monge
maps. In Advances in Neural Information Processing Systems (NeurIPS) , 2022. 1
[9]Ricky TQ Chen, Yulia Rubanova, Jesse Bettencourt, and David K Duvenaud. Neural ordinary
differential equations. Advances in neural information processing systems , 31, 2018. 2, 3.1
[10] Tianrong Chen, Guan-Horng Liu, and Evangelos A Theodorou. Likelihood training of schr \"
odinger bridge using forward-backward sdes theory. arXiv preprint arXiv:2110.11291 , 2021. 4,
E.1
[11] Lenaic Chizat, Gabriel Peyré, Bernhard Schmitzer, and François-Xavier Vialard. Unbalanced
optimal transport: geometry and Kantorovich formulation. Journal of Functional Analysis , 274
(11):3090–3123, 2018. 1, 2
[12] Keenan Crane, Clarisse Weischedel, and Max Wardetzky. Geodesics in heat: A new approach
to computing distance based on heat flow. ACM Transactions on Graphics (TOG) , 32(5):1–11,
2013. 3.1
[13] Marco Cuturi. Sinkhorn Distances: Lightspeed Computation of Optimal Transport. In Advances
in Neural Information Processing Systems (NeurIPS) , volume 26, 2013. 1, 2
[14] Marco Cuturi, Laetitia Meng-Papaxanthos, Yingtao Tian, Charlotte Bunne, Geoff Davis, and
Olivier Teboul. Optimal Transport Tools (OTT): A JAX Toolbox for all things Wasserstein.
arXiv Preprint arXiv:2201.12324 , 2022. E.1, G, G.3, G.4
[15] Max Daniels, Tyler Maunu, and Paul Hand. Score-based generative neural networks for large-
scale optimal transport. Advances in neural information processing systems , 34:12955–12965,
2021. 4, E.1
[16] Valentin De Bortoli, James Thornton, Jeremy Heng, and Arnaud Doucet. Diffusion schrödinger
bridge with applications to score-based generative modeling. Advances in Neural Information
Processing Systems , 34:17695–17709, 2021. 4, E.1
[17] Pinar Demetci, Rebecca Santorella, Björn Sandstede, William Stafford Noble, and Ritambhara
Singh. Scot: single-cell multi-omics alignment with optimal transport. Journal of Computational
Biology , 29(1):3–18, 2022. 1, 3.1, 3.4, 5.2, D.4
11[18] Mingze Dong, Bao Wang, Jessica Wei, Antonio H de O. Fonseca, Curtis J Perry, Alexander
Frey, Feriel Ouerghi, Ellen F Foxman, Jeffrey J Ishizuka, Rahul M Dhodapkar, et al. Causal
identification of single-cell experimental perturbation effects with cinema-ot. Nature Methods ,
20(11):1769–1779, 2023. 1
[19] Michael B Elowitz, Arnold J Levine, Eric D Siggia, and Peter S Swain. Stochastic gene
expression in a single cell. Science , 297(5584):1183–1186, 2002. 1
[20] Luca Eyring, Dominik Klein, Théo Uscidda, Giovanni Palla, Niki Kilbertus, Zeynep Akata, and
Fabian Theis. Unbalancedness in neural monge maps improves unpaired domain translation.
arXiv preprint arXiv:2311.15100 , 2023. 1, 3.2
[21] Luca Vincent Eyring, Dominik Klein, Giovanni Palla, Soeren Becker, Philipp Weiler, Niki
Kilbertus, and Fabian J. Theis. Modeling single-cell dynamics using unbalanced parameterized
monge maps. bioRxiv , 2022. doi: 10.1101/2022.10.04.510766. URL https://www.biorxiv.
org/content/early/2022/10/05/2022.10.04.510766 . 1
[22] Kilian Fatras, Younes Zine, Szymon Majewski, Rémi Flamary, Rémi Gribonval, and Nicolas
Courty. Minibatch optimal transport distances; analysis and applications. arXiv preprint
arXiv:2101.01792 , 2021. 4
[23] Jean Feydy, Thibault Séjourné, François-Xavier Vialard, Shun-Ichi Amari, Alain Trouvé, and
Gabriel Peyré. Interpolating between Optimal Transport and MMD using Sinkhorn Divergences.
InInternational Conference on Artificial Intelligence and Statistics (AISTATS) , volume 22, 2019.
5.2, B.1
[24] Charlie Frogner, Chiyuan Zhang, Hossein Mobahi, Mauricio Araya, and Tomaso A Poggio.
Learning with a wasserstein loss. Advances in neural information processing systems , 28, 2015.
1, 2
[25] Adam Gayoso, Philipp Weiler, Mohammad Lotfollahi, Dominik Klein, Justin Hong, Aaron M
Streets, Fabian J Theis, and Nir Yosef. Deep generative modeling of transcriptional dynamics
for rna velocity analysis in single cells. bioRxiv , pages 2022–08, 2022. 1, 5.1, C.1, E.1
[26] Milena Gazdieva, Arip Asadulaev, Alexander Korotin, and Evgeny Burnaev. Light unbalanced
optimal transport, 2024. URL https://arxiv.org/abs/2303.07988 . 4
[27] Aude Genevay, Lénaic Chizat, Francis Bach, Marco Cuturi, and Gabriel Peyré. Sample
Complexity of Sinkhorn Divergences. In International Conference on Artificial Intelligence
and Statistics (AISTATS) , volume 22, 2019. 4
[28] Aude Genevay, Lénaic Chizat, Francis Bach, Marco Cuturi, and Gabriel Peyré. Sample com-
plexity of sinkhorn divergences. In The 22nd international conference on artificial intelligence
and statistics , pages 1574–1583. PMLR, 2019. 4
[29] Nikita Gushchin, Alexander Kolesov, Alexander Korotin, Dmitry Vetrov, and Evgeny Burnaev.
Entropic neural optimal transport via diffusion processes. arXiv preprint arXiv:2211.01156 ,
2022. 1, 4, E.1
[30] Nikita Gushchin, Alexander Kolesov, Petr Mokrov, Polina Karpikova, Andrey Spiridonov,
Evgeny Burnaev, and Alexander Korotin. Building the bridge of schr \" odinger: A continuous
entropic optimal transport benchmark. arXiv preprint arXiv:2306.10161 , 2023. 4, 5.1, D.1, E.1,
E.1, 1, 2, 6, 3, F.1
[31] Muzlifah Haniffa, Deanne Taylor, Sten Linnarsson, Bruce J Aronow, Gary D Bader, Roger A
Barker, Pablo G Camara, J Gray Camp, Alain Chédotal, Andrew Copp, et al. A roadmap for the
human developmental cell atlas. Nature , 597(7875):196–205, 2021. E.1
[32] Zhisong He, Leander Dony, Jonas Simon Fleck, Artur Szalata, Katelyn X Li, Irena Sliskovic,
Hsiu-Chuan Lin, Malgorzata Santel, Alexander Atamian, Giorgia Quadrato, et al. An integrated
transcriptomic cell atlas of human neural organoids. bioRxiv , pages 2023–10, 2023. E.1
12[33] Leon Hetzel, Simon Boehm, Niki Kilbertus, Stephan Günnemann, Fabian Theis, et al. Predicting
cellular responses to novel drug perturbations at a single-cell resolution. Advances in Neural
Information Processing Systems , 35:26711–26722, 2022. D.3
[34] Lukas Heumos, Anna C Schaar, Christopher Lance, Anastasia Litinetskaya, Felix Drost, Luke
Zappia, Malte D Lücken, Daniel C Strobl, Juan Henao, Fabiola Curion, et al. Best practices for
single-cell analysis across modalities. Nature Reviews Genetics , pages 1–23, 2023. 3.4, 5.2, D.4
[35] Guillaume Huguet, Alexander Tong, María Ramos Zapatero, Guy Wolf, and Smita Krish-
naswamy. Geodesic sinkhorn: optimal transport for high-dimensional datasets. arXiv preprint
arXiv:2211.00805 , 2022. 1, 3.1, 3.4
[36] Hicham Janati, Boris Muzellec, Gabriel Peyré, and Marco Cuturi. Entropic optimal transport
between unbalanced gaussian measures has a closed form. Advances in neural information
processing systems , 33:10468–10479, 2020. 5.1, E.1, 11
[37] Olav Kallenberg. Foundations of Modern Probability . Springer, 2002. URL https://link.
springer.com/book/10.1007/978-3-030-61871-1 . 3.1
[38] L Kantorovich. On the transfer of masses (in russian). In Doklady Akademii Nauk , volume 37,
page 227, 1942. 2
[39] Dominik Klein, Giovanni Palla, Marius Lange, Michal Klein, Zoe Piran, Manuel Gander,
Laetitia Meng-Papaxanthos, Michael Sterr, Aimee Bastidas-Ponce, Marta Tarquis-Medina, et al.
Mapping cells through time and space with moscot. bioRxiv , pages 2023–05, 2023. 1, 3.1, 3.4,
D.4, G.4
[40] Alexander Korotin, Daniil Selikhanovych, and Evgeny Burnaev. Neural optimal transport. 2022.
doi: 10.48550/ARXIV .2201.12220. URL https://arxiv.org/abs/2201.12220 . E.1
[41] Alexander Korotin, Nikita Gushchin, and Evgeny Burnaev. Light schrödinger bridge, 2023. 1, 4
[42] Marius Lange, Zoe Piran, Michal Klein, Bastiaan Spanjaard, Dominik Klein, Jan Philipp Junker,
Fabian J Theis, and Mor Nitzan. Mapping lineage-traced cells across time points with moslin.
bioRxiv , pages 2023–04, 2023. 1, 3.4, C.2
[43] Khang Le, Dung Q Le, Huy Nguyen, Dat Do, Tung Pham, and Nhat Ho. Entropic gromov-
wasserstein between gaussian distributions. In International Conference on Machine Learning ,
pages 12164–12203. PMLR, 2022. 5.2, E.2, 19, 20
[44] Matthias Liero, Alexander Mielke, and Giuseppe Savaré. Optimal entropy-transport problems
and a new hellinger–kantorovich distance between positive measures. Inventiones Mathematicae ,
211(3):969–1117, 2018. 2
[45] Yaron Lipman, Ricky T. Q. Chen, Heli Ben-Hamu, Maximilian Nickel, and Matt Le. Flow
matching for generative modeling, 2023. 1, 2
[46] Guan-Horng Liu, Arash Vahdat, De-An Huang, Evangelos A. Theodorou, Weili Nie, and Anima
Anandkumar. I2sb: Image-to-image schrödinger bridge, 2023. 4
[47] Xingchao Liu, Chengyue Gong, and Qiang Liu. Flow straight and fast: Learning to generate
and transfer data with rectified flow, 2022. 3.1
[48] Romain Lopez, Jeffrey Regier, Michael B Cole, Michael I Jordan, and Nir Yosef. Deep
generative modeling for single-cell transcriptomics. Nature methods , 15(12):1053–1058, 2018.
5.2
[49] Romain Lopez, Jeffrey Regier, Michael B Cole, Michael I Jordan, and Nir Yosef. Deep
generative modeling for single-cell transcriptomics. Nature methods , 15(12), 2018. D.4
[50] Frederike Lübeck, Charlotte Bunne, Gabriele Gut, Jacobo Sarabia del Castillo, Lucas Pelkmans,
and David Alvarez-Melis. Neural unbalanced optimal transport via cycle-consistent semi-
couplings. arXiv preprint arXiv:2209.15621 , 2022. 1, 3.2
13[51] Malte D Luecken, Daniel Bernard Burkhardt, Robrecht Cannoodt, Christopher Lance, Aditi
Agrawal, Hananeh Aliee, Ann T Chen, Louise Deconinck, Angela M Detweiler, Alejandro A
Granados, et al. A sandbox for prediction and integration of dna, rna, and proteins in single cells.
InThirty-fifth conference on neural information processing systems datasets and benchmarks
track (Round 2) , 2021. 5.2, D.4, 14, 15
[52] Christian Léonard. A survey of the schrödinger problem and some of its connections with
optimal transport, 2013. 2
[53] Leland McInnes, John Healy, and James Melville. Umap: Uniform manifold approximation
and projection for dimension reduction. arXiv preprint arXiv:1802.03426 , 2018. 2, E.2
[54] Facundo Mémoli. Gromov–wasserstein distances and the metric approach to object matching.
Foundations of computational mathematics , 11:417–487, 2011. 1, 2
[55] Petr Mokrov, Alexander Korotin, and Evgeny Burnaev. Energy-guided entropic neural optimal
transport. arXiv preprint arXiv:2304.06094 , 2023. 4, E.1
[56] Gaspard Monge. Mémoire sur la théorie des déblais et des remblais. Histoire de l’Académie
Royale des Sciences , pages 666–704, 1781. 4
[57] Kevin R Moon, Jay S Stanley III, Daniel Burkhardt, David van Dijk, Guy Wolf, and Smita
Krishnaswamy. Manifold learning-based methods for analyzing single-cell rna-sequencing data.
Current Opinion in Systems Biology , 7:36–46, 2018. 1
[58] Maksim Nekrashevich, Alexander Korotin, and Evgeny Burnaev. Neural gromov-wasserstein
optimal transport. arXiv preprint arXiv:2303.05978 , 2023. 1
[59] Marcel Nutz. Introduction to entropic optimal transport. B.3
[60] Giovanni Palla, David S Fischer, Aviv Regev, and Fabian J Theis. Spatial components of
molecular tissue biology. Nature Biotechnology , 40(3):308–318, 2022. 1
[61] Stefano Peluchetti. Diffusion bridge mixture transports, schrödinger bridge problems and
generative modeling, 2023. 4
[62] Gabriel Peyré, Marco Cuturi, and Justin Solomon. Gromov-wasserstein averaging of kernel and
distance matrices. In International Conference on Machine Learning , pages 2664–2672, 2016.
2, 2, 3.3
[63] Aram-Alexandre Pooladian and Jonathan Niles-Weed. Entropic estimation of optimal transport
maps. arXiv preprint arXiv:2109.12004 , 2021. 1, 4
[64] Aram-Alexandre Pooladian, Heli Ben-Hamu, Carles Domingo-Enrich, Brandon Amos, Yaron
Lipman, and Ricky Chen. Multisample flow matching: Straightening flows with minibatch
couplings. arXiv preprint arXiv:2304.14772 , 2023. 3.1, 4, E.1
[65] Aviv Regev, Sarah A Teichmann, Eric S Lander, Ido Amit, Christophe Benoist, Ewan Birney,
Bernd Bodenmiller, Peter Campbell, Piero Carninci, Menna Clatworthy, et al. The human cell
atlas. elife, 6:e27041, 2017. 1
[66] Philippe Rigollet and Austin J. Stromme. On the sample complexity of entropic optimal
transport, 2022. 4
[67] Gabriel Rioux, Ziv Goldfeld, and Kengo Kato. Entropic gromov-wasserstein distances: Stability,
algorithms, and distributional limits. arXiv preprint arXiv:2306.00182 , 2023. 4
[68] Filippo Santambrogio. Optimal Transport for Applied Mathematicians. Birkhäuser, NY , 55
(58-63):94, 2015. B.1
[69] Meyer Scetbon, Marco Cuturi, and Gabriel Peyré. Low-rank sinkhorn factorization. In
International Conference on Machine Learning , pages 9344–9354. PMLR, 2021. 1
14[70] Meyer Scetbon, Gabriel Peyré, and Marco Cuturi. Linear-time gromov wasserstein distances
using low rank couplings and costs. In International Conference on Machine Learning , pages
19347–19365. PMLR, 2022. 1, 2
[71] Meyer Scetbon, Michal Klein, Giovanni Palla, and Marco Cuturi. Unbalanced low-rank optimal
transport solvers. Advances in Neural Information Processing Systems , 36, 2024. 1
[72] Geoffrey Schiebinger, Jian Shu, Marcin Tabaka, Brian Cleary, Vidya Subramanian, Aryeh
Solomon, Joshua Gould, Siyan Liu, Stacie Lin, Peter Berube, et al. Optimal-Transport Analysis
of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming. Cell,
176(4), 2019. 1, E.1
[73] Vivien Seguy, Bharath Bhushan Damodaran, Rémi Flamary, Nicolas Courty, Antoine Rolet,
and Mathieu Blondel. Large-scale optimal transport and mapping estimation. arXiv preprint
arXiv:1711.02283 , 2017. 4, E.1
[74] Thibault Séjourné, François-Xavier Vialard, and Gabriel Peyré. The unbalanced gromov
wasserstein distance: Conic formulation and relaxation. Advances in Neural Information
Processing Systems , 34:8766–8779, 2021. 1, B.2
[75] Thibault Séjourné, Gabriel Peyré, and François-Xavier Vialard. Unbalanced optimal transport,
from theory to numerics. arXiv preprint arXiv:2211.08775 , 2022. A
[76] Yuyang Shi, Valentin De Bortoli, Andrew Campbell, and Arnaud Doucet. Diffusion schr \"
odinger bridge matching. arXiv preprint arXiv:2303.16852 , 2023. 1, 4
[77] Justin Solomon, Fernando De Goes, Gabriel Peyré, Marco Cuturi, Adrian Butscher, Andy
Nguyen, Tao Du, and Leonidas Guibas. Convolutional wasserstein distances: Efficient optimal
transportation on geometric domains. ACM Transactions on Graphics (ToG) , 34(4):1–11, 2015.
3.1
[78] Sanjay R Srivatsan, José L McFaline-Figueroa, Vijay Ramani, Lauren Saunders, Junyue Cao,
Jonathan Packer, Hannah A Pliner, Dana L Jackson, Riza M Daza, Lena Christiansen, et al.
Massively multiplex chemical transcriptomics at single-cell resolution. Science , 367(6473),
2020. 5.1, D.3
[79] Tim Stuart, Avi Srivastava, Shaista Madad, Caleb A Lareau, and Rahul Satija. Single-cell
chromatin state analysis with signac. Nature methods , 18(11):1333–1341, 2021. 5.2, D.4
[80] Thibault Séjourné, Gabriel Peyré, and François-Xavier Vialard. Unbalanced optimal transport,
from theory to numerics, 2023. 2, B.2, B.3, B.3, B.2, B.2
[81] Thibault Séjourné, François-Xavier Vialard, and Gabriel Peyré. The unbalanced gromov
wasserstein distance: Conic formulation and relaxation, 2023. 2, 3.3, B.1, B.3
[82] Alexis Thual, Huy Tran, Tatiana Zemskova, Nicolas Courty, Rémi Flamary, Stanislas Dehaene,
and Bertrand Thirion. Aligning individual brains with fused unbalanced gromov-wasserstein,
2023. 3.3
[83] Alexander Tong, Jessie Huang, Guy Wolf, David Van Dijk, and Smita Krishnaswamy. Tra-
jectoryNet: A Dynamic Optimal Transport Network for Modeling Cellular Dynamics. In
International Conference on Machine Learning (ICML) , 2020. 1
[84] Alexander Tong, Nikolay Malkin, Kilian Fatras, Lazar Atanackovic, Yanlei Zhang, Guillaume
Huguet, Guy Wolf, and Yoshua Bengio. Simulation-free schr \" odinger bridges via score and
flow matching. arXiv preprint arXiv:2307.03672 , 2023. 1, 3.1, 4
[85] Alexander Tong, Nikolay Malkin, Guillaume Huguet, Yanlei Zhang, Jarrid Rector-Brooks,
Kilian Fatras, Guy Wolf, and Yoshua Bengio. Conditional flow matching: Simulation-free
dynamic optimal transport. arXiv preprint arXiv:2302.00482 , 2023. 1, 3.1, 4, 5, E.1
[86] Théo Uscidda and Marco Cuturi. The monge gap: A regularizer to learn all transport maps,
2023. 1
15[87] Francisco Vargas, Pierre Thodoroff, Austen Lamacraft, and Neil Lawrence. Solving schrödinger
bridges via maximum likelihood. Entropy , 23(9):1134, 2021. 4, E.1
[88] Titouan Vayer, Laetitia Chapel, Rémi Flamary, Romain Tavenard, and Nicolas Courty. Optimal
transport for structured data with application on graphs. arXiv preprint arXiv:1805.09114 , 2018.
1, 3.3, B.1, B.1
[89] Daniel E Wagner and Allon M Klein. Lineage tracing meets single-cell omics: opportunities
and challenges. Nature Reviews Genetics , 21(7):410–427, 2020. 1
[90] Tao Wang and Ziv Goldfeld. Neural estimation of entropic optimal transport, 2024. 4
[91] Jonathan Weed and Francis Bach. Sharp asymptotic and finite-sample rates of convergence
of empirical measures in wasserstein distance, 2017. URL https://arxiv.org/abs/1707.
00087 . 4
[92] Philipp Weiler, Marius Lange, Michal Klein, Dana Pe’er, and Fabian Theis. Unified fate
mapping in multiview single-cell data. bioRxiv , pages 2023–07, 2023. C.2
[93] Karren D Yang and Caroline Uhler. Scalable Unbalanced Optimal Transport using Generative
Adversarial Networks. International Conference on Learning Representations (ICLR) , 2019.
3.2, 11, E.1
[94] Karren D. Yang and Caroline Uhler. Scalable unbalanced optimal transport using generative
adversarial networks, 2019. 1
[95] Zhengxin Zhang, Ziv Goldfeld, Youssef Mroueh, and Bharath K. Sriperumbudur. Gromov-
wasserstein distances: Entropic regularization, duality, and sample complexity, 2023. 2, 4
[96] Linqi Zhou, Aaron Lou, Samar Khanna, and Stefano Ermon. Denoising diffusion bridge models,
2023. 4
16Appendix
A Limitations
While our study opens up the use of neural optimal transport to a wide range of tasks in single-cell
genomics, there are limitations of our work:
•The solution to the entropic (Fused) Gromov-Wasserstein problem is not necessarily unique.
As GENOT-Q and GENOT-F leverage discrete solvers in each iteration, the orientation of
the solution across iterations is not maintained. To prevent learning a mixture of solutions,
we propose to use a fused term whenever possible, make use of different cost functions if
helpful, or using GENOT with our proposed initialisation scheme (§ E.2). While the latter
can always be applied, its major drawback is the costly training as a neural ODE has to be
solved at every iteration.
•When learning unbalanced EOT plans, choosing a value for the hyperparameters (τa, τb)is
not evident. As discussed in Séjourné et al. [75], the choice of these parameters is mostly
empirical.
•While GENOT is motivated by the extensive use of optimal transport in single-cell genomics,
there is no evidence that cells evolve exactly according to an entropic OT plan.
•Evaluations of learnt transport plans for tasks in single-cell genomics experiments are
task-specific, and do not necessarily reflect to what extent the learnt coupling is an entropic
OT coupling. In effect, we rely on prior biological knowledge (CT error, Fig. 2) or on
common downstream trajectory inference methods in single-cell genomics to evaluate the
learnt velocity field (TSI score, Fig. 2) when computing EOT plans for trajectory inference.
Similarly, we can only assess learnt EOT plan on a cluster level, and not a single data point
level when studying cellular perturbations (3). For the task of modality translation (Fig. 4),
we know the ground-truth coupling. Yet, the ground-truth coupling is deterministic and
one-to-one, and hence is not a valid solution of an entropy-regularized Gromov-Wasserstein
OT plan with ε >0.
B Propositions and Proofs
B.1 Existence of EOT couplings
In this section, we point out that a solution to the entropic fused GW problem (EFGW) , and its
unbalanced counterpart, always exists. Note that for α= 0, we recover the existence for the pure
entropic GW (EFGW) and its unbalanced counterpart (UQEOT) problems. The arguments are
adapted from [88, Prop. 2]
Balanced setting: We first recall the fused Gromov-Wasserstein problem below.
min
π∈Π(µ,ν)Z
((Ω×˜X)×(Ω×˜Y))2Qc
c˜X,c˜Yd(π⊗π) +εKL(π|µ⊗ν) (6)
where Qc
c˜X,c˜Y((u,x),(v,y),x′,y′) := (1 −α)c(u,v) +α|c˜X(x,x′)−c˜Y(y,y′)|2. We first need
to show that a solution π⋆
εto this problem always exists. We assume that the intra-domain cX,cY
costs, and the inter-domain cost care l.s.c, an assumption that matches all our experimental settings.
From [88, Lemma 3], this implies that the functional:
π∈Π(µ, ν)7→Z
((Ω×˜X)×(Ω×˜Y))2Qc
c˜X,c˜Yd(π⊗π) (7)
is weakly l.s.c, i.e. l.s.c for the convergence in law. Moreover, from [ 23, Prop. 8], π7→KL(π|µ⊗ν)
is also weakly l.s.c. Therefore, the objective function of the fused Gromov-Wasserstein problem:
F:π∈Π(µ, ν)7→Z
((Ω×˜X)×(Ω×˜Y))2Qc
c˜X,c˜Yd(π⊗π) +εKL(π|µ⊗ν) (8)
is weakly l.s.c, as a sum of weakly l.s.c functionals. Then, since we assume that XandYare compact,
they are polish spaces, so from [ 68, Theorem 1.7], Π(µ, ν)is weakly compact. Therefore, from
Weierstrass Theorem, Fattains its minimum on Π(µ, ν), i.e. it exists π⋆
εsolution to this problem.
17Unbalanced setting: The proof is very similar. We first recall the unbalanced fused Gromov-
Wasserstein problem.
min
π∈M+(X×Y )Z
((Ω×˜X)×(Ω×˜Y))2Qc
c˜X,c˜Yd(π⊗π) +εKL(π|µ⊗ν) +λ1KL⊗(π1|µ) +λ2KL⊗(π2|µ)
(9)
where KL⊗(α|β) = KL( α⊗α|β⊗β). From [ 81, Prop. 8], KL⊗is weakly l.s.c, so is π7→
KL⊗(π1|µ)andπ7→KL⊗(π2|ν). Therefore, the objective function of the unbalanced fused
Gromov-Wasserstein problem is also weakly l.s.c. as a sum of weakly l.s.c. functions. Moreover,
sinceXandYare assumed to be compact, X × Y is also compact and the Banach-Alaoglu provides
the compactness of M+(X × Y ). Then, from Weierstrass Theorem, similarly to the balanced setting,
we get the existence of a solution π⋆
ε,τto this problem.
B.2 Proofs of § 3.2
Proposition B.1 (Re-Balancing the unbalanced problems.) .Letπ⋆
ε,τbe an unbalanced EOT coupling,
solution of (ULEOT) or(UQEOT) between µ∈ M+(X)andν∈ M+(Y). We note ˜µ=p1♯π⋆
ε,τ
and˜ν=p2♯π⋆
ε,τits marginals. Then, in both cases, ˜µ(resp. ˜ν) has a density w.r.t. µ(resp. ν). That
is, there exist two re-weighting functions, one on each space, η:X →R+andξ:Y →R+s.t.
˜µ=η·µand˜ν=ξ·ν. Furthermore, ˜µand˜νhave the same total mass and
1. (Linear) π⋆
ε,τsolves the balanced problem (LEOT) between ˜µand˜νwith the same ε.
2.(Quadratic) Provided that cX,cY(or−cX,−cY) are CPD kernels (see Def. B.2), π⋆
ε,τsolves the
balanced problem (QEOT) between ˜µand˜νwithε′=m(π⋆
ε,τ)ε, where m(π⋆
ε,τ) =π⋆
ε,τ(X ×Y ).
We first remind the definition of a conditionally positive kernel, which is involved in point 2. of
Prop. 3.1.
Definition B.2. A kernel k:Rd×Rd→Ris conditionally positive if it is symmetric and for any
x1, ...,xn∈Rdanda∈Rns.t.a⊤1n= 0, one has
nX
i,j=1aiajk(xi,xj)≥0
Conditionally positive kernels include all positive kernels, such k(x,y) =⟨x,y⟩orkγ(x,y) =
exp(−1
γ∥x−y∥2
2), but also the negative squared Euclidean distance k(x,y) =−∥x−y∥2
2.
Proof of 3.1. Step 1: Re-weightings. We first show that for π⋆
ε,τsolution of (LEOT) or(QEOT) , it
exists η, ξ:Rd→R+s.t.˜µ=p1♯π⋆
ε,τ=η·µand˜ν=p1♯π⋆
ε,τ=ξ·ν.
We start with the linear case and consider π⋆
ε,τsolution of (LEOT) . The result follows from duality.
Indeed, from [ 80, Prop. 2], one has the existence of the so-called entropic potentials f⋆∈ C(X)and
g⋆∈C(Y)s.t.
dπ⋆
ε,τ
d(µ⊗ν)(x,y) = expf⋆(x) +g⋆(y)−c(x,y)
ε
(10)
Therefore, ˜µ=η·µand˜ν=ξ·νwhere η:X →R+andξ:Y →R+are defined by:
η(x) =Z
Yexpf⋆(x) +g⋆(y)−c(x,y)
ε
dν(y)
and ξ(y) =Z
Xexpf⋆(x) +g⋆(y)−c(x,y)
ε
dµ(x).(11)
We now handle the quadratic case and consider π⋆
ε,τsolution of (UQEOT) . We remind that
the (UQEOT) problem between µandνreads:
min
π∈M+(X×Y )Z
(X×Y )2|cX(x,x′)−cY(y,y′)|2dπ(x,y) dπ(x′,y′)
+εKL⊗(π|µ⊗ν) +λ1KL⊗(π1|µ) +λ2KL⊗(π2|ν),
18Forπ∈ M+(X ×Y ), the quadratic relative entropy KL⊗(π|µ⊗µ) = KL( π⊗π|(µ⊗ν)⊗(µ⊗ν))
is finite i.f.f. π⊗πhas a density w.r.t. (µ⊗ν)⊗(µ⊗ν), which implies that πhas a density w.r.t.
µ⊗ν. Therefore, one can reformulate (UQEOT) as:
min
h∈L+
1(X×Y )Z
(X×Y )2(cX(x,x)−cY(y,y))2h(x,y)h(x′,y′) dµ(x) dµ(x′) dν(y) dν(y′)
+εKL(h|µ⊗ν) +τ1KL(h1|µ) +τ2KL(h2|ν)(12)
where we extend the KL divergence for densities: KL(r|γ) =R
(rlog(r) +r−1) dγ, and define
the marginal densities h1:x∈ X 7→R
Yh(x,y) dν(y)andh2:y∈ Y 7→R
Xh(x,y) dν(y). As a
result, it exists h⋆∈L+
1(X × Y )s.t.π⋆
ε,τ=h⋆·µ⊗ν. It follows that ˜µ=η·µand˜ν=ξ·νwith
η=h⋆
1andξ=h⋆
2.
Remark B.3.Note that in both cases, since d˜µ(x) =η(x) dµ(x)andd˜ν(y) =ξ(y) dν(y), the
equality of mass of ˜µand˜νyieldsEX∼µ[η(X)] =EY∼ν[ξ(Y)].
Step 2: Optimality in the balanced problem for the linear case. We now prove point 1 , stating
that if π⋆
ε,τsolves problem ULEOT between µandν, then it solves problem (LEOT) between ˜µand
˜νfor the same entropic regularization strength ε. It also follows from duality. We remind that that
thanks to [80, Prop. 2]
dπ⋆
ε,τ
d(µ⊗ν)(x,y) = expf⋆(x) +g⋆(y)−c(x,y)
ε
(13)
withf⋆∈ C(X)andg⋆∈C(Y). Moreover, by [ 59, Theorem 4.2], such a decomposition is equivalent
to the optimality in problem (LEOT) . Therefore, π⋆
ε,τis solves problem LEOT between its marginals
˜µand˜ν, i.e.
π⋆
ε,τ= arg min
π∈Π(˜µ,˜ν)Z
X×Yc(x,y) dπ(x,y) +εKL(π|µ⊗ν). (14)
Step 3: Optimality in the balanced problem for the quadratic case. We now prove point 2 , stating
that, provided that the costs cXandcYare conditionally positive (or conditionally negative), if π⋆
ε,τ
solves problem (UQEOT) between µandν, then it actually solves problem (QEOT) between ˜µand
˜νfor the entropic regularization strength ε′=m(π⋆
ε,τ)ε. We first define the functional:
F: (γ, π)∈ M+(X × Y )27→Z
(X×Y )2|cX(x,x′)−cY(y,y′)|2dπ(x,y) dγ(x′,y′)
+εKL(π⊗γ|(µ⊗ν)2) +λ1KL(π1⊗γ1|µ×µ) +λ2KL⊗(π2⊗γ2|ν×ν),(15)
s.t.π⋆
ε,τ∈arg minπ∈M(X×Y )F(π, π). Then, if we define the linearized cost
c⋆
ε,τ: (x,y)∈ X × Y 7→Z
X×Y|cX(x,x′)−cY(y,y′)|2dπ⋆
ε,τ(x′,y′), (16)
we get from [80, Proposition 9], that π⋆
ε,τsolves:
π⋆
ε,τ∈arg min
π∈M(×Y)Z
X×Yc⋆
ε,τ(x,y) dπ(x,y) +εm(π⋆
ε,τ)KL(π|µ⊗ν)
+λ1m(π⋆
ε,τ)KL(π1|µ) +λ2m(π⋆
ε,τ)KL(π2|ν).(17)
Therefore, π⋆
ε,τsolves problem ULEOT between µandνfor a new cost c⋆
ε,τ, and the regularization
strength ε′=εm(π⋆
ε,τ). We seek to apply point 1, to get that π⋆
ε,τsolves problem LEOT between
˜µ=p1♯π⋆
ε,τand˜ν=p2♯π⋆
ε,τfor the same entropic regularization strength ε′. To that end, we first
verify that c⋆
ε,τis continuous. Since cXandcYare continuous on X × X andY × Y , the function:
(x,y,x′,y′)∈(X × Y )27→ |cX(x,x′)−cY(y,y′)|2
is continuous. Therefore, it is bounded since (X × Y )2is compact as a product of compact sets.
Then, since π⋆
ε,τhas finite mass, Lebesgue’s dominated convergence yields the continuity of c⋆
ε,τ. We
then to apply point 1 and get:
π⋆
ε,τ∈arg min
π∈Π(˜µ,˜ν)Z
X×Yc⋆
ε,τ(x,y) dπ(x,y) +ε′KL(π|µ⊗ν) (18)
19Since the costs are conditionally positive (or conditionally negative) kernels, (18) finally yields the
desired result by applying [81, Theorem 3]:
π⋆
ε,τ∈arg min
π∈Π(˜µ,˜ν)Z
X×Y|cX(x,x′)−cY(y,y′)|dπ(x′,y′) dπ(x,y) +ε′KL(π|µ⊗ν) (19)
Remark B.4.In various experimental settings, µandνhave mass 1, and we impose one of the
two hard marginal constraints, for instance, on µ, by setting τ1= 1. Then ˜νhas also mass 1 and
m(π⋆
ε,τ) = 1 , soε′=m(π⋆
ε,τ) =εand we keep the same regularization strength εby re-balancing
(UQEOT).
Proposition B.5 (Pointwise estimation of re-weighting functions.) .Letπn
ε,τ=P
i,jPi,j
ε,τδ(Xi,Yj),
solution to (ULEOT) between empirical counterparts of µandν. Leta=Pε,τ1nandb=P⊤
ε,τ1n
its marginals weights. Then, almost surely, n ai→η(Xi)andn bi→ξ(Yi).
Proof. As we saw in the proof of Prop.3.1, using Séjourné et al. [80, Prop. 2 ], one has the existence
off⋆∈C(X)andg⋆∈C(Y)s.t.
dπ⋆
ε,τ
d(µ⊗ν)(x,y) = expf⋆(x) +g⋆(y)−c(x,y)
ε
:=h(x,y)
and the relative densities ηandξs.t.˜µ=p1♯π⋆
ε,τ=η·µand˜ν=p2♯π⋆
ε,τ=ξ·νare given by
η:x7→Z
Yh(x,y) dν(y)and ξ:y7→Z
Xh(x,y) dµ(x) (20)
Now, let consider ˆπε,τ=P
i,jPi,j
ε,τδ(Xi,Yj)the solution of problem LEOT between ˆµn=
1
nPn
i=1δXiandˆνn=1
nPn
i=1δYi. Similarly, using Séjourné et al. [80, Prop. 2 ], one has the
existence of f⋆
n∈C(X)andg⋆
n∈C(Y)s.t.
dˆπε,τ
d(ˆµn⊗ˆνn)(x,y) = expf⋆
n(x) +g⋆
n(y)−c(x,y)
ε
:=hn(x,y) (21)
and the relative densities ηnandξns.t.˜µn=p1♯ˆπn
ε,τ=ηn·ˆµnand˜νn=p2♯ˆπn
ε,τ=ξn·ˆνnare
given by
ηn:x7→1
nnX
j=1hn(x,yj)and ξn:y7→1
nnX
j=1hn(xi,y) (22)
From Eq. (21), we get that Pij
ε,τ=1
n2h(xi,yj), so reminding that a=Pε,τ1nandb=P⊤
ε,τ1n,
one has n ai=ηn(Xi)andn bi=ξn(Yi). We now show that almost surely, ηn→ηandξn→ξ
pointwise, which implies the desired result that, almost surely, n ai→η(Xi)andn bi→ξ(Yi).
Almost surely, ˆµn⇀ µ andˆνn⇀ ν , so using [ 74, Proposition 10], f⋆
n→f⋆andg⋆
n→g⋆in
sup-norm. Since f⋆
n→f⋆onXandg⋆
n→g⋆onYin sup-norm, we can show that hn→hin
sup-norm on X × Y . Indeed, for (x,y)∈(X × Y ), one has:
|hn(x,y)−h(x,y)|
=expf⋆
n(x) +g⋆
n(y)−c(x,y)
ε
−expf⋆(x) +g⋆(y)−c(x,y)
ε
= expc(x,y)
εexpf⋆
n(x) +g⋆
n(y)
ε
−expf⋆(x) +g⋆(y)
ε
≤Mc,εexpf⋆
n(x) +g⋆
n(y)
ε
−expf⋆(x) +g⋆(y)
ε(23)
20withMc,ε= sup(x,y)∈X×Y exp
c(x,y)
ε
<+∞, since (x,y)7→exp
c(x,y)
ε
is continuous on
the compact X × Y , ascis continuous. Afterwards,expf⋆
n(x) +g⋆
n(y)
ε
−expf⋆(x) +g⋆(y)
ε
≤expf⋆
n(x)
ε
expg⋆
n(x)
ε
−expf⋆
n(x)
ε
expg⋆(x)
ε
+expf⋆
n(x)
ε
expg⋆(x)
ε
−expf⋆(x)
ε
expg⋆(x)
ε(24)
For the first term, one has:expf⋆
n(x)
ε
expg⋆
n(x)
ε
−expf⋆
n(x)
ε
expg⋆(x)
ε
= expf⋆
n(x)
εexpg⋆
n(x)
ε
−expg⋆(x)
ε
≤exp∥f⋆
n∥∞
εexpg⋆
n(x)
ε
−expg⋆(x)
ε(25)
First, we can bound uniformly exp (∥f⋆
n∥∞/ε)since fnconverges in sup-norm, so (∥f⋆
n∥∞)n≥0
is bounded. Then, since g⋆
nconvergences in sup-norm, it is uniformly bounded, and since g⋆
is continuous on the compact X, it is bounded. Therefore, we can find a compact K⊂Rs.t.
g⋆(X)⊂Kand for each n,g⋆
n(X)⊂K. Then, applying the mean value theorem to the C1function
x7→exp(x/ε)onK, we can bound:
expg⋆
n(x)
ε
−expg⋆(x)
ε≤sup
z∈K1
εexp(1
εz)|g⋆
n(x)−g⋆(x)| (26)
This yields the existence of a constant M1>0s.t.expf⋆
n(x)
ε
expg⋆
n(x)
ε
−expf⋆
n(x)
ε
expg⋆(x)
ε≤M1∥g⋆
n−g⋆∥∞ (27)
Using the same strategy, we get the existence of a constant M2>0s.t.expf⋆
n(x)
ε
expg⋆(x)
ε
−expf⋆(x)
ε
expg⋆(x)
ε≤M2∥f⋆
n−f⋆∥∞ (28)
Combining (27) and (28) with (23), we get that:
|hn(x)−h(x)| ≤Mc,ε(M1∥g⋆
n−g⋆∥∞+M2∥f⋆
n−f⋆∥∞) (29)
from which we deduce that hn→hin sup-norm, from the convergence of fn→fandgn→gin
sup-norm.
Now, we can show the pointwise convergence of ˆηn. For any x∈ X, one has:
|ˆηn(x)−η(x)|
=|Z
hn(x,y) dˆνn(y)−Z
h(x,y) dν(y)|
≤|Z
hn(x,y) dˆνn(y)−Z
h(x,y) dˆνn(y)|+|Z
h(x,y) dˆνn(y)−Z
h(x,y) dν(y)|
≤Z
∥hn−h∥∞dˆνn(y) +|Z
h(x,y) dˆνn(y)−Z
h(x,y) dν(y)|
=∥hn−h∥∞+|Z
h(x,y) dˆνn(y)−Z
h(x,y) dν(y)|(30)
Therefore, it almost surely holds that ˆηn(x)→η(x). Indeed, ∥hn−h∥∞→0since we have shown
thathn→hin sup-norm. Then, his continuous on the compact X × Y , so it is bounded, so since
µn⇀ µ , we getR
hdˆνn→R
hdν. Next, we show similarly that, almost surely, ξn→ξpointwise.
21C Metrics
We start with introducing general metrics in § C.1, some of which will be used in the metrics
introduced in the context of experiments on single-cell data in § C.2.
C.1 General metrics
In the following, we discuss a way how to classify predictions in a generative model. We start with
the setting where each mapped sample is to be assigned to a category based on labelled data in the
target distribution. We then continue with the case where there are also labels for samples in the
source distribution, and this way define a classifier fclassmapping from the source distribution to
labels in the target distribution with the possibility to compute accuracy. Building upon this, we
assign the classifier fclassan uncertainty score for each prediction. Finally, we define a calibration
score assessing the quality of a given uncertainty score.
Turning a generative model into a classifier In the following, consider a finite set of samples in
the target domain y1, . . . ,yM∈ Y. Assume {ym}M
m=1allows for a partition {ym}M
m=1=⊔k∈KTk.
Hence, each sample belongs to exactly one class, which we interchangeably refer to as the sample
being labelled. Let T:X → Y be a map (deterministic or stochastic), and let f1-NN:Y → {T k}K
k=1
be the 1-nearest neighbor classifier. We obtain a map gfromXto{Tk}K
k=1by the concatenation of
f1-NN andT. This map gproves useful in settings when mapped cells are to be categorized, e.g. to
assign mapped cells to a cell type.
A metric to assess the accuracy of a generative model In the following, assume that the set of
samples in the source domain x1, . . .xNallows for a partition {xn}N
n=1=⊔k∈KSk. We want to
construct a classifier fclassassigning each category in the source distribution {Sk}K
k=1probabilistically
to a category in the target distribution {Tk}K
k=1. Define fclass:{Sk}K
k=1→NKvia(fclass(Sk))j=P
xn∈Sk1{g(xn)=Tj}where g:X → {T k}K
k=1was defined above.
Assume that there exists a known one-to-one (injective would be sufficient) match between elements
in{Sk}K
k=1and elements in {Tk}K
k=1. Then we can define a confusion matrix Awith entries
Aij:=P
xn∈Ti1{g(xn)=Sj}. In the context of entropic OT the confusion matrix is element-wise
defined as
Aij:=X
xn∈Ti1{f1-NN(T(xn))=Sj} (31)
This way we obtain an accuracy score of the classifier fclassmapping a partition of one set of samples
to a partition of another set of samples.
Calibration score To assess the meaningfulness of an uncertainty score, we introduce the following
calibration score. Assume we have a classifier which yields predictions along with uncertainty
estimations. Let u∈RKbe a vector containing an uncertainty estimation for each element in
{Sk}K
k=1. Moreover, let a∈RKbe a vector containing the accuracy for each element in {Sk}K
k=1.
We then define our calibration score to be the Spearman rank correlation coefficient between uand
1K−a, where 1Kdenotes the K−dimensional vector containing 1in every entry. In effect, the
calibration score is close to 1if the model assigns high uncertainty to wrong predictions and low
uncertainty to true predictions, while the calibration score is close to −1if the model assigns high
uncertainty to correct predictions and low uncertainty to wrong predictions.
In the following, we consider a stochastic map T. Lety1, ...,yL∼πθ(·|x)obtained from T. To
obtain a calibration score for fclasswe estimate a statistic V(πθ(·|x))from the samples y1, ...,yL,
reflecting an estimation of uncertainty. Then, we let the uncertainty of the prediction of fclassfor
category Sibe the mean uncertainty statistic, i.e.P
x∈SiV(πθ(·|x))
|Si|. In effect, for each prediction
fclass(Si)we get the uncertainty score
ui=X
x∈SiV(πθ(·|x))
|Si|. (32)
22Assessing the uncertainty with the cos-var metric Gayoso et al. [25] introduce a statistic to assess
the uncertainty of deep generative RNA velocity methods from samples of the posterior distribution,
which we adapt to the OT paradigm to obtain
cos-var (πθ(·|x)) = Var Y∼πθ(·|x)[cos-sim(Y,EY∼πθ(·|x)[Y])], (33)
where cos-simdenotes the cosine similarity. We refer to this metric as cos-var, as it computes the
variance of the cosine similarity of samples following the conditional distribution and the conditional
mean. We use 30 samples from the conditional distribution to compute this metric.
C.2 Single-cell specific metrics
TSI score for developmental systems In the following, we describe TSI metric used in Fig. 2.
The terminal state identification score (TSI) was introduced in Weiler et al. [92] and assesses to what
extent the learnt vector field of a developmental system points towards the correct directions. In
effect, we assume that terminal states of the biological developmental process are known. CellRank
[42] identifies macrostates using a Schur decomposition based on the transition matrix computed
from the learnt vector field (using CellRank’s VelocityKernel ). From these macrostates, CellRank
infers a set of putative terminal states, loosely speaking by looking for sinks in the transition matrix.
To define the TSI score, we consider a system containing mterminal states and the function fthat
assigns each number of macrostates nthe corresponding number of identified terminal states. In the
case of a strategy that identifies terminal states optimally, foptdescribes the step function
fopt(n) =n, n < m
m, n ≥m.
The TSI score of the learnt vector field θis the area under the curve fθrelative to the area under the
curve fopt,i.e.,
TSI(θ) =PNmax
n=1fθ(n)
PNmax
n=1fopt=2
m(1 +Nmax−m)NmaxX
n=1fθ(n).
Thus, the TSI score lies between 0and 1, with 1being optimal. We compute
the LSI score with https://cellrank.readthedocs.io/en/latest/api/_autosummary/
estimators/cellrank.estimators.GPCCA.html#cellrank.estimators.GPCCA.tsi
In the specific dataset considered here, the terminal cell states are Alpha, Beta, Delta, and Epsilon
cells [ 2]. Hence, the TSI score measures to what extent the underlying vector field captures the
dynamics such that cells develop into either of these cell states, while these cell states being a sink.
In the CellRank API, we set n_macrostates to 15, i.e., the algorithm looks for 15 macrostates.
Cell type scores/errors As in most single-cell tasks there is no ground truth of matches between
cells, we rely on labels of clusters of the data, i.e. on cell types. We then assess the accuracy of a
generative model by considering the accuracy of the corresponding classifier fclassas described above.
The correct matches between classes have to be considered task-specifically.
In the developmental pancreas example considered in Figures 2 and 9, we have {Sk}K
k=1=
{Tk}K
k=1={Alpha, Beta, Delta, Epsilon, Fev+ Alpha, Fev+ Beta, Fev+ Delta, Fev+ Delta, Fev+
Pyy, Ngn3 High late, Ngn3 High early, Ngn3 low EP }. Here, we do not look for a one-to-one match,
as from a developmental biology perspective, it is reasonable (and even expected) that e.g. a Fev+
Alpha cell evolves into an Alpha cell. To measure to what extent the dynamics follow the manifold,
we measure how many cells in one of the terminal cell states Alpha, Beta, Delta, Epsilon are derived
directly from Ngn3 low EP cells. These transitions are biologically unlikely, as cells are known to
evolve via the Ngn3 high cluster and either of Fev+ Alpha, Fev+ Beta, Fev+ Delta or Fev+ Epsilon.
Hence, the direct transition from Ngn3 low EP cells to one of the terminal cell states is very unlikely.
Thus, we denote this fraction as the cell transition error ( CT error ).
In the following, we discuss the choice of the labels {Sk}K
k=1and{Tk}K
k=1for perturbation
prediction in Fig.3, Fig.12. Each drug was applied to cells belonging to three different cell
types/cell lines, namely A549, K562, and MCF7. Hence, we can define {Sk}K
k=1={Tk}K
k=1=
23{A549, K562, MCF 7}as for each perturbed cell we know the cell type at the time of injecting the
drug.
FOSCTTM score In the following, we consider a setting where the true match between samples is
known. The FOSCTTM score ("Fraction of Samples Closer than True Match") measures the fraction
of cells which are closer to the true match than the predicted cell. Hence, a random match has a
FOSCTTM score of 0.5, while a perfect match has a FOSCTTM score of 0.0. In the following we
only consider discrete distributions. To define the FOSCTTM score for a map T:X → Y , let
x1, . . .xK∈ X be samples from the source distribution and y1, . . .yK∈ Y be samples from the
target distribution, such that xkandykform a true match. Moreover, let ˆyk=T(xk). Let
pj=P
k∈K1∥yk−ˆyj∥2
2≤∥yj−ˆyj∥2
2
|K|(34)
and
qj=P
k∈K1∥yj−ˆyk∥2
2≤∥yj−ˆyk∥2
2
|K|(35)
Then, the FOSCTTM score between the predicted target {ˆyk}k∈Kand the target {yk}k∈Kis obtained
as
FOSCTMM ({ˆyk}k∈K,{yk}k∈K) =X
k∈Kpj+qj
2. (36)
D Datasets
D.1 Gushchin et al. [30]’s benchmark datasets
We follow the notebook in https://github.com/ngushchin/EntropicOTBenchmark/blob/
main/notebooks/mixtures_benchmark_visualization_eot.ipynb , which allows to down-
load the data when instantiating the samplers by setting download=True in the function
get_guassian_mixture_benchmark_sampler() .
D.2 Pancreas single-cell dataset
The dataset of the developing mouse pancreas was published in Bastidas-Ponce et al. [2]and can
be downloaded following the guidelines on https://www.ncbi.nlm.nih.gov/geo/query/acc.
cgi?acc=GSE132188 . The full dataset contains measurements of embryonic days 12.5, 13.5, 14.5,
and 15.5, while we only consider time points 14.5 and 15.5.
We filter the dataset such that we only keep cells belonging to the cell types of the endocrine branch
to ensure that learnt transitions are biologically plausible. Moreover, cells annotated as Ngn3 high
cycling were removed due to its unknown stage in the developmental process [ 2]. The removal is
justified by the small number of cells belonging to this cell type and its outlying position in gene
expression space. Experiments were performed on 30-dimensional PCA space of log-transformed
gene expression counts.
D.3 Drug perturbation single-cell dataset
The dataset was published in [ 78]. We download the dataset following the instructions detailed on
https://github.com/bunnech/cellot/tree/main .
For all analyses we computed PCA embeddings (50 dimensions) on the filtered dataset including the
control cells and the corresponding drug only. This ensures the capturing of relevant distributional
shifts and hence prevents the model from near-constant predictions as the effect of numerous drugs is
weak.
The drugs in figure 3 were chosen as in Hetzel et al. [33].
D.4 Human bone marrow single-cell dataset for modality translation
This dataset contains paired measurements of single-cell RNA-seq readouts and single-nucleus
ATAC-seq measurements [ 51]. This means that we have a ground truth one-to-one matching
24(x,y)⇠⇡GENOT✓
<latexit sha1_base64="pJv55ohWgbk+16wO0M4Voz0dHac=">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</latexit>
(x,y)⇠⇡OT-CFM✓
<latexit sha1_base64="w15rFiisfi+B+IAYP4/49LR4cpo=">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</latexit>
(x,y)⇠⇡?",Coulomb
<latexit sha1_base64="TE4uMBl52X9idzkzTU/Tan89Dhc=">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</latexit>Figure 5: Fitting the EOT coupling between two Gaussian mixtures for the Coulomb cost [ 4]
c(x,y) = 1 /∥x−y∥2, and ε= 0.01, using GENOT and OT-CFM [ 85]. For both methods, we
hence use mini-batch couplings computed with this cost. We connect paired samples with a line. The
EOT coupling pairs source samples and target samples diagonally (left). GENOT (middle) generates
samples correctly, while OT-CFM (right) fails to preserve the signal from mini-batch couplings. The
data-setting is inspired by Bortoli et al. [5, Fig. 1]
for each cell. We use the processed data provided in moscot [ 39], which can be downloaded
following the instructions on https://moscot.readthedocs.io/en/latest/genapi/moscot.
datasets.bone_marrow.html#moscot.datasets.bone_marrow . This version of the dataset
additionally contains a shared embedding for both the RNA and the ATAC data, which we use in the
fused term. This embedding was created using a variational autoencoder (scVI [ 49]) by integrating
the RNA counts of the gene expression dataset and gene activity [ 79] derived from the ATAC data, a
commonly used approximation for gene expression estimation from ATAC data [34].
In RNA space we use the PCA embedding (the dimension of which is detailed in the corresponding
experiments), while the embedding used in ATAC space is the given LSI (latent semantic indexing)
embedding, followed by a feature-wise L2-normalization as proposed in Demetci et al. [17]. The
legend for the cell type labels is given in Fig. 25.
E Additional information and results for experiments
If not stated otherwise, the GENOT model configuration follows the setup described in appendix G.
E.1 (U)-GENOT-L
Entropic OT benchmark by Gushchin et al. [30] We assess the performance of GENOT-L
following the benchmark in Gushchin et al. [30]. While the results reported in Gushchin et al. [30]
are the best ones across different configurations of hyperparameters for certain models, we choose a
single hyperparameter configuration across all dimensions and entropy regularisation parameters.
In particular, GENOT is trained for 100,000 iterations and the learning rate is set to 10−5. The
dimension of the layers in the vector field is set to 1024, and the entropy regularization parameter
is set according to the task (i.e. 0.1,1.0or10.0.). The batch size is set to 2048, and its influence is
further studied in figure 6. The number of layers per block is set to 3, and the embedding dimension
of the time, condition, and noise is set to 1,024. All remaining parameters are chosen as described in
appendix G.
Following Gushchin et al. [30], Tab. 2 reports the Bures-Wasserstein Unexplained Variance Percentage
(BW2
2-UVP ) between the marginal distributions p2♯πθandνdefined as
BW2
2-UVP ( p2♯πθ, ν) =100%
1
2Var (ν)BW2
2(p2♯πθ, ν) (37)
25where BW2
2(p2♯πθ, π∗
2)is the Bures-Wasserstein metric between the Gaussian approximations of
the distributions p2♯πθandν:
BW2
2(p2♯πθ, ν) =W2
2(N(mν,Σν),N(mp2♯πθ,Σp2♯πθ)). (38)
Here, W2
2denotes the Wasserstein-2 distance, and for any measure γ,mγdenotes its mean and Σγ
its covariance.Tab. 3 displays the conditional Bures-Wasserstein Unexplained Variance Percentage
(cBW-UVP), which is the integration of the Bures-Wasserstein distances of the estimated and the true
conditional distributions:
cBW2
2-UVP ( πθ, π⋆
ε) =100%
1
2Var (ν)Z
XBW2
2(πθ(·|x), π⋆
ε(·|x)) dµ(x). (39)
Algorithm 2 U-GENOT with stratified sampling of the discrete conditionals. Skip teal steps for
GENOT.
1:Require parameters: Batch size n, number of (per x) conditional sample k, entropic regulariza-
tionε, unbalancedness parameter τ, discrete solver Solver ε,τ.
2:Require network: Time-dependent conditional velocity field vt,θ(·|·) :Rq×Rp→Rq, re-
weighting functions ηθ:Rp→R,ξθ:Rq→R.
3:fort= 1, . . . , T iterdo
4: X1, . . . , X n∼µandY1, . . . , Y n∼ν.
5:Pε,τ←Solver ε,τ((Xi)n
i=1,(Yi)n
i=1)∈Rn×n
+.
6:a←Pε,τ1nandb←P⊤
ε,τ1n.
7: Sample i1, . . . , i n∼aand set (X1, . . . , X n)←(Xi1, . . . , X in).
8: fori= 1, . . . , n do
9: Sample i1, ..., i k∼Pε,τ[i,:].
10: Sample noise vectors Zi,1, . . . , Z i,k∼ρand time-steps ti,1, . . . , t i,k∼ U([0,1]).
11: end for
12: L(θ) ←1
nPn
i=11
kPk
l=1∥vt,θ([Zi,l, Yil]t|Xi)− (Yil− Zi,l)∥2
2
+1
nPn
i=1(ηθ(Xi)−nak)2+ (ξθ(Yi)−nbk)2.
13: θ←Update (θ,∇L(θ)).
14:end for
Hence, BW2
2-UVP ( p2♯πθ, ν)measures the fitting property of the push-forward distribution
while cBW2
2-UVP ( πθ, π⋆
ε)measures the fitting property of the joint distribution. Hence,
BW2
2-UVP ( p2♯πθ, ν)measures the fitting property of the push-forward distribution while
cBW2
2-UVP ( πθ, π⋆
ε)measures the fitting property of the joint distribution.
The values for the competing methods are taken from the original manuscript Gushchin et al. [30].
Competing methods are Seguy et al. [73] (LSOT), Daniels et al. [15] (SCONES), Korotin et al. [40]
(NOT), Mokrov et al. [55] (EgNOT), Gushchin et al. [29] (ENOT), Vargas et al. [87] (MLE-SB),
De Bortoli et al. [16] (DiffSB), Chen et al. [10] (FB-SDE-A, FB-SDE-J).
To make the results of the benchmark more interpretable, we rank the methods for each experimental
setup. If multiple methods yield the same result, we assign the methods the mean of the ranks. Tab. 1
reports the average rank across the twelve different experimental setups.
Ablation study of GENOT A natural way to extend the GENOT algorithm is to sample k >1
instances from the conditional distribution. Alg. 2 describes this procedure in lines 8 to 11, resulting
only in an additional sum in the loss in line 12. As for each condition Xiwe then have multiple
samples {Zil}k
l=1and{Yil}k
l=1(in the unbalanced case kdepends on i), we can then couple the noise
samples with the samples from the conditional distribution using a discrete Sinkhorn solver (note
that the noise and the conditional distribution always live in the same space). This corresponds to
using the approach introduced in Pooladian et al. [64], Tong et al. [85] for each single conditional
generator Tθ(·|x). We study this natural extension of the GENOT model in Fig 7. While in a few
cases this extensions helps, in the majority of experiments using k >1decreases the performance.
GENOT-L for trajectory inference Discrete optimal transport is an established method for
trajectory inference in single-cell genomics [ 72]. Due to the ever increasing size of these datasets
26Model rank BW2
2-UVP rankcBW2
2-UVP ↓
LSOT 11.33 11.33
SCONES 8.67 9.33
DiffSB 8.92 9.50
FB-SDE-J 6.04 9.33
FB-SDE-A 8.08 8.66
EgNOT 3.04 7.08
DSBM 8.83 6.0
NOT 5.42 3.66
ENOT 6.92 3.58
CFM-SB 5.54 3.42
MLE-SB 3.33 3.25
GENOT-L 1.88 2.83
Table 1: Average ranks of each method across experiments, on estimating the ground-truth EOT cou-
pling π⋆
εbetween each pair of measures µ, ν, in dimension d∈ {2,16,64,128}andε∈ {0.1,1,10}
of Gushchin et al. [30]’s benchmark. As proposed by the authors of the benchmark, we measure
performances with both BW2
2-UVP (37) andcBW2
2-UVP (39) metrics. See Table 2 and Table 3 for
detailed results.
Model ϵ= 0.1 ϵ= 1 ϵ= 10
2 16 64 128 2 16 64 128 2 16 64 128
LSOT - (11.5) - (11.5) - (11.5) - (11.5) - (12) - (12) - (12) - (12) - (10.5) - (10.5) - (10.5) - (10.5)
SCONES - (11.5) - (11.5) - (11.5) - (11.5) 1.06 (10) 4.24 (10) 6.67 (9) 11.54 (9) 1.11 (7) 2.98 (6) 1.33 (3) 7.89 (4)
NOT 0.016 (3) 0.63 (6) 1.53 (6) 2.62 (6) 0.08 (3) 1.13 (9) 1.62 (8) 2.62 (7) 0.225 (5) 2.603 (5) 1.872 (4) 6.12 (3)
EgNOT 0.09 (6) 0.31 (5) 0.88 (4) 0.22 (1) 0.46 (7) 0.3 (4) 0.85 (4) 0.12 (1) 0.077 (1) 0.02 (1.5) 0.15 (1) 0.23 (1)
ENOT 0.2 (7) 2.9 (9) 1.8 (7) 1.4 (4) 0.22 (6) 0.4 (6) 7.8 (10) 29 (10) 1.2 (8) 2 (4) 18.9 (6) 28 (6)
MLE-SB 0.01 (2) 0.14 (3) 0.97 (5) 2.08 (5) 0.005 (1) 0.09 (2) 0.56 (2) 1.46 (5) 0.01 (2) 1.02 (3) 6.65 (5) 23.4 (5)
DiffSB 2.88 (9) 2.81 (8) 153.22 (10) 232.67 (10) 0.87 (9) 0.99 (8) 1.12 (5) 1.56 (6) - (10.5) - (10.5) - (10.5) - (10.5)
FB-SDE-A 2.37 (8) 2.55 (7) 68.19 (9) 27.11 (9) 0.6 (8) 0.63 (7) 0.65 (3) 0.71 (4) - (10.5) - (10.5) - (10.5) - (10.5)
FB-SDE-J 0.03 (4.5) 0.05 (2) 0.25 (2) 2.96 (7) 0.07 (2) 0.13 (3) 1.52 (7) 0.48 (3) - (10.5) - (10.5) - (10.5) - (10.5)
CFM-SB 0.03 (4.5) 0.30 (4) 0.55 (3) 0.81 (3) 0.09 (5) 0.36 (5) 1.24 (6) 2.76 (8) 0.31 (6) 89.84 (8) 37.50 (7) 97.44 (7)
DSBM 13.85 (10) 34.22 (10) 16.54 (8) 20.90 (8) 2.12 (11) 11.38 (11) 19.27 (11) 39.19 (11) 0.07 (3) 34.75 (7) 227.80 (8) 632.58 (8)
GENOT 0.003 (1) 0.015 (1) 0.13 (1) 0.33 (2) 0.085 (4) 0.06 (1) 0.08 (1) 0.18 (2) 0.10 (4) 0.02 (1.5) 0.30 (2) 0.47 (2)
Table 2: BW2
2-UVP (equation (37)) between π2andp2♯πθbetween the distributions defined in
Gushchin et al. [30], with numbers in parantheses denoting the rank within the experimental configu-
ration defined by the dimension of the space and the entropy regularization parameter ε.
Figure 6: cBW2
2-UVP (37) between π⋆
εandπθbetween the distributions defined in Gushchin et al.
[30] depending on the batch size. The dotted line corresponds to batch size 2048 and hence displays
the values reported in Tab. 3.
[31], neural OT solvers are of particular interest and deterministic Monge map estimators have been
successfully applied to millions of cells [32].
Obtaining samples from the conditional distribution allows for an assessment of the uncertainty of
the trajectory of a cell. We use the metric VarY∼πθ(·|x)[cos-sim(Y,EY∼πθ(·|x)[Y])]suggested in
Gayoso et al. [25] for generative RNA velocity models (appendix C.1). Therefore, we use 30 samples
from the conditional distribution.
27Model ϵ= 0.1 ϵ= 1 ϵ= 10
2 16 64 128 2 16 64 128 2 16 64 128
LSOT - (11.5) - (11.5) (11.5) - (11.5) - (12) - (12) - (12) - (12) - (10.5) - (10.5) - (10.5) - (10.5)
SCONES - (11.5) - (11.5) (11.5) - (11.5) 34.88 (10) 71.34 (10) 59.12 (9) 136.44 (9) 32.9 (8) 50.84 (7) 60.44 (7) 52.11 (6)
NOT 1.94 (3) 13.67 (3) 11.74 (2) 11.4 (2) 4.77 (3) 23.27 (6) 41.75 (7) 26.56 (4) 2.86 (3) 4.57 (5) 3.41 (3) 6.56 (3)
EgNOT 129.8 (10) 75.2 (9) 60.4 (7) 43.2 (7) 80.4 (11) 74.4 (11) 63.8 (10) 53.2 (6) 4.14 (6) 2.64 (4) 2.36 (2) 1.31 (2)
ENOT 3.64 (4) 22 (5) 13.6 (3) 12.6 (3) 1.04 (1) 9.4 (4) 21.6 (4) 48 (5) 1.4 (1) 2.4 (3) 19.6 (5) 30 (5)
MLE-SB 4.57 (5) 16.12 (4) 16.1 (5) 17.81 (4) 4.13 (2) 9.08 (2) 18.05 (3) 15.226 (3) 1.61 (2) 1.27 (1) 3.9 (4) 12.9 (4)
DiffSB 73.54 (8) 59.7 (8) 1386.4 (10) 1683.6 (10) 33.76 (9) 70.86 (9) 53.42 (8) 156.46 (10) - (10.5) - (10.5) - (10.5) - (10.5)
FB-SDE-A 86.4 (9) 53.2 (7) 1156.82 (9) 1566.44 (9) 30.62 (8) 63.48 (7) 34.84 (5) 131.72 (8) - (10.5) - (10.5) - (10.5) - (10.5)
FB-SDE-J 51.34 (7) 89.16 (10) 119.32 (8) 173.96 (8) 29.34 (7) 69.2 (8) 155.14 (11) 177.52 (11) - (10.5) - (10.5) - (10.5) - (10.5)
CFM-SB 0.45 (1) 4.09 (2) 4.94 (1) 7.17 (1) 6.31 (5) 5.99 (1) 4.76 (1) 5.26 (1) 10.18 (7) 90.85 (8) 43.45 (6) 103.59 (7)
DSBM 28.84 (6) 49.33 (6) 37.39 (6) 41.52 (6) 5.78 (4) 17.12 (5) 36.81 (6) 60.51 (7) 2.95 (4) 35.89 (6) 229.96 (8) 642.51 (8)
Independent 166.0 152.0 126.0 110.0 86.0 80.0 72.0 60.0 4.2 2.52 2.26 2.4
GENOT 0.46 (2) 0.91 (1) 14.48 (4) 28.52 (5) 7.43 (6) 9.10 (3) 8.61 (2) 6.76 (2) 3.24 (5) 1.97 (2) 0.91 (1) 1.03 (1)
Table 3: cBW2
2-UVP (37) between π⋆
εandπθbetween the distributions defined in Gushchin et al.
[30], with numbers in parantheses denoting the rank within the experimental configuration defined by
the dimension of the space and the entropy regularization parameter ε.
Figure 7: Evaluation of the influence of the number of data points sampled from the conditional
distribution in each step, and optimally coupling noise and samples from the target distribution, see
Alg. 2. k= 1corresponds to the model performances reported in table 3.
Fig. 8 visualizes the pancreatic endocrinogenesis dataset (D.2) according to source (embryonic day
14.5) and target distribution (15.5) as well as according to cell type. To quantitatively confirm the
visual results from Fig. 2, we aggregate the uncertainty to cell type level. Indeed, we observe a higher
uncertainty in cells which have not committed to a certain lineage (Ngn3 low, Ngn3 High early, Ngn3
High late), while more mature cell types indicate lower variances.
Figure 8: UMAP of the mouse pancreas development dataset colored by sample (left) and cell type
(middle). We transport samples from embryonic day 14.5 to embryonic day 15.5. Uncertainty score
as displayed in Fig 2 aggregated to cell type level.
A cell is expected to have an uncertain trajectory when it can still develop into different cell lineages.
In contrast, cells are expected to have a less uncertain trajectory when their descending population is
homogeneous or they belong to a terminal cell state, and hence have committed to a certain lineage.
GENOT-L produces meaningful uncertainty assessments as can be seen from Fig. 2 and Fig. 8.
Indeed, the Ngn3 low EP population and the Ngn3 high EP populations have a higher uncertainty
than later cell types. The uncertainty is particularly high for Ngn3 high EP late cells, a state where
cells commit to a fate towards alpha, beta, delta, or epsilon cells [2].
We now focus on the conditional distributions of cells from the Ngn3 low population, i.e. the least
mature cell population in the dataset. Fig. 9 shows more examples of selecting one Ngn3 low cell
and generating 30 samples from its conditional distribution as displayed in Fig 2. It is important to
28Figure 9: Left: Samples from the Ngn3 Low EP population in the leftmost column, and next to it 30
samples from their conditional distribution samples from GENOT with the geodesic cost (middle)
and the squared Euclidean cost (right). Right : Proportions of alpha, beta, delta, and epsilon cells
derived from the Ngn3 Low population (top) and the Ngn3 High population (bottom). Mean and
standard deviation across three different runs are reported.
note that the UMAP has to be recomputed to include the generated samples and hence the UMAPs
change slightly. The three instances in Fig.9 support the hypothesis that the conditional distribution
follows the data manifold when using the geodesic cost (here we assume that the UMAP represents
the manifold well). In contrast, choosing the squared Euclidean distance results in samples of the
conditional distribution being either very close on the UMAP or very far away, while the intermediate
stage (i.e. Ngn3 High late) is skipped. Biologically, this result is not plausible as all cells are known
to evolve from Ngn3 Low EP cells to Ngn3 High EP cells, before they finally commit to a lineage
(towards alpha, beta, delta, or epsilon cells). It is important to note that both GENOT-L models are
trained with the same entropy regularization parameter ε= 0.01.
Based on the examples, we hence hypothesize that when using the squared Euclidean cost, generated
cells in the terminal cell states (alpha, beta, delta, epsilon) are much more likely to be derived from
Ngn3 low EP cells than Ngn3 High EP cells (in the following we focus on Ngn3 High Late cells and
neglect Ngn3 High EP early cells as their number is very low, see Fig.8). As outlined above, this is
biologically not plausible. The impression conveyed by the UMAP plots are confirmed numerically
on the right hand side of Fig. 9. For each generated cell, we compute its nearest neighbor in the target
distribution, and this way assign it a label (cell type), see App. C.2. We then obtain a cell type to cell
type transition matrix, which we column-normalise (with columns containing the cell types of the
generated cells), such that for each cell type, we obtain the distribution of ancestor cell types. Figure
9 shows that for the Euclidean cost, around 30% of all delta cells are derived from Ngn3 Low EP
cells, while only 5%are derived from Ngn3 High EP cells. In contrast, the proportion of progenitors
in Ngn3 low EP cells and Ngn3 high EP cells when using the geodesic cost is much more comparable.
Similar results can be observed for alpha, beta, and epsilon cells.
1d simulated data Figure 10 visualizes the influence of τon a simple setting between mixtures
of Gaussians. While τ= 1.0corresponds to the fully balanced case, setting τ= 0.97results in a
complete discardment of one mode in the target distribution. The ground truth is computed with a
discrete entropy-regularized OT solver [ 14], with kernel density estimation to create the plot. This
figure is meant to visualize the task, while in the following, we assess the results quantitatively.
Benchmark of U-GENOT-L between Gaussian distributions Therefore, we leverage the closed-
form solutions of the unbalanced EOT coupling between Gaussian distributions for the squared
Euclidean cost [ 36]. We follow the data generation process described by Janati et al. [36], and
evaluate the results for different entropy-regularisation parameters εand different unbalancedness
parameters λ=ετ
1−τ, and across different dimensions.
29Figure 10: Unbalanced entropic neural optimal transport plan with ε= 0.05and varying unbalanced-
ness parameter τ=τ1=τ2.
Figure 11: Benchmark of U-GENOT-L on the task of learning an unbalanced entropic OT plan
between Gaussian distributions across different dimensions, entropy regularisation parameters ε,
and unbalancedness parameters λ, following Janati et al. [36]. The dotted line represents the outer
coupling, while SUOT denotes the method proposed in Yang and Uhler [93].
Yang and Uhler [93] propose a method (scalable unbalanced optimal transport, SUOT) to learn
unbalanced EOT plans, but their implementation only supports unbalanced deterministic Monge
maps. We visualize the results in Fig.11. Besides the simple switch to learning unbalanced EOT
plans, U-GENOT-L was run with the same setup as in the balanced linear EOT benchmark.
30Perturbation modeling with GENOT-L and U-GENOT-L For each drug, we project the single-
cell RNA-seq readout of the unperturbed and perturbed cells to a 50-dimensional PCA embedding.
Subsequently, we split the data randomly to obtain a train and test set with a ratio of 60%/40%. This
preprocessing step holds for both the calibration score experiments and the experiments conducted
with U-GENOT-L to assess the influence of unbalancedness to the accuracy score.
The uncertainty score for the calibration study is computed based on 30 samples from the conditional
distribution, see appendix C.2.
Figure 12: Calibration score for the predictions of GENOT-L for modeling cellular responses to 163
cancer drugs.
In Figure 13 and Figure 14, we visualize the influence of unbalancedness for perturbation modeling
with Dacinostat and Tanespimycin, respectively. These experiments were conducted on the full
dataset for visualization reasons. While the fitting property seems to be little affected by incorporating
unbalancedness (top rows), the cell type clusters are better separated for U-GENOT-L transport plans
than for GENOT-L transport plans.
Figure 13: Visual assessment of the influence of unbalancedness in modeling cellular predictions
to the cancer drug Dacinostat. In the left column, the source and target distribution are jointly
plotted with cells colored by whether they belong to the source (unperturbed) or the target (perturbed)
distribution (top), and which cell type they belong to (bottom). In the center column, we plot a UMAP
embedding of target and predicted target distribution. The top plot colors cells according to whether
a cell belongs to the target distribution or the predicted target distribution. The bottom plot is colored
by cell type. The cell type of the predicted target distribution is the cell type of the pre-image of the
predicted cell. The right column visualizes the same results, but this time obtained from U-GENOT-L
with unbalancedness parameters τ=τ1=τ2= 0.8.
31Figure 14: Visual assessment of the influence of unbalancedness in modeling cellular predictions
to the cancer drug Tanespimycin. In the left column, the source and target distribution are jointly
plotted with cells colored by whether they belong to the source (unperturbed) or the target (perturbed)
distribution (top), and which cell type they belong to (bottom). In the center column, we plot a UMAP
embedding of target and predicted target distribution. The top plot colors cells according to whether
a cell belongs to the target distribution or the predicted target distribution. The bottom plot is colored
by cell type. The cell type of the predicted target distribution is the cell type of the pre-image of the
predicted cell. The right column visualizes the same results, but this time obtained from U-GENOT-L
with unbalancedness parameters τ=τ1=τ2= 0.9.
E.2 (U)-GENOT-Q & (U)-GENOT-F
GENOT-Q for mapping a Swiss role to a spiral Fig. 15 visualizes the dependence of the con-
ditional distribution on the entropy regularization parameter εwith the same setup as in Figure 3.
In particular, we display what happens when we consider the outer coupling. Fig. 16 visualizes
the density in the target space, evolving from a 2-dimensional Gaussian distribution at t= 0 to
conditional distributions at t= 1. Analogously to Fig.15, we visualize the influence of the entropy
regularization parameter ε.
Figure 15: Samples from conditional distributions πθ(·|x)for GENOT-Q models trained with different
entropy regularization parameters ε. The setup is the same as in Figure 3, in effect we transport
a three-dimensional Swiss roll to a two-dimensional spiral, which is colored in blue (with high
transparency). The right plot shows the result when choosing the outer coupling as opposed to
an EOT coupling. The source distribution as well as the data points which are conditioned on are
visualized in Figure 3.
How to handle non-uniqueness of quadratic EOT couplings In the following, we show how
to empirically overcome the non-uniqueness of solutions to (QEOT) . The left hand side of Fig. 17
visualizes the solutions to an entropic GW coupling between two Gaussian distributions learnt by
GENOT-Q without any modification. It becomes evident that the learned solution is not close to a
valid solution, but rather resembles a mixture of solutions.
32Figure 16: Evolution of the density from t= 0 corresponding to the latent distribution (i.e. mul-
tivariate standard Gaussian distribution) to t= 1 corresponding to the density of the conditional
distribution πθ(y|Xi). The setup is the same as in Figure 3, in effect we transport a three-dimensional
Swiss roll to a two- dimensional spiral The left panel displays the densities of oneconditional
distribution, while the right panel visualizes a mixture of densities over time. The top part of the
figure corresponds to GENOT-Q models with entropy regularization parameter ε= 0.005, while
the middle ones corresponds to ε= 0.005. The bottom ones correspond to the outer coupling. The
markers on the 3-dimensional plot on the very top correspond to data points in the source distribution.
We discuss three ways to overcome the limitations of non-uniqueness of quadratic OT couplings:
•Incorporation of a fused term: Whenever the data allows, using a fused term empirically
helps to stabilize the solution.
•Changing the cost function: The set of solutions to (QEOT) depends on the cost function.
Thus, finding a cost with a small set of solutions overcomes the limitation to a certain extent.
Empirically, the geodesic cost helps to do so for single-cell data.
•Initialisation of the discrete solver: We initialize the discrete GW solver at iteration i+ 1
using the solution to the linear EOT problem between p2ˆπi
θandν, with ˆπi
θdenoting the
learnt coupling at step i.
Visually, the initialisation scheme helps for learning the GW-EOT coupling between Gaussian
distributions (17).
We now quantify to what extent we can reduce the diversity of the solutions by considering the
variance of the conditional distribution of a single data point. Therefore, we consider two datasets:
1.30 dimensional Gaussian distributions (20 dimensions in the quadratic term and 10 dimen-
sions in the additional fused term): For both the source ( µ) and the target ( ν) distribution we
33Figure 17: Left: Learnt transport plan of GENOT-Q without initialization between two one-
dimensional Gaussian distributions. Right: Learnt transport plan of GENOT-Q with initialization.
The initialization scheme prevents GENOT from learning mixtures of valid transport plans.
sample mean vectors from U([−1,1])and construct the covariance matrices by sampling
each entry of their square roots from U([0,3])
2.30 dimensional single-cell data (as in 4): 20-dimensional PCA of the normalized ATAC
data, 20-dimensional PCA projection of the gene expression data, and 10-dimensional PCA
of the V AE embedding (shared space).
To assess the stability of the solution of discrete EOT, we fix one sample from the source distribution,
and compute the variance of ˆπ(·|X0[10 :]) , i.e. of the incomparable space only, which is obtained
from a discrete EOT solver with different samples in source and target. We do this for ε= 0.01and
ε= 0.001with the squared Euclidean cost.
We consider the following couplings:
1. outer coupling, supposed to serve as a baseline.
2.Gromov-Wasserstein (GW): We use ˜Xand˜Y, i.e., we use the last 20 dimensions of both the
source and the target distribution.
3. Fused Gromov-Wasserstein (FGW): We use Ω×˜XandΩ×˜Ywithα=1
11.
4.Gromov-Wasserstein with geodesic cost (Geodesic): We use ˜Xand˜Ywith the geodesic
cost.
5. Gromov-Wasserstein with initialization as described above.
Fig.18 shows that both the fused term and the initialization scheme empirically help to preserve the
variance of the conditional distributions. Moreover, the geodesic cost helps for small εto reduce the
conditional variance, suggesting a less diverse set of solutions to (QEOT).
GENOT-Q und U-GENOT-Q for learning EOT plans between Gaussians To quantitatively
assess the performance of GENOT-Q, we evaluate its performance by learning quadratic EOT
couplings between Gaussian distributions [ 43]. We follow the authors’ data generation process and
computations for the closed-form solution and the computation of the discrete GW solver. Note that
we can only evaluate the cost of the learnt transport plan as the solution of the EOT plan is not unique.
Thus, we use the initialisation scheme suggested above. The discrete solution calculated based on the
discrete coupling (1000 samples), while we report results from GENOT-GW on both training data
(30k samples) and test data (5k samples). GENOT-GW is trained with batch size 1024 and for 5k
iterations, with the same network architecture as used for the benchmark for balanced, linear EOT for
the squared Euclidean cost (§ F.1). As a baseline, we report the cost induced by the outer coupling.
To keep the results on a similar scale across different dimensions, we report the L1-distance between
the predicted cost and the true cost, divided by the true cost.
We continue with the evaluation in the unbalanced setting in Fig. 20. Here, we compare only the
costs induced by the distortion, i.e. not the one induced by the KL penalisation, as for the latter one
requires access to the densities. As demonstrated, GENOT can estimate the densities, but it comes at
the cost of an estimation error. As the purpose of this benchmark is to show the accuracy of the learnt
34Figure 18: Variance of conditional distributions of different couplings for ε= 0.001(left) and
ε= 0.0001 (right) for both Gaussian data (top) and single-cell data (HSCP also considered in e.g.
Fig. 4. Error bars denote standard error across dimensions of the 20-dimensional space.) (bottom)
Figure 19: Learning Gromov-Wasserstein entropic optimal transport couplings between Gaussian
distributions where the ground truth plan is known for [ 43]. The quality of the learnt coupling is
assessed with the induced cost.
couplings (and not the estimation of the density), we compare based on the distortion cost. As done
by the authors in Le et al. [43], we set the total mass of both distributions to 1.0.
Modality translation with GENOT-Q For all experiments, we perform a random 60/40 split for
training and test data. All results are reported on the test dataset. The cost matrices of all models
35Figure 20: Learning unbalanced Gromov-Wasserstein entropic optimal transport couplings between
Gaussian distributions where the ground truth plan is known for [ 43]. The quality of the learnt
coupling is assessed with the induced cost.
were scaled by its mean and the entropy regularization parameter εwas set to 0.0001 . Moreover, the
models were trained for 5,000 iterations.
Modality translation with GENOT-F For all experiments, we perform a random 60-40 split for
training and test data. All results are reported on the test dataset. The cost matrices of all models
were scaled by its mean and the entropy regularization parameter εwas set to 0.001. Moreover, the
models were trained for 20,000 iterations.
Figure 21 reports results of the GENOT-F model with interpolation parameters α= 0.3(left) and
α= 0.7(right). While the Sinkhorn divergences are not comparable with results of the GENOT-Q
model due to the respective target distributions living in different spaces, we can compare GENOT-Q
with GENOT-F with respect to the FOSCTTM score. Figure 21 shows that GENOT-F strikingly
outperforms GENOT-Q, hence the incorporation of the fused term is crucial for a good performance.
At the same time, it is important to mention that the GW terms add valuable information to the
problem setting, which can be derived from the results for GENOT-F with α= 0.3. Here, the higher
influence of the fused term causes the model to perform overall worse.
Moreover, we can visualize the optimality and fitting term in a UMAP embedding [ 53]. To demon-
strate the robustness of our model, we train a GENOT-F model with ε= 0.01,α= 0.5and the
Euclidean distance on 60% of the dataset (38 dimensions for the ATAC LSI embedding, 50 dimen-
sions for the RNA PCA embedding, and 28 dimensions for the V AE embedding in the fused term)
and evaluate the learnt transport plan visually. Figure 22 shows joint UMAP embeddings of predicted
target and target distributions, the full legend of cell types can be found in Figure 25. Qualitatively,
a good mix between data points of the predicted target and the target distribution suggests a good
fitting term. Optimality of the mapping can be visually assessed by considering to what extent cell
types are mixed (low optimality) or separated from other cluster (high optimality).
We observed that taking the conditional mean improves results on the FOSCTTM score, but can
impair the fitting property. Indeed, the mixing rate between data points belonging to the target and
data points belonging to the predicted target seems to be slightly worse when considered in the joint
embedding as well as when considering only the fused space and only considering the quadratic
space (22) .
Modality translation with U-GENOT-F To simulate a setting where there is not a match for
certain cells in the target space (RNA), we remove the cells labelled as Proerythroblasts, Erythroblasts,
36Figure 21: Mean and 95% confidence interval (across three runs) of the FOSCTTM score (top)
and the Sinkhorn divergence (bottom) of GENOT-F and discrete FGW with linear regression for
out-of-sample estimation. Experiments are categorized by the numbers d1/d2/d3, where d1is the
dimension of the space corresponding to the GW of the source distribution, d2is the dimension of the
space corresponding to the GW of the target distribution, and d3is the dimension of the shared space.
Results are reported for the interpolation parameter α= 0.3(left half) and α= 0.7(right half).
Figure 22: UMAP embedding of target and predicted target based on subspaces of the target domain.
Top left: full target space. Top right: incomparable space only. Bottom left: full target space (with
predicted target computed by the mean of the conditional distributions). Bottom right: share space
only. Cells are colored based on whether they belong to the target distribution or the predicted target
distribution in the left plot of each subplot. Cells are colored based on their cell type in the right plot
of each subplot. For cells which belong to the predicted target distribution, the cell type is defined as
the cell type of the preimage. Shown are results on the test data set, corresponding to 40% of the full
dataset.
and Normoblasts as these cells form a lineage, developing into mature Reticulocytes (not present in
the dataset). Thus, they are similar in their cellular profile while being clearly distinguishable from
the remaining cells. Note that this simulates an extreme setting of class imbalances, as these cells
make up for more than 20% of the dataset.
While we keep the right marginals constant, as we have a true match for each cell in the target
distribution, we introduce unbalancedness in the source marginals. It is important to note that the
influence of the unbalancedness parameters are affected by the number of samples, as well as the
entropy regularization parameter ϵ. To demonstrate the robustness of GENOT-F with respect to
hyperparameters, we still choose α= 0.7, but this time set ε= 5·10−3. We use 50-dimensional
PCA-space for the Gromov term in the RNA space, 38-dimensional LSI-space for the Gromov term
in the ATAC space, and a 30-dimensional V AE-embedding for the shared space.
37<latexit sha1_base64="RHopsy7jMi5jawYMjCy+yuXUr1I=">AAACBHicbVC7TgJBFJ3FF+ILtaSZSEysyK4xaKxAGkuMvBIgZHa4wITZR2buGsmGwsZfsbHQGFs/ws6/cVgoFD3JJCfn3Mfc44ZSaLTtLyu1srq2vpHezGxt7+zuZfcPGjqIFIc6D2SgWi7TIIUPdRQooRUqYJ4roemOKzO/eQdKi8Cv4SSErseGvhgIztBIvWyug3CPyotvk4mXtFwrV6gOGYdpL5u3C3YC+pc4C5InC1R72c9OP+CRBz5yybRuO3aI3ZgpFFzCNNOJNJjJYzaEtqE+80B34+SIKT02Sp8OAmWejzRRf3bEzNN64rmm0mM40sveTPzPa0c4uOjGwg8jBJ/PFw0iSTGgs0RoXyjgKCeGMK6E+SvlI6YYR5NbxoTgLJ/8lzROC06xULw5y5euFnGkSY4ckRPikHNSItekSuqEkwfyRF7Iq/VoPVtv1vu8NGUteg7JL1gf3ywzl8w=</latexit>Source: ATAC space<latexit sha1_base64="DO1Vx+nZ8bANq9wmzXkXbIk3WTU=">AAACA3icbVDJSgNBEO2JW4zbqDe9NAbBU5gRieIp6sWTRMkGSQg9nUrSpGehu0YMQ8CLv+LFgyJe/Qlv/o2d5aCJDwoe71V1Vz0vkkKj43xbqYXFpeWV9GpmbX1jc8ve3qnoMFYcyjyUoap5TIMUAZRRoIRapID5noSq178a+dV7UFqEQQkHETR91g1ER3CGRmrZew2EB1R+UmKqC3hO724uqI4Yh2HLzjo5Zww6T9wpyZIpii37q9EOeexDgFwyreuuE2EzYQoFlzDMNGIN5uU+60Ld0ID5oJvJ+IYhPTRKm3ZCZSpAOlZ/TyTM13rge6bTZ9jTs95I/M+rx9g5ayYiiGKEgE8+6sSSYkhHgdC2UMBRDgxhXAmzK+U9phhHE1vGhODOnjxPKsc5N5/L355kC5fTONJknxyQI+KSU1Ig16RIyoSTR/JMXsmb9WS9WO/Wx6Q1ZU1ndskfWJ8/mZeXgA==</latexit>Target: RNA spaceFigure 23: Top: A single Erythroblast cell is highlighted while all other cells in the source distribution
are depicted with increased transparency. Bottom: Target distribution colored by cell type (left) and
colored by the conditional density (conditioned on the highlighted cell above) evaluated on all cells
in the target distribution. All cells with a relatively high density belong to the Eythroblast cluster,
hence the mapping learnt by GENOT-F is meaningful.
model ( τ1) Normoblast Erythroblast Proerythroblast other FOSCTTM
Discrete UFGW (0.8) 0.788 0.820 0.842 0.945 0.258
U-GENOT-F (0.8) 0.622 0.733 0.894 1.077 0.131
Discrete UFGW (0.3) 0.591 0.586 0.734 0.761 0.311
U-GENOT-F (0.3) 0.295 0.430 0.554 1.186 0.162
Table 4: Mean value of the rescaling function per cluster for U-GENOT-F and discrete unbalanced
FGW together with the FOSCTTM scores across three runs. Tab. 5 reports the variances for the
GENOT-Q models.
The computation of the growth rates for the discrete setting is described in appendix F.2. We perform
a random 60-40 split to divide the data into training and test set. The FOSCTTM score only considers
those cells which have a true match, i.e. cells in the source distribution belonging to the Normoblast,
Erythroblast, and Proerythroblast cell types are not taken into account as their true match was removed
from the target distribution.
We assess the performance w.r.t. the FOSCTTM score to ensure that the model still learns meaningful
results, and consider the average reweighting function ˆηper cell type (appendix E.2). We consider
two values ( τ1= 0.8andτ1= 0.3) of the left unbalancedness parameter, while τ2= 1.0as for
every cell in the target distribution there exists the true match in the source distribution. Tab. 4 shows
that U-GENOT-F learns more meaningful reweighting functions than discrete UFGW as the average
rescaling function on the left-out cell types is closer to 0, while the mean value of the rescaling
function on all remaining cell types ("other") is closer to 1. At the same time, U-GENOT-F yields
lower FOSCTMM scores and hence learns more optimal couplings.
Tab. 5 shows the variance across three runs, demonstrating the stability of both the learnt rescaling
function as well as the performance with respect to the FOSCTTM score.
38model ( τ1) Normoblast Erythroblast Proerythroblast other FOSCTTM
U-GENOT-F (0.8) 3·10−62·10−51·10−45·10−53·10−5
U-GENOT-F (0.3) 2·10−69·10−65·10−48·10−49·10−5
Table 5: Comparison of reweighting functions learnt by U-GENOT-F and discrete unbalanced FGW.
Fig. 24 shows the mean and the 95% confidence interval of the learnt growth rates per cell type. First,
it is interesting to see that Normoblasts have the lowest mean of rescaling function evaluations (for
both discrete UFGW and U-GENOT-F), which is due to them being most mature among the left out
cell types and hence being furthest away in gene expression space / ATAC space from the common
origin of all cells, the HSC cluster. Moreover, it is obvious that the 95% confidence interval of the
reweighting function (across cells in one cell type) is much smaller for U-GENOT-F than for discrete
UFGW. This is desirable as cells within one cell type are very similar in their ATAC profile.
Figure 24: Comparison of learnt growth rates of discrete UFGW and U-GENOT-F aggregated to cell
type level for unbalancedness parameters τ1= 0.8, τ2= 1(left) and τ1= 0.3, τ2= 1(right).
Figure 25: Complete legend of cell types for Fig. 4, Fig. 22 and Fig.23.
39F Competing methods
F.1 EOT benchmark in the balanced, linear case
As results for competing methods were taken from Gushchin et al. [30], we refer to the original
publication for details on the competing methods. For SB-CFM we follow the setup in the au-
thors’ tutorial in https://github.com/atong01/conditional-flow-matching/blob/main/
examples/single_cell/single-cell_example.ipynb .For DSBM, we follow the setup in
https://github.com/yuyang-shi/dsbm-pytorch/blob/main/DSBM-Gaussian.py , but in-
crease the number of inner iterations from 10 to 50, the number of outer iterations from 40 to
80, and the btach size from 128 to 2048 to account for higher dimensionality.
F.2 Regression for out-of-sample data points
Out-of-sample prediction for GW has been considered in [ 1]. Yet, their methods rely on an orthogonal
projection, which only works if both the sample size and the feature dimensions are the same in both
spaces. Hence, we rely on a barycentric projection for in-sample data points. For out-of-sample
data points we project a data point onto the training set and apply the barycentric projection to the
linear combination of points in the in-sample distribution. Let X∈Rn×dbe the matrix containing n
in-sample data points.
Then, for a data point in the source distribution x∈Rd, let
ˆβx= arg min
β∈Rn∥ˆx−XTβ∥2
2 (40)
where the sum is taken over the nin-sample data points. Moreover, let pi=Pm
j=1Πij. Then, the
barycentric projection of a point in the source distribution is given as
ˆy=nX
i=1ˆβi
pimX
j=1Πijyj∈ Y. (41)
Similarly, we can apply this procedure to estimate rescaling factors in the unbalanced setting. To
ensure non-negativity of the rescaling function, we perform regression with non-negative weights:
ˆα= arg min
α∈Rn
≥0∥ˆx−XTα∥2
2 (42)
To estimate the rescaling function for a data point ˆx, the estimated left rescaling function is given as
ˆη=nX
i=1ˆαiηi∈R (43)
where {ηi}n
i=1is the set of reweighting function evaluations of in-sample data points.
40G Implementation
The GENOT framework is implemented in JAX[6]. We use the discrete OT solvers provided by
OTT-JAX [14].
G.1 Parameterization of the vector field
The vector field is parameterized with a feed-forward neural network which takes as input the time
(which is cyclically encoded with frequency 128), the condition (i.e. the samples from the source
distribution) and the latent noise. Each of these input vectors are independently embedded by one
block of layers before the embeddings are concatenated and applied to another block of layers,
followed by one output layer. If not stated otherwise, one block of layers consists of 8 layers of width
256 with siluactivation functions.
G.2 Parameterization of the rescaling functions
Rescaling functions are parameterized as feed-forward neural networks with 5 layers of width 128,
followed by a final softplus activation function to ensure non-negativity.
G.3 Training details
We report default values for the different parameters of the GENOT Alg.1. If not stated otherwise in
the corresponding experiments section, we use these parameters. As in Alg.1, parameters related to
U-GENOT are provided in teal.
•Batch size :n= 1024 .
•Entropic regularization strength :ε= 10−2. By default, we do not scale the cost matrices
passed to discrete OT solvers.
•Unbalancedness parameter :τ= (1,1). This means that by default, we impose the hard
marginal constraints.
•Number of training iterations :Titer= 10,000.
•Optimizer :AdamW with learning rate lr= 10−4, and weight decay λ= 10−10. This is used
for both, the vector field vt,θ, and the re-weighting functions ηθ, ξθ.
When using the graph distance, we construct a k-nearest neighbor graph with batch _size number of
edges. Then we apply a negative exponential kernel to obtain connectivties from the distances in the
knn-graph. For the approximation of the heat kernel, we use the default parameters provided by the
implementation in OTT-JAX [14].
G.4 Code availability
The GENOT model along with the code to reproduce the experiments can be found at https:
//github.com/MUCDK/genot , while a more modular implementation can be found in OTT-JAX
[14]. Additionally, we implement applications in moscot [39].
H Impact statement
This work introduces novel approaches in neural optimal transport and presents applications in
single-cell biology. Leveraging single-cell genomics data holds promise for advancing personalized
medicine but requires cautious handling due to its potential inclusion of sensitive information.
Moreover, as neural optimal transport techniques find applicability across diverse domains, the
societal ramifications of this research extend beyond single-cell genomics. Our intention is to provide
access to the GENOT code, enabling its utilization by both general machine learning practitioners
and, in a subsequent release, ensuring its accessibility to advance and accelerate research specifically
tailored for single-cell biologists.
41NeurIPS Paper Checklist
1.Claims
Question: Do the main claims made in the abstract and introduction accurately reflect the
paper’s contributions and scope?
Answer: [Yes]
Justification: Everything we claim we do in the abstract and introduction we actually do in
the following.
Guidelines:
•The answer NA means that the abstract and introduction do not include the claims
made in the paper.
•The abstract and/or introduction should clearly state the claims made, including the
contributions made in the paper and important assumptions and limitations. A No or
NA answer to this question will not be perceived well by the reviewers.
•The claims made should match theoretical and experimental results, and reflect how
much the results can be expected to generalize to other settings.
•It is fine to include aspirational goals as motivation as long as it is clear that these goals
are not attained by the paper.
2.Limitations
Question: Does the paper discuss the limitations of the work performed by the authors?
Answer: [Yes]
Justification: We discuss limitations in § A.
Guidelines:
•The answer NA means that the paper has no limitation while the answer No means that
the paper has limitations, but those are not discussed in the paper.
• The authors are encouraged to create a separate "Limitations" section in their paper.
•The paper should point out any strong assumptions and how robust the results are to
violations of these assumptions (e.g., independence assumptions, noiseless settings,
model well-specification, asymptotic approximations only holding locally). The authors
should reflect on how these assumptions might be violated in practice and what the
implications would be.
•The authors should reflect on the scope of the claims made, e.g., if the approach was
only tested on a few datasets or with a few runs. In general, empirical results often
depend on implicit assumptions, which should be articulated.
•The authors should reflect on the factors that influence the performance of the approach.
For example, a facial recognition algorithm may perform poorly when image resolution
is low or images are taken in low lighting. Or a speech-to-text system might not be
used reliably to provide closed captions for online lectures because it fails to handle
technical jargon.
•The authors should discuss the computational efficiency of the proposed algorithms
and how they scale with dataset size.
•If applicable, the authors should discuss possible limitations of their approach to
address problems of privacy and fairness.
•While the authors might fear that complete honesty about limitations might be used by
reviewers as grounds for rejection, a worse outcome might be that reviewers discover
limitations that aren’t acknowledged in the paper. The authors should use their best
judgment and recognize that individual actions in favor of transparency play an impor-
tant role in developing norms that preserve the integrity of the community. Reviewers
will be specifically instructed to not penalize honesty concerning limitations.
3.Theory Assumptions and Proofs
Question: For each theoretical result, does the paper provide the full set of assumptions and
a complete (and correct) proof?
Answer: [Yes]
42Justification: We provide proofs in § B, which we refer to from the main paper.
Guidelines:
• The answer NA means that the paper does not include theoretical results.
•All the theorems, formulas, and proofs in the paper should be numbered and cross-
referenced.
•All assumptions should be clearly stated or referenced in the statement of any theorems.
•The proofs can either appear in the main paper or the supplemental material, but if
they appear in the supplemental material, the authors are encouraged to provide a short
proof sketch to provide intuition.
•Inversely, any informal proof provided in the core of the paper should be complemented
by formal proofs provided in appendix or supplemental material.
• Theorems and Lemmas that the proof relies upon should be properly referenced.
4.Experimental Result Reproducibility
Question: Does the paper fully disclose all the information needed to reproduce the main ex-
perimental results of the paper to the extent that it affects the main claims and/or conclusions
of the paper (regardless of whether the code and data are provided or not)?
Answer: [Yes]
Justification: We describe the model trainings in § G and E, and the dataset curation in § D
and § E.
Guidelines:
• The answer NA means that the paper does not include experiments.
•If the paper includes experiments, a No answer to this question will not be perceived
well by the reviewers: Making the paper reproducible is important, regardless of
whether the code and data are provided or not.
•If the contribution is a dataset and/or model, the authors should describe the steps taken
to make their results reproducible or verifiable.
•Depending on the contribution, reproducibility can be accomplished in various ways.
For example, if the contribution is a novel architecture, describing the architecture fully
might suffice, or if the contribution is a specific model and empirical evaluation, it may
be necessary to either make it possible for others to replicate the model with the same
dataset, or provide access to the model. In general. releasing code and data is often
one good way to accomplish this, but reproducibility can also be provided via detailed
instructions for how to replicate the results, access to a hosted model (e.g., in the case
of a large language model), releasing of a model checkpoint, or other means that are
appropriate to the research performed.
•While NeurIPS does not require releasing code, the conference does require all submis-
sions to provide some reasonable avenue for reproducibility, which may depend on the
nature of the contribution. For example
(a)If the contribution is primarily a new algorithm, the paper should make it clear how
to reproduce that algorithm.
(b)If the contribution is primarily a new model architecture, the paper should describe
the architecture clearly and fully.
(c)If the contribution is a new model (e.g., a large language model), then there should
either be a way to access this model for reproducing the results or a way to reproduce
the model (e.g., with an open-source dataset or instructions for how to construct
the dataset).
(d)We recognize that reproducibility may be tricky in some cases, in which case
authors are welcome to describe the particular way they provide for reproducibility.
In the case of closed-source models, it may be that access to the model is limited in
some way (e.g., to registered users), but it should be possible for other researchers
to have some path to reproducing or verifying the results.
5.Open access to data and code
Question: Does the paper provide open access to the data and code, with sufficient instruc-
tions to faithfully reproduce the main experimental results, as described in supplemental
material?
43Answer: [Yes]
Justification: We provide links to multiple implementations of GENOT in § G
Guidelines:
• The answer NA means that paper does not include experiments requiring code.
•Please see the NeurIPS code and data submission guidelines ( https://nips.cc/
public/guides/CodeSubmissionPolicy ) for more details.
•While we encourage the release of code and data, we understand that this might not be
possible, so “No” is an acceptable answer. Papers cannot be rejected simply for not
including code, unless this is central to the contribution (e.g., for a new open-source
benchmark).
•The instructions should contain the exact command and environment needed to run to
reproduce the results. See the NeurIPS code and data submission guidelines ( https:
//nips.cc/public/guides/CodeSubmissionPolicy ) for more details.
•The authors should provide instructions on data access and preparation, including how
to access the raw data, preprocessed data, intermediate data, and generated data, etc.
•The authors should provide scripts to reproduce all experimental results for the new
proposed method and baselines. If only a subset of experiments are reproducible, they
should state which ones are omitted from the script and why.
•At submission time, to preserve anonymity, the authors should release anonymized
versions (if applicable).
•Providing as much information as possible in supplemental material (appended to the
paper) is recommended, but including URLs to data and code is permitted.
6.Experimental Setting/Details
Question: Does the paper specify all the training and test details (e.g., data splits, hyper-
parameters, how they were chosen, type of optimizer, etc.) necessary to understand the
results?
Answer: [Yes]
Justification: We report training details and dataset curation details in § D, § E, and § G.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The experimental setting should be presented in the core of the paper to a level of detail
that is necessary to appreciate the results and make sense of them.
•The full details can be provided either with the code, in appendix, or as supplemental
material.
7.Experiment Statistical Significance
Question: Does the paper report error bars suitably and correctly defined or other appropriate
information about the statistical significance of the experiments?
Answer: [Yes]
Justification: We report results across multiple runs for all experiments in the main text.
For experiments in the appendix we only report results on one run due to limitations in
computational resources.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The authors should answer "Yes" if the results are accompanied by error bars, confi-
dence intervals, or statistical significance tests, at least for the experiments that support
the main claims of the paper.
•The factors of variability that the error bars are capturing should be clearly stated (for
example, train/test split, initialization, random drawing of some parameter, or overall
run with given experimental conditions).
•The method for calculating the error bars should be explained (closed form formula,
call to a library function, bootstrap, etc.)
• The assumptions made should be given (e.g., Normally distributed errors).
44•It should be clear whether the error bar is the standard deviation or the standard error
of the mean.
•It is OK to report 1-sigma error bars, but one should state it. The authors should
preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis
of Normality of errors is not verified.
•For asymmetric distributions, the authors should be careful not to show in tables or
figures symmetric error bars that would yield results that are out of range (e.g. negative
error rates).
•If error bars are reported in tables or plots, The authors should explain in the text how
they were calculated and reference the corresponding figures or tables in the text.
8.Experiments Compute Resources
Question: For each experiment, does the paper provide sufficient information on the com-
puter resources (type of compute workers, memory, time of execution) needed to reproduce
the experiments?
Answer: [No]
Justification: We only perform single-GPU training, thus we assume there is no limita-
tion to reproduce single experiments / there is no environmental/societal effect due to a
single experimental run. The computational burden lies in the large number of different
experiments/configurations conducted for this study.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The paper should indicate the type of compute workers CPU or GPU, internal cluster,
or cloud provider, including relevant memory and storage.
•The paper should provide the amount of compute required for each of the individual
experimental runs as well as estimate the total compute.
•The paper should disclose whether the full research project required more compute
than the experiments reported in the paper (e.g., preliminary or failed experiments that
didn’t make it into the paper).
9.Code Of Ethics
Question: Does the research conducted in the paper conform, in every respect, with the
NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines ?
Answer: [Yes]
Justification: We are aware of the NeurIPS Code of Ethics, and to the best of our knowledge-
adhere to it. Moreover, we include an impact statement in § H.
Guidelines:
•The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.
•If the authors answer No, they should explain the special circumstances that require a
deviation from the Code of Ethics.
•The authors should make sure to preserve anonymity (e.g., if there is a special consid-
eration due to laws or regulations in their jurisdiction).
10.Broader Impacts
Question: Does the paper discuss both potential positive societal impacts and negative
societal impacts of the work performed?
Answer: [Yes]
Justification: We include an impact statement in § H.
Guidelines:
• The answer NA means that there is no societal impact of the work performed.
•If the authors answer NA or No, they should explain why their work has no societal
impact or why the paper does not address societal impact.
45•Examples of negative societal impacts include potential malicious or unintended uses
(e.g., disinformation, generating fake profiles, surveillance), fairness considerations
(e.g., deployment of technologies that could make decisions that unfairly impact specific
groups), privacy considerations, and security considerations.
•The conference expects that many papers will be foundational research and not tied
to particular applications, let alone deployments. However, if there is a direct path to
any negative applications, the authors should point it out. For example, it is legitimate
to point out that an improvement in the quality of generative models could be used to
generate deepfakes for disinformation. On the other hand, it is not needed to point out
that a generic algorithm for optimizing neural networks could enable people to train
models that generate Deepfakes faster.
•The authors should consider possible harms that could arise when the technology is
being used as intended and functioning correctly, harms that could arise when the
technology is being used as intended but gives incorrect results, and harms following
from (intentional or unintentional) misuse of the technology.
•If there are negative societal impacts, the authors could also discuss possible mitigation
strategies (e.g., gated release of models, providing defenses in addition to attacks,
mechanisms for monitoring misuse, mechanisms to monitor how a system learns from
feedback over time, improving the efficiency and accessibility of ML).
11.Safeguards
Question: Does the paper describe safeguards that have been put in place for responsible
release of data or models that have a high risk for misuse (e.g., pretrained language models,
image generators, or scraped datasets)?
Answer: [NA]
Justification: We don’t release a pretrained model, nor a dataset.
Guidelines:
• The answer NA means that the paper poses no such risks.
•Released models that have a high risk for misuse or dual-use should be released with
necessary safeguards to allow for controlled use of the model, for example by requiring
that users adhere to usage guidelines or restrictions to access the model or implementing
safety filters.
•Datasets that have been scraped from the Internet could pose safety risks. The authors
should describe how they avoided releasing unsafe images.
•We recognize that providing effective safeguards is challenging, and many papers do
not require this, but we encourage authors to take this into account and make a best
faith effort.
12.Licenses for existing assets
Question: Are the creators or original owners of assets (e.g., code, data, models), used in
the paper, properly credited and are the license and terms of use explicitly mentioned and
properly respected?
Answer: [No]
Justification: We cite the papers publishing the original data, and provide links to datasets.
We don’t mention the licenses explicitly, as they are provided by the original publications.
Guidelines:
• The answer NA means that the paper does not use existing assets.
• The authors should cite the original paper that produced the code package or dataset.
•The authors should state which version of the asset is used and, if possible, include a
URL.
• The name of the license (e.g., CC-BY 4.0) should be included for each asset.
•For scraped data from a particular source (e.g., website), the copyright and terms of
service of that source should be provided.
46•If assets are released, the license, copyright information, and terms of use in the
package should be provided. For popular datasets, paperswithcode.com/datasets
has curated licenses for some datasets. Their licensing guide can help determine the
license of a dataset.
•For existing datasets that are re-packaged, both the original license and the license of
the derived asset (if it has changed) should be provided.
•If this information is not available online, the authors are encouraged to reach out to
the asset’s creators.
13.New Assets
Question: Are new assets introduced in the paper well documented and is the documentation
provided alongside the assets?
Answer: [NA]
Justification: We don’t release new assets.
Guidelines:
• The answer NA means that the paper does not release new assets.
•Researchers should communicate the details of the dataset/code/model as part of their
submissions via structured templates. This includes details about training, license,
limitations, etc.
•The paper should discuss whether and how consent was obtained from people whose
asset is used.
•At submission time, remember to anonymize your assets (if applicable). You can either
create an anonymized URL or include an anonymized zip file.
14.Crowdsourcing and Research with Human Subjects
Question: For crowdsourcing experiments and research with human subjects, does the paper
include the full text of instructions given to participants and screenshots, if applicable, as
well as details about compensation (if any)?
Answer: [NA]
Justification: The paper does not involve crowdsourcing nor research with human subjects
other than the bone marrow dataset [ 51]. The data is anonymized, and the original publication
discusses questions related to research with human individuals.
Guidelines:
•The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
•Including this information in the supplemental material is fine, but if the main contribu-
tion of the paper involves human subjects, then as much detail as possible should be
included in the main paper.
•According to the NeurIPS Code of Ethics, workers involved in data collection, curation,
or other labor should be paid at least the minimum wage in the country of the data
collector.
15.Institutional Review Board (IRB) Approvals or Equivalent for Research with Human
Subjects
Question: Does the paper describe potential risks incurred by study participants, whether
such risks were disclosed to the subjects, and whether Institutional Review Board (IRB)
approvals (or an equivalent approval/review based on the requirements of your country or
institution) were obtained?
Answer: [NA]
Justification: Only the bone marrow dataset [ 51] stems from human individuals, but the data
is anonymized, and the original publication discusses these aspects.
Guidelines:
•The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
47•Depending on the country in which research is conducted, IRB approval (or equivalent)
may be required for any human subjects research. If you obtained IRB approval, you
should clearly state this in the paper.
•We recognize that the procedures for this may vary significantly between institutions
and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the
guidelines for their institution.
•For initial submissions, do not include any information that would break anonymity (if
applicable), such as the institution conducting the review.
48