Real-Time Selection Under General Constraints via
Predictive Inference
Yuyang Huo1∗Lin Lu1∗Haojie Ren2†Changliang Zou1†
1School of Statistics and Data Sciences, LPMC, KLMDASR and LEBPS,
Nankai University, Tianjin, China
2School of Mathematical Sciences, Shanghai Jiao Tong University, Shanghai, China
huoyynk@gmail.com ,linlu102099@gmail.com
haojieren@sjtu.edu.cn ,zoucl@nankai.edu.cn
Abstract
Real-time decision-making gets more attention in the big data era. Here, we con-
sider the problem of sample selection in the online setting, where one encounters a
possibly infinite sequence of individuals collected over time with covariate infor-
mation available. The goal is to select samples of interest that are characterized by
their unobserved responses until the user-specified stopping time. We derive a new
decision rule that enables us to find more preferable samples that meet practical
requirements by simultaneously controlling two types of general constraints: indi-
vidual and interactive constraints, which include the widely utilized False Selection
Rate (FSR), cost limitations, diversity of selected samples, etc. The key elements
of our approach involve quantifying the uncertainty of response predictions via
predictive inference and addressing individual and interactive constraints in a se-
quential manner. Theoretical and numerical results demonstrate the effectiveness
of the proposed method in controlling both individual and interactive constraints.
1 Introduction
In recent times, the field of real-time decision has flourished significantly, primarily driven by the
exponential growth of available data in both the tech industry and computer science. We consider
here a typical application of real-time decision, the problem of online sample selection [2,5]. For
instance, online recruitment systems utilize machine learning algorithms to sequentially choose
qualified candidates rather than waiting for all (future) candidates’ information to be collected
[14]. Additionally, recommendation systems have now become commonplace in providing real-time
suggestions for content (e.g., news articles, short videos) with potential high click-through rates to
users [24]. Common situations also can be found in real-time precision marketing [43].
We describe the online sample selection problem as follows: samples (individuals) characterized by
covariates Xt∈Rdarrive sequentially while their responses Yt∈Rremain unobserved throughout
the process. The data pairs (X, Y)of each time are i.i.d. random vectors. At each time point, the
analyst is faced with the task of deciding whether to select the current observation based on certain
predetermined criteria related to Yt, and this selection process continues until a specific stopping rule
is triggered. For example, Ytis the score that measures how one candidate fits a given job position in
the recruitment system and the human resource agencies aim to prioritize candidates with higher Yt,
such as Yt≥b. OrYtis a binary variable where Yt= 1/0means accepting or rejecting the offer,
and the companies wish to find those individuals with Yt= 1based on the Xt.
*Equal contribution, and the first two authors are listed in alphabetical order.
†Correspondence to: Haojie Ren <haojieren@sjtu.edu.cn>, Changliang Zou <zoucl@nankai.edu.cn.>
38th Conference on Neural Information Processing Systems (NeurIPS 2024).Our Goal and Motivation. Our goal is to sequentially select samples whose unobserved responses
Yt’s are in the specified target region. A natural idea is to make decisions based on the prediction
value of Ytfrom models associated with (X, Y)built on some historical data. However, neglecting
the uncertainty in predictions could result in numerous false decisions, i.e., selecting those samples
whose true responses are beyond the specified region. To measure the selection uncertainty, some
existing works reformulate sample selection as a hypothesis testing problem and focus on controlling
the online false discovery rate (FDR) [ 16,33]; see more discussions and literature in Section 1.2.
However, in addition to quantifying statistical uncertainty, online selections often need to take into
account various constraints to find informative samples in practice, for example, cost limitations,
the impacts of some covariates or the diversity of candidates in the online recruitment [ 39]. Hence,
it’s necessary to explore the covariate space to satisfy these requirements. This motivates us to
investigate how to efficiently implement online sample selection with statistical guarantees under
various constraints.
To address this issue, we summarize common constraints into two types, i.e., individual constraints
andinteractive constraints . The former one is relevant to the cost of selected samples, and one typical
example is the fundamental and crucial criterion, false selection rate (FSR), which quantifies the
proportion of falsely selected samples and is equivalent to the well-adopted FDR. The latter constraint
captures the interactive influence among selected samples and is regarded as some kind of quadratic
constraint on some pairwise functions, such as the similarity or diversity among selected samples.
While the individual constraint associated with online FDR control has gained some attentions
[16,18], it alone fails to capture the nuanced pairwise relationships among different samples. To
bridge this gap, we introduce interactive constraints, which are pivotal within our framework. Building
upon individual constraints, the interactive criteria significantly expand the range of constraints our
method can control. Integrating two distinct types of constraints into a unified framework makes it
easier to create practical algorithms and ensures theoretical guarantees.
A motivating example: candidate screening. As an example, in recruitment, screening from the
resumes arriving sequentially to determine viable candidates who can get into interview processes is
an important problem in human resource management [ 13,35]. In this case, one may be interested in:
(1) controlling the online FSR to enhance resource efficiency [ 21], and (2) maintaining a desired level
of candidate diversity during the screening process, thereby reducing bias [ 23,44]. The individual
and interactive constraints and the novel real-time sample selection procedure we propose can solve
this problem precisely. See Section 4.2 for the details and more real data examples.
1.1 Our Contributions
In this paper, we design a novel and flexible online selection rule to effectively ensure the above two
types of constraints are under control at pre-specified levels simultaneously, named as “Individual
and Interactive Constrained Online Selection" (II-COS). The main idea stems from an oracle model
based on the local false discovery rate (lFDR) [12, 38], which is involved in offering valid evidence
on whether Ytis our interest at each time point. With some appropriately chosen evaluating functions,
the II-COS procedure entails validating whether the estimates of constraints are controlled. Simulated
and real-data examples clearly demonstrate the superiority of the II-COS in terms of both online
individual and interactive criteria control.
To the best of our knowledge, this is the first work to systematically bridge the predictive inference
and online selection procedure with various constraints. Our contributions are summarized as follows:
•Under a unified framework, the II-COS addresses how to implement online predictive
selection sufficiently in consideration of both individual and interactive constraints. It is
flexible to characterize the selective uncertainty and trade-off the sampling efficiency and
practical limitations in the covariate space.
•Under mild conditions, we establish the theoretical guarantee that the II-COS is able to
control both individual and interactive constraints simultaneously and asymptotically under
one given stopping rule.
•The II-COS is model-agnostic in the sense that its implementation is applicable to any
(appropriate) learning algorithms. Extensive numerical experiments indicate that the II-COS
can significantly outperform existing ones while yielding effective constraints control.
21.2 Related Works
Our proposed method is built upon two fundamental pillars: (1) quantifying the uncertainty of
response predictions using predictive inference; and (2) systematically addressing individual and
interactive constraints in a sequential manner. Our work is intricately connected to the fields of
predictive inference and online multiple testing. Here we briefly review literature on these two topics.
Predictive Inference. One key ingredient of our proposed method is predictive/conformal inference.
Conformal inference [ 42,34] provides a powerful and flexible tool to achieve algorithm-agnostic
uncertainty quantification of predictions. Conventionally, conformal inference aims to build the pre-
diction intervals and enjoys valid and distribution-free properties by leveraging data exchangeability
[25,3]. Taking a different but related perspective from multiple-testing, Bates et al. [7]pioneered a
method to construct conformal p-values to detect outliers with finite-sample FDR control. Building
upon this, recent advancements have improved detection power by involving more information or
performing model selection [ 50,26,27,51,46]. The most related works are Jin and Candès [21] and
Wu et al. [45], which considered a similar scenario that one would like to select some individuals of
interest by controlling FDR or maximizing the diversity of selected samples in an off-line setting.
Their methods are based on the conformal p-values or lFDR constructed with the predicted response
values, respectively. Besides the fundamental difference between online and offline paradigms, our
framework for characterizing various constraints poses additional challenges in how to select samples
sequentially since we have multiple goals to achieve.
Online Multiple Testing. When only considering individual constraint as FSR control, the online
sample selection can be reformulated as online multiple testing problem. Methods for online multiple
testing have received much recent attention and were pioneered by Foster and Stine [16] who proposed
the so-called α-investing strategy, which was later built upon and generalized [ 1,29,30,18,19]. The
key idea in α-investing and its generalizations is to compare p-values with dynamic thresholds and
gain some extra α-wealth for each rejection. We refer to Robertson et al. [33] for a thorough overview.
Those rules suffer from the “alpha-death" issue to some extent [ 29], which means a permanent end to
decision-making when the decision threshold is too small, i.e., the online procedure stops early. This
phenomenon occurs in many existing online multiple testing algorithms, as discussed in [ 29]. Along
a different direction, Gang et al. [17] developed a new class of structure-adaptive sequential testing
(SAST) rules built on the lFDR to avoid the alpha-death issue. The SAST serves as a building block
for developing our II-COS procedure and can be essentially seen as a special case of ours. Later
on, Ao et al. [4]reformulated online multiple testing procedure into an online knapsack problem,
providing novel policies with near-optimal regret guarantees. Additionally, Xu and Ramdas [48]
proposed to use e-values [ 41] for online multiple testing to address the dependence. However, those
existing works do not take predictive inference into account and are concerned only with online error
rate control without exploration of the covariate space, which may greatly hamper their applicability.
2 Individual and Interactive Constrained Online Selection Procedure
2.1 Problem Formulation
Assume there exists a historical labeled dataset as D={˜Xi,˜Yi}n
i=1, where (˜Xi,˜Yi)’s are independent
and identically distributed (i.i.d.) from (X, Y). A sequence of unlabeled data X1,X2,··· ∼ X=
(X1,···, Xd)⊤arrives in a stream with unknown responses Y1, Y2,···. At each time t, one must
make a real-time decision about whether or not to select the t-th individual, which is determined by
some pre-specified requirement on Yt. Denote Aas the target region of Yt, which differs depending
on users’ specifications. For example, in a regression setting, the requirement could be of the form
Yt∈[a, b],(−∞, a)orYt≥b.
Letθt=I{Yt∈ A} describe the true state of Yt. Denote a decision rule as δt∈ {0,1}, where δt= 1
indicates that the Xtis selected and δt= 0otherwise. A false selection is made if δt= 1butθt= 0.
Denote δt={δi:i≤t}as the decision rule and Tas the time that the procedure stops. Our goal
is to build a decision rule δtto select samples with {Yt∈ A} up to stopping time Tsuch that the
following two general types of constraints hold simultaneously.
Individual Constraint. In practice, one main concern is to control the cost of selecting samples of
interest. For example, in online recruitment, companies need to control the proportion of selected
3unqualified candidates or the average loss when hiring someone who rejects the offer. In such cases,
we can assign each selected sample a cost associated with some pre-specified function of the covariate
Xand control the expected cost associated with time Tat the target level. We refer to this requirement
asindividual constraint and write it as:
C1(δt) =E"P
i≤t{(1−θi)G0(Xi) +θiG1(Xi)}δi
(P
i≤tδi)∨1#
, (1)
where a∨b= max {a, b}andG0(X)≥0andG1(X)≥0withG0̸=G1are the costs corresponding
toθ= 0andθ= 1, respectively. Here, we take expectation due to the randomness of θ1,···, θt.
For example, when we simply choose G0(X) = 1 andG1(X) = 0 , the individual constraint is the
popular false selection rate (FSR), i.e.
C1(δt) = FSR( δt) =E"P
i≤t(1−θi)δi
(P
i≤tδi)∨1#
. (2)
The FSR is essentially equivalent to the well-adopted FDR in multiple testing literature, which is
a useful tool to maintain the ability to reliably select samples of interest without excessively false
selections [9]. Some works on online FDR control have been well studied. [16, 1].
The individual constraints alone cannot capture the pairwise relationship among different samples.
We address this by introducing interactive constraints below.
Interactive Constraint Another common concern is the interactive constraint , which involves
choosing more preferable samples. For example, companies would like to retain candidates with a
diverse range of backgrounds and experiences in online recruitment, or real-time suggested contents
are required to avoid homogeneity in recommendation systems. Here, we introduce a bi-variate
weight function g(X,X′)to evaluate the interaction between selected samples. Denote PC(δt) =PP
1≤i<j≤tg(Xi,Xj)θiθjδiδj,PS(δt) =PP
1≤i<j≤tθiθjδiδj. We define the interactive constraint as
˜C2(δt) =EPC(δt)
PS(δt)
. (3)
Here, since only the correctly selected samples are of interest, the constraint is concerned with the
average mutual effects between the correctly selected ones rather than all selected ones. When
choosing the function gas some similarities, controlling ˜C2(δt)at a specified constant K, i.e.,
˜C2(δt)≤K, is controlling the expected similarity (ES). It is equivalent to requiring that correctly
selected samples exhibit certain diversity and rich information in the covariate space of interest.
Typically, one useful choice for g(X,X′)is the weighted RBF kernel g(X,X′) =
expn
−1
σ2Pd
k=1wk(Xk−X′
k)2o
with parameter σ > 0to measure the similarity between two
independent XandX′. The RBF kernel is a common and widely embraced choice in machine
learning [ 49,28]. Here, {w1, . . . , w d}are some given weights per users’ needs. For instance, if
one is just interested in the effects of the k-th feature, then simply wk= 1andwj= 0forj̸=k.
Specifically, the case that wk= 1for all k= 1, . . . , d is chosen in Section 4. We also consider other
similarity choices of g(X,X′), such as the cosine similarity g(X,X′) =X⊤X′/(∥X∥2∥X′∥2)[52].
Due to the randomness in the denominator, it turns out controlling (3)directly is not easy. Instead,
we employ a modified interactive constraint,
C2(δt) =E
PC(δt)
E
PS(δt). (4)
The constraint (4)aims to control a ratio of expectations, which is still a reasonable interactive
measure. In numerical studies, we see that ˜C2(δt)in(3)andC2(δt)in(4)yield almost identical
patterns. An illustrative example can be found in Appendix D.1.
In sum, the goal is to select samples of interest by a decision rule δTcontrolling both the individual
and interactive constraints until stopping time T, i.e., C1(δT)≤αand C2(δT)≤K.We
emphasize that C1(δT)andC2(δT)as well as their pre-specified levels αandKcan be chosen up
to the practical applications.
42.2 Oracle Selection Procedure
To design a general rule that is valid for any arbitrary stopping time T, we consider controlling the
constraints at each time tin an online fashion, such that supt∈NC1(δt)≤αandsupt∈NC2(δt)≤K.
Since Ytis unavailable, we consider utilizing predictive inference to measure the suspicious patterns.
Letµ(x) := Y|X=xbe the regression or classification model associated with (Xt, Yt), and
one reliable estimate as bµ(·), being estimated on the labeled data Dwith some machine learning
algorithm. Denote Wt=bµ(Xt)as a predicted value of Ytand assume that bµ(·)is a bijection almost
surely. The bijection assumption is considerably mild and widely adopted for the identyification of
eachXtin the predictive inference framework [ 45]. The θt=I(Yt∈ A)is Bernoulli( π) distributed
withπ= Pr( Yt∈ A), and Wtcan be viewed as generated from one two-group model
Wt|θt∼(1−θt)f0+θtf1,
where f0andf1denote the probability distribution functions of Wtconditional on Yt/∈ A (i.e.,
θt= 0) and Yt∈ A, respectively. Then, the conditional probability of Yt/∈ A is
Lt= Pr( θt= 0|Wt) =(1−π)f0(Wt)
f(Wt), (5)
where f= (1−π)f0+πf1. The Ltcoincides with the local FDR in multiple testing literature
[12,17]. With the two-group model (5), we have E[θt|Xt] = 1−Ltand further notice that the
individual constraint C1(δt)in (1) can be exactly satisfied if
Vt
Rt:=P
i≤t{LiG0(Xi) + (1 −Li)G1(Xi)}δi
(P
i≤tδi)∨1≤α,
holds. Here, we denote Vt=P
i≤t{LiG0(Xi) + (1 −Li)G1(Xi)δi}and the number of selected
ones as Rt=P
i≤tδi∨1for notational convenience. Especially, when G0(X) = 1 ,G1(X) = 0 ,
thenFSR( δt)in (2) can be exactly controlled.
Accordingly, the interactive constraint C2(δt)≤Kin (4) can be achieved if
TSt
NSt:=PP
1≤i<j≤tg(Xi,Xj)(1−Li)(1−Lj)δiδj
PP
1≤i<j≤t(1−Li)(1−Lj)δiδj≤K,
where the expected total mutual effects conditional on {Xi}i≤tand the expected number are denoted
as TS tand NS t, respectively.
Therefore, if Ltis known, when a new sample Xtarrives at time point t, we can perform the decision
rule as follows. Note that there is no need to consider interactive effects before the first selection.
When tcomes before the first selection (i.e, Rt−1= 0), the decision rule is δt= 1if
Vt−1+LtG0(Xt) + (1 −Lt)G1(Xt)
Rt−1+ 1≤α, (6)
holds; otherwise, δt= 0 which means Xtis not selected. When Xtarrives with Rt−1≥1, then
δt= 1if (6) and
TSt−1+"
P
i≤t−1g(Xi,Xt)(1−Li)δi#
(1−Lt)
NSt−1+"
P
i≤t−1(1−Li)δi#
(1−Lt)≤K (7)
hold simultaneously; otherwise, δt= 0. Note that if we set C1(δt)as FSR( δt) and choose K= +∞,
then our method essentially reduces to the same manner as the controlling step of the SAST in Gang
et al. [17]. Our proposed method can be seen as a much more generalized and flexible framework for
controlling both the individual and the interactive constraints simultaneously in an online fashion.
We call this method the oracle II-COS (Individual and Interactive Constrained Online Selection). The
workflow in Figure 1 shows the procedure of the oracle II-COS. The following result shows that it
can exactly achieve our goal.
Proposition 2.1. Assume Ltvalues are known. Then the oracle II-COS selection rule controls both
constraints at any stopping time T, i.e., C1(δT)≤αand C2(δT)≤K.
5Oracle II -COS 𝑋𝑡
Input: 
𝑊𝑡,𝐿𝑡,
𝑔(𝑋𝑖,𝑋𝑡)𝐶1(𝑡)
𝐶2(𝑡)Yes𝛿𝑡=0
Yes
𝛿𝑡=1Update:
𝑉𝑡,𝑅𝑡,
𝑇𝑆𝑡,𝑁𝑆𝑡No
No
𝑋𝑡Figure 1: The implementation flowchart of the oracle II-COS procedure.
2.3 Data-driven II-COS Procedure
AsLtis unknown in practice, we propose a data-driven II-COS procedure, which uses a reliable
estimation bLtfor implementation. We resort to a data-splitting strategy: randomly split historical
dataDinto two parts, the training set Dtrand the calibration one Dcalof sizes n0andn1respectively,
where Dtris used for training a predictive model and Dcalis to estimate those unknown parameters.
Specifically, we first fit a regression or classification model bµ(·)onDtr, and then obtain predicted
values on Dcal, i.e.{bµ(˜Xi) : (˜Xi,˜Yi)∈ D cal}. Note that conditional on Dtr,{bµ(˜Xi) : (˜Xi,˜Yi)∈
Dcal}are i.i.d. random variables and have the same distribution as Wt=bµ(Xt), so that it can be
utilized to estimate (5).
Therefore, the estimators of f0andf,bf0andbf, can be obtained by applying the kernel density
estimation method to the data {bµ(˜Xi) : ( ˜Xi,˜Yi)∈ D cal,˜Yi/∈ A} and{bµ(˜Xi) : ( ˜Xi,˜Yi)∈
Dcal}, respectively. And the probability π= Pr( Yt∈ A)can be approximated by bπ=
n−1
1P
(˜Xi,˜Yi)∈DcalI(˜Yi∈ A).Further the Ltin (5) can be estimated by
bLi=(1−bπ)bf0(Wi)
bf(Wi)∧1. (8)
The data-driven II-COS procedure is summarized in Algorithm 1, and it indeed consists of two phases:
offline estimation and online decision. The running time of offline estimation is not critical. At each
timet, the computational complexity is a linear function of the currently selected number Rt. More
implementation details can be found in Section 4 and Appendix B.1.
In fact, the proposed II-COS is flexible to trade off the individual and interactive constraints by
adjusting the thresholds αandK. If one is concerned only with individual cost control, then we can
setK= +∞, with which the interactive constraint is out of work. Similarly, only the interactive
effect is of interest when α= 1. Appendix D.2 provides a toy example to illustrate this.
Before further pursuing, we would discuss the stopping time in practice. It’s worth noting that the
specific choice of stopping rule (and thus stopping time) is completely up to the user. For example,
when m≥2is the desired number of selections, one can set T= inf t{t:Pt
i=1δi=m}. Or when
sis the total wages for recruitment, one can set T= inf t{t:Pt
i=1δisi=s}where siis the payroll
for each selected candidate. Or Tis just chosen as one given deadline. With the use of II-COS,
practitioners have the flexibility to design diverse stopping strategies that can adapt seamlessly to
their specific applications. In brief, our method is flexible and is appropriate for various goals based
on the user’s requirements by choosing different G0(X), G1(X), g(Xi,Xj)and varied target levels
(α, K)and a user-specified stopping time.
6Algorithm 1 The data-driven II-COS procedure
Input: Target levels αandK, pairwise function g, cost G0(X)andG1(X), stopping time T,
interested region A, labeled data D, prediction algorithm H.
Initialization: t= 0,Vt=Rt= 0,TSt= NS t= 0; Decision rule δt=∅
Estimation: Randomly split Dinto training set Dtrand calibration set Dcal. OnDtr, fitbµ(x)with
H. Obtain bπ,bf0andbffromDcal.
Online decisions: while t≤Tdo
Sett=t+ 1. Compute Wt=bµ(Xt),bLtby (8) and the similarities g(Xi,Xt)for those δi= 1.
Replace LtbybLtin (6) and (7).
ifRt−1<1and (6) holds thenδt= 1;
elseδt= 0;
ifRt−1≥1, (6) and (7)hold thenδt= 1;
elseδt= 0;
Update: δt=δt−1S{δt};Rt=Rt−1+δt;Vt=Vt−1+{bLtG0(Xt) + (1 −bLt)G1(Xt)}δt;
TSt=TSt−1+"X
i<tg(Xi,Xt)(1−bLi)δi#
(1−bLt)δt;NSt=NSt−1+"X
i<t(1−bLi)δi#
(1−bLt)δt;
end
Output: Selection set {Xi:δi= 1, δi∈δT}.
Extension to varying proportion case. In practice, the distribution of (Xt, Yt)may vary smoothly
over time. In Appendix C, we consider the probability of Yt∈ A (i.e. the proportion of samples in
the specified region) varying over time and extend the proposed II-COS to learn πt= Pr( Yt∈ A)
continuously over time and we also construct the corresponding theoretical guarantees.
3 Statistical Performance Guarantees
In this section, we provide statistical guarantees for the data-driven II-COS procedure. The main
difficulties lie in the quantification of data-driven estimation error of Ltand we utilize the classical
kernel density estimation theory along with the structure of our online procedure to effectively
characterize it. For simplicity, we consider that the training data set is given such that the estimated
modelbµis fixed. Before presenting our theoretical results, we state the following regularity conditions.
Assumption 3.1 (Density functions and kernel) .The density functions and kernel function satisfy
(1) The f1(·)andf0(·)are upper bounded by M > 0, and the f(·)is lower bounded by ℓ >0.
(2)Thef0andf1are Hölder-continuous, i.e. |f0(w)−f0(w′)| ≤cβ|w−w′|βfor any w, w′∈
R,and the same for f1with some fixed 0< β≤1and constant cβ.
(3) Kernel K(·)is a bounded symmetric function and enjoys exponential decay.
Assumption 3.2 (Weight functions) .There exists constants cG>0andcg>0such that 0<
G0(X)≤cG,0< G 1(X)≤cGfor any Xand0< g(X,X′)≤cgfor any X̸=X′.
Assumption 3.1 is considerably mild and widely adopted in the uniform convergence of kernel
density estimation [ 36]. Iff0andf1have bounded first-order derivatives, the Hölder-continuous
assumption would hold with β= 1. The lower bound of fis to ensure the uniform convergence
of the estimated lFDR . Assumption 3.2 is mild since the weight functions are required only to be
positive and bounded. It can be satisfied by a large category of G0,G1andg. For example, we can
takeGj(X) =aj∥X∥2
2forj= 0or 1 and cGexists when Xis bounded. And we can set gas the
RBF and orthogonal similarities with cg= 1.
With those regularity conditions, we establish the validity of the II-COS procedure for the individual
constraint control.
7Theorem 3.3 (Bound for individual constraint) .Suppose Assumptions 3.1 and 3.2 hold and take
the bandwidths for estimating fandf0in the order of n−1/(2β+1)
1 . Then for any given time t, the
individual constraint of the II-COS procedure (Algorithm 1) satisfies C1(δt)≤α+ ∆ n1,where
∆n1=Dn−β
2β+1
1√logn1andDis a constant depending on M,ℓ,cβ,β,π,cGandK(·).
Although the C1(·)of II-COS might be slightly larger than the target level in finite samples, this
gap converges to 0asymptotically as n1increases. In the numerical studies, we find that a small
calibration size of around 200is enough to control the C1in a reasonable range. Taking the FSR as
an individual constraint, Theorem 3.3 indicates that our method can provide asymptotic online FSR
control similar to an online FDR control procedure [16].
The next theorem examines the performance of the II-COS in terms of interactive constraint.
Theorem 3.4 (Bound for interactive constraint) .Suppose Assumptions 3.1-3.2 hold and take the
bandwidths for estimating fandf0in the order of n−1/(2β+1)
1 . LetTs= inf{t:Pt
i=1δi=s}for
s >2and assume there exists a constant α′∈(0,1)such thatP
i≤tbLiδi/(1∨Rt)≤α′. Then for
any given time t≥Tm, the interactive constraint of the II-COS satisfies
C2(δt)≤K+(K+cg)∆n1
0.5−mα′
m−1−∆n1.
The term mα′/(m−1)is used to characterize the lower bound of the denominator term of the
interactive constraint. Specifically, when we choose FSR as the individual constraint, we have
α′=α, which demonstrates the interdependence between controlling individual and interactive
constraints. Furthermore, under arbitrary stopping strategies with a stopping time T, we can have the
asymptotic guarantee.
Corollary 3.5. Suppose the conditions in Theorem 3.4 hold, the stopping moment T≥Tmand
α′<(1−1/m)/2. Then the II-COS procedure controls the individual and interactive constraints
asymptotically at T, i.e.limn1→∞C1(δT)≤αand limn1→∞C2(δT)≤K.
4 Experiments and Evaluation
We illustrate the breadth of applicability of the II-COS procedure by experiments on simulated data
and real-data applications. As an example, we set the stopping rule as selecting total m= 100
samples, i.e., T=Tm= inf t{t:Pt
i=1δi=m}. Additional experiments including the extended II-
COS in Appendix C are shown in Appendix D.9. Code for implementing II-COS and reproducing the
experiments and figures in our paper is available at https://github.com/lulin2023/II-COS .
Implementation of II-COS . To our best knowledge, online selection with uncertainty qualification
has only been studied in the field of online multiple testing, which aims to control online FDR. Hence,
we focus on using FSR as the individual criterion and modified ES as the interactive criterion. As
Xmay be measured on scales with widely differing ranges in different dimensions, we assume that
X’s have been properly scaled in each dimension before computing g. We choose gas the weighted
RBF kernel with σ= 1,wk= 1here. Other choices for individual and interactive constraints are
considered in Appendix D.5.
Benchmarks . We compare the II-COS procedure with four benchmarks from online multiple testing.
The first one is a structure-adaptive sequential testing rule, the SAST [17], which is implemented
withbLt. It can achieve the FSR control but ignore the interactive constraint. As mentioned earlier
in Section 2, SAST can also be considered as a special case of our II-COS with K= +∞. Its
details are deferred to Appendix B.2. The other competitors are three well-known online FDR control
algorithms LOND [18],SAFFRON [30] and ADDIS [40] implemented with the conformal p-values
suggested by Bates et al. [7]. Refer more information in Appendix B.3. All the benchmarks can only
control FDR, which demonstrates the flexibility of our method for different constraints.
Performance Measures . The empirical FSR, ES and stopping time ( Tm) are evaluated using the
average values of the false selection proportions, the similarity and the stopping time from 500
replications, respectively, where Tmserves as a criterion for assessing selection efficiency.
84.1 Results on Synthetic Data
Data Description. We consider a classification model: X|Y= 0∼ N 4(µ1,I4), andX|Y=
1∼ N 4(µ2,I4), where µ1= (5,0,0,0)⊤,µ2= (0,0,−3,−2)⊤. We set Pr(Y= 1) = 0 .2. The
information set is A={1}. The predictor His taken as random forest with defaulted parameters.
We also consider a regression setting and conduct additional experiments in Appendix D.
Firstly, we observe that methods relying on conformal p-values, such as LOND, SAFFRON, and
ADDIS, encounter the alpha-death (stop early) issue [ 29]. These methods struggle to select an
adequate number of samples, especially in small calibration sets. In contrast, II-COS ensures the
control of both individual and interactive constraints even with a small ncal(e.g., 200). See more
details and results in Appendix D.3. Hence, to make a fair comparison, we consider a relatively large
size of the calibration set, ncal= 4,000. We fix training data size ntr= 1,000.
0.000.050.100.150.20
100 200 300
TimeC1(FSR)
0.0250.0500.075
100 200 300
TimeC~
2(ES)
Method II−COS SAST LOND SAFFRON ADDIS
Figure 2: The values of FSR( δt)andES(δt)over time tfor II-COS, SAST, LOND, SAFFRON and ADDIS.
The black dashed lines denote the FSR level α= 0.1and the ES level K= 0.045. Shading represents error
bars of one standard error above and below.
0.00.10.20.3
II−COSSASTLONDSAFFRONADDISC1(FSR)
0.000.050.100.15
II−COSSASTLONDSAFFRONADDISC~
2(ES)
02505007501000
II−COSSASTLONDSAFFRONADDISTm
Figure 3: Boxplots of FSR( δTm),ES(δTm)and stopping time Tmfor II-COS, SAST, LOND, SAFFRON and
ADDIS. The black dashed lines indicate the corresponding nominal levels.
Results. Figure 2 presents the online FSR (false selection rate) and ES (expected similarity) values of
five methods against time t, which are individual and interactive constraints, respectively. The FSR
levels of II-COS and SAST are closer to the nominal level than the other three methods. As expected,
only the empirical ES levels of II-COS are controlled under the pre-specified level Kover time t.
The LOND and SAFFRON lead to slightly conservative FSR values, while the FSR levels of ADDIS
are inflated compared to the target level. Figure 3 further displays the boxplots of empirical FSR,
ES at stopping time Tm. We observe that only II-COS achieves satisfactory ES values compared
to the nominal level. Moreover, the II-COS has a relatively larger value of Tmcompared to those
of other benchmarks. This is consistent with the fact that the II-COS spends more time exploring
the structure information inside the covariate space due to the requirement of interactive constraint.
Similar conclusions for the regression example in Appendix D.4 can be drawn.
Regarding efficiency, we also conducted an experiment to compare the effectiveness of II-COS with
an oracle method possessing knowledge of true state θt. The Tmof II-COS is very close to the oracle.
This close proximity indicates the high efficiency of II-COS. See Appendix D.8 for the details.
4.2 Results on Real Data
We next demonstrate the performance of the II-COS in two real-world applications. Since those
online multiple testing methods based on conformal p-values yield few selected individuals, we focus
9on comparing the II-COS with the SAST. For comparison, we also include the offline method using
conformal p-values, where δt= 1ifbpt≤α. We denote it as CP.
Datasets. We consider the recruitment dataset from Kaggle [22] that contains 45,372 candidates after
removing the missing data and records a binary response indicating whether the candidate passes the
job interview, and other 11 attributes including education status, handicapped or not, and gender. The
other problem is to use 1994 Census Bureau dataset [ 8] to select a subset of individuals who may
have high incomes in precision marketing. This census dataset records 32,561 individuals with their
14 attributes, including gender, race, marriage, education length and so on.
For each dataset, we randomly partition the data into three parts: ntr= 1,000training data, ncal=
1,000calibration data and the rest which are used as the online observations. The categorical
attributes are converted into one-hot codes and then are treated as numerical attributes for computing
similarity measures. The prediction algorithm His random forest with defaulted parameters.
Results. Table 1 reports the results among 500 repetitions. Both the II-COS and SAST enjoy valid
FSR control, but CP yields an inflated FSR level in income investigation. The II-COS performs well
in terms of similarities. To further compare the diversities, we present the proportions of different
education status in in Figure 4. It can be seen that the proposed II-COS demonstrates its superior
diversity in the specific attributes. See Appendix D.6 for more results for the real data. In summary,
the proposed II-COS works well for selecting individuals of interest to achieve various constraints in
practical applications.
Table 1: Average values with candidate dataset and income dataset: FSR( δTm),ES(δTm)(×10−3) and
stopping time Tm. The target FSR level is α= 0.2for both. For the candidate data, the target ESlevel
K= 1×10−3; For the income data, K= 6×10−3. The bracket contains the standard error.
(a) Candidate dataset [22]
Method FSR ES Tm
II-COS 0.19 (0.002) 0.98 (0.005) 2227 (91.6)
SAST 0.19 (0.002) 8.73 (0.269) 310 (35.2)
CP 0.16 (0.002) 10.34 (0.084) 277 (1.49)(b) Income dataset [8]
Method FSR ES Tm
II-COS 0.16 (0.007) 5.56 (0.128) 2760 (227.0)
SAST 0.19 (0.008) 30.90 (1.078) 1200 (202.3)
CP 0.42 (0.006) 18.84 (0.640) 283 (3.883)
0.20.210.210.49
0.440.48
0.020.07
0.020.3
0.260.3
0.010.030.01
0.00.10.20.30.40.5
No Qual High School Matriculation Bachelors Master
Education StatusPropotionMethod II−COS SAST CP
0.350.45
0.00.10.20.30.40.5
4 8 12 16
Education LengthPropotionMethod II−COS SAST
Figure 4: Left: Education status composition of the correctly selected samples (II-COS, SAST and CP) in
candidate dataset; Right: Education length (year) composition of the correctly selected samples (II-COS, SAST)
in income dataset. The plots have error bar to show the variation across the 500 runs.
5 Concluding Remarks
Broader Impacts. This work focuses on creating reliable machine learning tools for making real-time
decisions. One key achievement is a new algorithm called II-COS, designed to select informative
samples in real-time while meeting two types of general constraints. II-COS allows for both individual
and interactive control, validated through theoretical analysis and numerical tests. Our method is
model-agnostic and easily applicable to many real-world cases such as producing diversified results
while controlling FSR for online recruitment. One potential negative impact of our work is that
researchers will apply the algorithm without sufficient scrutiny. We emphasize that it’s important to
use caution when applying this method to complex real-world scenarios to prevent misuse.
Limitations. Firstly, we mainly consider binary functions as the interactive constraint. How to adapt
the II-COS to other popular constraints, such as the Gini index, deserves further study. Secondly,
in certain practical scenarios, it is possible to obtain feedback after decisions. Incorporating the
feedback information into our method to enhance its performance warrants future research.
10Acknowledgments and Disclosure of Funding
We thank anonymous area chair and reviewers for their helpful comments. Zou was supported
by the National Key R&D Program of China (Grant Nos. 2022YFA1003703, 2022YFA1003800),
the National Natural Science Foundation of China (Grant Nos. 11925106, 12231011, 11931001,
12226007, 12326325). Ren was supported by the National Natural Science Foundation of China
(Grant Nos. 12101398, 12471262), and Young Elite Scientists Sponsorship Program by CAST.
References
[1]Ehud Aharoni and Saharon Rosset. Generalized α-investing: definitions, optimality results and
application to public databases. Journal of the Royal Statistical Society: Series B (Statistical
Methodology) , 76(4):771–794, 2014.
[2]Rahaf Aljundi, Min Lin, Baptiste Goujaud, and Yoshua Bengio. Gradient based sample selection
for online continual learning. Advances in Neural Information Processing Systems , 32, 2019.
[3]Anastasios N Angelopoulos and Stephen Bates. Conformal prediction: A gentle introduction.
Foundations and Trends® in Machine Learning , 16(4):494–591, 2023.
[4]Ruicheng Ao, Hongyu Chen, David Simchi-Levi, and Feng Zhu. Online local false discovery
rate control: A resource allocation approach. arXiv preprint arXiv:2402.11425 , 2024.
[5]Eric Bach, Shuchi Chawla, and Seeun Umboh. Threshold rules for online sample selection.
Discrete Mathematics, Algorithms and Applications , 2(4):625–642, 2010.
[6]Peter L. Bartlett. Learning with a slowly changing distribution. In Proceedings of the Fifth
Annual Workshop on Computational Learning Theory , page 243–252, 1992.
[7]Stephen Bates, Emmanuel Candès, Lihua Lei, Yaniv Romano, and Matteo Sesia. Testing for
outliers with conformal p-values. Annals of Statistics , 51(1):149–178, 2023.
[8]Barry Becker and Ronny Kohavi. Adult income investigation. UCI Machine Learning Repository
https://archive.ics.uci.edu/dataset/2/adult , 1996.
[9]Yoav Benjamini and Yosef Hochberg. Controlling the false discovery rate: a practical and
powerful approach to multiple testing. Journal of the Royal Statistical Society: Series B
(Statistical Methodology) , 57(1):289–300, 1995.
[10] Yoav Benjamini and Daniel Yekutieli. The control of the false discovery rate in multiple testing
under dependency. Annals of Statistics , 29(4):1165–1188, 2001.
[11] Rick Durrett. Probability: theory and examples , volume 49. Cambridge University Press, 2019.
[12] Bradley Efron, Robert Tibshirani, John D Storey, and Virginia Tusher. Empirical bayes analysis
of a microarray experiment. Journal of the American Statistical Association , 96(456):1151–
1160, 2001.
[13] Evanthia Faliagka, Kostas Ramantas, Athanasios Tsakalidis, and Giannis Tzimas. Application of
machine learning algorithms to an online recruitment system. In Proc. International Conference
on Internet and Web Applications and Services , pages 215–220, 2012.
[14] Evanthia Faliagka, Lazaros Iliadis, Ioannis Karydis, Maria Rigou, Spyros Sioutas, Athanasios
Tsakalidis, and Giannis Tzimas. On-line consistent ranking on e-recruitment: seeking the truth
behind a well-formed cv. Artificial Intelligence Review , 42(3):515–528, 2014.
[15] Kai-Tai Fang, Runze Li, and Agus Sudjianto. Design and modeling for computer experiments .
Chapman and Hall/CRC, 2005.
[16] Dean P Foster and Robert A Stine. α-investing: a procedure for sequential control of expected
false discoveries. Journal of the Royal Statistical Society: Series B (Statistical Methodology) ,
70(2):429–444, 2008.
11[17] Bowen Gang, Wenguang Sun, and Weinan Wang. Structure–adaptive sequential testing for
online false discovery rate control. Journal of the American Statistical Association , 118(541):
732–745, 2023.
[18] Adel Javanmard and Andrea Montanari. On online control of false discovery rate. arXiv preprint
arXiv:1502.06197 , 2015.
[19] Adel Javanmard and Andrea Montanari. Online rules for control of false discovery rate and
false discovery exceedance. The Annals of Statistics , 46(2):526–554, 2018.
[20] Heinrich Jiang. Uniform convergence rates for kernel density estimation. In International
Conference on Machine Learning , pages 1694–1703. PMLR, 2017.
[21] Ying Jin and Emmanuel J Candès. Selection by prediction with conformal p-values. Journal of
Machine Learning Research , 24(244):1–41, 2023.
[22] Kaggle. Candidate selection dataset. https://www.kaggle.com/datasets/
tarunchilkur/client , 2020.
[23] G Kanagavalli, R Seethalakshmi, and T Sowdamini. A systematic review of literature on
recruitment and selection process. Humanities & Social Sciences Reviews , 7(2):01–09, 2019.
[24] Mozhgan Karimi, Dietmar Jannach, and Michael Jugovac. News recommender systems–survey
and roads ahead. Information Processing & Management , 54(6):1203–1227, 2018.
[25] Jing Lei, Max G’Sell, Alessandro Rinaldo, Ryan J Tibshirani, and Larry Wasserman.
Distribution-free predictive inference for regression. Journal of the American Statistical Associ-
ation , 113(523):1094–1111, 2018.
[26] Ziyi Liang, Matteo Sesia, and Wenguang Sun. Integrative conformal p-values for out-of-
distribution testing with labelled outliers. Journal of the Royal Statistical Society Series B:
Statistical Methodology , 86(3):671–693, 01 2024.
[27] Ariane Marandon, Lihua Lei, David Mary, and Etienne Roquain. Adaptive novelty detection
with false discovery rate guarantee. The Annals of Statistics , 52(1):157–183, 2024.
[28] Houwen Peng, Bing Li, Haibin Ling, Weiming Hu, Weihua Xiong, and Stephen J. Maybank.
Salient object detection via structured matrix decomposition. IEEE Transactions on Pattern
Analysis and Machine Intelligence , 39(4):818–832, 2017.
[29] Aaditya Ramdas, Fanny Yang, Martin J Wainwright, and Michael I Jordan. Online control of
the false discovery rate with decaying memory. Advances in Neural Information Processing
Systems , 30:5655–5664, 2017.
[30] Aaditya Ramdas, Tijana Zrnic, Martin Wainwright, and Michael Jordan. Saffron: an adaptive
algorithm for online control of the false discovery rate. In International Conference on Machine
Learning , pages 4286–4294. PMLR, 2018.
[31] Bradley Rava, Wenguang Sun, Gareth M James, and Xin Tong. A burden shared is a burden
halved: A fairness-adjusted approach to classification. arXiv preprint arXiv:2110.05720 , 2021.
[32] David S Robertson, Jan Wildenhain, Adel Javanmard, and Natasha A Karp. onlineFDR: an R
package to control the false discovery rate for growing data repositories. Bioinformatics , 35
(20):4196–4199, 2019.
[33] David S Robertson, James MS Wason, and Aaditya Ramdas. Online multiple hypothesis testing.
Statistical Science , 38(4):557, 2023.
[34] Glenn Shafer and Vladimir V ovk. A tutorial on conformal prediction. Journal of Machine
Learning Research , 9(3):371–421, 2008.
[35] Muhammad Ahmad Shehu and Faisal Saeed. An adaptive personnel selection model for
recruitment using domain-driven data mining. Journal of Theoretical and Applied Information
Technology , 91(1):117, 2016.
12[36] Bernard W. Silverman. Weak and strong uniform consistency of the kernel estimate of a density
and its derivatives. The Annals of Statistics , 6(1):177–184, 1978.
[37] John D Storey. A direct approach to false discovery rates. Journal of the Royal Statistical
Society: Series B (Statistical Methodology) , 64(3):479–498, 2002.
[38] Wenguang Sun and T. Tony Cai. Oracle and adaptive compound decision rules for false
discovery rate control. Journal of the American Statistical Association , 102(479):901–912,
2007.
[39] Stephen Taylor. Resourcing and talent management . Kogan Page Publishers, 2018.
[40] Jinjin Tian and Aaditya Ramdas. Addis: an adaptive discarding algorithm for online fdr control
with conservative nulls. Advances in Neural Information Processing Systems , 32:9388–9396,
2019.
[41] Vladimir V ovk and Ruodu Wang. E-values: Calibration, combination and applications. The
Annals of Statistics , 49(3):1736–1754, 2021.
[42] Vladimir V ovk, Alexander Gammerman, and Glenn Shafer. Algorithmic learning in a random
world . New York: Springer, 2005.
[43] Michel Wedel and PK Kannan. Marketing analytics for data-rich environments. Journal of
Marketing , 80(6):97–121, 2016.
[44] Sang Eun Woo, James M LeBreton, Melissa G Keith, and Louis Tay. Bias, fairness, and validity
in graduate-school admissions: A psychometric perspective. Perspectives on Psychological
Science , 18(1):3–31, 2023.
[45] Xiaoyang Wu, Yuyang Huo, Haojie Ren, and Changliang Zou. Optimal subsampling via
predictive inference. Journal of the American Statistical Association , pages 1–29, 2023.
[46] Xiaoyang Wu, Lin Lu, Zhaojun Wang, and Changliang Zou. Conditional testing based on
localized conformal p-values. arXiv preprint arXiv:2409.16829 , 2024.
[47] Pengtao Xie, Yuntian Deng, and Eric Xing. Latent variable modeling with diversity-inducing
mutual angular regularization. arXiv preprint arXiv:1512.07336 , 2015.
[48] Ziyu Xu and Aaditya Ramdas. Online multiple testing with e-values. In International Conference
on Artificial Intelligence and Statistics , pages 3997–4005. PMLR, 2024.
[49] Yi Yang, Zhigang Ma, Feiping Nie, Xiaojun Chang, and Alexander G Hauptmann. Multi-class
active learning by uncertainty sampling with diversity maximization. International Journal of
Computer Vision , 113(2):113–127, 2015.
[50] Yifan Zhang, Haiyan Jiang, Haojie Ren, Changliang Zou, and Dejing Dou. Automs: automatic
model selection for novelty detection with error rate control. Advances in Neural Information
Processing Systems , 35:19917–19929, 2022.
[51] Zinan Zhao and Wenguang Sun. False discovery rate control for structured multiple testing:
Asymmetric rules and conformal q-values. Journal of the American Statistical Association ,
pages 1–24, 2024.
[52] Ping Zhong, Zhiqiang Gong, Shutao Li, and Carola-Bibiane Schönlieb. Learning to diversify
deep belief networks for hyperspectral image classification. IEEE Transactions on Geoscience
and Remote Sensing , 55(6):3516–3530, 2017.
13Supplementary Material for “Real-Time Selection Under General
Constraints via Predictive Inference”
This supplementary material contains:
• Preliminary terms for self-containment (Appendix A);
• Implementation details (Appendix B);
• An extension algorithm to varying proportion case (Appendix C);
• Additional experiments (Appendix D);
• The proofs of all the theoretical results. (Appendix E).
A Preliminary Terms for Self-Containment
Here, we list the preliminary terms we use in the paper for the sake of clarity and self-containment.
•FDR [9], false discovery rate, a widely-adopted error rate notion in the field of multiple
testing, is defined as the expected proportion of incorrectly rejected null hypotheses as
follows:
FDR( t) =E|H0∩ R(t)|
|R(t)| ∨1
,
whereH0is the unknown set of true null hypotheses, R(t)represents the set of rejected null
hypotheses until time tand then H0∩ R(t)is the set of false discoveries.
•FSR , false selection rate, defined as the expected proportion of individuals being not of
interest among the selected subset of individuals. It is in fact equivalent to the definition of
FDR. In our framework in this paper, we describe it equivalently as:
FSR( t) =E"P
i≤t(1−θi)δi
(P
i≤tδi)∨1#
.
B Implementation Details of Algorithms
𝒟
𝒟𝑡𝑟 𝒟𝑐𝑎𝑙
ℋ
Ƹ𝜇(𝑋) ො𝜋,෡𝑓0,෡𝑓1Offline EstimationOnline Decision 𝑋𝑡
Compute: 
𝑊𝑡,෡𝐿𝑡,
𝑔(𝑋𝑖,𝑋𝑡)𝐶1(𝑡)
𝐶2(𝑡)Yes𝛿𝑡=0
Yes
𝛿𝑡=1Update:
𝑉𝑡,𝑅𝑡,
𝑇𝑆𝑡,𝑁𝑆𝑡No
No
𝑋𝑡
Figure 5: The implementation flowchart of the data-driven II-COS procedure.
14B.1 Implementation Details of II-COS
Figure 5 shows the implementation flowchart of our proposed data-driven II-COS procedure, including
the offline estimation step and online decision step. Here we introduce more implementation details
to reproduce the results.
About the classifier. For the classification problem, we use the predicted conditional probability
cPr(Yt= 1|Xt=x)asbµ(x)in the procedure of II-COS. Many commonly used algorithms such as
random forest and neural networks can provide such probability estimators. In fact, the choice of bµ
is not restricted to probability. For example, the support vector machine outputs the distance to the
separating hyperplane for classification, and such distance can be chosen as bµ.
However, for probability estimators, one potential problem is that when the classifier is quite accurate,
most of Wi’s are concentrated at 0or1and few of them take values between (0,1). In such a
situation, it is difficult to accurately and stably estimate lFDR Li’s since the density functions f0(w)
andf(w)are not smooth enough and are not lower bounded. This yields that our assumptions are
violated, but the II-COS can still perform satisfactorily with some corrections on the estimation bLi’s.
Notice that the larger Wiis, the more likely Yi∈ A and hence the smaller Liis. That is bLishould be
monotonically decreasing as Wiincreases. Observing this, we can make a monotonization correction
onbLi’s. To be specific, we rearrange bLiby the decreasing order of Wi. IfbL(W(i−1))<bL(W(i))
which violates the monotonicity, we revise it by bL(W(i−1)) =bL(W(i)), where W(i)is the ith
smallest among W. This monotonization correction enables us to avoid obvious errors due to
unstable estimation and improve the performances of all the methods utilizing bLi’s.
Choice of K. A useful interactive constraint needs an appropriate specification of K. For any
two i.i.d. observations XandX′with corresponding θandθ′respectively, the expected C2of the
individuals of interest is given as C2:=E[g(X,X′)|θ= 1, θ′= 1] , which can be estimated by
cC2=PP
i<j;i,j∈Lg(˜Xi,˜Xj)/{|L|(|L| − 1)},where L={i:˜Yi∈ A} . It is reasonable to set
K=acC2, where a >0is user-specific to control the interactive constraint level. Our numerical
evidence reveals that a∈(0.1,0.5)works generally well.
B.2 Implementation Details of SAST
Gang et al. [17] proposed a structure-adaptive sequential testing (SAST) rule for online false dis-
covery rate control. In their work, the rejecting rule is as follows: If Lt< γ tand{|Rt−1|+
1}−1P
i∈Rt−1Li+Lt
≤α, then δt= 1. Otherwise δt= 0, where Rt−1={i≤t−1 :δi= 1}
andγtis a barrier estimated from an "offline" procedure.
The implementation details of SAST for comparisons in our simulations in Section 4 are different
from the original one. Firstly, the original SAST assumes the null density function f0is already
known while in our setting f0remains unknown. Secondly, in our predictive inference setting, the
density functions and the null proportion are directly estimated via calibration set as the offline
estimation procedure in Algorithm 1, not from current rejection sets. Besides, considering the
time-varying structures of the data stream in their setting, Gang et al. [17] incorporated the barrier
strategy in their method, which is not necessary to be adopted here.
B.3 Implementation Details of Conformal p-values
The notion of conformal p-values was originally proposed by V ovk et al. [42] to construct prediction
interval. Recently, there exist some works to apply conformal p-values to implement sample selection
from a multiple-testing perspective, such as Bates et al. [7], Rava et al. [31] and Jin and Candès [21].
In the sample selection problem, the hypothesis has the following form for each t,
H0t:Yt∈ Acv.s. H1t:Yt∈ A.
There are two types of conformal p-values and we adopt the one in Bates et al. [7]which utilizes the
same class calibration. Recall that for Wt, its conformal p-value ptis defined as
bpt=1 +P
i∈D calI{Q(˜Wi)≤Q(Wt)}
1 +|Dcal|.
15The nonconformity score function Q(Wt)is used to indicate the possibility of θt= 0. For example,
in regression settings, if A= [b,+∞), we can use Q(Wj) =b−Wj. IfA= (−∞, a]∪[b,+∞),
then we can choose Q(Wt) = max {Wt−a, b−Wt}. And in binary classification settings, if A= 1
andWtindicates the probability of Yt= 1, we set Q(Wt) = 1−Wt.
Even though conformal p-values are correlated, using conformal p-values to conduct multiple testing
can control the FDR level with finite sample guarantee since they are positive regression dependent
on a subset (PRDS) [ 10]. However, the conformal p-values are lower bounded by 1/(|Dcal|+ 1) ,
which leads to unsatisfactory performance for online multiple testing methods based on p-values.
Since these methods require sufficiently small p-values to make rejections.
In our simulations, we implement LOND, SAFFRON and ADDIS for online sample selection by
R package OnlineFDR [32] with α= 0.1. Other parameters are defaulted. Here we introduce
the details about these online FDR control methods. Ramdas et al. [29] proposed a “statistical
perspective" to control FDR in online setting, which is to keep an estimate of the FDP less than α
similar to the offline setting. Specifically, for offline FDR, let the rejection set R(s) ={i|pi≤s}.
An oracle estimate for FDP is given by FDP∗(s) :=|H0|·s
|R(s)|∨1.For online FDR, an oracle estimate of
FDP∗(t)isP
j≤t,j∈H0αj
R(t)∨1. Table 2 lists a comparison of estimating FDP in classical offline methods
and online methods for FDR control in multiple testing. For the online methods, denote the decision
rule as δt={pt≤αt}, where ptis the corresponding conformal p-value at time tfor our problem.
The test levels {αt}for LOND [18], SAFFRON [30] and ADDIS [40] are listed as follows:
Table 2: A comparison of [FDP in offline methods v.s. online methods for FDR control.
Offline dFDP dFDP(t) Online
BH [9]n·s
|R(s)|∨1P
j≤tαj
R(t)∨1LOND [18]
Storey-BH [37]n·s·ˆπ0
|R(s)|∨1,ˆπ0=Pn
i=11(pi>λ)
n(1−λ)P
j≤tαj1{pj>λj}
(1−λj)
R(t)∨1SAFFRON [30]
P
j≤tαj1{λj<pj≤τj}
τj−λj
R(t)∨1ADDIS [40]
•LOND: αt=γt(R(t−1)+1) , where {γt}∞
t=1is a given infinite non-increasing sequence of
positive constants that sums to αandR(n) =Pn
t=1Rtdenotes the number of discoveries
in the first nhypotheses tested.
•SAFFRON: At each time t, define Cj+=Cj+(t) =Pt−1
i=τj+1, where Ct=I{pt≤λ}.
Fort= 1,α1= min {γ1W0, λ}; Fort= 2,3, . . .,αt:= min {λ,˜αt}, where
˜αt=W0γt−C0++ ((1−λ)α−W0)γt−τ1−C1++ (1−λ)αX
j≥2γt−τj−Cj+.
• ADDIS: The testing levels for ADDIS are given by αt= min {λ,ˆαt}, where
ˆαt= (η−λ)[ω0γSt−C0++ (α−ω0)γSt−τ∗
1−C1++αX
j≥2γSt−τ∗
j−Cj+]
andSt=P
i<tI{pi≤η},τ∗
j=P
i≤τjI{pi≤η}.
B.4 Experiments Compute Resources
All the experiments were conducted on 3.11 GHz Intel Gen i5-11300H processors with 16 Gb memory
at a Lenovo personal computer and the R platform with version 4.2.1. The time of execution for
each of the individual experimental runs is about 6.686 seconds. And the total compute time for the
synthetic classification example in Section 4 for 500 replications is about 63.877 minutes.
16B.5 A Toy Example for Illustration in Section 2.3
We illustrate the idea of the II-COS procedure via a binary classification example. We aim to select
m= 50 data points of a specific class from unlabeled data arriving sequentially. We choose FSR as
the individual constraint and mES as the interactive constraint.
The data is generated as follows. The 4-dimensional covariates X= (X1, X2, X3, X4)⊤are
generated from a mixture of multivariate normal distributions with mean (0,0,0,0)ifY= 0and
mean (−3,−3,0,0)ifY= 1. The proportions of Y= 0andY= 1are 80% and 20% respectively.
In this illustrative example, we set the historical data size n= 1,000with calibration size n1= 500
and would like to select m= 50 data points from the interest region A={1}with the target FSR
levelα= 0.1. The mES threshold Kis set at 0.01for II-COS.
Figure 6 depicts the scatterplot of the first two dimensions of the covariates X, with green dots and
red triangles denoting correctly selected points and falsely selected ones, respectively. The SAST
method proposed by Gang et al. [17] is taken as one benchmark, which considers only the FSR
control. We observe that the selected points of II-COS enjoy significant diversity among the covariate
space and only a few false selections are contained. In contrast, the SAST is inclined to choose
similar samples concentrated at the center of the concerned group and stops too early to fully explore
the covariate space with sequentially arriving samples.
Correctly−selected Falsely−selected
−5.0−2.50.0
−6−4−2 0
X1X2II−COS
−5.0−2.50.0
−6−4−2 0
X1X2SAST
Figure 6: Scatter plots of selected points of the II-COS and SAST. It stops when selecting 50samples . Left:
the selection results of the II-COS; Right: the results of SAST. Green dots and red triangles indicate correct and
false selections, respectively.
C Extension to Varying Proportion Case
In practice, the distribution of (Xt, Yt)may vary smoothly over time. Due to the unknown Yt, it is
unrealistic to re-estimate parameters (i.e., Estimation Step in Algorithm 1) on both labeled data
and the most recent data. To mitigate this problem, we consider the probability of Yt∈ A (i.e. the
proportion of samples in the specified region) varying over time and extend the proposed II-COS to
learn πt= Pr( Yt∈ A)continuously over time.
LetQ(Wt)be one score function, which is high when the possibility of θt= 0is large and otherwise
low. For example, in regression settings, if A= [a,+∞), we can take Q(Wt) =a−Wt. And in
binary classification, if A= 1andWtindicates the probability of Yt= 1, we can set Q(Wt) = 1−Wt.
One valid conformal p-value for Q(Wt)can be obtained as Bates et al. [7],
bpt=1 +P
i∈D calI{Q(˜Wi)≤Q(Wt)}
1 +|Dcal|.
Inspired by the techniques for null proportion estimation in multiple testing literature [ 37], we note
thatPr(bpt≥λ)≈Pr(bpt≥λ, θt= 0)≈πt(1−λ)for large λ∈(0,1)(i.e.,λ= 0.5).
Thus, we consider using some recent bptto estimate a reliable πt. Denote qas the size of a neighbor-
hood{t−q, . . . , t −1}and fix λ. We employ an exponential weighted scheme to estimate πtwhere
17the more recent samples will contribute more to the estimation:
bπλ
t= 1−Pt−1
j=t−qκb(j−t)I{bpj> λ}
(1−λ)Pt−1
j=t−qκb(j−t),
where κb(s) = exp {−|s|/b}andbis the bandwidth parameter. Then, we can compute the distribution
ofWtasbft=bf0(w)(1−bπt) +bf1(w)bπtand estimate LtbybLλ
t=(1−bπλ
t)bf0(Wt)
bft(Wt)∧1.
The extended II-COS is to substitute bLλ
tforbLtin Algorithm 1. The following theorem establishes
the guarantee by assuming the slow change of distribution [6].
Theorem C.1. Assume πtsatisfies |πt+1−πt| ≤ ηfor any t, and the bandwidth pa-
rameter bsatisfies bζ≤qfor some ζ > 1. Denote ∆′=c1n−β/(2β+1)
1√logn1+
c2max{b−1/3,(logn1/n1)1/6,(bη)2/3}with constants c1,c2. Suppose ptandλsatisfy Pr(pt> λ|
θt= 1) = 0 . Under Assumption 3.1-3.2, we have:
(a) For any given time t, the individual constraint of extended II-COS satisfies C1(δt)≤α+ ∆′;
(b) Furthermore, if the conditions in Theorem 3.4 hold, then for any given time t > T m, the
interactive constraint of the extended II-COS satisfies C2(δt)≤K+(K+cg)∆′
0.5−mα′
m−1−∆′.
Besides the part similar to ∆n1in Theorem 3.3, the bound ∆′owns an additional term that can be
decomposed into three parts. The b−1/3indicates how many valid samples we use to estimate πt. The
second part comes from the approximation error of p-values. The last one characterizes the effects of
distribution shift. If we properly choose bsuch that bη=o(1), this term is negligible. Thus when b
andn1both tend to infinity, ∆′converges to 0and the individual and interactive constraints will be
controlled asymptotically.
D Additional Experiments
D.1 Illustration of the Similar Patterns between ˜C2andC2
We calculate the empirical ˜C2andC2during the online sample selection procedure under regression
setting in Section D.4 with II-COS from 500 replications. The results are summarized in Figure 7.
0.0080.0100.0120.014
200 400 600
TimeValue
Figure 7: Illustration of the similar patterns between ˜C2andC2. Line charts of ˜C2(δt)(red line) and C2(δt)
(blue line) over time tfor the regression example. Experiment details are in Appendix D.4. The black dashed
line is K= 0.015. The two measures yield almost identical patterns.
D.2 An Illustration Example of the Flexibility for Choices of αandK.
There exists some trade-off of stopping time and two criteria. In fact, II-COS could result in a short
stopping time when only one criterion is considered. Typically, one could choose K= +∞for the
case the interactive constraint is out of work and only individual criterion control is considered, and
meanwhile one can set α= 1with which the interactive constraint is the only concern. The results in
Table 3 evaluated this conclusion where C1is the FSR and ˜C2is the ES.
18Table 3: Results of flexible choice of αandKfor the classification example. Average values among 500
repetitions: FSR( δTm),ES(δTm)and stopping time Tm.
α, K C 1(FSR) ˜C2(ES) Tm
α= 0.1, K= +∞ 0.101 0.073 446.51
α= 0.1, K= 0.045 0.102 0.044 628.82
α= 1, K= 0.045 0.849 0.038 107.79
Table 4: Average number of selected samples when stopping for II-COS, LOND, SAFFRON and ADDIS.
Classification Regression
ncal II-COS LOND SAFFRON ADDIS II-COS LOND SAFFRON ADDIS
500 100 0.20 0.70 100 100 0.20 21.82 24.05
1000 100 0.72 10.40 100 100 0.87 56.72 59.20
1500 100 11.40 36.33 100 100 12.28 74.70 80.05
2000 100 44.20 50.79 100 100 40.99 80.03 82.02
2500 100 68.33 60.95 100 100 59.72 92.01 91.04
D.3 Effects of the Calibration Size
We perform some additional simulations under the classification setting, to study the stopping early
issue for those methods based on the conformal p-values.
Take α= 0.1andK= 0.045for FSR and mES, respectively. In Table 4, we first fix ntr= 1,000
andm= 100 and vary ncalfrom 500 to 2,500 to compare the average numbers of selected samples of
these three methods with II-COS until stopping. It is clear that all the three benchmarks are unable to
select enough samples across all the settings, especially with a small calibration set. As the calibration
sizen1increases, their selected numbers tend to be close to the target. This can be understood
because a larger calibration size would generally yield more accurate detection of the individual
of interest and thus alleviate the alpha-death issue to some extent. In contrast, the performances of
II-COS, in terms of the number of selected samples until stopping, would be much less influenced
by the size of calibration data. The II-COS only stops when msamples are obtained under all the
scenarios.
Furthermore, to verify that II-COS can guarantee both FSR( δTm)andES(δTm)control with a
relatively small calibration size ncal(such as 200), we apply II-COS in synthetic data. The details of
the data generation process can be found in Section 4 and D.4.
We fix ntr= 1000 ,m= 100 andncalvaries from 200 to 800. The average of FSR( δTm)and
ES(δTm)with II-COS for both scenarios are calculated from 500 replications. The results are
summarized as Table 5. It’s obvious that for different ncal, both FSR( δTm)andES(δTm)are
controlled under the pre-specified constant αandKrespectively under all scenarios with our II-COS
method.
Table 5: Average values of FSR( δTm)(%) andES(δTm)(×10−2)(with standard errors in parentheses) for
II-COS with different ncalunder classification setting ( α= 10% , K= 4.50×10−2) and regression setting
(α= 10% , K= 1.50×10−2).
Classification Regression
ncalFSR ( Tm) ES ( Tm) FSR ( Tm) ES ( Tm)
200 9.22(0.73) 4 .41(0.08) 5 .74(0.18) 1 .49(0.03)
400 9.22(0.69) 4 .42(0.07) 4 .84(0.19) 1 .49(0.04)
600 9.47(0.80) 4 .39(0.09) 5 .18(0.19) 1 .49(0.04)
800 9.36(0.69) 4 .40(0.08) 5 .79(0.19) 1 .49(0.04)
19D.4 Results on Synthetic Data for Regression Setting
The following regression setting is considered: Y=−7X2
1+ 5 exp X2+ 10( X3+X4)2+ε,with
X∼ N 4(0,I4)andε∼ N(0,1). The informative set is A= (c,∞), where cis the 80% quantile
ofY. The FSR and mES are considered as C1andC2, respectively. The prediction algorithm H
is taken as neural network, with a single hidden layer and 10 hidden neurons, implemented by R
package nnet , and Kis chosen as 0.015.
The simulation results are summarized in Figure 8 and 9 from 500 replications. The results are similar
to those for classification setting. It’s further verified that our proposed II-COS outperforms all the
benchmarks under both classification and regression scenarios.
0.000.050.100.150.20
100 200 300
TimeC1(FSR)
0.010.020.030.040.05
100 200 300
TimeC~
2(ES)
Method II−COS SAST LOND SAFFRON ADDIS
Figure 8: Simulation results for regression setting. Line charts of FSR( δt)(Left) and ES(δt)(Right)
for II-COS, SAST, LOND, SAFFRON and ADDIS over time t. The black dashed lines are the
corresponding FSR level α= 0.1and the ES level K= 0.015. Shading represents error bars of one
standard error above and below.
0.000.050.100.150.20
II−COS
SAST
LOND
SAFFRON
ADDISC1(FSR)
0.000.030.060.090.12
II−COS
SAST
LOND
SAFFRON
ADDISC~
2(ES)
050010001500
II−COS
SAST
LOND
SAFFRON
ADDISTm
Figure 9: Simulation results for regression setting. Boxplots of FSR( δTm)(Left), ES(δTm)(Middle)
andTm(Right) for II-COS, SAST, LOND, SAFFRON and ADDIS. The black dashed lines are the
corresponding FSR level α= 0.1and ES level K= 0.015.
D.5 Experiments for Other Individual and Interactive Constrains.
Other individual constraints To better illustrate the performance of our proposed method, we
also conduct an experiment for the general individual constraint. We choose G0(X) =|Pd
i=1Xi|,
G1(X) =|Pd
i=1Xi|/2for EC (expected cost), and choose G0(X) = 1 ,G1(X) = 0 for FSR. Other
settings are the same as the classification model. The results are shown in Figure 10. We can see that
only the proposed II-COD can guarantee all EC (expected cost), FSR and ES control, while all the
benchmarks are out of control for EC or ES.
Other pairwise function g.Besides the RBF kernel, popular choices include the cosine similarity
[47,52] with adjustment g(X,X′) =X⊤X′/(∥X∥2∥X′∥2) + 1 , and the absolute value of cosine
similarity, i.e., g(X,X′) =|X⊤X′|/(∥X∥2∥X′∥2)which characterizes the orthogonality between
200.00.51.01.5
II−COSSASTLONDSAFFRONADDISC1(EC)
0.00.20.4
II−COSSASTLONDSAFFRONADDISC1(FSR)
0.000.050.100.15
II−COSSASTLONDSAFFRONADDISC~
2(ES)Figure 10: Boxplots of EC(δTm),FSR( δTm), and ES(δTm)for II-COS, SAST, LOND, SAFFRON and
ADDIS under classification model. The black dashed lines indicate the corresponding nominal levels α1=
0.5, α2= 0.2, K= 0.045.
XandX′and is often considered in the field of design of experiments [ 15]. The similarity functions
mentioned above all satisfy Assumption 3.2. As a supplement to the experiments in the main text, we
choose the cosine similarity with adjustment g(X,X′) =X⊤X′/(∥X∥2∥X′∥2)+1 for classification
setting. Notice that the original cosine similarity X⊤X′/(∥X∥2∥X′∥2)can be negative sometimes.
Hence we add a constant 1which guarantees g(X,X′)≥0and does not change the final results. The
simulation results are summarized in Figure 11 from 500 replications. As can be seen, the simulation
results are similar to those when choosing the RBF kernel in Section 4.1.
0.00.10.2
II-COSSASTLONDSAFFRONADDIS
MethodFSR
0.951.001.051.10
II-COSSASTLONDSAFFRONADDIS
MethodES
0200400600800
II-COSSASTLONDSAFFRONADDIS
MethodTm
Figure 11: Boxplots of FSR( Tm),ES(Tm)andTmwith random forest algorithms under classification setting
for II-COS, SAST, LOND, SAFFRON and ADDIS. The similarity function gis chosen as the cosine similarity
with adjustment g(X,X′) =X⊤X′/(∥X∥2∥X′∥2) + 1 . The black dashed lines are the corresponding FSR
levelα= 0.1and the ES level K= 1.0.
D.6 Additional Results for Real Data Analysis
In Table 6, the average proportions of handicapped and female in the selected candidates are in the
last two columns of (a). The average proportions of minority and female among the correctly selected
individuals are in the last two columns of (b).
D.7 Additional Experiments for Different Learning Algorithms
Except for the random forest algorithm, we further apply two different learning algorithms Hfor
classification setting to estimate the model ˆµ(X): Support vector machine (SVM) and Neural network
(NN) with a single hidden layer and 10 hidden neurons, which are implemented by R packages
kernlab andnnet , respectively. For NN algorithm, the entropy fitting is used for classification
setting. The empirical FSR( Tm)andES(Tm)levels are estimated by the average of the false
selection proportion and the expected similarity respectively from 500 replications. The results are
summarized in Figure 12. As can be seen, the simulation results are similar as those when applying
random forest in Section 4.1.
21Table 6: Average values with candidate dataset and income dataset: FSR( δTm),ES(δTm)(×10−3) and
stopping time Tm. The average proportions of handicapped and female in the selected candidates are in the last
two columns of (a). The average proportions of minority and female among the correctly selected individuals
are in the last two columns of (b). The target FSR level is α= 0.2for both. For the candidate data, the target
ESlevelK= 1×10−3; For the income data, K= 6×10−3.
(a) Candidate dataset [22]
Method FSR ES Tm Handicap Female
II-COS 0.19 0.98 2227 0.15 0.48
SAST 0.19 8.73 310 0.05 0.47
CP 0.16 10.34 277 0.04 0.46(b) Income dataset [8]
Method FSR ES Tm Minority Female
II-COS 0.16 5.56 2760 0.05 0.09
SAST 0.19 30.90 1200 0.03 0.05
CP 0.42 18.84 283 0.06 0.13
NN SVM
II−COS SAST LONDSAFFRONADDIS II−COS SAST LONDSAFFRONADDIS0.000.100.200.300.400.50
MethodFSR
NN SVM
II−COS SAST LONDSAFFRONADDIS II−COS SAST LONDSAFFRONADDIS0.000.030.060.09
MethodES
Figure 12: Boxplots of FSR( Tm)andES(Tm)with two different learning algorithms under classification
setting for II-COS, SAST, LOND, SAFFRON and ADDIS. The black dashed lines are the corresponding FSR
levelα= 0.1and the ES level K= 0.045.
D.8 Experiments for the comparison with oracle procedure
Regarding efficiency, we conducted an experiment to compare the effectiveness of II-COS with an
oracle method possessing knowledge of true state θt. This can be succinctly formulated as follows.
At time t,δt= 1ifθt= 1andPC(δTm)/PS(δTm)≤K,the process halts whenP
i≤tδi=m. To
ensure a fair comparison, we fix α= 0.01for II-COS and choose K= 0.045for both methods. The
results are shown in Table 7. The FSR of the oracle procedure is 0 as expected. The Tmof II-COS is
very close to the oracle. This close proximity indicates the high efficiency of II-COS. Both FSR and
ES are effectively controlled by II-COS.
D.9 Experiments for the Extended II-COS under Varying Proportion Case
Table 7: FSR( δTm),ES(δTm)(×10−2)
andTmof the II-COS and the oracle proce-
dure under classification model.
Method FSR ES Tm
II-COS 0.0097 4.41 686.245
Oracle 0 4.41 681.665LetNbe a prespecified large integer denoting the number
of samples arriving sequentially. Denote nas the size of
available labeled history dataset D. We fix N= 5000 ,
n= 5000 . Consider three different varying patterns for πt:
1.Blocks pattern: πt= 0.3, for t∈[1,100]∪
[501,600]∪[1001 ,1100] ∪[1501 ,2000] ∪
[2001 ,2100] ∪[2501 ,2600] ∪[3001 ,3100] ∪
[3501 ,4000] ;πt= 0.2fort∈[101,500]∪
[601,1000] ∪[1101 ,1500] ∪[2101 ,2500] ∪
[2601 ,3000]∪[3101 .3500]∪[4000 ,5000] .
222.Linear pattern: Vary πtlinearly from 0 to 0.5,
πt= 0.5t/N.
3.Sine pattern: πt={sin(8πt/N ) + 1}/4,πt
ranges between 0 and 0.5.
The other settings are the same as those in classification setting. For the historical dataset, we fix
πt= 0.2.
In simulation we generate 500 data points prior to t= 1to form an initial proportion estimate. The
varying proportion estimates are updated every 200 time points. The bandwidth parameter bfor
estimating πλ
tare chosen based on normal reference rule. We set b= 38 . The window size qare
chosen by a rule of thumb in practice. Let q=Cb, where Cis a fixed constant between 10 and 20.
In our simulations, we fix q= 500 andλ= 0.5. As for the density estimation, we first estimate f0
andf1on the calibration data, then compute bft=bf0(w)(1−bπt) +bf1(w)bπt. Thus accordingly, we
estimate LtbybLλ
t=(1−bπλ
t)bf0(Wt)
bft(Wt)∧1.As for those methods based on conformal p-values, they do
not need modification since they only require the exchangeability of data in the null hypothesis. The
varying proportion case does not violate such a condition.
The simulation results are shown in Figures 13-15, from which we can observe that the extended
version of II-COS performs better than the benchmarks under all three different varying settings for
bothC1(FSR) and C2(ES) control.
0.000.050.100.150.200.25
II-COSSASTLONDSAFFRONADDIS
MethodFSR
0.000.050.100.15
II-COSSASTLONDSAFFRONADDIS
MethodES
010002000300040005000
II-COSSASTLONDSAFFRONADDIS
MethodTm
Figure 13: Boxplots of FSR( δTm),ES(δTm)andTmfor II-COS, SAST, LOND, SAFFRON and ADDIS
(Blocks pattern). The black dashed lines indicate the corresponding nominal levels.
0.0000.0250.0500.0750.100
II-COSSASTLONDSAFFRONADDIS
MethodFSR
0.000.050.100.15
II-COSSASTLONDSAFFRONADDIS
MethodES
010002000300040005000
II-COSSASTLONDSAFFRONADDIS
MethodTm
Figure 14: Boxplots of FSR( δTm),ES(δTm)andTmfor II-COS, SAST, LOND, SAFFRON and ADDIS
(Linear pattern). The black dashed lines indicate the corresponding nominal levels.
230.000.050.100.150.20
II-COSSASTLONDSAFFRONADDIS
MethodFSR
0.000.050.100.15
II-COSSASTLONDSAFFRONADDIS
MethodES
010002000300040005000
II-COSSASTLONDSAFFRONADDIS
MethodTmFigure 15: Boxplots of FSR( δTm),ES(δTm)andTmfor II-COS, SAST, LOND, SAFFRON and ADDIS
(Sine pattern). The black dashed lines indicate the corresponding nominal levels.
E Proofs
E.1 Auxiliary Lemmas
The following results include a standard uniform bound for kernel density estimator [ 36,20] and a
simple corollary from the central limit theorem [11].
Lemma E.1. If Assumption 3.1 hold and we take the bandwidth h=n−1/(2β+1)
1 , then with probabil-
ity at least 1−1/n1
sup
w∈R|bf(w)−f(w)| ≤D1n−β
2β+1
1p
logn1,
where D1=D1(M, c β, β, K )is a positive constant depending on Mandβ, cβof Hölder continuity
and the kernel K(·).
Lemma E.2. The estimation bπsatisfies
|bπ−π| ≤p
π(1−π)n−1
2+γ
1 ,
with probability 1−n−2γ
1for any constant 0< γ < 1/2.
Next lemma characterizes the uniform convergence of bL(w).
Lemma E.3 (Uniform convergence of bL(w)).Suppose Assumption 3.1 holds. Taking the bandwidth
of kernel density estimator as h=n−1/(2β+1)
1 , then we have
sup
w∈R|bL(w)−L(w)| ≤D2n−β
2β+1
1p
logn1,
for some positive constant D2=D2(M, D 1, ℓ, π)with probability 1−2/n1−1/n1/3
1.
Proof .
24Note that bL(w) = (1 −bπ)bf0(w)
bf(w)∧1and
sup
w∈R|bL(w)−L(w)| ≤sup
w∈R(1−bπ)bf0(w)
bf(w)−L(w)= sup
w∈R(1−bπ)bf0(w)f(w)−(1−π)f0(w)bf(w)
bf(w)f(w)
≤sup
w∈R1
bf(w)f(w)n
(1−bπ)f(w)|bf0(w)−f0(w)|+|π−bπ|f0(w)f(w) + (1 −π)f0(w)|bf(w)−f(w)|o
≤sup
w∈R|bf0(w)−f0(w)|+f0(w)|π−bπ|
bf(w)+ sup
w∈RL(w)|bf(w)−f(w)|
bf(w)
(i)
≤1
infw∈Rbf(w){D1n−β
2β+1
1p
logn1+Mp
π(1−π)n−1
2+γ
1 +D1·n−β
2β+1
1p
logn1}
(ii)
≤2
ℓ{D∗
1n−β
2β+1
1p
logn1+Mp
p(1−p)n−1
2+γ
1 +D1·n−β
2β+1
1p
logn1}
(iii)
≤D2n−β
2β+1
1p
logn1,
where D∗
1=D∗
1(D1, π)is a positive constant depending on D1andπbecause bf0is estimated by
about n1(1−π)samples. The (i)follows the results directly in Lemma E.1 and Lemma E.2 and
the bounds of f(w)andf0(w)in Assumption 3.1-(1) with probability 1−2/n1−1/n2γ
1. The (ii)
holds since
bf(w)≥f(w)−D1n−β
2β+1
1p
logn1≥ℓ−D1n−β
2β+1
1p
logn1> ℓ/2
for sufficiently large n1. Due to the fact β≤1and taking γ= 1/6in Lemma E.2, the (iii)holds
withD2= 2{D∗
1+Mp
π(1−π) +D1}/ℓ. Hence we verify the conclusion. □
The next lemma shows the property of data-driven II-COS procedure which is useful to give the
bound of the mES gap.
Lemma E.4. Suppose δtis the decision result at time t≥Tsby the data-driven II-COS procedure
withP
i≤tbLiδi/1∨P
i≤tδi≤α′, where Ts= inf{t:Pt
i=1δi=s}ands≥2. Then we have
E(PP
1≤i<j≤tδiδj)
EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)o≤ 
1−2s
s−1α′−1.
Proof . It suffices to show
XX
1≤i<j≤tδiδj(1−bLi)(1−bLj)≥(1−2s
s−1α′)XX
1≤i<j≤tδiδj.
By the selection procedure, we have
tX
i=1δi(1−bLi)≥(1−α′)tX
i=1δi. (9)
Squaring both sides of (9) and making some decomposition, we have
XX
1≤i<j≤tδiδj(1−bLi)(1−bLj)≥(1−α′)2XX
1≤i<j≤tδiδj+1
2tX
i=1{(1−α′)2−(1−bLi)2}δi.
Notice that
tX
i=1δi=2
s−1XX
1≤i<j≤tδiδj.
25We have
(1−α′)2XX
1≤i<j≤tδiδj+1
2tX
i=1{(1−α′)2−(1−bLi)2}δi
≥(1−α′)2XX
1≤i<j≤tδiδj+1
2tX
i=1{(1−α′)2−1}δi
≥(1−α′)2XX
1≤i<j≤tδiδj−α′(2−α′)
22
s−1XX
1≤i<j≤tδiδj
≥(1−2s
s−1α′)XX
1≤i<j≤tδiδj.
□
The next two lemmas will be used in the analysis of the extended II-COS for varying proportion case.
Lemma E.5. Assume that random variables Y1,Y2, have density functions bounded by a constant
c > 0, and other two random variables Y3, and Y4satisfy P(|Y1−Y3| ≤ε)≥1−ζand
P(|Y2−Y4| ≤ϵ)≥1−ς, where ε >0,ϵ >0,ζ >0andς >0. Then for all t >0,
|P(Y1> t, Y 2> t)−P(Y3> t, Y 4> t)| ≤2c(ε+ϵ) + 3( ζ+ς).
Proof . Define the events E1={|Y1−Y3| ≤ε},E2={|Y2−Y4| ≤ϵ}, andE=E1SE2. Note that
P(Y1+ε > t,E1)≤P(Y3> t,E1)≤P(Y1−ε > t,E1),
and
P(Y2+ϵ > t,E2)≤P(Y4> t,E2)≤P(Y2−ϵ > t,E2),
we have
P(Y1> t, Y 2> t)−P(Y3> t, Y 4> t)
≤ |P(Y1> t, Y 2> t)−P(Y3> t, Y 4> t,E)|+P(Ec
1) +P(Ec
2)
≤ |P(Y1> t, Y 2> t)−P(Y1−ε > t, Y 2−ϵ > t,E)|
+|P(Y1> t, Y 2> t)−P(Y1+ε > t, Y 2+ϵ > t,E)|+P(Ec
1) +P(Ec
2)
≤ |P(Y1> t, Y 2> t)−P(Y1−ε > t, Y 2−ϵ > t)|+ 3P(Ec
1) + 3P(Ec
2)
+|P(Y1> t, Y 2> t)−P(Y1+ε > t, Y 2+ϵ > t)|
≤2c(ε+ϵ) + 3( ζ+ς),
the last inequality holds because the density function is bounded.
□
Lemma E.6. Ifbζ≤qfor some ζ >1andbis sufficiently large, the exponential weight κb(s) =
exp{−|s|/b}satisfiesPq
s=1κ2
b(s)
{Pq
s=1κb(s)}2≤Cb1
b
andPq
s=1sκb(s)Pq
s=1κb(s)≤Cbb,
where Cb>0is constant determined by b.
Proof . Take Zb= exp{−1/b}. Notice that
jX
s=iκb(s) =exp{−(i+ 1)/b} −exp{−(j+ 1)/b}
1−exp{−1/b}=Zi+1
b−Zj+1
b
1−Zb.
26Thus for a constant Cb>0. we have
Pq
s=1κ2
b(s)
{Pq
s=1κb(s)}2=Z4
b−Z2q
b
1−Z2
b
/Z4
b−2Zq+2
b+Z2q
b
1 +Z2
b−2Zb
(i)
≤Cb(1−Zb)
(ii)
≤Cb1
b,
where ( i) holds since bis sufficiently large such that Zq
b= exp {−q/b} ≤ exp{−bζ−1}can be
eliminated and Zb<1. The last inequality ( ii) holds by exp{x} ≥x+ 1.
By the same discussion, we have
Pq
s=1sκb(s)Pq
s=1κb(s)≤Z∞
1sZs
bds/Z2
b−Zq
b
1−Zb
≤Zb
(1−Zb)2
/Z2
b−Zq
b
1−Zb
≤Cb1
1−Zb
≤Cb(b+ 1).
The last inequality holds since exp{x} ≤1/(1−x)forx <1. For simplicity, we use the same
notation Cbto denote the constants. □
E.2 Proof of Proposition 2.1
Proof . For the part of individual constraint control, note that Liis defined as
Li= Pr( θi= 0|Wi) =E[(1−θi)|Wi].
Define W∗=σ(W1,···). The stopping time Tis measurable respect to W∗. The individual
constraint at time Tsatisfies
C1(δT) = E(P
i≤T{(1−θi)G0(Xi) +θiG1(Xi)}δi
(P
i≤Tδi)∨1)
=E
E
(RT∨1)−1X
i≤t{(1−θi)G0(Xi) +θiG1(Xi)}δi| W∗	

(i)=E
(Rt∨1)−1X
i≤t{E
(1−θi)|Wi	
G0(Xi) +E
θi|Wi	
G1(Xi)}δi

=E
(Rt∨1)−1X
i≤t{LiG0(Xi) + (1 −Li)G1(Xi)}δi	
.
The(i)holds since Xi’s are independent of each other. By construction of the selection rule, we have
that at the stopping time T,((RT∨1)−1P
i≤T{LiW0(Xi) + (1 −Li)W1(Xi)}δi≤α. It follows
thatC1(δT)≤αat a random time T. By construction of the selection rule, we have for stopping
timeT,
XX
1≤i<j≤Tg(Xi,Xj)δiδj(1−Li)(1−Lj)≤K×XX
1≤i<j≤Tδiδj(1−Li)(1−Lj).(10)
Taking expectations on both sides of inequality (10) and by double expectation theorem, we finally
obtain
EnXX
1≤i<j≤Tg(Xi,Xj)δiδjθiθjo
≤K×EnXX
1≤i<j≤Tδiδjθiθjo
.
27It follows that for every time t≥T2,
C2(δT) =EnPP
1≤i<j≤Tg(Xi,Xj)δiδjθiθjo
En
(P
i≤Tδiθi)(P
i≤Tδiθi−1)o≤K
□
E.3 Proof of Theorem 3.3
Proof . In the data-driven II-COS procedure, δiis determined by the estimated lFDR bLiand we have
1
RtX
i≤t{bLiG0(Xi) + (1 −bLi)G1(Xi)}δi≤α.
Note that
C1(δt) =En1
RtX
i≤t{LiG0(Xi) + (1 −Li)G1(Xi)}δio
=En1
RtX
i≤t{bLiG0(Xi) + (1 −bLi)G1(Xi)}δio
+En1
RtX
i≤t{(Li−bLi)G0(Xi) + (bLi−Li)G1(Xi)}δio
≤α+En1
RtX
i≤t{(Li−bLi)G0(Xi) + (bLi−Li)G1(Xi)}δio
.
It suffices to bound the absolute value of the second term. We have
En1
RtX
i≤t{(Li−bLi)G0(Xi) + (bLi−Li)G1(Xi)}δio
≤En1
RtX
i≤t{|Li−bLi||G0(Xi)|+|bLi−Li||G1(Xi)|}δio
≤En1
RtX
i≤t{sup
w∈R|Li−bLi||G0(Xi)|+ sup
w∈R|bLi−Li||G1(Xi)|}δio
≤2cGD2n−β
2β+1
1p
logn1+ 2n−1
1+n−1
3
1.
The last inequality follows from Lemma E.3 and max w|bL(w)−L(w)| ≤1. Notice that n−1
3
1≤
n−β
2β+1
1 byβ≤1. We have
C1(δt)≤α+Dn−β
2β+1
1p
logn1,
where D= 2cGD2+ 3. □
E.4 Proof of Theorem 3.4
Proof . Notice that
EnXX
1≤i<j≤tg(Xi,Xj)δiδj(1−bLi)(1−bLj)−XX
1≤i<j≤tg(Xi,Xj)δiδj(1−Li)(1−Lj)o
≤EnXX
1≤i<j≤tg(Xi,Xj)δiδj(|bLi−Li|+|bLj−Lj|+bLi|bLj−Lj|+Lj|bLi−Li|)o
(i)
≤2cgEnXX
1≤i<j≤tδiδj(|bLi−Li|+|bLj−Lj|)o
(ii)
≤2cgDn−β
2β+1
1p
logn1E(XX
1≤i<j≤tδiδj). (11)
28The(i)holds by Assumption 3.2 and L(w),bL(w)≤1even when tis random, as the uniform
convergence of bL(w). And (ii)follows from Lemma E.3. By the similar arguments we have
EnXX
1≤i<j≤tδiδj(1−bLi)(1−bLj)−XX
1≤i<j≤tδiδj(1−Li)(1−Lj)o
≤2Dn−β
2β+1
1p
logn1E(XX
1≤i<j≤tδiδj). (12)
Denote ∆n1=Dn−β
2β+1
1√logn1. Combining (11) and (12), it follows that for every time t≥Ts,
C2(δt) =EnPP
1≤i<j≤tg(Xi,Xj)δiδj(1−Li)(1−Lj)o
EnPP
1≤i<j≤tδiδj(1−Li)(1−Lj)o
(i)
≤EnPP
1≤i<j≤tg(Xi,Xj)δiδj(1−bLi)(1−bLj)o
+ 2cg∆n1E(PP
1≤i<j≤tδiδj)
EnPP
1≤i<j≤tδiδj(1−Li)(1−Lj)o
(ii)
≤h
K+ 2cg∆n1E(PP
1≤i<j≤tδiδj)
EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)oi
×EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)o
EnPP
1≤i<j≤tδiδj(1−Li)(1−Lj)o
(iii)
≤n
K+2cg∆n1
1−2mα′
m−1o
×EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)o
EnPP
1≤i<j≤tδiδj(1−Li)(1−Lj)o
(iv)
≤n
K+2cg∆n1
1−2mα′
m−1o
×h
1−2∆n1E(PP
1≤i<j≤tδiδj)
EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)oi−1
(v)
≤n
K+2cg∆n1
1−2mα′
m−1on
1−2∆n1
1−2mα′
m−1o−1
.
The(i)follows from (11) , and (ii)comes from the operation of our algorithm, where
EnPP
1≤i<j≤tg(Xi,Xj)δiδj(1−bLi)(1−bLj)o
≤K·EnPP
1≤i<j≤tδiδj(1−bLi)(1−bLj)o
.
The(iii)and(v)are directly from Lemma E.4. The (iv)holds due to (12). Thus we have
C2(δt)≤K+(K+cg)∆n1
0.5−mα′
m−1−∆n1
□
E.5 Proof of Corollary 3.5
Proof . Define the C1constraint conditional on Was
C′
1(δt) =1
RtX
i≤t{(Li−bLi)G0(Xi) + (bLi−Li)G1(Xi)}δi.
By the proofs of Theorem 3.3, we have for any t
C′
1(δt)≤α+ 2cGsup
w∈R|bL(w)−L(w)|.
29Hence at stopping time Tm, we have
C′
1(δTm) =E[C′
1(δTm)]≤E[sup
tC′
1(δt)]≤α+ 2cGE[ sup
w∈R|bL(w)−L(w)|]≤α+ ∆ n1.
By the proof of Theorem 3.4, we can also drop off the expectation and replace ∆n1with
supw∈R|bL(w)−L(w)|. That is
{1−2 supw∈R|bL(w)−L(w)|
1−2mα
m−1oXX
1≤i<j≤tg(Xi,Xj)δiδj(1−Li)(1−Lj)
≤n
K+2cgsupw∈R|bL(w)−L(w)|
1−2mα
m−1oXX
1≤i<j≤tδiδj(1−Li)(1−Lj). (13)
Hence at stopping time t=Tm, (13) still holds. Take expectations at both sides and we will get
C2(δTm)≤K+(K+cg)∆n1
0.5−mα′
m−1−∆n1.
Notice that ∆n1=Dn−β
2β+1
1√logn1converges to 0asn1→ ∞ andα′<(1−1/m)/2by the
condition. It follows that
lim
n1→∞C1(δTm)≤αand lim
n1→∞C2(δTm)≤K.
E.6 Proof of Theorem C.1
Proof . We first denote some notations. For notational simplicity, we use cto denote constants in the
following proofs.
Recall the conformal score function Q(Xt). The conformal p-value is
bpt=1 +P
i∈LI{Q(˜Wi)≤Q(Wt)}
1 +|L|=bFn2(Zt),
where n2=|L|.
Denote the population p-value as pt=F(Q(Wt)), where F(·)is the distribution of Q(Wt)condi-
tional on θt= 0. Denote πt= Pr( θt= 1) and
πλ
t= 1−Pr(pt> λ)
1−λ.
The corresponding local FDR is defined as
Lλ
t=πλ
tf0(Wt)
ft(Wt).
It follows the definition of Cλ
1(δt)andCλ
2(δt).
Cλ
1(δt) =En1
RtX
i≤t{Lλ
iG0(Xi) + (1 −Lλ
i)G1(Xi)}δio
and
Cλ
2(δt) =E{PP
1≤i<j≤tg(Xi,Xj)δiδj(1−Lλ
i)(1−Lλ
j)}
E{PP
1≤i<j≤tg(Xi,Xj)δiδj}.
The estimated proportion is defined as
bπλ
t= 1−Pt−1
j=t−qκb(j−t)I{bpj> λ}
(1−λ)Pt−1
j=t−qκb(j−t).
30And denote the ideal estimated proportion via population p-values as
˜πλ
t= 1−Pt−1
j=t−qκb(j−t)I{pj> λ}
(1−λ)Pt−1
j=t−qκb(j−t),
where κb(s) = exp {−|s|/b}andqis the size of a neighborhood for estimation before time t.
We first claim the following proposition and the proof is deferred in Section E.7.
Proposition E.7. Suppose the assumptions in Theorem 3 hold. Then
|bπλ−πλ| ≤cmaxn1
b,√logn1
n1/2
1,(bη)2o1/2−γ
(14)
with probability 1−maxn
1/b,p
logn1/n1,(bη)2o2γ
, where c >0is a constant and 0< γ < 1/2.
Notice that
sup
w|bft(w)−ft(w)|
= sup
w|bf0(w)(1−bπt) +bf1(w)bπt−f0(w)(1−πt)−f1(w)πt|
≤sup
w|bf0(w)−f0(w)|+ sup
w|bf1(w)−f1(w)|+ 2M|bπt−πt|.
The last inequality holds since bπt∈[0,1]andf0(w)andf1(w)are upper bounded by M.
Thus by Lemma E.1 and take γin Proposition E.7 at 1/6, with probability 1−
cmaxn
1/b,p
logn1/n1,(bη)2o1/3
we have
sup
w|bft(w)−ft(w)| ≤cn−β
2β+1
1p
logn1+cmaxn
b−1
3,logn1
n11
6,(bη)2
3o
.
By the procedure of Lemma E.3 directly, with probability 1−cmaxn
1/b,p
logn1/n1,(bη)2o1/3
we have
sup
w|bLλ
t(w)−Lλ
t(w)| ≤cn−β
2β+1
1p
logn1+cmaxn
b−1
3,logn1
n11
6,(bη)2
3o
.
It follows that
Cλ
1(δt)≤α+cn−β
2β+1
1p
logn1+ 2ccGmaxn
b−1
3,logn1
n11
6,(bη)2
3o
.
Denote ∆′
n1= 2ccGn−β
2β+1
1√logn1+cmaxn
b−1
3,
logn1
n11
6,(bη)2
3o
. By our assumption, bη=
o(1). So
lim
b,n1→∞∆′
n1= 0.
By the additional assumption that Pr(pt> λ|θt= 1) = 0 , we have πλ
t=πt. Thus Hence the first
part of Theorem 3 is completed.
At last, we can use the same procedure to prove that
Cλ
2(δt)≤K+(K+cg)∆′
n1
0.5−mα′
m−1−∆′n1.
Since πλ
t=πt,Cλ
2(δt) =C2(δt)and the results directly follow.
31E.7 Proof of Proposition E.7
Proof. Notice that
Pr(|bπλ
t−πλ
t|> ε)≤Pr
|bπλ
t−˜πλ
t|>ε
2
+ Pr
|˜πλ
t−πλ
t|>ε
2
.
We discuss for the two parts respectively. For the first term of the above inequality, it suffices to show
the upper bound of the second moment of |bπλ
t−˜πλ
t|.
For convenience, denote Uj=I(pj> λ), and Vj=I(bpj> λ). It follows
E{|bπλ
t−˜πλ
t|2}
=1
{Pt−1
j=t−qκb(j−t)}2(1−λ)2E
t−1X
j=t−qκb(j−t)(Uj−Vj)
2
=Pt−1
j=t−qκ2
b(j−t)E{(Uj−Vj)2}
{Pt−1
j=t−qκb(j−t)}2(1−λ)2+P
i,j∈Nq(t),q̸=jκb(i−t)κb(j−t)E{(Ui−Vi)(Uj−Vj)}
{Pt−1
j=t−qκb(j−t)}2(1−λ)2
=1
{Pt−1
j=t−qκb(j−t)}2(1−λ)2ht−1X
j=t−qκ2
b(j−t)n
Pr(pj> λ) + Pr( bpj> λ)−2 Pr(pj> λ,bpj> λ)o
+2X
t−q≤i<j≤t−1κb(i−t)κb(j−t)n
Pr(pi> λ, p j> λ)−2 Pr(bpi> λ, p j> λ) + Pr( bpi> λ,bpj> λ)oi
.
Now we check the upper bound of |pj−bpj|. We can rewrite them as pj=F(Q(Wj))and
bpj=bFn2(Q(Wj)). Even though n2is a random variable, due to the two-group model, bFn2(·)is still
an empirical distribution function composed by i.i.d. samples conditional on {˜θi}i∈Cwhere Cis the
index set of calibration set. Thus by DKW inequality, for any ε1>0
Pr (|pj−bpj| ≤ε1) =Eh
Pr
|pj−bpj| ≤ε1| {˜θi}i∈Ci
≤Eh
Pr
sup
zF(z)−bFn2(z)≤ε1| {˜θi}i∈Ci
≤Eh
1−2 exp{−n2ε2
1}i
≤1−2 exp{−(1−π)n1ε2
1} −4π/{n1(1−π)}.
The last inequality holds since n2≥(1−π)n1/2with probability 1−4π/{n1(1−π)}.
Thus by Lemma E.5 and the fact that pjhas a bounded density function, we obtain
|Pr(pj> λ)−Pr(bpj> λ)| ≤2ε1+ 6 exp {−(1−π)n1ε2
1}+ 12π/{n1(1−π)}.
Takeε1=p
logn1/{n1(1−π)}, for sufficient large n1such that√n1logn1≥6 + 6 πwe have
|Pr(pj> λ)−Pr(bpj> λ)| ≤2√logn1
(1−π)n1/2+6 + 12 π/(1−π)
n1≤3√logn1
(1−π)n1/2.
Again by Lemma E.5 and the same ε1, for any i, j∈ {t−q, . . . , t −1}:=Nq(t), we have
|Pr(pj> λ, p i> λ)−Pr(bpj> λ,bpi> λ)| ≤4ε1+12 exp {−(1−π)n1ε2
1}+24π
n1(1−π)≤6√logn1
(1−π)n1/2
1.
Therefore by Lemma E.6, we have
E(|bπλ
t−˜πλ
t|)≤9Cb√logn1
bn1/2
1(1−π)(1−λ)2+12√logn1
n1/2
1(1−π)(1−λ)2.
32So by definition and Markov’ inequality, we have
Pr
|bπλ
t−˜πλ
t|>ε
2
≤4E(|bπλ
t−˜πλ
t|)
ε2
≤36Cb√logn1
bn1/2
1(1−π)(1−λ)2ε2+48√logn1
n1/2
1(1−π)(1−λ)2ε2
For the second part, we have
Pr
|˜πλ
t−πλ
t|>ε
2
= Pr Pr(pt> λ)
1−λ−Pt−1
j=t−qκb(j−t)I{pj> λ}
{Pt−1
j=t−qκb(j−t)}2(1−λ)>ε
2!
≤4EhPt−1
j=t−qκb(j−t){Pr(pt> λ)−I(pj> λ)}i2
{Pt−1
j=t−qκb(j−t)}2ε2(1−λ)2
=4Pt−1
j=t−qκ2
b(j−t)
Var{I(pj> λ)}+{Pr(pj> λ)−Pr(pt> λ)}2
{Pt−1
j=t−qκb(j−t)}2ε2(1−λ)2
(i)
≤Cb
bε2(1−λ)2+4Pt−1
j=t−qκ2
b(j−t){Pr(pj> λ)−Pr(pt> λ)}2
{Pt−1
j=t−qκ2
b(j−t)}2ε2(1−λ)2
(ii)
≤Cb
bε2(1−λ)2+16η2Pt−1
j=t−q(j−t)2κ2
b(j−t)
{Pt−1
j=t−qκ2
b(j−t)}2ε2(1−λ)2
(iii)
≤Cb
bε2(1−λ)2+16(Cbbη)2
{Pt−1
j=t−qκ2
b(j−t)}2ε2(1−λ)2(15)
The(i)holds since Var{I(pj> λ)} ≤1/4. As for ( ii), consider Aλ={w:F(Q(w))> λ}. Then
by the two-group model we have Pr(pt> λ) =R
Aλ{f0(w)(1−πt) +f1(w)πt}dw.Hence
|Pr(pj> λ)−Pr(pt> λ)|=Z
Aλn
f0(w)|πj−πt|+f1(w)|πt−πj|o
dw≤2|j−t|η
by our assumptions. And ( iii) is directly from the second part of Lemma E.6.
Above all, we finally conclude that for all ε >0and sufficiently large n1, we have
Pr(|bπλ
t−πλ
t|> ε)≤Cb
bε2(1−λ)2+36Cb√logn1
bn1/2
1(1−π)(1−λ)2ε2+48√logn1
n1/2
1(1−π)(1−λ)2ε2+16(Cbbη)2
ε2(1−λ)2
≤maxn1
b,√logn1
n1/2
1,(bη)2oc
ε2
for some constant c >0.
Thus take ε= maxn
1/b,√logn1/n1/2
1,(bη)2o1/2−γ√cand we obtain
|bπλ−πλ| ≤cmaxn1
b,√logn1
n1/2
1,(bη)2o1/2−γ
with probability 1−maxn
1/b,p
logn1/n1,(bη)2o2γ
, where 0< γ < 1/2. Hence we complete
the proof.
33NeurIPS Paper Checklist
1.Claims
Question: Do the main claims made in the abstract and introduction accurately reflect the
paper’s contributions and scope?
Answer: [Yes]
Justification: See the end of Sect. 1, we summarize our main contributions. The experimental
results in Sect. 4 and Appendix D validate the theoretical results in Sect. 3 and Appendix C.
Guidelines:
•The answer NA means that the abstract and introduction do not include the claims
made in the paper.
•The abstract and/or introduction should clearly state the claims made, including the
contributions made in the paper and important assumptions and limitations. A No or
NA answer to this question will not be perceived well by the reviewers.
•The claims made should match theoretical and experimental results, and reflect how
much the results can be expected to generalize to other settings.
•It is fine to include aspirational goals as motivation as long as it is clear that these goals
are not attained by the paper.
2.Limitations
Question: Does the paper discuss the limitations of the work performed by the authors?
Answer: [Yes]
Justification: In Sect. 5, we discuss the limitations of our II-COS algorithm. In Sect. 3, we
have explained why our assumptions are weak piece by piece. And see Subsect. 2.2 for the
details about our computational complexity.
Guidelines:
•The answer NA means that the paper has no limitation while the answer No means that
the paper has limitations, but those are not discussed in the paper.
• The authors are encouraged to create a separate "Limitations" section in their paper.
•The paper should point out any strong assumptions and how robust the results are to
violations of these assumptions (e.g., independence assumptions, noiseless settings,
model well-specification, asymptotic approximations only holding locally). The authors
should reflect on how these assumptions might be violated in practice and what the
implications would be.
•The authors should reflect on the scope of the claims made, e.g., if the approach was
only tested on a few datasets or with a few runs. In general, empirical results often
depend on implicit assumptions, which should be articulated.
•The authors should reflect on the factors that influence the performance of the approach.
For example, a facial recognition algorithm may perform poorly when image resolution
is low or images are taken in low lighting. Or a speech-to-text system might not be
used reliably to provide closed captions for online lectures because it fails to handle
technical jargon.
•The authors should discuss the computational efficiency of the proposed algorithms
and how they scale with dataset size.
•If applicable, the authors should discuss possible limitations of their approach to
address problems of privacy and fairness.
•While the authors might fear that complete honesty about limitations might be used by
reviewers as grounds for rejection, a worse outcome might be that reviewers discover
limitations that aren’t acknowledged in the paper. The authors should use their best
judgment and recognize that individual actions in favor of transparency play an impor-
tant role in developing norms that preserve the integrity of the community. Reviewers
will be specifically instructed to not penalize honesty concerning limitations.
3.Theory Assumptions and Proofs
Question: For each theoretical result, does the paper provide the full set of assumptions and
a complete (and correct) proof?
34Answer: [Yes]
Justification: For the theory assumptions, see Assumption 3.1-Assumption 3.2 in Sect. 3.
For the proofs of each theoretical result, see Appendix E in the Supplementary material.
Guidelines:
• The answer NA means that the paper does not include theoretical results.
•All the theorems, formulas, and proofs in the paper should be numbered and cross-
referenced.
•All assumptions should be clearly stated or referenced in the statement of any theorems.
•The proofs can either appear in the main paper or the supplemental material, but if
they appear in the supplemental material, the authors are encouraged to provide a short
proof sketch to provide intuition.
•Inversely, any informal proof provided in the core of the paper should be complemented
by formal proofs provided in appendix or supplemental material.
• Theorems and Lemmas that the proof relies upon should be properly referenced.
4.Experimental Result Reproducibility
Question: Does the paper fully disclose all the information needed to reproduce the main ex-
perimental results of the paper to the extent that it affects the main claims and/or conclusions
of the paper (regardless of whether the code and data are provided or not)?
Answer: [Yes]
Justification: See Appendix B for the implementation details to reproduce our experimental
results.
Guidelines:
• The answer NA means that the paper does not include experiments.
•If the paper includes experiments, a No answer to this question will not be perceived
well by the reviewers: Making the paper reproducible is important, regardless of
whether the code and data are provided or not.
•If the contribution is a dataset and/or model, the authors should describe the steps taken
to make their results reproducible or verifiable.
•Depending on the contribution, reproducibility can be accomplished in various ways.
For example, if the contribution is a novel architecture, describing the architecture fully
might suffice, or if the contribution is a specific model and empirical evaluation, it may
be necessary to either make it possible for others to replicate the model with the same
dataset, or provide access to the model. In general. releasing code and data is often
one good way to accomplish this, but reproducibility can also be provided via detailed
instructions for how to replicate the results, access to a hosted model (e.g., in the case
of a large language model), releasing of a model checkpoint, or other means that are
appropriate to the research performed.
•While NeurIPS does not require releasing code, the conference does require all submis-
sions to provide some reasonable avenue for reproducibility, which may depend on the
nature of the contribution. For example
(a)If the contribution is primarily a new algorithm, the paper should make it clear how
to reproduce that algorithm.
(b)If the contribution is primarily a new model architecture, the paper should describe
the architecture clearly and fully.
(c)If the contribution is a new model (e.g., a large language model), then there should
either be a way to access this model for reproducing the results or a way to reproduce
the model (e.g., with an open-source dataset or instructions for how to construct
the dataset).
(d)We recognize that reproducibility may be tricky in some cases, in which case
authors are welcome to describe the particular way they provide for reproducibility.
In the case of closed-source models, it may be that access to the model is limited in
some way (e.g., to registered users), but it should be possible for other researchers
to have some path to reproducing or verifying the results.
5.Open access to data and code
35Question: Does the paper provide open access to the data and code, with sufficient instruc-
tions to faithfully reproduce the main experimental results, as described in supplemental
material?
Answer: [Yes]
Justification: We provide the data and code in the supplemental materials, including sufficient
instructions in the zip file.
Guidelines:
• The answer NA means that paper does not include experiments requiring code.
•Please see the NeurIPS code and data submission guidelines ( https://nips.cc/
public/guides/CodeSubmissionPolicy ) for more details.
•While we encourage the release of code and data, we understand that this might not be
possible, so “No” is an acceptable answer. Papers cannot be rejected simply for not
including code, unless this is central to the contribution (e.g., for a new open-source
benchmark).
•The instructions should contain the exact command and environment needed to run to
reproduce the results. See the NeurIPS code and data submission guidelines ( https:
//nips.cc/public/guides/CodeSubmissionPolicy ) for more details.
•The authors should provide instructions on data access and preparation, including how
to access the raw data, preprocessed data, intermediate data, and generated data, etc.
•The authors should provide scripts to reproduce all experimental results for the new
proposed method and baselines. If only a subset of experiments are reproducible, they
should state which ones are omitted from the script and why.
•At submission time, to preserve anonymity, the authors should release anonymized
versions (if applicable).
•Providing as much information as possible in supplemental material (appended to the
paper) is recommended, but including URLs to data and code is permitted.
6.Experimental Setting/Details
Question: Does the paper specify all the training and test details (e.g., data splits, hyper-
parameters, how they were chosen, type of optimizer, etc.) necessary to understand the
results?
Answer: [Yes]
Justification: In Sect.4 and Appendix B, we provide the experimental setting/details.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The experimental setting should be presented in the core of the paper to a level of detail
that is necessary to appreciate the results and make sense of them.
•The full details can be provided either with the code, in appendix, or as supplemental
material.
7.Experiment Statistical Significance
Question: Does the paper report error bars suitably and correctly defined or other appropriate
information about the statistical significance of the experiments?
Answer: [Yes]
Justification: We calculate the standard error across 500 replications and show the error bars
in experimental results, which is calculated by mean +/−se.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The authors should answer "Yes" if the results are accompanied by error bars, confi-
dence intervals, or statistical significance tests, at least for the experiments that support
the main claims of the paper.
•The factors of variability that the error bars are capturing should be clearly stated (for
example, train/test split, initialization, random drawing of some parameter, or overall
run with given experimental conditions).
36•The method for calculating the error bars should be explained (closed form formula,
call to a library function, bootstrap, etc.)
• The assumptions made should be given (e.g., Normally distributed errors).
•It should be clear whether the error bar is the standard deviation or the standard error
of the mean.
•It is OK to report 1-sigma error bars, but one should state it. The authors should
preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis
of Normality of errors is not verified.
•For asymmetric distributions, the authors should be careful not to show in tables or
figures symmetric error bars that would yield results that are out of range (e.g. negative
error rates).
•If error bars are reported in tables or plots, The authors should explain in the text how
they were calculated and reference the corresponding figures or tables in the text.
8.Experiments Compute Resources
Question: For each experiment, does the paper provide sufficient information on the com-
puter resources (type of compute workers, memory, time of execution) needed to reproduce
the experiments?
Answer: [Yes]
Justification: See Appendix B.4 for the compute resources and more details about the
execution time.
Guidelines:
• The answer NA means that the paper does not include experiments.
•The paper should indicate the type of compute workers CPU or GPU, internal cluster,
or cloud provider, including relevant memory and storage.
•The paper should provide the amount of compute required for each of the individual
experimental runs as well as estimate the total compute.
•The paper should disclose whether the full research project required more compute
than the experiments reported in the paper (e.g., preliminary or failed experiments that
didn’t make it into the paper).
9.Code Of Ethics
Question: Does the research conducted in the paper conform, in every respect, with the
NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines ?
Answer: [Yes]
Justification: All the authors have reviewed the NeurIPS Code of Ethics guidelines and
ensured that our paper conforms to them.
Guidelines:
•The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.
•If the authors answer No, they should explain the special circumstances that require a
deviation from the Code of Ethics.
•The authors should make sure to preserve anonymity (e.g., if there is a special consid-
eration due to laws or regulations in their jurisdiction).
10.Broader Impacts
Question: Does the paper discuss both potential positive societal impacts and negative
societal impacts of the work performed?
Answer: [Yes]
Justification: We have discussed the broader impacts of our work in Section 5.
Guidelines:
• The answer NA means that there is no societal impact of the work performed.
•If the authors answer NA or No, they should explain why their work has no societal
impact or why the paper does not address societal impact.
37•Examples of negative societal impacts include potential malicious or unintended uses
(e.g., disinformation, generating fake profiles, surveillance), fairness considerations
(e.g., deployment of technologies that could make decisions that unfairly impact specific
groups), privacy considerations, and security considerations.
•The conference expects that many papers will be foundational research and not tied
to particular applications, let alone deployments. However, if there is a direct path to
any negative applications, the authors should point it out. For example, it is legitimate
to point out that an improvement in the quality of generative models could be used to
generate deepfakes for disinformation. On the other hand, it is not needed to point out
that a generic algorithm for optimizing neural networks could enable people to train
models that generate Deepfakes faster.
•The authors should consider possible harms that could arise when the technology is
being used as intended and functioning correctly, harms that could arise when the
technology is being used as intended but gives incorrect results, and harms following
from (intentional or unintentional) misuse of the technology.
•If there are negative societal impacts, the authors could also discuss possible mitigation
strategies (e.g., gated release of models, providing defenses in addition to attacks,
mechanisms for monitoring misuse, mechanisms to monitor how a system learns from
feedback over time, improving the efficiency and accessibility of ML).
11.Safeguards
Question: Does the paper describe safeguards that have been put in place for responsible
release of data or models that have a high risk for misuse (e.g., pretrained language models,
image generators, or scraped datasets)?
Answer: [NA]
Guidelines:
• The answer NA means that the paper poses no such risks.
•Released models that have a high risk for misuse or dual-use should be released with
necessary safeguards to allow for controlled use of the model, for example by requiring
that users adhere to usage guidelines or restrictions to access the model or implementing
safety filters.
•Datasets that have been scraped from the Internet could pose safety risks. The authors
should describe how they avoided releasing unsafe images.
•We recognize that providing effective safeguards is challenging, and many papers do
not require this, but we encourage authors to take this into account and make a best
faith effort.
12.Licenses for existing assets
Question: Are the creators or original owners of assets (e.g., code, data, models), used in
the paper, properly credited and are the license and terms of use explicitly mentioned and
properly respected?
Answer: [Yes]
Justification: We have cited and provided the URL of the dataset we use in the paper, see
Sect. 4 and the references.
Guidelines:
• The answer NA means that the paper does not use existing assets.
• The authors should cite the original paper that produced the code package or dataset.
•The authors should state which version of the asset is used and, if possible, include a
URL.
• The name of the license (e.g., CC-BY 4.0) should be included for each asset.
•For scraped data from a particular source (e.g., website), the copyright and terms of
service of that source should be provided.
•If assets are released, the license, copyright information, and terms of use in the
package should be provided. For popular datasets, paperswithcode.com/datasets
has curated licenses for some datasets. Their licensing guide can help determine the
license of a dataset.
38•For existing datasets that are re-packaged, both the original license and the license of
the derived asset (if it has changed) should be provided.
•If this information is not available online, the authors are encouraged to reach out to
the asset’s creators.
13.New Assets
Question: Are new assets introduced in the paper well documented and is the documentation
provided alongside the assets?
Answer: [NA]
Guidelines:
• The answer NA means that the paper does not release new assets.
•Researchers should communicate the details of the dataset/code/model as part of their
submissions via structured templates. This includes details about training, license,
limitations, etc.
•The paper should discuss whether and how consent was obtained from people whose
asset is used.
•At submission time, remember to anonymize your assets (if applicable). You can either
create an anonymized URL or include an anonymized zip file.
14.Crowdsourcing and Research with Human Subjects
Question: For crowdsourcing experiments and research with human subjects, does the paper
include the full text of instructions given to participants and screenshots, if applicable, as
well as details about compensation (if any)?
Answer: [NA]
Guidelines:
•The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
•Including this information in the supplemental material is fine, but if the main contribu-
tion of the paper involves human subjects, then as much detail as possible should be
included in the main paper.
•According to the NeurIPS Code of Ethics, workers involved in data collection, curation,
or other labor should be paid at least the minimum wage in the country of the data
collector.
15.Institutional Review Board (IRB) Approvals or Equivalent for Research with Human
Subjects
Question: Does the paper describe potential risks incurred by study participants, whether
such risks were disclosed to the subjects, and whether Institutional Review Board (IRB)
approvals (or an equivalent approval/review based on the requirements of your country or
institution) were obtained?
Answer: [NA]
Guidelines:
•The answer NA means that the paper does not involve crowdsourcing nor research with
human subjects.
•Depending on the country in which research is conducted, IRB approval (or equivalent)
may be required for any human subjects research. If you obtained IRB approval, you
should clearly state this in the paper.
•We recognize that the procedures for this may vary significantly between institutions
and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the
guidelines for their institution.
•For initial submissions, do not include any information that would break anonymity (if
applicable), such as the institution conducting the review.
39